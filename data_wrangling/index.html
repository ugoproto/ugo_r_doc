
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A R documentation website.">
      
      
      
      
      <link rel="icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.0">
    
    
      
        <title>Data Wrangling - ugo_r_doc</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8b42a75e.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#2094f3">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700%7CUbuntu+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Ubuntu";--md-code-font-family:"Ubuntu Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue" data-md-color-accent="red">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#documentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ugo_r_doc" class="md-header__button md-logo" aria-label="ugo_r_doc" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 16 7.36-5.73L21 9l-9-7-9 7 1.63 1.27M12 18.54l-7.38-5.73L3 14.07l9 7 9-7-1.63-1.27L12 18.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ugo_r_doc
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Data Wrangling
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/ugoproto/ugo_r_doc.git/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ugo_r_doc
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ugo_r_doc" class="md-nav__button md-logo" aria-label="ugo_r_doc" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 16 7.36-5.73L21 9l-9-7-9 7 1.63 1.27M12 18.54l-7.38-5.73L3 14.07l9 7 9-7-1.63-1.27L12 18.54z"/></svg>

    </a>
    ugo_r_doc
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/ugoproto/ugo_r_doc.git/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ugo_r_doc
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Cheat Sheets
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cheat Sheets" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Cheat Sheets
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../basics_cs/" class="md-nav__link">
        Basics Cheat Sheets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../specializations_cs/" class="md-nav__link">
        Specialization Cheat Sheets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../visualization_cs/" class="md-nav__link">
        Visualization Cheat Sheets
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Code and Vade Mecum
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Code and Vade Mecum" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Code and Vade Mecum
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../frequentist_bayesian/" class="md-nav__link">
        Frequentist vs. Bayesian
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../intermediate_r/" class="md-nav__link">
        Intermediate R
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../intermediate_r_the_apply_family/" class="md-nav__link">
        Intermediate R - The apply Family
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Data Wrangling Snippets
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data Wrangling Snippets" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Data Wrangling Snippets
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../io_snippets_cleaning/" class="md-nav__link">
        I/O Snippets & Cleaning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reading_data_into_r_with_readr/" class="md-nav__link">
        Reading Data into R with readr
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data_analysis_in_r_the_data_table_way/" class="md-nav__link">
        Data Analysis in R, the data.table Way
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data_manipulation_in_r_with_dplyr/" class="md-nav__link">
        Data Manipulation in R with dplyr
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Data Wrangling
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Data Wrangling
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#documentation" class="md-nav__link">
    Documentation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-analysis-in-r-the-datatable-way" class="md-nav__link">
    Data Analysis in R, the data.table Way
  </a>
  
    <nav class="md-nav" aria-label="Data Analysis in R, the data.table Way">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-datatable-novice" class="md-nav__link">
    1, data.table novice
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-datatable-yeoman" class="md-nav__link">
    2, data.table yeoman
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-datatable-expert" class="md-nav__link">
    3, data.table expert
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-manipulation-in-r-with-dplyr" class="md-nav__link">
    Data Manipulation in R with dplyr
  </a>
  
    <nav class="md-nav" aria-label="Data Manipulation in R with dplyr">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-introduction-to-dplyr" class="md-nav__link">
    1, Introduction to dplyr
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-select-and-mutate" class="md-nav__link">
    2, select and mutate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-filter-and-arrange" class="md-nav__link">
    3, filter and arrange
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-summarise-and-the-pipe-operator" class="md-nav__link">
    4, summarise and the Pipe Operator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-group_by-and-working-with-data" class="md-nav__link">
    5, group_by and working with data
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-tidyr-functions" class="md-nav__link">
    Adding tidyr Functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extension-joining-data-in-r-with-dplyr" class="md-nav__link">
    Extension: 'Joining Data in R with dplyr'
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Packages
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Packages" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Packages
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../googlevis/" class="md-nav__link">
        googleVis (embed HTML plots)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gganimate/" class="md-nav__link">
        gganimate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../fast_and_frugal_decision_trees_in_r_with_fftrees/" class="md-nav__link">
        Fast-and-Frugal Decision Trees
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../big_data_analysis_with_revolution_r_enterprise/" class="md-nav__link">
        Big Data Analysis with Revolution R Enterprise
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../time_series_in_r_the_power_of_xts_and_zoo/" class="md-nav__link">
        Time Series in R, The Power of xts and zoo
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Plot Snippets
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Plot Snippets" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Plot Snippets
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plot_snippets_basics/" class="md-nav__link">
        Plot Snippets for Exploratory (and some Explanatory) Analyses
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plot_snippets_ggplot2/" class="md-nav__link">
        Plot Snippets - ggplot2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plot_snippets_ggvis/" class="md-nav__link">
        Plot Snippets - ggvis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plot_snippets_colours/" class="md-nav__link">
        Plot Snippets - Colours
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          RStudio
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="RStudio" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          RStudio
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../working_with_rstudio_ide/" class="md-nav__link">
        Working with the RStudio IDE
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Tables and Figures
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tables and Figures" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Tables and Figures
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tables/" class="md-nav__link">
        Tables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../embedding/" class="md-nav__link">
        Embedding HTML into HTML
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../embedding_2/" class="md-nav__link">
        Embedding Rmd into Rmd
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          A Hands-on Introduction to Statistics with R
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="A Hands-on Introduction to Statistics with R" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          A Hands-on Introduction to Statistics with R
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../a_hands-on_introduction_to_statistics_with_r_course_one_introduction/" class="md-nav__link">
        Statistics with R, Course One, Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../a_hands-on_introduction_to_statistics_with_r_course_two_student_s_t-test/" class="md-nav__link">
        Statistics with R, Course Two, Student's t-test
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../a_hands-on_introduction_to_statistics_with_r_course_three_analysis_of_variance/" class="md-nav__link">
        Statistics with R, Course Three, Analysis of Variance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../a_hands-on_introduction_to_statistics_with_r_course_four_repeated_measures_anova/" class="md-nav__link">
        Statistics with R, Course Four, Repeated Measures ANOVA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../a_hands-on_introduction_to_statistics_with_r_course_five_correlation_and_regression/" class="md-nav__link">
        Statistics with R, Course Five, Correlation and Regression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../a_hands-on_introduction_to_statistics_with_r_course_six_multiple_regression/" class="md-nav__link">
        Statistics with R, Course Six, Multiple Regression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../a_hands-on_introduction_to_statistics_with_r_course_seven_moderation_and_mediation/" class="md-nav__link">
        Statistics with R, Course Seven, Moderation and Mediation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../a_hands-on_introduction_to_statistics_with_r_notes/" class="md-nav__link">
        Statistics with R, Notes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#documentation" class="md-nav__link">
    Documentation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-analysis-in-r-the-datatable-way" class="md-nav__link">
    Data Analysis in R, the data.table Way
  </a>
  
    <nav class="md-nav" aria-label="Data Analysis in R, the data.table Way">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-datatable-novice" class="md-nav__link">
    1, data.table novice
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-datatable-yeoman" class="md-nav__link">
    2, data.table yeoman
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-datatable-expert" class="md-nav__link">
    3, data.table expert
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-manipulation-in-r-with-dplyr" class="md-nav__link">
    Data Manipulation in R with dplyr
  </a>
  
    <nav class="md-nav" aria-label="Data Manipulation in R with dplyr">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-introduction-to-dplyr" class="md-nav__link">
    1, Introduction to dplyr
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-select-and-mutate" class="md-nav__link">
    2, select and mutate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-filter-and-arrange" class="md-nav__link">
    3, filter and arrange
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-summarise-and-the-pipe-operator" class="md-nav__link">
    4, summarise and the Pipe Operator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-group_by-and-working-with-data" class="md-nav__link">
    5, group_by and working with data
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-tidyr-functions" class="md-nav__link">
    Adding tidyr Functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extension-joining-data-in-r-with-dplyr" class="md-nav__link">
    Extension: 'Joining Data in R with dplyr'
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ugoproto/ugo_r_doc.git/edit/master/docs/data_wrangling.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>Data Wrangling</h1>
                
                <!--

-   [Documentation](#documentation)
-   [Data Analysis in R, the `data.table` Way](#data-analysis-in-r-the-data.table-way)
    -   [1, `data.table` novice](#data.table-novice)
    -   [2, `data.table` yeoman](#data.table-yeoman)
    -   [3, `data.table` expert](#data.table-expert)
-   [Data Manipulation in R with `dplyr`](#data-manipulation-in-r-with-dplyr)
    -   [1, Introduction to `dplyr`](#introduction-to-dplyr)
    -   [2, `select` and `mutate`](#select-and-mutate)
    -   [3, `filter` and `arrange`](#filter-and-arrange)
    -   [4, `summarise` and the Pipe Operator](#summarise-and-the-pipe-operator)
    -   [5, `group_by` and working with data](#group_by-and-working-with-data)
-   [Adding `tidyr` Functions](#adding-tidyr-functions)
-   [Extension: 'Joining Data in R with `dplyr`'](#extension-joining-data-in-r-with-dplyr)
-->
<hr />
<p><strong>Foreword</strong></p>
<ul>
<li>Output options: the &lsquo;tango&rsquo; syntax and the &lsquo;readable&rsquo; theme.</li>
<li>Snippets and results.</li>
</ul>
<hr />
<h3 id="documentation">Documentation<a class="headerlink" href="#documentation" title="Permanent link">&para;</a></h3>
<p><code>data.table</code></p>
<ul>
<li>extension of <code>data.frame</code>.</li>
<li>Fast aggregation of large data (e.g. 100GB in RAM), fast ordered<br />
    joins, fast add/modify/delete of columns by group using no copies at<br />
    all, list columns, a fast friendly file reader and parallel<br />
    file writer. Offers a natural and flexible syntax, for<br />
    faster development.</li>
</ul>
<p><code>dplyr</code></p>
<ul>
<li>A fast, consistent tool for working with data frame like objects,<br />
    both in memory and out of memory.</li>
<li>Pipelines.</li>
</ul>
<p><code>tidyr</code></p>
<ul>
<li>An evolution of &lsquo;reshape2&rsquo;. It&rsquo;s designed specifically for data<br />
    tidying (not general reshaping or aggregating) and works well with<br />
    dplyr data pipelines.</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">package</th>
<th align="left">'narrower'</th>
<th align="left">'wider'</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>tidyr</code></td>
<td align="left">gather</td>
<td align="left">spread</td>
</tr>
<tr class="even">
<td align="left"><code>reshape2</code></td>
<td align="left">melt</td>
<td align="left">cast</td>
</tr>
<tr class="odd">
<td align="left">spreadsheets</td>
<td align="left">unpivot</td>
<td align="left">pivot</td>
</tr>
<tr class="even">
<td align="left">databases</td>
<td align="left">fold</td>
<td align="left">unfold</td>
</tr>
</tbody>
</table>

<h2 id="data-analysis-in-r-the-datatable-way">Data Analysis in R, the <code>data.table</code> Way<a class="headerlink" href="#data-analysis-in-r-the-datatable-way" title="Permanent link">&para;</a></h2>
<h3 id="1-datatable-novice">1, <code>data.table</code> novice<a class="headerlink" href="#1-datatable-novice" title="Permanent link">&para;</a></h3>
<p>Find out more with <code>?data.table</code>.</p>
<p><strong>Create and subset a <code>data.table</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># The data.table package</span>
<span class="nf">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span>

<span class="c1"># Create my_first_data_table</span>
<span class="n">my_first_data_table</span> <span class="o">&lt;-</span> <span class="nf">data.table</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="s">&#39;e&#39;</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">))</span>

<span class="c1"># Create a data.table using recycling</span>
<span class="n">DT</span> <span class="o">&lt;-</span> <span class="nf">data.table</span><span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="s">&#39;B&#39;</span><span class="p">,</span> <span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;D&#39;</span><span class="p">))</span>

<span class="c1"># Print the third row to the console</span>
<span class="n">DT</span><span class="p">[</span><span class="m">3</span><span class="p">,]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    a b
## 1: 1 C
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Print the second and third row to the console, but do not commas</span>
<span class="n">DT</span><span class="p">[</span><span class="m">2</span><span class="o">:</span><span class="m">3</span><span class="p">]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    a b
## 1: 2 B
## 2: 1 C
</code></pre></div>
</td></tr></table>
<p><strong>Getting to know a <code>data.table</code></strong></p>
<p>Like <code>head</code>, <code>tail</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Print the penultimate row of DT using .N</span>
<span class="n">DT</span><span class="p">[</span><span class="n">.N</span> <span class="o">-</span> <span class="m">1</span><span class="p">]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    a b
## 1: 1 C
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Print the column names of DT, and number of rows and number of columns</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">DT</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## [1] &quot;a&quot; &quot;b&quot;
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">dim</span><span class="p">(</span><span class="n">DT</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## [1] 4 2
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Select row 2 twice and row 3, returning a data.table with three rows where row 2 is a duplicate of row 1.</span>
<span class="n">DT</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">)]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    a b
## 1: 2 B
## 2: 2 B
## 3: 1 C
</code></pre></div>
</td></tr></table>
<p><code>DT</code> is a data.table/data.frame, but <code>DT[ , B]</code> is a vector;<br />
<code>DT[ , .(B)]</code> is a subsetted data.table.</p>
<p><strong>Subsetting data tables</strong></p>
<p><code>DT[i, j, by]</code> means take <code>DT</code>, subset rows using <code>i</code>, then calculate<br />
<code>j</code> grouped by <code>by</code>. You can wrap <code>j</code> with <code>.()</code>.</p>
<div class="highlight"><pre><span></span><code><span class="n">A</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">)</span>
<span class="n">B</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="s">&#39;e&#39;</span><span class="p">)</span>
<span class="n">C</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">6</span><span class="p">,</span> <span class="m">7</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="m">9</span><span class="p">,</span> <span class="m">10</span><span class="p">)</span>
<span class="n">DT</span> <span class="o">&lt;-</span> <span class="nf">data.table</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>

<span class="c1"># Subset rows 1 and 3, and columns B and C</span>
<span class="n">DT</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">)</span> <span class="p">,</span><span class="nf">.</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">)]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    B C
## 1: a 6
## 2: c 8
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Assign to ans the correct value</span>
<span class="n">ans</span> <span class="o">&lt;-</span> <span class="nf">data.table</span><span class="p">(</span><span class="n">DT</span><span class="p">[,</span> <span class="nf">.</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">C</span><span class="p">)])</span>

<span class="c1"># Fill in the blanks such that ans2 equals target</span>
<span class="c1">#target &lt;- data.table(B = c(&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;),  val = as.integer(c(6:10, 1:5)))</span>
<span class="n">ans2</span> <span class="o">&lt;-</span> <span class="nf">data.table</span><span class="p">(</span><span class="n">DT</span><span class="p">[,</span> <span class="nf">.</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="nf">as.integer</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">6</span><span class="o">:</span><span class="m">10</span><span class="p">,</span> <span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">)))])</span>
</code></pre></div>
<p><strong>The <code>by</code> basics</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># iris and iris3 are already available in the workspace</span>

<span class="c1"># Convert iris to a data.table: DT</span>
<span class="n">DT</span> <span class="o">&lt;-</span> <span class="nf">as.data.table</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>

<span class="c1"># For each Species, print the mean Sepal.Length</span>
<span class="n">DT</span><span class="p">[,</span> <span class="nf">.</span><span class="p">(</span><span class="nf">mean</span><span class="p">(</span><span class="n">Sepal.Length</span><span class="p">)),</span> <span class="n">by</span> <span class="o">=</span> <span class="nf">.</span><span class="p">(</span><span class="n">Species</span><span class="p">)]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##       Species    V1
## 1:     setosa 5.006
## 2: versicolor 5.936
## 3:  virginica 6.588
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Print mean Sepal.Length, grouping by first letter of Species</span>
<span class="n">DT</span><span class="p">[,</span> <span class="nf">.</span><span class="p">(</span><span class="nf">mean</span><span class="p">(</span><span class="n">Sepal.Length</span><span class="p">)),</span> <span class="n">by</span> <span class="o">=</span> <span class="nf">.</span><span class="p">(</span><span class="nf">substr</span><span class="p">(</span><span class="n">Species</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">))]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    substr    V1
## 1:      s 5.006
## 2:      v 6.262
</code></pre></div>
</td></tr></table>
<p><strong>Using <code>.N</code> and <code>by</code></strong></p>
<p><code>.N</code>, number, in row or column.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># data.table version of iris: DT</span>
<span class="n">DT</span> <span class="o">&lt;-</span> <span class="nf">as.data.table</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>

<span class="c1"># Group the specimens by Sepal area (to the nearest 10 cm2) and count how many occur in each group.</span>
<span class="n">DT</span><span class="p">[,</span> <span class="n">.N</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="m">10</span> <span class="o">*</span> <span class="nf">round</span><span class="p">(</span><span class="n">Sepal.Length</span> <span class="o">*</span> <span class="n">Sepal.Width</span> <span class="o">/</span> <span class="m">10</span><span class="p">)]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    round   N
## 1:    20 117
## 2:    10  29
## 3:    30   4
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Now name the output columns `Area` and `Count`</span>
<span class="n">DT</span><span class="p">[,</span> <span class="nf">.</span><span class="p">(</span><span class="n">Count</span> <span class="o">=</span> <span class="n">.N</span><span class="p">),</span> <span class="n">by</span> <span class="o">=</span> <span class="nf">.</span><span class="p">(</span><span class="n">Area</span> <span class="o">=</span> <span class="m">10</span> <span class="o">*</span> <span class="nf">round</span><span class="p">(</span><span class="n">Sepal.Length</span> <span class="o">*</span> <span class="n">Sepal.Width</span> <span class="o">/</span> <span class="m">10</span><span class="p">))]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    Area Count
## 1:   20   117
## 2:   10    29
## 3:   30     4
</code></pre></div>
</td></tr></table>
<p><strong>Return multiple numbers in <code>j</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Create the data.table DT</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">1L</span><span class="p">)</span>
<span class="n">DT</span> <span class="o">&lt;-</span> <span class="nf">data.table</span><span class="p">(</span><span class="n">A</span> <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="kc">letters</span><span class="p">[</span><span class="m">2</span><span class="o">:</span><span class="m">1</span><span class="p">],</span> <span class="n">each</span> <span class="o">=</span> <span class="m">4L</span><span class="p">),</span> <span class="n">B</span> <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,</span> <span class="n">each</span> <span class="o">=</span> <span class="m">2L</span><span class="p">),</span> <span class="n">C</span> <span class="o">=</span> <span class="nf">sample</span><span class="p">(</span><span class="m">8</span><span class="p">))</span>

<span class="c1"># Create the new data.table, DT2</span>
<span class="n">DT2</span> <span class="o">&lt;-</span> <span class="n">DT</span><span class="p">[,</span> <span class="nf">.</span><span class="p">(</span><span class="n">C</span> <span class="o">=</span> <span class="nf">cumsum</span><span class="p">(</span><span class="n">C</span><span class="p">)),</span> <span class="n">by</span><span class="o">=</span><span class="nf">.</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)]</span>

<span class="c1"># Select from DT2 the last two values from C while you group by A</span>
<span class="n">DT2</span><span class="p">[,</span> <span class="nf">.</span><span class="p">(</span><span class="n">C</span> <span class="o">=</span> <span class="nf">tail</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="m">2</span><span class="p">)),</span> <span class="n">by</span><span class="o">=</span><span class="n">A</span><span class="p">]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    A C
## 1: b 4
## 2: b 9
## 3: a 2
## 4: a 8
</code></pre></div>
</td></tr></table>
<h3 id="2-datatable-yeoman">2, <code>data.table</code> yeoman<a class="headerlink" href="#2-datatable-yeoman" title="Permanent link">&para;</a></h3>
<p><strong>Chaining, the basics</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Build DT</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">1L</span><span class="p">)</span>
<span class="n">DT</span> <span class="o">&lt;-</span> <span class="nf">data.table</span><span class="p">(</span><span class="n">A</span> <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="kc">letters</span><span class="p">[</span><span class="m">2</span><span class="o">:</span><span class="m">1</span><span class="p">],</span> <span class="n">each</span> <span class="o">=</span> <span class="m">4L</span><span class="p">),</span> <span class="n">B</span> <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,</span> <span class="n">each</span> <span class="o">=</span> <span class="m">2L</span><span class="p">),</span> <span class="n">C</span> <span class="o">=</span> <span class="nf">sample</span><span class="p">(</span><span class="m">8</span><span class="p">))</span> 
<span class="n">DT</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    A B C
## 1: b 1 3
## 2: b 1 8
## 3: b 2 4
## 4: b 2 5
## 5: a 3 1
## 6: a 3 7
## 7: a 4 2
## 8: a 4 6
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Use chaining</span>
<span class="c1"># Cumsum of C while grouping by A and B, and then select last two values of C while grouping by A</span>
<span class="n">DT</span><span class="p">[,</span> <span class="nf">.</span><span class="p">(</span><span class="n">C</span> <span class="o">=</span> <span class="nf">cumsum</span><span class="p">(</span><span class="n">C</span><span class="p">)),</span> <span class="n">by</span> <span class="o">=</span> <span class="nf">.</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)][,</span> <span class="nf">.</span><span class="p">(</span><span class="n">C</span> <span class="o">=</span> <span class="nf">tail</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="m">2</span><span class="p">)),</span> <span class="n">by</span> <span class="o">=</span> <span class="nf">.</span><span class="p">(</span><span class="n">A</span><span class="p">)]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    A C
## 1: b 4
## 2: b 9
## 3: a 2
## 4: a 8
</code></pre></div>
</td></tr></table>
<p><strong>Chaining your <code>iris</code> dataset</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">DT</span> <span class="o">&lt;-</span> <span class="nf">data.table</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>

<span class="c1"># Perform chained operations on DT</span>
<span class="n">DT</span><span class="p">[,</span> <span class="nf">.</span><span class="p">(</span><span class="n">Sepal.Length</span> <span class="o">=</span> <span class="nf">median</span><span class="p">(</span><span class="n">Sepal.Length</span><span class="p">),</span> <span class="n">Sepal.Width</span> <span class="o">=</span> <span class="nf">median</span><span class="p">(</span><span class="n">Sepal.Width</span><span class="p">),</span> <span class="n">Petal.Length</span> <span class="o">=</span> <span class="nf">median</span><span class="p">(</span><span class="n">Petal.Length</span><span class="p">),</span> <span class="n">Petal.Width</span> <span class="o">=</span> <span class="nf">median</span><span class="p">(</span><span class="n">Petal.Width</span><span class="p">)),</span> <span class="n">by</span> <span class="o">=</span> <span class="nf">.</span><span class="p">(</span><span class="n">Species</span><span class="p">)][</span><span class="nf">order</span><span class="p">(</span><span class="n">Species</span><span class="p">,</span> <span class="n">decreasing</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##       Species Sepal.Length Sepal.Width Petal.Length Petal.Width
## 1:  virginica          6.5         3.0         5.55         2.0
## 2: versicolor          5.9         2.8         4.35         1.3
## 3:     setosa          5.0         3.4         1.50         0.2
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="n">DT</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##      Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
##   1:          5.1         3.5          1.4         0.2    setosa
##   2:          4.9         3.0          1.4         0.2    setosa
##   3:          4.7         3.2          1.3         0.2    setosa
##   4:          4.6         3.1          1.5         0.2    setosa
##   5:          5.0         3.6          1.4         0.2    setosa
##  ---                                                            
## 146:          6.7         3.0          5.2         2.3 virginica
## 147:          6.3         2.5          5.0         1.9 virginica
## 148:          6.5         3.0          5.2         2.0 virginica
## 149:          6.2         3.4          5.4         2.3 virginica
## 150:          5.9         3.0          5.1         1.8 virginica
</code></pre></div>
</td></tr></table>
<p><strong>Programming time vs readability</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">7</span><span class="p">,</span> <span class="m">9</span><span class="p">,</span> <span class="m">11</span><span class="p">,</span> <span class="m">13</span><span class="p">)</span>
<span class="n">z</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">12</span><span class="p">,</span> <span class="m">14</span><span class="p">)</span>
<span class="n">DT</span> <span class="o">&lt;-</span> <span class="nf">data.table</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>

<span class="c1"># Mean of columns</span>
<span class="n">DT</span><span class="p">[,</span> <span class="nf">lapply</span><span class="p">(</span><span class="n">.SD</span><span class="p">,</span> <span class="n">mean</span><span class="p">),</span> <span class="n">by</span> <span class="o">=</span> <span class="nf">.</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span> 
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    x        y        z
## 1: 2 6.500000 7.500000
## 2: 1 7.666667 8.666667
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Median of columns</span>
<span class="n">DT</span><span class="p">[,</span> <span class="nf">lapply</span><span class="p">(</span><span class="n">.SD</span><span class="p">,</span> <span class="n">median</span><span class="p">),</span> <span class="n">by</span> <span class="o">=</span> <span class="nf">.</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    x y z
## 1: 2 7 8
## 2: 1 7 8
</code></pre></div>
</td></tr></table>
<p><strong>Introducing <code>.SDcols</code></strong></p>
<p><code>.SDcols</code> specifies the columns of <code>DT</code> that are included in <code>.SD</code>.</p>
<div class="highlight"><pre><span></span><code><span class="n">grp</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">6</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="m">8</span><span class="p">)</span>
<span class="n">Q1</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
<span class="n">Q2</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">4</span><span class="p">)</span>
<span class="n">Q3</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span>
<span class="n">H1</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">4</span><span class="p">)</span>
<span class="n">H2</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
<span class="n">DT</span> <span class="o">&lt;-</span> <span class="nf">data.table</span><span class="p">(</span><span class="n">grp</span><span class="p">,</span> <span class="n">Q1</span><span class="p">,</span> <span class="n">Q2</span><span class="p">,</span> <span class="n">Q3</span><span class="p">,</span> <span class="n">H1</span><span class="p">,</span> <span class="n">H2</span><span class="p">)</span>

<span class="c1"># Calculate the sum of the Q columns</span>
<span class="n">DT</span><span class="p">[,</span> <span class="nf">lapply</span><span class="p">(</span><span class="n">.SD</span><span class="p">,</span> <span class="n">sum</span><span class="p">),</span> <span class="n">.SDcols</span> <span class="o">=</span> <span class="m">2</span><span class="o">:</span><span class="m">4</span><span class="p">]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    Q1 Q2 Q3
## 1: 18 14 16
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Calculate the sum of columns H1 and H2 </span>
<span class="n">DT</span><span class="p">[,</span> <span class="nf">lapply</span><span class="p">(</span><span class="n">.SD</span><span class="p">,</span> <span class="n">sum</span><span class="p">),</span> <span class="n">.SDcols</span> <span class="o">=</span> <span class="m">5</span><span class="o">:</span><span class="m">6</span><span class="p">]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    H1 H2
## 1: 12 15
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Select all but the first row of groups 1 and 2, returning only the grp column and the Q columns. </span>
<span class="n">DT</span><span class="p">[,</span> <span class="n">.SD</span><span class="p">[</span><span class="m">-1</span><span class="p">],</span> <span class="n">.SDcols</span> <span class="o">=</span> <span class="m">2</span><span class="o">:</span><span class="m">4</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="nf">.</span><span class="p">(</span><span class="n">grp</span><span class="p">)]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    grp Q1 Q2 Q3
## 1:   6  3  4  1
## 2:   8  5  4  5
## 3:   8  3  4  2
</code></pre></div>
</td></tr></table>
<p><strong>Mixing it together: <code>lapply</code>, <code>.SD</code>, <code>SDcols</code> and <code>.N</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">7</span><span class="p">,</span> <span class="m">9</span><span class="p">,</span> <span class="m">11</span><span class="p">,</span> <span class="m">13</span><span class="p">)</span>
<span class="n">z</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">12</span><span class="p">,</span> <span class="m">14</span><span class="p">)</span>
<span class="n">DT</span> <span class="o">&lt;-</span> <span class="nf">data.table</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>

<span class="c1"># Sum of all columns and the number of rows</span>
<span class="c1"># For the first part, you need to combine the returned list from lapply, .SD and .SDcols and the integer vector of .N. You have to this because the result of the two together has to be a list again, with all values put together.</span>
<span class="n">DT</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    x  y  z
## 1: 2  1  2
## 2: 1  3  4
## 3: 2  5  6
## 4: 1  7  8
## 5: 2  9 10
## 6: 2 11 12
## 7: 1 13 14
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="n">DT</span><span class="p">[,</span><span class="nf">c</span><span class="p">(</span><span class="nf">lapply</span><span class="p">(</span><span class="n">.SD</span><span class="p">,</span> <span class="n">sum</span><span class="p">),</span> <span class="n">.N</span><span class="p">),</span> <span class="n">.SDcols</span> <span class="o">=</span> <span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="n">x</span><span class="p">]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    x x  y  z N
## 1: 2 8 26 30 4
## 2: 1 3 23 26 3
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Cumulative sum of column x and y while grouping by x and z &gt; 8</span>
<span class="n">DT</span><span class="p">[,</span><span class="nf">lapply</span><span class="p">(</span><span class="n">.SD</span><span class="p">,</span> <span class="n">cumsum</span><span class="p">),</span> <span class="n">.SDcols</span> <span class="o">=</span> <span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="nf">.</span><span class="p">(</span><span class="n">by1</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">by2</span> <span class="o">=</span> <span class="n">z</span> <span class="o">&gt;</span> <span class="m">8</span><span class="p">)]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    by1   by2 x  y
## 1:   2 FALSE 2  1
## 2:   2 FALSE 4  6
## 3:   1 FALSE 1  3
## 4:   1 FALSE 2 10
## 5:   2  TRUE 2  9
## 6:   2  TRUE 4 20
## 7:   1  TRUE 1 13
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Chaining</span>
<span class="n">DT</span><span class="p">[,</span><span class="nf">lapply</span><span class="p">(</span><span class="n">.SD</span><span class="p">,</span> <span class="n">cumsum</span><span class="p">),</span> <span class="n">.SDcols</span> <span class="o">=</span> <span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="nf">.</span><span class="p">(</span><span class="n">by1</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">by2</span> <span class="o">=</span> <span class="n">z</span> <span class="o">&gt;</span> <span class="m">8</span><span class="p">)][,</span><span class="nf">lapply</span><span class="p">(</span><span class="n">.SD</span><span class="p">,</span> <span class="n">max</span><span class="p">),</span> <span class="n">.SDcols</span> <span class="o">=</span> <span class="m">3</span><span class="o">:</span><span class="m">4</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="n">by1</span><span class="p">]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    by1 x  y
## 1:   2 4 20
## 2:   1 2 13
</code></pre></div>
</td></tr></table>
<p><strong>Adding, updating and removing columns</strong></p>
<p><code>:=</code> is defined for use in <code>j</code> only.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># The data.table DT</span>
<span class="n">DT</span> <span class="o">&lt;-</span> <span class="nf">data.table</span><span class="p">(</span><span class="n">A</span> <span class="o">=</span> <span class="kc">letters</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">)],</span> <span class="n">B</span> <span class="o">=</span> <span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">)</span>
<span class="n">DT</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    A B
## 1: a 1
## 2: a 2
## 3: a 3
## 4: b 4
## 5: b 5
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Add column by reference: Total</span>
<span class="n">DT</span><span class="p">[,</span> <span class="p">(</span><span class="s">&#39;Total&#39;</span><span class="p">)</span> <span class="o">:=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">B</span><span class="p">),</span> <span class="n">by</span> <span class="o">=</span> <span class="nf">.</span><span class="p">(</span><span class="n">A</span><span class="p">)]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    A B Total
## 1: a 1     6
## 2: a 2     6
## 3: a 3     6
## 4: b 4     9
## 5: b 5     9
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Add 1 to column B</span>
<span class="n">DT</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">4</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;B&#39;</span><span class="p">)</span> <span class="o">:=</span> <span class="nf">as.integer</span><span class="p">(</span><span class="m">1</span> <span class="o">+</span> <span class="n">B</span><span class="p">)]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    A B Total
## 1: a 1     6
## 2: a 3     6
## 3: a 3     6
## 4: b 5     9
## 5: b 5     9
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Add a new column Total2</span>
<span class="n">DT</span><span class="p">[</span><span class="m">2</span><span class="o">:</span><span class="m">4</span><span class="p">,</span> <span class="s">&#39;:=&#39;</span><span class="p">(</span><span class="n">Total2</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">B</span><span class="p">)),</span> <span class="n">by</span> <span class="o">=</span> <span class="nf">.</span><span class="p">(</span><span class="n">A</span><span class="p">)]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    A B Total Total2
## 1: a 1     6     NA
## 2: a 3     6      6
## 3: a 3     6      6
## 4: b 5     9      5
## 5: b 5     9     NA
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Remove the Total column</span>
<span class="n">DT</span><span class="p">[,</span> <span class="n">Total</span> <span class="o">:=</span> <span class="kc">NULL</span><span class="p">]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    A B Total2
## 1: a 1     NA
## 2: a 3      6
## 3: a 3      6
## 4: b 5      5
## 5: b 5     NA
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Select the third column using `[[`</span>
<span class="n">DT</span><span class="p">[[</span><span class="m">3</span><span class="p">]]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## [1] NA  6  6  5 NA
</code></pre></div>
</td></tr></table>
<p><strong>The functional form</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># A data.table DT</span>
<span class="n">DT</span> <span class="o">&lt;-</span> <span class="nf">data.table</span><span class="p">(</span><span class="n">A</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span> <span class="n">B</span> <span class="o">=</span> <span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">)</span>

<span class="c1"># Update B, add C and D</span>
<span class="n">DT</span><span class="p">[,</span> <span class="nf">`:=`</span><span class="p">(</span><span class="n">B</span> <span class="o">=</span> <span class="n">B</span> <span class="o">+</span> <span class="m">1</span><span class="p">,</span>  <span class="n">C</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">B</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="m">2</span><span class="p">)]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    A B C D
## 1: 1 2 2 2
## 2: 1 3 3 2
## 3: 1 4 4 2
## 4: 2 5 6 2
## 5: 2 6 7 2
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Delete my_cols</span>
<span class="n">my_cols</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;B&#39;</span><span class="p">,</span> <span class="s">&#39;C&#39;</span><span class="p">)</span>
<span class="n">DT</span><span class="p">[,</span> <span class="p">(</span><span class="n">my_cols</span><span class="p">)</span> <span class="o">:=</span> <span class="kc">NULL</span><span class="p">]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    A D
## 1: 1 2
## 2: 1 2
## 3: 1 2
## 4: 2 2
## 5: 2 2
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Delete column 2 by number</span>
<span class="n">DT</span><span class="p">[,</span> <span class="m">2</span> <span class="o">:=</span> <span class="kc">NULL</span><span class="p">]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    A
## 1: 1
## 2: 1
## 3: 1
## 4: 2
## 5: 2
</code></pre></div>
</td></tr></table>
<p><strong>Ready, <code>set</code>, go!</strong></p>
<p>The <code>set</code> function is used to repeatedly update a data.table by<br />
reference. You can think of the <code>set</code> function as a loopable.</p>
<div class="highlight"><pre><span></span><code><span class="n">A</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
<span class="n">B</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">4</span><span class="p">)</span>
<span class="n">C</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span>
<span class="n">D</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
<span class="n">DT</span> <span class="o">&lt;-</span> <span class="nf">data.table</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>

<span class="c1"># Set the seed</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>

<span class="c1"># Check the DT</span>
<span class="n">DT</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##     A B C D
##  1: 2 2 5 3
##  2: 2 1 2 3
##  3: 3 4 4 3
##  4: 5 2 1 1
##  5: 2 4 2 5
##  6: 5 3 2 4
##  7: 5 4 1 4
##  8: 4 5 2 1
##  9: 4 2 5 4
## 10: 1 4 2 3
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># For loop with set</span>
<span class="nf">for </span><span class="p">(</span><span class="n">l</span> <span class="n">in</span> <span class="m">2</span><span class="o">:</span><span class="m">4</span><span class="p">)</span> <span class="nf">set</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="nf">sample</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="m">3</span><span class="p">),</span> <span class="n">l</span><span class="p">,</span> <span class="kc">NA</span><span class="p">)</span>

<span class="c1"># Change the column names to lowercase</span>
<span class="nf">setnames</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">,</span><span class="s">&#39;B&#39;</span><span class="p">,</span><span class="s">&#39;C&#39;</span><span class="p">,</span><span class="s">&#39;D&#39;</span><span class="p">),</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">))</span>

<span class="c1"># Print the resulting DT to the console</span>
<span class="n">DT</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##     a  b  c  d
##  1: 2  2  5  3
##  2: 2  1 NA  3
##  3: 3 NA  4  3
##  4: 5 NA  1  1
##  5: 2 NA  2  5
##  6: 5  3  2 NA
##  7: 5  4  1  4
##  8: 4  5 NA  1
##  9: 4  2  5 NA
## 10: 1  4 NA NA
</code></pre></div>
</td></tr></table>
<p><strong>The <code>set</code> family</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Define DT</span>
<span class="n">DT</span> <span class="o">&lt;-</span> <span class="nf">data.table</span><span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="kc">letters</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">)],</span> <span class="n">b</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
<span class="n">DT</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    a b
## 1: a 1
## 2: a 1
## 3: a 1
## 4: b 1
## 5: b 1
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Add a postfix &#39;_2&#39; to all column names</span>
<span class="nf">setnames</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">),</span> <span class="nf">paste0</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">),</span> <span class="s">&#39;_2&#39;</span><span class="p">))</span>
<span class="n">DT</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    a_2 b_2
## 1:   a   1
## 2:   a   1
## 3:   a   1
## 4:   b   1
## 5:   b   1
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Change column name &#39;a_2&#39; to &#39;A2&#39;</span>
<span class="nf">setnames</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="s">&#39;a_2&#39;</span><span class="p">,</span> <span class="s">&#39;A2&#39;</span><span class="p">)</span>
<span class="n">DT</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    A2 b_2
## 1:  a   1
## 2:  a   1
## 3:  a   1
## 4:  b   1
## 5:  b   1
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Reverse the order of the columns</span>
<span class="nf">setcolorder</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;b_2&#39;</span><span class="p">,</span><span class="s">&#39;A2&#39;</span><span class="p">))</span>
</code></pre></div>
<h3 id="3-datatable-expert">3, <code>data.table</code> expert<a class="headerlink" href="#3-datatable-expert" title="Permanent link">&para;</a></h3>
<p><strong>Selecting rows the <code>data.table</code> way</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Convert iris to a data.table</span>
<span class="n">iris</span> <span class="o">&lt;-</span> <span class="nf">data.table</span><span class="p">(</span><span class="s">&#39;Sepal.Length&#39;</span> <span class="o">=</span> <span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="p">,</span> <span class="s">&#39;Sepal.Width&#39;</span> <span class="o">=</span> <span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Width</span><span class="p">,</span> <span class="s">&#39;Petal.Length&#39;</span> <span class="o">=</span> <span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">,</span> <span class="s">&#39;Petal.Width&#39;</span> <span class="o">=</span> <span class="n">iris</span><span class="o">$</span><span class="n">Petal.Width</span><span class="p">,</span> <span class="s">&#39;Species&#39;</span> <span class="o">=</span> <span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">)</span>
<span class="n">iris</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##      Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
##   1:          5.1         3.5          1.4         0.2    setosa
##   2:          4.9         3.0          1.4         0.2    setosa
##   3:          4.7         3.2          1.3         0.2    setosa
##   4:          4.6         3.1          1.5         0.2    setosa
##   5:          5.0         3.6          1.4         0.2    setosa
##  ---                                                            
## 146:          6.7         3.0          5.2         2.3 virginica
## 147:          6.3         2.5          5.0         1.9 virginica
## 148:          6.5         3.0          5.2         2.0 virginica
## 149:          6.2         3.4          5.4         2.3 virginica
## 150:          5.9         3.0          5.1         1.8 virginica
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Species is &#39;virginica&#39;</span>
<span class="nf">head</span><span class="p">(</span><span class="n">iris</span><span class="p">[</span><span class="n">Species</span> <span class="o">==</span> <span class="s">&#39;virginica&#39;</span><span class="p">],</span> <span class="m">20</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
##  1:          6.3         3.3          6.0         2.5 virginica
##  2:          5.8         2.7          5.1         1.9 virginica
##  3:          7.1         3.0          5.9         2.1 virginica
##  4:          6.3         2.9          5.6         1.8 virginica
##  5:          6.5         3.0          5.8         2.2 virginica
##  6:          7.6         3.0          6.6         2.1 virginica
##  7:          4.9         2.5          4.5         1.7 virginica
##  8:          7.3         2.9          6.3         1.8 virginica
##  9:          6.7         2.5          5.8         1.8 virginica
## 10:          7.2         3.6          6.1         2.5 virginica
## 11:          6.5         3.2          5.1         2.0 virginica
## 12:          6.4         2.7          5.3         1.9 virginica
## 13:          6.8         3.0          5.5         2.1 virginica
## 14:          5.7         2.5          5.0         2.0 virginica
## 15:          5.8         2.8          5.1         2.4 virginica
## 16:          6.4         3.2          5.3         2.3 virginica
## 17:          6.5         3.0          5.5         1.8 virginica
## 18:          7.7         3.8          6.7         2.2 virginica
## 19:          7.7         2.6          6.9         2.3 virginica
## 20:          6.0         2.2          5.0         1.5 virginica
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Species is either &#39;virginica&#39; or &#39;versicolor&#39;</span>
<span class="nf">head</span><span class="p">(</span><span class="n">iris</span><span class="p">[</span><span class="n">Species</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;virginica&#39;</span><span class="p">,</span> <span class="s">&#39;versicolor&#39;</span><span class="p">)],</span> <span class="m">20</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
##  1:          7.0         3.2          4.7         1.4 versicolor
##  2:          6.4         3.2          4.5         1.5 versicolor
##  3:          6.9         3.1          4.9         1.5 versicolor
##  4:          5.5         2.3          4.0         1.3 versicolor
##  5:          6.5         2.8          4.6         1.5 versicolor
##  6:          5.7         2.8          4.5         1.3 versicolor
##  7:          6.3         3.3          4.7         1.6 versicolor
##  8:          4.9         2.4          3.3         1.0 versicolor
##  9:          6.6         2.9          4.6         1.3 versicolor
## 10:          5.2         2.7          3.9         1.4 versicolor
## 11:          5.0         2.0          3.5         1.0 versicolor
## 12:          5.9         3.0          4.2         1.5 versicolor
## 13:          6.0         2.2          4.0         1.0 versicolor
## 14:          6.1         2.9          4.7         1.4 versicolor
## 15:          5.6         2.9          3.6         1.3 versicolor
## 16:          6.7         3.1          4.4         1.4 versicolor
## 17:          5.6         3.0          4.5         1.5 versicolor
## 18:          5.8         2.7          4.1         1.0 versicolor
## 19:          6.2         2.2          4.5         1.5 versicolor
## 20:          5.6         2.5          3.9         1.1 versicolor
</code></pre></div>
</td></tr></table>
<p><strong>Removing columns and adapting your column names</strong></p>
<p>Refer to a regex cheat sheet for metacharacter.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># iris as a data.table</span>
<span class="n">iris</span> <span class="o">&lt;-</span> <span class="nf">as.data.table</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>
<span class="n">iris</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##      Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
##   1:          5.1         3.5          1.4         0.2    setosa
##   2:          4.9         3.0          1.4         0.2    setosa
##   3:          4.7         3.2          1.3         0.2    setosa
##   4:          4.6         3.1          1.5         0.2    setosa
##   5:          5.0         3.6          1.4         0.2    setosa
##  ---                                                            
## 146:          6.7         3.0          5.2         2.3 virginica
## 147:          6.3         2.5          5.0         1.9 virginica
## 148:          6.5         3.0          5.2         2.0 virginica
## 149:          6.2         3.4          5.4         2.3 virginica
## 150:          5.9         3.0          5.1         1.8 virginica
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Remove the &#39;Sepal.&#39; prefix</span>
<span class="c1">#gsub(&#39;([ab])&#39;, &#39;\\1_\\1_&#39;, &#39;abc and ABC&#39;) = pattern, replacement, x</span>
<span class="nf">setnames</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;Sepal.Length&#39;</span><span class="p">,</span> <span class="s">&#39;Sepal.Width&#39;</span><span class="p">),</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;Length&#39;</span><span class="p">,</span><span class="s">&#39;Width&#39;</span><span class="p">))</span> 
<span class="c1">#gsub(&#39;^Sepal\\.&#39;,&#39;&#39;, iris)</span>

<span class="c1"># Remove the two columns starting with &#39;Petal&#39;</span>
<span class="n">iris</span><span class="p">[,</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;Petal.Length&#39;</span><span class="p">,</span> <span class="s">&#39;Petal.Width&#39;</span><span class="p">)</span> <span class="o">:=</span> <span class="kc">NULL</span><span class="p">]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##      Length Width   Species
##   1:    5.1   3.5    setosa
##   2:    4.9   3.0    setosa
##   3:    4.7   3.2    setosa
##   4:    4.6   3.1    setosa
##   5:    5.0   3.6    setosa
##  ---                       
## 146:    6.7   3.0 virginica
## 147:    6.3   2.5 virginica
## 148:    6.5   3.0 virginica
## 149:    6.2   3.4 virginica
## 150:    5.9   3.0 virginica
</code></pre></div>
</td></tr></table>
<p><strong>Understanding automatic indexing</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Cleaned up iris data.table</span>
<span class="n">iris2</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">Length</span> <span class="o">=</span> <span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="p">,</span> <span class="n">Width</span> <span class="o">=</span> <span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Width</span><span class="p">,</span> <span class="n">Species</span> <span class="o">=</span> <span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">)</span>
<span class="n">iris2</span> <span class="o">&lt;-</span> <span class="nf">as.data.table</span><span class="p">(</span><span class="n">iris2</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Area is greater than 20 square centimeters</span>
<span class="n">iris2</span><span class="p">[</span> <span class="n">Width</span> <span class="o">*</span> <span class="n">Length</span> <span class="o">&gt;</span> <span class="m">20</span> <span class="p">],</span> <span class="m">20</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>   Length Width    Species is_large
 1:    5.4   3.9     setosa    FALSE
 2:    5.8   4.0     setosa    FALSE
 3:    5.7   4.4     setosa     TRUE
 4:    5.4   3.9     setosa    FALSE
 5:    5.7   3.8     setosa    FALSE
 6:    5.2   4.1     setosa    FALSE
 7:    5.5   4.2     setosa    FALSE
 8:    7.0   3.2 versicolor    FALSE
 9:    6.4   3.2 versicolor    FALSE
10:    6.9   3.1 versicolor    FALSE
11:    6.3   3.3 versicolor    FALSE
12:    6.7   3.1 versicolor    FALSE
13:    6.7   3.0 versicolor    FALSE
14:    6.0   3.4 versicolor    FALSE
15:    6.7   3.1 versicolor    FALSE
16:    6.3   3.3  virginica    FALSE
17:    7.1   3.0  virginica    FALSE
18:    7.6   3.0  virginica    FALSE
19:    7.3   2.9  virginica    FALSE
20:    7.2   3.6  virginica     TRUE
...
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Add new boolean column</span>
<span class="n">iris2</span><span class="p">[,</span> <span class="n">is_large</span> <span class="o">:=</span> <span class="n">Width</span> <span class="o">*</span> <span class="n">Length</span> <span class="o">&gt;</span> <span class="m">25</span><span class="p">]</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Now large observations with is_large</span>
<span class="n">iris2</span><span class="p">[</span><span class="n">is_large</span> <span class="o">==</span> <span class="kc">TRUE</span><span class="p">]</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>   Length Width   Species is_large
1:    5.7   4.4    setosa     TRUE
2:    7.2   3.6 virginica     TRUE
3:    7.7   3.8 virginica     TRUE
4:    7.9   3.8 virginica     TRUE
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">iris2</span><span class="p">[(</span><span class="n">is_large</span><span class="p">)]</span> <span class="c1"># Also OK</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>   Length Width   Species is_large
1:    5.7   4.4    setosa     TRUE
2:    7.2   3.6 virginica     TRUE
3:    7.7   3.8 virginica     TRUE
4:    7.9   3.8 virginica     TRUE
</code></pre></div>
<p><strong>Selecting groups or parts of groups</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># The &#39;keyed&#39; data.table DT</span>
<span class="n">DT</span> <span class="o">&lt;-</span> <span class="nf">data.table</span><span class="p">(</span><span class="n">A</span> <span class="o">=</span> <span class="kc">letters</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">)],</span>
                 <span class="n">B</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">9</span><span class="p">,</span><span class="m">8</span> <span class="p">,</span><span class="m">8</span><span class="p">,</span> <span class="m">6</span><span class="p">),</span> 
                 <span class="n">C</span> <span class="o">=</span> <span class="m">6</span><span class="o">:</span><span class="m">12</span><span class="p">)</span>
<span class="nf">setkey</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>

<span class="c1"># Select the &#39;b&#39; group</span>
<span class="n">DT</span><span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    A B  C
## 1: b 1  8
## 2: b 5  6
## 3: b 8 11
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># &#39;b&#39; and &#39;c&#39; groups</span>
<span class="n">DT</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">)]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    A B  C
## 1: b 1  8
## 2: b 5  6
## 3: b 8 11
## 4: c 6 12
## 5: c 9  9
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># The first row of the &#39;b&#39; and &#39;c&#39; groups</span>
<span class="n">DT</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">),</span> <span class="n">mult</span> <span class="o">=</span> <span class="s">&#39;first&#39;</span><span class="p">]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    A B  C
## 1: b 1  8
## 2: c 6 12
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># First and last row of the &#39;b&#39; and &#39;c&#39; groups</span>
<span class="n">DT</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">),</span> <span class="n">.SD</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">.N</span><span class="p">)],</span> <span class="n">by</span> <span class="o">=</span> <span class="n">.EACHI</span><span class="p">]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    A B  C
## 1: b 1  8
## 2: b 8 11
## 3: c 6 12
## 4: c 9  9
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Copy and extend code for instruction 4: add printout</span>
<span class="n">DT</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">),</span> <span class="p">{</span> <span class="nf">print</span><span class="p">(</span><span class="n">.SD</span><span class="p">);</span> <span class="n">.SD</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">.N</span><span class="p">)]</span> <span class="p">},</span> <span class="n">by</span> <span class="o">=</span> <span class="n">.EACHI</span><span class="p">]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    B  C
## 1: 1  8
## 2: 5  6
## 3: 8 11
##    B  C
## 1: 6 12
## 2: 9  9

##    A B  C
## 1: b 1  8
## 2: b 8 11
## 3: c 6 12
## 4: c 9  9
</code></pre></div>
</td></tr></table>
<p><strong>Rolling joins - part one</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Keyed data.table DT</span>
<span class="n">DT</span> <span class="o">&lt;-</span> <span class="nf">data.table</span><span class="p">(</span><span class="n">A</span> <span class="o">=</span> <span class="kc">letters</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">)],</span>                  <span class="n">B</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">9</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="m">6</span><span class="p">),</span> 
                 <span class="n">C</span> <span class="o">=</span> <span class="m">6</span><span class="o">:</span><span class="m">12</span><span class="p">,</span> 
                 <span class="n">key</span> <span class="o">=</span> <span class="s">&#39;A,B&#39;</span><span class="p">)</span>

<span class="c1"># Get the key of DT</span>
<span class="nf">key</span><span class="p">(</span><span class="n">DT</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## [1] &quot;A&quot; &quot;B&quot;
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Row where A == &#39;b&#39; &amp; B == 6</span>
<span class="nf">setkey</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="n">DT</span><span class="p">[</span><span class="nf">.</span><span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="m">6</span><span class="p">)]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    A B  C
## 1: b 6 NA
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Return the prevailing row</span>
<span class="n">DT</span><span class="p">[</span><span class="nf">.</span><span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="m">6</span><span class="p">),</span> <span class="n">roll</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    A B C
## 1: b 6 6
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Return the nearest row</span>
<span class="n">DT</span><span class="p">[</span><span class="nf">.</span><span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="m">6</span><span class="p">),</span> <span class="n">roll</span> <span class="o">=+</span> <span class="kc">Inf</span><span class="p">]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    A B C
## 1: b 6 6
</code></pre></div>
</td></tr></table>
<p><strong>Rolling joins - part two</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Keyed data.table DT</span>
<span class="n">DT</span> <span class="o">&lt;-</span> <span class="nf">data.table</span><span class="p">(</span><span class="n">A</span> <span class="o">=</span> <span class="kc">letters</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">)],</span>                  <span class="n">B</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">9</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="m">6</span><span class="p">),</span> 
                 <span class="n">C</span> <span class="o">=</span> <span class="m">6</span><span class="o">:</span><span class="m">12</span><span class="p">,</span> 
                 <span class="n">key</span> <span class="o">=</span> <span class="s">&#39;A,B&#39;</span><span class="p">)</span>

<span class="c1"># Look at the sequence (-2):10 for the &#39;b&#39; group</span>
<span class="n">DT</span><span class="p">[</span><span class="nf">.</span><span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="p">(</span><span class="m">-2</span><span class="p">)</span><span class="o">:</span><span class="m">10</span><span class="p">)]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##     A  B  C
##  1: b -2 NA
##  2: b -1 NA
##  3: b  0 NA
##  4: b  1  8
##  5: b  2 NA
##  6: b  3 NA
##  7: b  4 NA
##  8: b  5  6
##  9: b  6 NA
## 10: b  7 NA
## 11: b  8 11
## 12: b  9 NA
## 13: b 10 NA
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Add code: carry the prevailing values forwards</span>
<span class="n">DT</span><span class="p">[</span><span class="nf">.</span><span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="p">(</span><span class="m">-2</span><span class="p">)</span><span class="o">:</span><span class="m">10</span><span class="p">),</span> <span class="n">roll</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##     A  B  C
##  1: b -2 NA
##  2: b -1 NA
##  3: b  0 NA
##  4: b  1  8
##  5: b  2  8
##  6: b  3  8
##  7: b  4  8
##  8: b  5  6
##  9: b  6  6
## 10: b  7  6
## 11: b  8 11
## 12: b  9 11
## 13: b 10 11
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Add code: carry the first observation backwards</span>
<span class="n">DT</span><span class="p">[</span><span class="nf">.</span><span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="p">(</span><span class="m">-2</span><span class="p">)</span><span class="o">:</span><span class="m">10</span><span class="p">),</span> <span class="n">roll</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="n">rollends</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">]</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##     A  B  C
##  1: b -2  8
##  2: b -1  8
##  3: b  0  8
##  4: b  1  8
##  5: b  2  8
##  6: b  3  8
##  7: b  4  8
##  8: b  5  6
##  9: b  6  6
## 10: b  7  6
## 11: b  8 11
## 12: b  9 11
## 13: b 10 11
</code></pre></div>
</td></tr></table>
<hr />
<h2 id="data-manipulation-in-r-with-dplyr">Data Manipulation in R with <code>dplyr</code><a class="headerlink" href="#data-manipulation-in-r-with-dplyr" title="Permanent link">&para;</a></h2>
<h3 id="1-introduction-to-dplyr">1, Introduction to <code>dplyr</code><a class="headerlink" href="#1-introduction-to-dplyr" title="Permanent link">&para;</a></h3>
<p><strong>Load the <code>dplyr</code> and <code>hflights</code> package</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Load the dplyr package</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dtplyr</span><span class="p">)</span>

<span class="c1"># Load the hflights package</span>
<span class="c1"># A data only package containing commercial domestic flights that departed Houston (IAH and HOU) in 2011</span>
<span class="nf">library</span><span class="p">(</span><span class="n">hflights</span><span class="p">)</span>

<span class="c1"># Call both head() and summary() on hflights</span>
<span class="nf">head</span><span class="p">(</span><span class="n">hflights</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##      Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier
## 5424 2011     1          1         6    1400    1500            AA
## 5425 2011     1          2         7    1401    1501            AA
## 5426 2011     1          3         1    1352    1502            AA
## 5427 2011     1          4         2    1403    1513            AA
## 5428 2011     1          5         3    1405    1507            AA
## 5429 2011     1          6         4    1359    1503            AA
##      FlightNum TailNum ActualElapsedTime AirTime ArrDelay DepDelay Origin
## 5424       428  N576AA                60      40      -10        0    IAH
## 5425       428  N557AA                60      45       -9        1    IAH
## 5426       428  N541AA                70      48       -8       -8    IAH
## 5427       428  N403AA                70      39        3        3    IAH
## 5428       428  N492AA                62      44       -3        5    IAH
## 5429       428  N262AA                64      45       -7       -1    IAH
##      Dest Distance TaxiIn TaxiOut Cancelled CancellationCode Diverted
## 5424  DFW      224      7      13         0                         0
## 5425  DFW      224      6       9         0                         0
## 5426  DFW      224      5      17         0                         0
## 5427  DFW      224      9      22         0                         0
## 5428  DFW      224      9       9         0                         0
## 5429  DFW      224      6      13         0                         0
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">summary</span><span class="p">(</span><span class="n">hflights</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="s s-Atom">##</span>       <span class="nv">Year</span>          <span class="nv">Month</span>          <span class="nv">DayofMonth</span>      <span class="nv">DayOfWeek</span>    
<span class="s s-Atom">##</span>  <span class="nv">Min</span><span class="p">.</span>   <span class="s s-Atom">:</span><span class="mi">2011</span>   <span class="nv">Min</span><span class="p">.</span>   <span class="s s-Atom">:</span> <span class="mf">1.000</span>   <span class="nv">Min</span><span class="p">.</span>   <span class="s s-Atom">:</span> <span class="mf">1.00</span>   <span class="nv">Min</span><span class="p">.</span>   <span class="s s-Atom">:</span><span class="mf">1.000</span>  
<span class="s s-Atom">##</span>  <span class="mi">1</span><span class="s s-Atom">st</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span><span class="mi">2011</span>   <span class="mi">1</span><span class="s s-Atom">st</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span> <span class="mf">4.000</span>   <span class="mi">1</span><span class="s s-Atom">st</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span> <span class="mf">8.00</span>   <span class="mi">1</span><span class="s s-Atom">st</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span><span class="mf">2.000</span>  
<span class="s s-Atom">##</span>  <span class="nv">Median</span> <span class="s s-Atom">:</span><span class="mi">2011</span>   <span class="nv">Median</span> <span class="s s-Atom">:</span> <span class="mf">7.000</span>   <span class="nv">Median</span> <span class="s s-Atom">:</span><span class="mf">16.00</span>   <span class="nv">Median</span> <span class="s s-Atom">:</span><span class="mf">4.000</span>  
<span class="s s-Atom">##</span>  <span class="nv">Mean</span>   <span class="s s-Atom">:</span><span class="mi">2011</span>   <span class="nv">Mean</span>   <span class="s s-Atom">:</span> <span class="mf">6.514</span>   <span class="nv">Mean</span>   <span class="s s-Atom">:</span><span class="mf">15.74</span>   <span class="nv">Mean</span>   <span class="s s-Atom">:</span><span class="mf">3.948</span>  
<span class="s s-Atom">##</span>  <span class="mi">3</span><span class="s s-Atom">rd</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span><span class="mi">2011</span>   <span class="mi">3</span><span class="s s-Atom">rd</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span> <span class="mf">9.000</span>   <span class="mi">3</span><span class="s s-Atom">rd</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span><span class="mf">23.00</span>   <span class="mi">3</span><span class="s s-Atom">rd</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span><span class="mf">6.000</span>  
<span class="s s-Atom">##</span>  <span class="nv">Max</span><span class="p">.</span>   <span class="s s-Atom">:</span><span class="mi">2011</span>   <span class="nv">Max</span><span class="p">.</span>   <span class="s s-Atom">:</span><span class="mf">12.000</span>   <span class="nv">Max</span><span class="p">.</span>   <span class="s s-Atom">:</span><span class="mf">31.00</span>   <span class="nv">Max</span><span class="p">.</span>   <span class="s s-Atom">:</span><span class="mf">7.000</span>  
<span class="s s-Atom">##</span>                                                                 
<span class="s s-Atom">##</span>     <span class="nv">DepTime</span>        <span class="nv">ArrTime</span>     <span class="nv">UniqueCarrier</span>        <span class="nv">FlightNum</span>   
<span class="s s-Atom">##</span>  <span class="nv">Min</span><span class="p">.</span>   <span class="s s-Atom">:</span>   <span class="mi">1</span>   <span class="nv">Min</span><span class="p">.</span>   <span class="s s-Atom">:</span>   <span class="mi">1</span>   <span class="nv">Length</span><span class="s s-Atom">:</span><span class="mi">227496</span>      <span class="nv">Min</span><span class="p">.</span>   <span class="s s-Atom">:</span>   <span class="mi">1</span>  
<span class="s s-Atom">##</span>  <span class="mi">1</span><span class="s s-Atom">st</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span><span class="mi">1021</span>   <span class="mi">1</span><span class="s s-Atom">st</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span><span class="mi">1215</span>   <span class="nv">Class</span> <span class="s s-Atom">:character</span>   <span class="mi">1</span><span class="s s-Atom">st</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span> <span class="mi">855</span>  
<span class="s s-Atom">##</span>  <span class="nv">Median</span> <span class="s s-Atom">:</span><span class="mi">1416</span>   <span class="nv">Median</span> <span class="s s-Atom">:</span><span class="mi">1617</span>   <span class="nv">Mode</span>  <span class="s s-Atom">:character</span>   <span class="nv">Median</span> <span class="s s-Atom">:</span><span class="mi">1696</span>  
<span class="s s-Atom">##</span>  <span class="nv">Mean</span>   <span class="s s-Atom">:</span><span class="mi">1396</span>   <span class="nv">Mean</span>   <span class="s s-Atom">:</span><span class="mi">1578</span>                      <span class="nv">Mean</span>   <span class="s s-Atom">:</span><span class="mi">1962</span>  
<span class="s s-Atom">##</span>  <span class="mi">3</span><span class="s s-Atom">rd</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span><span class="mi">1801</span>   <span class="mi">3</span><span class="s s-Atom">rd</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span><span class="mi">1953</span>                      <span class="mi">3</span><span class="s s-Atom">rd</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span><span class="mi">2755</span>  
<span class="s s-Atom">##</span>  <span class="nv">Max</span><span class="p">.</span>   <span class="s s-Atom">:</span><span class="mi">2400</span>   <span class="nv">Max</span><span class="p">.</span>   <span class="s s-Atom">:</span><span class="mi">2400</span>                      <span class="nv">Max</span><span class="p">.</span>   <span class="s s-Atom">:</span><span class="mi">7290</span>  
<span class="s s-Atom">##</span>  <span class="nv">NA</span><span class="s s-Atom">&#39;s   :2905   NA&#39;s</span>   <span class="s s-Atom">:</span><span class="mi">3066</span>                                    
<span class="s s-Atom">##</span>    <span class="nv">TailNum</span>          <span class="nv">ActualElapsedTime</span>    <span class="nv">AirTime</span>         <span class="nv">ArrDelay</span>      
<span class="s s-Atom">##</span>  <span class="nv">Length</span><span class="s s-Atom">:</span><span class="mi">227496</span>      <span class="nv">Min</span><span class="p">.</span>   <span class="s s-Atom">:</span> <span class="mf">34.0</span>     <span class="nv">Min</span><span class="p">.</span>   <span class="s s-Atom">:</span> <span class="mf">11.0</span>   <span class="nv">Min</span><span class="p">.</span>   <span class="p">:-</span><span class="mf">70.000</span>  
<span class="s s-Atom">##</span>  <span class="nv">Class</span> <span class="s s-Atom">:character</span>   <span class="mi">1</span><span class="s s-Atom">st</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span> <span class="mf">77.0</span>     <span class="mi">1</span><span class="s s-Atom">st</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span> <span class="mf">58.0</span>   <span class="mi">1</span><span class="s s-Atom">st</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span> <span class="o">-</span><span class="mf">8.000</span>  
<span class="s s-Atom">##</span>  <span class="nv">Mode</span>  <span class="s s-Atom">:character</span>   <span class="nv">Median</span> <span class="s s-Atom">:</span><span class="mf">128.0</span>     <span class="nv">Median</span> <span class="s s-Atom">:</span><span class="mf">107.0</span>   <span class="nv">Median</span> <span class="s s-Atom">:</span>  <span class="mf">0.000</span>  
<span class="s s-Atom">##</span>                     <span class="nv">Mean</span>   <span class="s s-Atom">:</span><span class="mf">129.3</span>     <span class="nv">Mean</span>   <span class="s s-Atom">:</span><span class="mf">108.1</span>   <span class="nv">Mean</span>   <span class="s s-Atom">:</span>  <span class="mf">7.094</span>  
<span class="s s-Atom">##</span>                     <span class="mi">3</span><span class="s s-Atom">rd</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span><span class="mf">165.0</span>     <span class="mi">3</span><span class="s s-Atom">rd</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span><span class="mf">141.0</span>   <span class="mi">3</span><span class="s s-Atom">rd</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span> <span class="mf">11.000</span>  
<span class="s s-Atom">##</span>                     <span class="nv">Max</span><span class="p">.</span>   <span class="s s-Atom">:</span><span class="mf">575.0</span>     <span class="nv">Max</span><span class="p">.</span>   <span class="s s-Atom">:</span><span class="mf">549.0</span>   <span class="nv">Max</span><span class="p">.</span>   <span class="s s-Atom">:</span><span class="mf">978.000</span>  
<span class="s s-Atom">##</span>                     <span class="nv">NA</span><span class="s s-Atom">&#39;s   :3622      NA&#39;s</span>   <span class="s s-Atom">:</span><span class="mi">3622</span>    <span class="nv">NA</span><span class="s s-Atom">&#39;s   :3622     </span>
<span class="s s-Atom">##     DepDelay          Origin              Dest              Distance     </span>
<span class="s s-Atom">##  Min.   :-33.000   Length:227496      Length:227496      Min.   :  79.0  </span>
<span class="s s-Atom">##  1st Qu.: -3.000   Class :character   Class :character   1st Qu.: 376.0  </span>
<span class="s s-Atom">##  Median :  0.000   Mode  :character   Mode  :character   Median : 809.0  </span>
<span class="s s-Atom">##  Mean   :  9.445                                         Mean   : 787.8  </span>
<span class="s s-Atom">##  3rd Qu.:  9.000                                         3rd Qu.:1042.0  </span>
<span class="s s-Atom">##  Max.   :981.000                                         Max.   :3904.0  </span>
<span class="s s-Atom">##  NA&#39;s</span>   <span class="s s-Atom">:</span><span class="mi">2905</span>                                                            
<span class="s s-Atom">##</span>      <span class="nv">TaxiIn</span>           <span class="nv">TaxiOut</span>         <span class="nv">Cancelled</span>       <span class="nv">CancellationCode</span>  
<span class="s s-Atom">##</span>  <span class="nv">Min</span><span class="p">.</span>   <span class="s s-Atom">:</span>  <span class="mf">1.000</span>   <span class="nv">Min</span><span class="p">.</span>   <span class="s s-Atom">:</span>  <span class="mf">1.00</span>   <span class="nv">Min</span><span class="p">.</span>   <span class="s s-Atom">:</span><span class="mf">0.00000</span>   <span class="nv">Length</span><span class="s s-Atom">:</span><span class="mi">227496</span>     
<span class="s s-Atom">##</span>  <span class="mi">1</span><span class="s s-Atom">st</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span>  <span class="mf">4.000</span>   <span class="mi">1</span><span class="s s-Atom">st</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span> <span class="mf">10.00</span>   <span class="mi">1</span><span class="s s-Atom">st</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span><span class="mf">0.00000</span>   <span class="nv">Class</span> <span class="s s-Atom">:character</span>  
<span class="s s-Atom">##</span>  <span class="nv">Median</span> <span class="s s-Atom">:</span>  <span class="mf">5.000</span>   <span class="nv">Median</span> <span class="s s-Atom">:</span> <span class="mf">14.00</span>   <span class="nv">Median</span> <span class="s s-Atom">:</span><span class="mf">0.00000</span>   <span class="nv">Mode</span>  <span class="s s-Atom">:character</span>  
<span class="s s-Atom">##</span>  <span class="nv">Mean</span>   <span class="s s-Atom">:</span>  <span class="mf">6.099</span>   <span class="nv">Mean</span>   <span class="s s-Atom">:</span> <span class="mf">15.09</span>   <span class="nv">Mean</span>   <span class="s s-Atom">:</span><span class="mf">0.01307</span>                     
<span class="s s-Atom">##</span>  <span class="mi">3</span><span class="s s-Atom">rd</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span>  <span class="mf">7.000</span>   <span class="mi">3</span><span class="s s-Atom">rd</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span> <span class="mf">18.00</span>   <span class="mi">3</span><span class="s s-Atom">rd</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span><span class="mf">0.00000</span>                     
<span class="s s-Atom">##</span>  <span class="nv">Max</span><span class="p">.</span>   <span class="s s-Atom">:</span><span class="mf">165.000</span>   <span class="nv">Max</span><span class="p">.</span>   <span class="s s-Atom">:</span><span class="mf">163.00</span>   <span class="nv">Max</span><span class="p">.</span>   <span class="s s-Atom">:</span><span class="mf">1.00000</span>                     
<span class="s s-Atom">##</span>  <span class="nv">NA</span><span class="s s-Atom">&#39;s   :3066      NA&#39;s</span>   <span class="s s-Atom">:</span><span class="mi">2947</span>                                         
<span class="s s-Atom">##</span>     <span class="nv">Diverted</span>       
<span class="s s-Atom">##</span>  <span class="nv">Min</span><span class="p">.</span>   <span class="s s-Atom">:</span><span class="mf">0.000000</span>  
<span class="s s-Atom">##</span>  <span class="mi">1</span><span class="s s-Atom">st</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span><span class="mf">0.000000</span>  
<span class="s s-Atom">##</span>  <span class="nv">Median</span> <span class="s s-Atom">:</span><span class="mf">0.000000</span>  
<span class="s s-Atom">##</span>  <span class="nv">Mean</span>   <span class="s s-Atom">:</span><span class="mf">0.002853</span>  
<span class="s s-Atom">##</span>  <span class="mi">3</span><span class="s s-Atom">rd</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span><span class="mf">0.000000</span>  
<span class="s s-Atom">##</span>  <span class="nv">Max</span><span class="p">.</span>   <span class="s s-Atom">:</span><span class="mf">1.000000</span>  
<span class="s s-Atom">##</span>
</code></pre></div>
</td></tr></table>
<p><strong>Convert <code>data.frame</code> to table</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Convert the hflights data.frame into a hflights tbl</span>
<span class="n">hflights</span> <span class="o">&lt;-</span> <span class="nf">tbl_df</span><span class="p">(</span><span class="n">hflights</span><span class="p">)</span>

<span class="c1"># Display the hflights tbl</span>
<span class="n">hflights</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## # A tibble: 227,496 × 21</span>
<span class="c1">##     Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier</span>
<span class="c1">## *  &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;         &lt;chr&gt;</span>
<span class="c1">## 1   2011     1          1         6    1400    1500            AA</span>
<span class="c1">## 2   2011     1          2         7    1401    1501            AA</span>
<span class="c1">## 3   2011     1          3         1    1352    1502            AA</span>
<span class="c1">## 4   2011     1          4         2    1403    1513            AA</span>
<span class="c1">## 5   2011     1          5         3    1405    1507            AA</span>
<span class="c1">## 6   2011     1          6         4    1359    1503            AA</span>
<span class="c1">## 7   2011     1          7         5    1359    1509            AA</span>
<span class="c1">## 8   2011     1          8         6    1355    1454            AA</span>
<span class="c1">## 9   2011     1          9         7    1443    1554            AA</span>
<span class="c1">## 10  2011     1         10         1    1443    1553            AA</span>
<span class="c1">## # ... with 227,486 more rows, and 14 more variables: FlightNum &lt;int&gt;,</span>
<span class="c1">## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,</span>
<span class="c1">## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,</span>
<span class="c1">## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,</span>
<span class="c1">## #   Diverted &lt;int&gt;</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Create the object carriers, containing only the UniqueCarrier variable of hflights</span>
<span class="n">carriers</span> <span class="o">&lt;-</span> <span class="n">hflights</span><span class="o">$</span><span class="n">UniqueCarrier</span>
</code></pre></div>
<p><strong>Changing labels of <code>hflights</code>, part 1 of 2</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># add</span>
<span class="n">lut</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;AA&#39;</span> <span class="o">=</span> <span class="s">&#39;American&#39;</span><span class="p">,</span> <span class="s">&#39;AS&#39;</span> <span class="o">=</span> <span class="s">&#39;Alaska&#39;</span><span class="p">,</span> <span class="s">&#39;B6&#39;</span> <span class="o">=</span> <span class="s">&#39;JetBlue&#39;</span><span class="p">,</span> <span class="s">&#39;CO&#39;</span> <span class="o">=</span> <span class="s">&#39;Continental&#39;</span><span class="p">,</span> 
         <span class="s">&#39;DL&#39;</span> <span class="o">=</span> <span class="s">&#39;Delta&#39;</span><span class="p">,</span> <span class="s">&#39;OO&#39;</span> <span class="o">=</span> <span class="s">&#39;SkyWest&#39;</span><span class="p">,</span> <span class="s">&#39;UA&#39;</span> <span class="o">=</span> <span class="s">&#39;United&#39;</span><span class="p">,</span> <span class="s">&#39;US&#39;</span> <span class="o">=</span> <span class="s">&#39;US_Airways&#39;</span><span class="p">,</span> 
         <span class="s">&#39;WN&#39;</span> <span class="o">=</span> <span class="s">&#39;Southwest&#39;</span><span class="p">,</span> <span class="s">&#39;EV&#39;</span> <span class="o">=</span> <span class="s">&#39;Atlantic_Southeast&#39;</span><span class="p">,</span> <span class="s">&#39;F9&#39;</span> <span class="o">=</span> <span class="s">&#39;Frontier&#39;</span><span class="p">,</span> 
         <span class="s">&#39;FL&#39;</span> <span class="o">=</span> <span class="s">&#39;AirTran&#39;</span><span class="p">,</span> <span class="s">&#39;MQ&#39;</span> <span class="o">=</span> <span class="s">&#39;American_Eagle&#39;</span><span class="p">,</span> <span class="s">&#39;XE&#39;</span> <span class="o">=</span> <span class="s">&#39;ExpressJet&#39;</span><span class="p">,</span> <span class="s">&#39;YV&#39;</span> <span class="o">=</span> <span class="s">&#39;Mesa&#39;</span><span class="p">)</span>

<span class="c1"># Use lut to translate the UniqueCarrier column of hflights</span>
<span class="n">hflights</span><span class="o">$</span><span class="n">UniqueCarrier</span> <span class="o">&lt;-</span> <span class="n">lut</span><span class="p">[</span><span class="n">hflights</span><span class="o">$</span><span class="n">UniqueCarrier</span><span class="p">]</span>

<span class="c1"># Inspect the resulting raw values of your variables</span>
<span class="nf">glimpse</span><span class="p">(</span><span class="n">hflights</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Observations: 227,496
## Variables: 21
## $ Year              &lt;int&gt; 2011, 2011, 2011, 2011, 2011, 2011, 2011, 20...
## $ Month             &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,...
## $ DayofMonth        &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 1...
## $ DayOfWeek         &lt;int&gt; 6, 7, 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6,...
## $ DepTime           &lt;int&gt; 1400, 1401, 1352, 1403, 1405, 1359, 1359, 13...
## $ ArrTime           &lt;int&gt; 1500, 1501, 1502, 1513, 1507, 1503, 1509, 14...
## $ UniqueCarrier     &lt;chr&gt; &quot;American&quot;, &quot;American&quot;, &quot;American&quot;, &quot;America...
## $ FlightNum         &lt;int&gt; 428, 428, 428, 428, 428, 428, 428, 428, 428,...
## $ TailNum           &lt;chr&gt; &quot;N576AA&quot;, &quot;N557AA&quot;, &quot;N541AA&quot;, &quot;N403AA&quot;, &quot;N49...
## $ ActualElapsedTime &lt;int&gt; 60, 60, 70, 70, 62, 64, 70, 59, 71, 70, 70, ...
## $ AirTime           &lt;int&gt; 40, 45, 48, 39, 44, 45, 43, 40, 41, 45, 42, ...
## $ ArrDelay          &lt;int&gt; -10, -9, -8, 3, -3, -7, -1, -16, 44, 43, 29,...
## $ DepDelay          &lt;int&gt; 0, 1, -8, 3, 5, -1, -1, -5, 43, 43, 29, 19, ...
## $ Origin            &lt;chr&gt; &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;I...
## $ Dest              &lt;chr&gt; &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;D...
## $ Distance          &lt;int&gt; 224, 224, 224, 224, 224, 224, 224, 224, 224,...
## $ TaxiIn            &lt;int&gt; 7, 6, 5, 9, 9, 6, 12, 7, 8, 6, 8, 4, 6, 5, 6...
## $ TaxiOut           &lt;int&gt; 13, 9, 17, 22, 9, 13, 15, 12, 22, 19, 20, 11...
## $ Cancelled         &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
## $ CancellationCode  &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, ...
## $ Diverted          &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
</code></pre></div>
</td></tr></table>
<p><strong>Changing labels of <code>hflights</code>, part 2 of 2</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Build the lookup table: lut</span>
<span class="n">lut</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;A&quot;</span> <span class="o">=</span> <span class="s">&quot;carrier&quot;</span><span class="p">,</span> <span class="s">&quot;B&quot;</span> <span class="o">=</span> <span class="s">&quot;weather&quot;</span> <span class="p">,</span><span class="s">&quot;C&quot;</span> <span class="o">=</span> <span class="s">&quot;FFA&quot;</span> <span class="p">,</span><span class="s">&quot;D&quot;</span> <span class="o">=</span> <span class="s">&quot;security&quot;</span><span class="p">,</span> <span class="s">&quot;E&quot;</span> <span class="o">=</span> <span class="s">&quot;not cancelled&quot;</span><span class="p">)</span>

<span class="c1"># Add the Code column</span>
<span class="n">hflights</span><span class="o">$</span><span class="n">Code</span> <span class="o">&lt;-</span> <span class="n">lut</span><span class="p">[</span><span class="n">hflights</span><span class="o">$</span><span class="n">CancellationCode</span><span class="p">]</span>

<span class="c1"># Glimpse at hflights</span>
<span class="nf">glimpse</span><span class="p">(</span><span class="n">hflights</span><span class="p">)</span>
</code></pre></div>
<p>Result.</p>
<div class="highlight"><pre><span></span><code>Observations: 227,496
Variables: 22
$ Year              &lt;int&gt; 2011, 2011, 2011, 2011, 2011, 2011,...
$ Month             &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,...
$ DayofMonth        &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, ...
$ DayOfWeek         &lt;int&gt; 6, 7, 1, 2, 3, 4, 5, 6, 7, 1, 2, 3,...
$ DepTime           &lt;int&gt; 1400, 1401, 1352, 1403, 1405, 1359,...
$ ArrTime           &lt;int&gt; 1500, 1501, 1502, 1513, 1507, 1503,...
$ UniqueCarrier     &lt;chr&gt; &quot;American&quot;, &quot;American&quot;, &quot;American&quot;,...
$ FlightNum         &lt;int&gt; 428, 428, 428, 428, 428, 428, 428, ...
$ TailNum           &lt;chr&gt; &quot;N576AA&quot;, &quot;N557AA&quot;, &quot;N541AA&quot;, &quot;N403...
$ ActualElapsedTime &lt;int&gt; 60, 60, 70, 70, 62, 64, 70, 59, 71,...
$ AirTime           &lt;int&gt; 40, 45, 48, 39, 44, 45, 43, 40, 41,...
$ ArrDelay          &lt;int&gt; -10, -9, -8, 3, -3, -7, -1, -16, 44...
$ DepDelay          &lt;int&gt; 0, 1, -8, 3, 5, -1, -1, -5, 43, 43,...
$ Origin            &lt;chr&gt; &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, ...
$ Dest              &lt;chr&gt; &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, ...
$ Distance          &lt;int&gt; 224, 224, 224, 224, 224, 224, 224, ...
$ TaxiIn            &lt;int&gt; 7, 6, 5, 9, 9, 6, 12, 7, 8, 6, 8, 4...
$ TaxiOut           &lt;int&gt; 13, 9, 17, 22, 9, 13, 15, 12, 22, 1...
$ Cancelled         &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
$ CancellationCode  &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;,...
$ Diverted          &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
$ Code              &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA,...
</code></pre></div>
<h3 id="2-select-and-mutate">2, <code>select</code> and <code>mutate</code><a class="headerlink" href="#2-select-and-mutate" title="Permanent link">&para;</a></h3>
<p><strong>The five verbs and their meaning</strong></p>
<ul>
<li><code>select</code>; which returns a subset of the columns.</li>
<li><code>filter</code>; that is able to return a subset of the rows.</li>
<li><code>arrange</code>; that reorders the rows according to single or<br />
    multiple variables.</li>
<li><code>mutate</code>; used to add columns from existing data.</li>
<li><code>summarise</code>; which reduces each group to a single row by calculating<br />
    aggregate measures.</li>
</ul>
<p><strong>Choosing is not losing! The <code>select</code> verb</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Print out a tbl with the four columns of hflights related to delay</span>
<span class="nf">select</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="n">ActualElapsedTime</span><span class="p">,</span> <span class="n">AirTime</span><span class="p">,</span> <span class="n">ArrDelay</span><span class="p">,</span> <span class="n">DepDelay</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## # A tibble: 227,496 × 4
##    ActualElapsedTime AirTime ArrDelay DepDelay
## *              &lt;int&gt;   &lt;int&gt;    &lt;int&gt;    &lt;int&gt;
## 1                 60      40      -10        0
## 2                 60      45       -9        1
## 3                 70      48       -8       -8
## 4                 70      39        3        3
## 5                 62      44       -3        5
## 6                 64      45       -7       -1
## 7                 70      43       -1       -1
## 8                 59      40      -16       -5
## 9                 71      41       44       43
## 10                70      45       43       43
## # ... with 227,486 more rows
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Print out hflights, nothing has changed!</span>
<span class="n">hflights</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## # A tibble: 227,496 × 21</span>
<span class="c1">##     Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier</span>
<span class="c1">## *  &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;         &lt;chr&gt;</span>
<span class="c1">## 1   2011     1          1         6    1400    1500      American</span>
<span class="c1">## 2   2011     1          2         7    1401    1501      American</span>
<span class="c1">## 3   2011     1          3         1    1352    1502      American</span>
<span class="c1">## 4   2011     1          4         2    1403    1513      American</span>
<span class="c1">## 5   2011     1          5         3    1405    1507      American</span>
<span class="c1">## 6   2011     1          6         4    1359    1503      American</span>
<span class="c1">## 7   2011     1          7         5    1359    1509      American</span>
<span class="c1">## 8   2011     1          8         6    1355    1454      American</span>
<span class="c1">## 9   2011     1          9         7    1443    1554      American</span>
<span class="c1">## 10  2011     1         10         1    1443    1553      American</span>
<span class="c1">## # ... with 227,486 more rows, and 14 more variables: FlightNum &lt;int&gt;,</span>
<span class="c1">## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,</span>
<span class="c1">## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,</span>
<span class="c1">## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,</span>
<span class="c1">## #   Diverted &lt;int&gt;</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Print out the columns Origin up to Cancelled of hflights</span>
<span class="nf">select</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="m">14</span><span class="o">:</span><span class="m">19</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## # A tibble: 227,496 × 6
##    Origin  Dest Distance TaxiIn TaxiOut Cancelled
## *   &lt;chr&gt; &lt;chr&gt;    &lt;int&gt;  &lt;int&gt;   &lt;int&gt;     &lt;int&gt;
## 1     IAH   DFW      224      7      13         0
## 2     IAH   DFW      224      6       9         0
## 3     IAH   DFW      224      5      17         0
## 4     IAH   DFW      224      9      22         0
## 5     IAH   DFW      224      9       9         0
## 6     IAH   DFW      224      6      13         0
## 7     IAH   DFW      224     12      15         0
## 8     IAH   DFW      224      7      12         0
## 9     IAH   DFW      224      8      22         0
## 10    IAH   DFW      224      6      19         0
## # ... with 227,486 more rows
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Answer to last question: be concise!</span>
<span class="nf">select</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,</span> <span class="m">12</span><span class="o">:</span><span class="m">21</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## # A tibble: 227,496 × 14</span>
<span class="c1">##     Year Month DayofMonth DayOfWeek ArrDelay DepDelay Origin  Dest</span>
<span class="c1">## *  &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;    &lt;int&gt;    &lt;int&gt;  &lt;chr&gt; &lt;chr&gt;</span>
<span class="c1">## 1   2011     1          1         6      -10        0    IAH   DFW</span>
<span class="c1">## 2   2011     1          2         7       -9        1    IAH   DFW</span>
<span class="c1">## 3   2011     1          3         1       -8       -8    IAH   DFW</span>
<span class="c1">## 4   2011     1          4         2        3        3    IAH   DFW</span>
<span class="c1">## 5   2011     1          5         3       -3        5    IAH   DFW</span>
<span class="c1">## 6   2011     1          6         4       -7       -1    IAH   DFW</span>
<span class="c1">## 7   2011     1          7         5       -1       -1    IAH   DFW</span>
<span class="c1">## 8   2011     1          8         6      -16       -5    IAH   DFW</span>
<span class="c1">## 9   2011     1          9         7       44       43    IAH   DFW</span>
<span class="c1">## 10  2011     1         10         1       43       43    IAH   DFW</span>
<span class="c1">## # ... with 227,486 more rows, and 6 more variables: Distance &lt;int&gt;,</span>
<span class="c1">## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,</span>
<span class="c1">## #   Diverted &lt;int&gt;</span>
</code></pre></div>
</td></tr></table>
<p><strong>Helper functions for variable selection</strong></p>
<p><code>select</code>:</p>
<ul>
<li><code>starts_with("X")</code>; every name that starts with <code>"X"</code>,</li>
<li><code>ends_with("X")</code>; every name that ends with <code>"X"</code>,</li>
<li><code>contains("X")</code>; every name that contains <code>"X"</code>,</li>
<li><code>matches("X")</code>; every name that matches <code>"X"</code>, where <code>"X"</code> can be a<br />
    regular expression,</li>
<li><code>num_range("x", 1:5)</code>; the variables named <code>x01</code>, <code>x02</code>, <code>x03</code>, -<br />
<code>x04</code> and <code>x05</code>,</li>
<li><code>one_of(x)</code>; every name that appears in <code>x</code>, which should be a<br />
    character vector.</li>
</ul>
<!-- -->

<div class="highlight"><pre><span></span><code><span class="c1"># Print out a tbl containing just ArrDelay and DepDelay</span>
<span class="nf">select</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="n">ArrDelay</span><span class="p">,</span> <span class="n">DepDelay</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## # A tibble: 227,496 × 2
##    ArrDelay DepDelay
## *     &lt;int&gt;    &lt;int&gt;
## 1       -10        0
## 2        -9        1
## 3        -8       -8
## 4         3        3
## 5        -3        5
## 6        -7       -1
## 7        -1       -1
## 8       -16       -5
## 9        44       43
## 10       43       43
## # ... with 227,486 more rows
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Print out a tbl as described in the second instruction, using both helper functions and variable names</span>
<span class="nf">select</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="n">UniqueCarrier</span><span class="p">,</span> <span class="nf">ends_with</span><span class="p">(</span><span class="s">&#39;Num&#39;</span><span class="p">),</span> <span class="nf">starts_with</span><span class="p">(</span><span class="s">&#39;Cancel&#39;</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## # A tibble: 227,496 × 5
##    UniqueCarrier FlightNum TailNum Cancelled CancellationCode
## *          &lt;chr&gt;     &lt;int&gt;   &lt;chr&gt;     &lt;int&gt;            &lt;chr&gt;
## 1       American       428  N576AA         0                 
## 2       American       428  N557AA         0                 
## 3       American       428  N541AA         0                 
## 4       American       428  N403AA         0                 
## 5       American       428  N492AA         0                 
## 6       American       428  N262AA         0                 
## 7       American       428  N493AA         0                 
## 8       American       428  N477AA         0                 
## 9       American       428  N476AA         0                 
## 10      American       428  N504AA         0                 
## # ... with 227,486 more rows
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Print out a tbl as described in the third instruction, using only helper functions.</span>
<span class="nf">select</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="nf">ends_with</span><span class="p">(</span><span class="s">&#39;Time&#39;</span><span class="p">),</span> <span class="nf">ends_with</span><span class="p">(</span><span class="s">&#39;Delay&#39;</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## # A tibble: 227,496 × 6
##    DepTime ArrTime ActualElapsedTime AirTime ArrDelay DepDelay
## *    &lt;int&gt;   &lt;int&gt;             &lt;int&gt;   &lt;int&gt;    &lt;int&gt;    &lt;int&gt;
## 1     1400    1500                60      40      -10        0
## 2     1401    1501                60      45       -9        1
## 3     1352    1502                70      48       -8       -8
## 4     1403    1513                70      39        3        3
## 5     1405    1507                62      44       -3        5
## 6     1359    1503                64      45       -7       -1
## 7     1359    1509                70      43       -1       -1
## 8     1355    1454                59      40      -16       -5
## 9     1443    1554                71      41       44       43
## 10    1443    1553                70      45       43       43
## # ... with 227,486 more rows
</code></pre></div>
</td></tr></table>
<p><strong>Comparison to basic R</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># add</span>
<span class="n">ex1r</span> <span class="o">&lt;-</span> <span class="n">hflights</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;TaxiIn&#39;</span><span class="p">,</span><span class="s">&#39;TaxiOut&#39;</span><span class="p">,</span><span class="s">&#39;Distance&#39;</span><span class="p">)]</span>

<span class="n">ex1d</span> <span class="o">&lt;-</span> <span class="nf">select</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="nf">starts_with</span><span class="p">(</span><span class="s">&#39;Taxi&#39;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">)</span>

<span class="n">ex2r</span> <span class="o">&lt;-</span> <span class="n">hflights</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;Year&#39;</span><span class="p">,</span><span class="s">&#39;Month&#39;</span><span class="p">,</span><span class="s">&#39;DayOfWeek&#39;</span><span class="p">,</span><span class="s">&#39;DepTime&#39;</span><span class="p">,</span><span class="s">&#39;ArrTime&#39;</span><span class="p">)]</span>

<span class="n">ex2d</span> <span class="o">&lt;-</span> <span class="nf">select</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="n">Year</span><span class="p">,</span> <span class="n">Month</span><span class="p">,</span> <span class="n">DayOfWeek</span><span class="p">,</span> <span class="n">DepTime</span><span class="p">,</span> <span class="n">ArrTime</span><span class="p">)</span>

<span class="n">ex3r</span> <span class="o">&lt;-</span> <span class="n">hflights</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;TailNum&#39;</span><span class="p">,</span><span class="s">&#39;TaxiIn&#39;</span><span class="p">,</span><span class="s">&#39;TaxiOut&#39;</span><span class="p">)]</span>

<span class="n">ex3d</span> <span class="o">&lt;-</span> <span class="nf">select</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="n">TailNum</span><span class="p">,</span> <span class="nf">starts_with</span><span class="p">(</span><span class="s">&#39;Taxi&#39;</span><span class="p">))</span>
</code></pre></div>
<p><strong>Mutating is creating</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Add the new variable ActualGroundTime to a copy of hflights and save the result as g1</span>
<span class="n">g1</span> <span class="o">&lt;-</span> <span class="nf">mutate</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="n">ActualGroundTime</span> <span class="o">=</span> <span class="n">ActualElapsedTime</span> <span class="o">-</span> <span class="n">AirTime</span><span class="p">)</span>
<span class="nf">glimpse</span><span class="p">(</span><span class="n">hflights</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Observations: 227,496
## Variables: 21
## $ Year              &lt;int&gt; 2011, 2011, 2011, 2011, 2011, 2011, 2011, 20...
## $ Month             &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,...
## $ DayofMonth        &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 1...
## $ DayOfWeek         &lt;int&gt; 6, 7, 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6,...
## $ DepTime           &lt;int&gt; 1400, 1401, 1352, 1403, 1405, 1359, 1359, 13...
## $ ArrTime           &lt;int&gt; 1500, 1501, 1502, 1513, 1507, 1503, 1509, 14...
## $ UniqueCarrier     &lt;chr&gt; &quot;American&quot;, &quot;American&quot;, &quot;American&quot;, &quot;America...
## $ FlightNum         &lt;int&gt; 428, 428, 428, 428, 428, 428, 428, 428, 428,...
## $ TailNum           &lt;chr&gt; &quot;N576AA&quot;, &quot;N557AA&quot;, &quot;N541AA&quot;, &quot;N403AA&quot;, &quot;N49...
## $ ActualElapsedTime &lt;int&gt; 60, 60, 70, 70, 62, 64, 70, 59, 71, 70, 70, ...
## $ AirTime           &lt;int&gt; 40, 45, 48, 39, 44, 45, 43, 40, 41, 45, 42, ...
## $ ArrDelay          &lt;int&gt; -10, -9, -8, 3, -3, -7, -1, -16, 44, 43, 29,...
## $ DepDelay          &lt;int&gt; 0, 1, -8, 3, 5, -1, -1, -5, 43, 43, 29, 19, ...
## $ Origin            &lt;chr&gt; &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;I...
## $ Dest              &lt;chr&gt; &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;D...
## $ Distance          &lt;int&gt; 224, 224, 224, 224, 224, 224, 224, 224, 224,...
## $ TaxiIn            &lt;int&gt; 7, 6, 5, 9, 9, 6, 12, 7, 8, 6, 8, 4, 6, 5, 6...
## $ TaxiOut           &lt;int&gt; 13, 9, 17, 22, 9, 13, 15, 12, 22, 19, 20, 11...
## $ Cancelled         &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
## $ CancellationCode  &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, ...
## $ Diverted          &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">glimpse</span><span class="p">(</span><span class="n">g1</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Observations: 227,496
## Variables: 22
## $ Year              &lt;int&gt; 2011, 2011, 2011, 2011, 2011, 2011, 2011, 20...
## $ Month             &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,...
## $ DayofMonth        &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 1...
## $ DayOfWeek         &lt;int&gt; 6, 7, 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6,...
## $ DepTime           &lt;int&gt; 1400, 1401, 1352, 1403, 1405, 1359, 1359, 13...
## $ ArrTime           &lt;int&gt; 1500, 1501, 1502, 1513, 1507, 1503, 1509, 14...
## $ UniqueCarrier     &lt;chr&gt; &quot;American&quot;, &quot;American&quot;, &quot;American&quot;, &quot;America...
## $ FlightNum         &lt;int&gt; 428, 428, 428, 428, 428, 428, 428, 428, 428,...
## $ TailNum           &lt;chr&gt; &quot;N576AA&quot;, &quot;N557AA&quot;, &quot;N541AA&quot;, &quot;N403AA&quot;, &quot;N49...
## $ ActualElapsedTime &lt;int&gt; 60, 60, 70, 70, 62, 64, 70, 59, 71, 70, 70, ...
## $ AirTime           &lt;int&gt; 40, 45, 48, 39, 44, 45, 43, 40, 41, 45, 42, ...
## $ ArrDelay          &lt;int&gt; -10, -9, -8, 3, -3, -7, -1, -16, 44, 43, 29,...
## $ DepDelay          &lt;int&gt; 0, 1, -8, 3, 5, -1, -1, -5, 43, 43, 29, 19, ...
## $ Origin            &lt;chr&gt; &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;I...
## $ Dest              &lt;chr&gt; &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;D...
## $ Distance          &lt;int&gt; 224, 224, 224, 224, 224, 224, 224, 224, 224,...
## $ TaxiIn            &lt;int&gt; 7, 6, 5, 9, 9, 6, 12, 7, 8, 6, 8, 4, 6, 5, 6...
## $ TaxiOut           &lt;int&gt; 13, 9, 17, 22, 9, 13, 15, 12, 22, 19, 20, 11...
## $ Cancelled         &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
## $ CancellationCode  &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, ...
## $ Diverted          &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
## $ ActualGroundTime  &lt;int&gt; 20, 15, 22, 31, 18, 19, 27, 19, 30, 25, 28, ...
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Add the new variable GroundTime to a g1; save the result as g2</span>
<span class="n">g2</span> <span class="o">&lt;-</span> <span class="nf">mutate</span><span class="p">(</span><span class="n">g1</span><span class="p">,</span> <span class="n">GroundTime</span> <span class="o">=</span> <span class="n">TaxiIn</span> <span class="o">+</span> <span class="n">TaxiOut</span><span class="p">)</span>

<span class="nf">head</span><span class="p">(</span><span class="n">g1</span><span class="o">$</span><span class="n">ActualGroundTime</span> <span class="o">==</span> <span class="n">g2</span><span class="o">$</span><span class="n">GroundTime</span><span class="p">,</span> <span class="m">20</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
## [15] TRUE TRUE TRUE TRUE TRUE TRUE
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Add the new variable AverageSpeed to g2; save the result as g3</span>
<span class="n">g3</span> <span class="o">&lt;-</span> <span class="nf">mutate</span><span class="p">(</span><span class="n">g2</span><span class="p">,</span> <span class="n">AverageSpeed</span> <span class="o">=</span> <span class="n">Distance</span> <span class="o">/</span> <span class="n">AirTime</span> <span class="o">*</span> <span class="m">60</span><span class="p">)</span>
<span class="n">g3</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## # A tibble: 227,496 × 24</span>
<span class="c1">##     Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier</span>
<span class="c1">##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;         &lt;chr&gt;</span>
<span class="c1">## 1   2011     1          1         6    1400    1500      American</span>
<span class="c1">## 2   2011     1          2         7    1401    1501      American</span>
<span class="c1">## 3   2011     1          3         1    1352    1502      American</span>
<span class="c1">## 4   2011     1          4         2    1403    1513      American</span>
<span class="c1">## 5   2011     1          5         3    1405    1507      American</span>
<span class="c1">## 6   2011     1          6         4    1359    1503      American</span>
<span class="c1">## 7   2011     1          7         5    1359    1509      American</span>
<span class="c1">## 8   2011     1          8         6    1355    1454      American</span>
<span class="c1">## 9   2011     1          9         7    1443    1554      American</span>
<span class="c1">## 10  2011     1         10         1    1443    1553      American</span>
<span class="c1">## # ... with 227,486 more rows, and 17 more variables: FlightNum &lt;int&gt;,</span>
<span class="c1">## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,</span>
<span class="c1">## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,</span>
<span class="c1">## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,</span>
<span class="c1">## #   Diverted &lt;int&gt;, ActualGroundTime &lt;int&gt;, GroundTime &lt;int&gt;,</span>
<span class="c1">## #   AverageSpeed &lt;dbl&gt;</span>
</code></pre></div>
</td></tr></table>
<p><strong>Add multiple variables using mutate</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Add a second variable loss_percent to the dataset: m1</span>
<span class="n">m1</span> <span class="o">&lt;-</span> <span class="nf">mutate</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">ArrDelay</span> <span class="o">-</span> <span class="n">DepDelay</span><span class="p">,</span> <span class="n">loss_percent</span> <span class="o">=</span> <span class="p">(</span><span class="n">ArrDelay</span> <span class="o">-</span> <span class="n">DepDelay</span><span class="p">)</span><span class="o">/</span><span class="n">DepDelay</span><span class="o">*</span><span class="m">100</span><span class="p">)</span>

<span class="c1"># Copy and adapt the previous command to reduce redendancy: m2</span>
<span class="n">m2</span> <span class="o">&lt;-</span> <span class="nf">mutate</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">ArrDelay</span> <span class="o">-</span> <span class="n">DepDelay</span><span class="p">,</span> <span class="n">loss_percent</span> <span class="o">=</span> <span class="n">loss</span><span class="o">/</span><span class="n">DepDelay</span> <span class="o">*</span> <span class="m">100</span><span class="p">)</span>

<span class="c1"># Add the three variables as described in the third instruction: m3</span>
<span class="n">m3</span> <span class="o">&lt;-</span> <span class="nf">mutate</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="n">TotalTaxi</span> <span class="o">=</span> <span class="n">TaxiIn</span> <span class="o">+</span> <span class="n">TaxiOut</span><span class="p">,</span> <span class="n">ActualGroundTime</span> <span class="o">=</span> <span class="n">ActualElapsedTime</span> <span class="o">-</span> <span class="n">AirTime</span><span class="p">,</span> <span class="n">Diff</span> <span class="o">=</span> <span class="n">TotalTaxi</span> <span class="o">-</span> <span class="n">ActualGroundTime</span><span class="p">)</span>
<span class="nf">glimpse</span><span class="p">(</span><span class="n">m3</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Observations: 227,496
## Variables: 24
## $ Year              &lt;int&gt; 2011, 2011, 2011, 2011, 2011, 2011, 2011, 20...
## $ Month             &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,...
## $ DayofMonth        &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 1...
## $ DayOfWeek         &lt;int&gt; 6, 7, 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6,...
## $ DepTime           &lt;int&gt; 1400, 1401, 1352, 1403, 1405, 1359, 1359, 13...
## $ ArrTime           &lt;int&gt; 1500, 1501, 1502, 1513, 1507, 1503, 1509, 14...
## $ UniqueCarrier     &lt;chr&gt; &quot;American&quot;, &quot;American&quot;, &quot;American&quot;, &quot;America...
## $ FlightNum         &lt;int&gt; 428, 428, 428, 428, 428, 428, 428, 428, 428,...
## $ TailNum           &lt;chr&gt; &quot;N576AA&quot;, &quot;N557AA&quot;, &quot;N541AA&quot;, &quot;N403AA&quot;, &quot;N49...
## $ ActualElapsedTime &lt;int&gt; 60, 60, 70, 70, 62, 64, 70, 59, 71, 70, 70, ...
## $ AirTime           &lt;int&gt; 40, 45, 48, 39, 44, 45, 43, 40, 41, 45, 42, ...
## $ ArrDelay          &lt;int&gt; -10, -9, -8, 3, -3, -7, -1, -16, 44, 43, 29,...
## $ DepDelay          &lt;int&gt; 0, 1, -8, 3, 5, -1, -1, -5, 43, 43, 29, 19, ...
## $ Origin            &lt;chr&gt; &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;I...
## $ Dest              &lt;chr&gt; &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;D...
## $ Distance          &lt;int&gt; 224, 224, 224, 224, 224, 224, 224, 224, 224,...
## $ TaxiIn            &lt;int&gt; 7, 6, 5, 9, 9, 6, 12, 7, 8, 6, 8, 4, 6, 5, 6...
## $ TaxiOut           &lt;int&gt; 13, 9, 17, 22, 9, 13, 15, 12, 22, 19, 20, 11...
## $ Cancelled         &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
## $ CancellationCode  &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, ...
## $ Diverted          &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
## $ TotalTaxi         &lt;int&gt; 20, 15, 22, 31, 18, 19, 27, 19, 30, 25, 28, ...
## $ ActualGroundTime  &lt;int&gt; 20, 15, 22, 31, 18, 19, 27, 19, 30, 25, 28, ...
## $ Diff              &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
</code></pre></div>
</td></tr></table>
<h3 id="3-filter-and-arrange">3, <code>filter</code> and <code>arrange</code><a class="headerlink" href="#3-filter-and-arrange" title="Permanent link">&para;</a></h3>
<p><strong>Logical operators</strong></p>
<p><code>filter</code>:</p>
<ul>
<li><code>x &lt; y</code>; <code>TRUE</code> if <code>x</code> is less than <code>y</code>.</li>
<li><code>x &lt;= y</code>; <code>TRUE</code> if <code>x</code> is less than or equal to <code>y</code>.</li>
<li><code>x == y</code>; <code>TRUE</code> if <code>x</code> equals <code>y</code>.</li>
<li><code>x != y</code>; <code>TRUE</code> if <code>x</code> does not equal <code>y</code>.</li>
<li><code>x &gt;= y</code>; <code>TRUE</code> if <code>x</code> is greater than or equal to <code>y</code>.</li>
<li><code>x &gt; y</code>; <code>TRUE</code> if <code>x</code> is greater than <code>y</code>.</li>
<li><code>x %in% c(a, b, c)</code>; <code>TRUE</code> if <code>x</code> is in the vector <code>c(a, b, c)</code>.</li>
</ul>
<!-- -->

<div class="highlight"><pre><span></span><code><span class="c1"># All flights that traveled 3000 miles or more</span>
<span class="nf">filter</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="n">Distance</span> <span class="o">&gt;=</span> <span class="m">3000</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## # A tibble: 527 × 21</span>
<span class="c1">##     Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier</span>
<span class="c1">##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;         &lt;chr&gt;</span>
<span class="c1">## 1   2011     1         31         1     924    1413   Continental</span>
<span class="c1">## 2   2011     1         30         7     925    1410   Continental</span>
<span class="c1">## 3   2011     1         29         6    1045    1445   Continental</span>
<span class="c1">## 4   2011     1         28         5    1516    1916   Continental</span>
<span class="c1">## 5   2011     1         27         4     950    1344   Continental</span>
<span class="c1">## 6   2011     1         26         3     944    1350   Continental</span>
<span class="c1">## 7   2011     1         25         2     924    1337   Continental</span>
<span class="c1">## 8   2011     1         24         1    1144    1605   Continental</span>
<span class="c1">## 9   2011     1         23         7     926    1335   Continental</span>
<span class="c1">## 10  2011     1         22         6     942    1340   Continental</span>
<span class="c1">## # ... with 517 more rows, and 14 more variables: FlightNum &lt;int&gt;,</span>
<span class="c1">## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,</span>
<span class="c1">## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,</span>
<span class="c1">## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,</span>
<span class="c1">## #   Diverted &lt;int&gt;</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># All flights flown by one of JetBlue, Southwest, or Delta</span>
<span class="nf">filter</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="n">UniqueCarrier</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;JetBlue&#39;</span><span class="p">,</span><span class="s">&#39;Southwest&#39;</span><span class="p">,</span><span class="s">&#39;Delta&#39;</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## # A tibble: 48,679 × 21</span>
<span class="c1">##     Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier</span>
<span class="c1">##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;         &lt;chr&gt;</span>
<span class="c1">## 1   2011     1          1         6     654    1124       JetBlue</span>
<span class="c1">## 2   2011     1          1         6    1639    2110       JetBlue</span>
<span class="c1">## 3   2011     1          2         7     703    1113       JetBlue</span>
<span class="c1">## 4   2011     1          2         7    1604    2040       JetBlue</span>
<span class="c1">## 5   2011     1          3         1     659    1100       JetBlue</span>
<span class="c1">## 6   2011     1          3         1    1801    2200       JetBlue</span>
<span class="c1">## 7   2011     1          4         2     654    1103       JetBlue</span>
<span class="c1">## 8   2011     1          4         2    1608    2034       JetBlue</span>
<span class="c1">## 9   2011     1          5         3     700    1103       JetBlue</span>
<span class="c1">## 10  2011     1          5         3    1544    1954       JetBlue</span>
<span class="c1">## # ... with 48,669 more rows, and 14 more variables: FlightNum &lt;int&gt;,</span>
<span class="c1">## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,</span>
<span class="c1">## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,</span>
<span class="c1">## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,</span>
<span class="c1">## #   Diverted &lt;int&gt;</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># All flights where taxiing took longer than flying</span>
<span class="nf">filter</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="p">(</span><span class="n">TaxiIn</span> <span class="o">+</span> <span class="n">TaxiOut</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AirTime</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## # A tibble: 1,389 × 21</span>
<span class="c1">##     Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier</span>
<span class="c1">##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;         &lt;chr&gt;</span>
<span class="c1">## 1   2011     1         24         1     731     904      American</span>
<span class="c1">## 2   2011     1         30         7    1959    2132      American</span>
<span class="c1">## 3   2011     1         24         1    1621    1749      American</span>
<span class="c1">## 4   2011     1         10         1     941    1113      American</span>
<span class="c1">## 5   2011     1         31         1    1301    1356   Continental</span>
<span class="c1">## 6   2011     1         31         1    2113    2215   Continental</span>
<span class="c1">## 7   2011     1         31         1    1434    1539   Continental</span>
<span class="c1">## 8   2011     1         31         1     900    1006   Continental</span>
<span class="c1">## 9   2011     1         30         7    1304    1408   Continental</span>
<span class="c1">## 10  2011     1         30         7    2004    2128   Continental</span>
<span class="c1">## # ... with 1,379 more rows, and 14 more variables: FlightNum &lt;int&gt;,</span>
<span class="c1">## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,</span>
<span class="c1">## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,</span>
<span class="c1">## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,</span>
<span class="c1">## #   Diverted &lt;int&gt;</span>
</code></pre></div>
</td></tr></table>
<p><strong>Combining tests using boolean operators</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># All flights that departed before 5am or arrived after 10pm</span>
<span class="nf">filter</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="n">DepTime</span> <span class="o">&lt;</span> <span class="m">500</span> <span class="o">|</span> <span class="n">ArrTime</span> <span class="o">&gt;</span> <span class="m">2200</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## # A tibble: 27,799 × 21</span>
<span class="c1">##     Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier</span>
<span class="c1">##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;         &lt;chr&gt;</span>
<span class="c1">## 1   2011     1          4         2    2100    2207      American</span>
<span class="c1">## 2   2011     1         14         5    2119    2229      American</span>
<span class="c1">## 3   2011     1         10         1    1934    2235      American</span>
<span class="c1">## 4   2011     1         26         3    1905    2211      American</span>
<span class="c1">## 5   2011     1         30         7    1856    2209      American</span>
<span class="c1">## 6   2011     1          9         7    1938    2228        Alaska</span>
<span class="c1">## 7   2011     1         31         1    1919    2231   Continental</span>
<span class="c1">## 8   2011     1         31         1    2116    2344   Continental</span>
<span class="c1">## 9   2011     1         31         1    1850    2211   Continental</span>
<span class="c1">## 10  2011     1         31         1    2102    2216   Continental</span>
<span class="c1">## # ... with 27,789 more rows, and 14 more variables: FlightNum &lt;int&gt;,</span>
<span class="c1">## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,</span>
<span class="c1">## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,</span>
<span class="c1">## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,</span>
<span class="c1">## #   Diverted &lt;int&gt;</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># All flights that departed late but arrived ahead of schedule</span>
<span class="nf">filter</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="n">DepDelay</span> <span class="o">&gt;</span> <span class="m">0</span> <span class="o">&amp;</span> <span class="n">ArrDelay</span> <span class="o">&lt;</span> <span class="m">0</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## # A tibble: 27,712 × 21</span>
<span class="c1">##     Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier</span>
<span class="c1">##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;         &lt;chr&gt;</span>
<span class="c1">## 1   2011     1          2         7    1401    1501      American</span>
<span class="c1">## 2   2011     1          5         3    1405    1507      American</span>
<span class="c1">## 3   2011     1         18         2    1408    1508      American</span>
<span class="c1">## 4   2011     1         18         2     721     827      American</span>
<span class="c1">## 5   2011     1         12         3    2015    2113      American</span>
<span class="c1">## 6   2011     1         13         4    2020    2116      American</span>
<span class="c1">## 7   2011     1         26         3    2009    2103      American</span>
<span class="c1">## 8   2011     1          1         6    1631    1736      American</span>
<span class="c1">## 9   2011     1         10         1    1639    1740      American</span>
<span class="c1">## 10  2011     1         12         3    1631    1739      American</span>
<span class="c1">## # ... with 27,702 more rows, and 14 more variables: FlightNum &lt;int&gt;,</span>
<span class="c1">## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,</span>
<span class="c1">## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,</span>
<span class="c1">## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,</span>
<span class="c1">## #   Diverted &lt;int&gt;</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># All cancelled weekend flights</span>
<span class="nf">filter</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="n">DayOfWeek</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="m">6</span><span class="p">,</span><span class="m">7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">Cancelled</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## # A tibble: 585 × 21</span>
<span class="c1">##     Year Month DayofMonth DayOfWeek DepTime ArrTime      UniqueCarrier</span>
<span class="c1">##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;              &lt;chr&gt;</span>
<span class="c1">## 1   2011     1          9         7      NA      NA           American</span>
<span class="c1">## 2   2011     1         29         6      NA      NA        Continental</span>
<span class="c1">## 3   2011     1          9         7      NA      NA        Continental</span>
<span class="c1">## 4   2011     1          9         7      NA      NA              Delta</span>
<span class="c1">## 5   2011     1          9         7      NA      NA            SkyWest</span>
<span class="c1">## 6   2011     1          2         7      NA      NA          Southwest</span>
<span class="c1">## 7   2011     1         29         6      NA      NA              Delta</span>
<span class="c1">## 8   2011     1          9         7      NA      NA Atlantic_Southeast</span>
<span class="c1">## 9   2011     1          1         6      NA      NA            AirTran</span>
<span class="c1">## 10  2011     1          9         7      NA      NA            AirTran</span>
<span class="c1">## # ... with 575 more rows, and 14 more variables: FlightNum &lt;int&gt;,</span>
<span class="c1">## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,</span>
<span class="c1">## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,</span>
<span class="c1">## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,</span>
<span class="c1">## #   Diverted &lt;int&gt;</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># All flights that were cancelled after being delayed</span>
<span class="nf">filter</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="n">DepDelay</span> <span class="o">&gt;</span> <span class="m">0</span> <span class="o">&amp;</span> <span class="n">Cancelled</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## # A tibble: 40 × 21</span>
<span class="c1">##     Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier</span>
<span class="c1">##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;         &lt;chr&gt;</span>
<span class="c1">## 1   2011     1         26         3    1926      NA   Continental</span>
<span class="c1">## 2   2011     1         11         2    1100      NA    US_Airways</span>
<span class="c1">## 3   2011     1         19         3    1811      NA    ExpressJet</span>
<span class="c1">## 4   2011     1          7         5    2028      NA    ExpressJet</span>
<span class="c1">## 5   2011     2          4         5    1638      NA      American</span>
<span class="c1">## 6   2011     2          8         2    1057      NA   Continental</span>
<span class="c1">## 7   2011     2          2         3     802      NA    ExpressJet</span>
<span class="c1">## 8   2011     2          9         3     904      NA    ExpressJet</span>
<span class="c1">## 9   2011     2          1         2    1508      NA       SkyWest</span>
<span class="c1">## 10  2011     3         31         4    1016      NA   Continental</span>
<span class="c1">## # ... with 30 more rows, and 14 more variables: FlightNum &lt;int&gt;,</span>
<span class="c1">## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,</span>
<span class="c1">## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,</span>
<span class="c1">## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,</span>
<span class="c1">## #   Diverted &lt;int&gt;</span>
</code></pre></div>
</td></tr></table>
<p><strong>Blend together what you&rsquo;ve learned!</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Select the flights that had JFK as their destination: c1</span>
<span class="n">c1</span> <span class="o">&lt;-</span> <span class="nf">filter</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="n">Dest</span> <span class="o">==</span> <span class="s">&#39;JFK&#39;</span><span class="p">)</span>

<span class="c1"># Combine the Year, Month and DayofMonth variables to create a Date column: c2</span>
<span class="n">c2</span> <span class="o">&lt;-</span> <span class="nf">mutate</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">Date</span> <span class="o">=</span> <span class="nf">paste</span><span class="p">(</span><span class="n">Year</span><span class="p">,</span> <span class="n">Month</span><span class="p">,</span> <span class="n">DayofMonth</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">&#39;-&#39;</span><span class="p">))</span>

<span class="c1"># Print out a selection of columns of c2</span>
<span class="nf">select</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span> <span class="n">Date</span><span class="p">,</span> <span class="n">DepTime</span><span class="p">,</span> <span class="n">ArrTime</span><span class="p">,</span> <span class="n">TailNum</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## # A tibble: 695 × 4
##        Date DepTime ArrTime TailNum
##       &lt;chr&gt;   &lt;int&gt;   &lt;int&gt;   &lt;chr&gt;
## 1  2011-1-1     654    1124  N324JB
## 2  2011-1-1    1639    2110  N324JB
## 3  2011-1-2     703    1113  N324JB
## 4  2011-1-2    1604    2040  N324JB
## 5  2011-1-3     659    1100  N229JB
## 6  2011-1-3    1801    2200  N206JB
## 7  2011-1-4     654    1103  N267JB
## 8  2011-1-4    1608    2034  N267JB
## 9  2011-1-5     700    1103  N708JB
## 10 2011-1-5    1544    1954  N644JB
## # ... with 685 more rows
</code></pre></div>
</td></tr></table>
<p><strong>Arranging your data</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Definition of dtc</span>
<span class="n">dtc</span> <span class="o">&lt;-</span> <span class="nf">filter</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="n">Cancelled</span> <span class="o">==</span> <span class="m">1</span><span class="p">,</span> <span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">DepDelay</span><span class="p">))</span>

<span class="c1"># Arrange dtc by departure delays</span>
<span class="nf">arrange</span><span class="p">(</span><span class="n">dtc</span><span class="p">,</span> <span class="n">DepDelay</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## # A tibble: 68 × 21</span>
<span class="c1">##     Year Month DayofMonth DayOfWeek DepTime ArrTime  UniqueCarrier</span>
<span class="c1">##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;          &lt;chr&gt;</span>
<span class="c1">## 1   2011     7         23         6     605      NA       Frontier</span>
<span class="c1">## 2   2011     1         17         1     916      NA     ExpressJet</span>
<span class="c1">## 3   2011    12          1         4     541      NA     US_Airways</span>
<span class="c1">## 4   2011    10         12         3    2022      NA American_Eagle</span>
<span class="c1">## 5   2011     7         29         5    1424      NA    Continental</span>
<span class="c1">## 6   2011     9         29         4    1639      NA        SkyWest</span>
<span class="c1">## 7   2011     2          9         3     555      NA American_Eagle</span>
<span class="c1">## 8   2011     5          9         1     715      NA        SkyWest</span>
<span class="c1">## 9   2011     1         20         4    1413      NA         United</span>
<span class="c1">## 10  2011     1         17         1     831      NA      Southwest</span>
<span class="c1">## # ... with 58 more rows, and 14 more variables: FlightNum &lt;int&gt;,</span>
<span class="c1">## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,</span>
<span class="c1">## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,</span>
<span class="c1">## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,</span>
<span class="c1">## #   Diverted &lt;int&gt;</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Arrange dtc so that cancellation reasons are grouped</span>
<span class="nf">arrange</span><span class="p">(</span><span class="n">dtc</span><span class="p">,</span> <span class="n">CancellationCode</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## # A tibble: 68 × 21</span>
<span class="c1">##     Year Month DayofMonth DayOfWeek DepTime ArrTime  UniqueCarrier</span>
<span class="c1">##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;          &lt;chr&gt;</span>
<span class="c1">## 1   2011     1         20         4    1413      NA         United</span>
<span class="c1">## 2   2011     1          7         5    2028      NA     ExpressJet</span>
<span class="c1">## 3   2011     2          4         5    1638      NA       American</span>
<span class="c1">## 4   2011     2          8         2    1057      NA    Continental</span>
<span class="c1">## 5   2011     2          1         2    1508      NA        SkyWest</span>
<span class="c1">## 6   2011     2         21         1    2257      NA        SkyWest</span>
<span class="c1">## 7   2011     2          9         3     555      NA American_Eagle</span>
<span class="c1">## 8   2011     3         18         5     727      NA         United</span>
<span class="c1">## 9   2011     4          4         1    1632      NA          Delta</span>
<span class="c1">## 10  2011     4          8         5    1608      NA      Southwest</span>
<span class="c1">## # ... with 58 more rows, and 14 more variables: FlightNum &lt;int&gt;,</span>
<span class="c1">## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,</span>
<span class="c1">## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,</span>
<span class="c1">## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,</span>
<span class="c1">## #   Diverted &lt;int&gt;</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Arrange dtc according to carrier and departure delays</span>
<span class="nf">arrange</span><span class="p">(</span><span class="n">dtc</span><span class="p">,</span> <span class="n">UniqueCarrier</span><span class="p">,</span> <span class="n">DepDelay</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## # A tibble: 68 × 21</span>
<span class="c1">##     Year Month DayofMonth DayOfWeek DepTime ArrTime      UniqueCarrier</span>
<span class="c1">##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;              &lt;chr&gt;</span>
<span class="c1">## 1   2011     6         11         6    1649      NA            AirTran</span>
<span class="c1">## 2   2011     8         18         4    1808      NA           American</span>
<span class="c1">## 3   2011     2          4         5    1638      NA           American</span>
<span class="c1">## 4   2011    10         12         3    2022      NA     American_Eagle</span>
<span class="c1">## 5   2011     2          9         3     555      NA     American_Eagle</span>
<span class="c1">## 6   2011     7         17         7    1917      NA     American_Eagle</span>
<span class="c1">## 7   2011     4         30         6     612      NA Atlantic_Southeast</span>
<span class="c1">## 8   2011     4         10         7    1147      NA Atlantic_Southeast</span>
<span class="c1">## 9   2011     5         23         1     657      NA Atlantic_Southeast</span>
<span class="c1">## 10  2011     9         29         4     723      NA Atlantic_Southeast</span>
<span class="c1">## # ... with 58 more rows, and 14 more variables: FlightNum &lt;int&gt;,</span>
<span class="c1">## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,</span>
<span class="c1">## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,</span>
<span class="c1">## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,</span>
<span class="c1">## #   Diverted &lt;int&gt;</span>
</code></pre></div>
</td></tr></table>
<p><strong>Reverse the order of arranging</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Arrange according to carrier and decreasing departure delays</span>
<span class="nf">arrange</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="n">UniqueCarrier</span><span class="p">,</span> <span class="nf">desc</span><span class="p">(</span><span class="n">DepDelay</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## # A tibble: 227,496 × 21</span>
<span class="c1">##     Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier</span>
<span class="c1">##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;         &lt;chr&gt;</span>
<span class="c1">## 1   2011     2         19         6    1902    2143       AirTran</span>
<span class="c1">## 2   2011     3         14         1    2024    2309       AirTran</span>
<span class="c1">## 3   2011     2         16         3    2349     227       AirTran</span>
<span class="c1">## 4   2011    11         13         7    2312     213       AirTran</span>
<span class="c1">## 5   2011     5         26         4    2353     305       AirTran</span>
<span class="c1">## 6   2011     5         26         4    1922    2229       AirTran</span>
<span class="c1">## 7   2011     4         28         4    1045    1328       AirTran</span>
<span class="c1">## 8   2011     6          5         7    2207      52       AirTran</span>
<span class="c1">## 9   2011     5          7         6    1009    1256       AirTran</span>
<span class="c1">## 10  2011     7         25         1    2107      14       AirTran</span>
<span class="c1">## # ... with 227,486 more rows, and 14 more variables: FlightNum &lt;int&gt;,</span>
<span class="c1">## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,</span>
<span class="c1">## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,</span>
<span class="c1">## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,</span>
<span class="c1">## #   Diverted &lt;int&gt;</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Arrange flights by total delay (normal order).</span>
<span class="nf">arrange</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="p">(</span><span class="n">ArrDelay</span><span class="o">+</span><span class="n">DepDelay</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## # A tibble: 227,496 × 21</span>
<span class="c1">##     Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier</span>
<span class="c1">##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;         &lt;chr&gt;</span>
<span class="c1">## 1   2011     7          3         7    1914    2039    ExpressJet</span>
<span class="c1">## 2   2011     8         31         3     934    1039       SkyWest</span>
<span class="c1">## 3   2011     8         21         7     935    1039       SkyWest</span>
<span class="c1">## 4   2011     8         28         7    2059    2206       SkyWest</span>
<span class="c1">## 5   2011     8         29         1     935    1041       SkyWest</span>
<span class="c1">## 6   2011    12         25         7     741     926       SkyWest</span>
<span class="c1">## 7   2011     1         30         7     620     812       SkyWest</span>
<span class="c1">## 8   2011     8          3         3    1741    1810    ExpressJet</span>
<span class="c1">## 9   2011     8          4         4     930    1041       SkyWest</span>
<span class="c1">## 10  2011     8         18         4     939    1043       SkyWest</span>
<span class="c1">## # ... with 227,486 more rows, and 14 more variables: FlightNum &lt;int&gt;,</span>
<span class="c1">## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,</span>
<span class="c1">## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,</span>
<span class="c1">## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,</span>
<span class="c1">## #   Diverted &lt;int&gt;</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Keep flights leaving to DFW before 8am and arrange according to decreasing AirTime </span>
<span class="nf">arrange</span><span class="p">(</span><span class="nf">filter</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="n">Dest</span> <span class="o">==</span> <span class="s">&#39;DFW&#39;</span> <span class="o">&amp;</span> <span class="n">DepTime</span><span class="o">&lt;</span><span class="m">800</span><span class="p">),</span> <span class="nf">desc</span><span class="p">(</span><span class="n">AirTime</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## # A tibble: 799 × 21</span>
<span class="c1">##     Year Month DayofMonth DayOfWeek DepTime ArrTime  UniqueCarrier</span>
<span class="c1">##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;          &lt;chr&gt;</span>
<span class="c1">## 1   2011    11         22         2     635     825       American</span>
<span class="c1">## 2   2011     8         25         4     602     758 American_Eagle</span>
<span class="c1">## 3   2011    10         12         3     559     738 American_Eagle</span>
<span class="c1">## 4   2011     5          2         1     716     854       American</span>
<span class="c1">## 5   2011     4          4         1     741     949       American</span>
<span class="c1">## 6   2011     4          4         1     627     742 American_Eagle</span>
<span class="c1">## 7   2011     6         21         2     726     848     ExpressJet</span>
<span class="c1">## 8   2011     9          1         4     715     844       American</span>
<span class="c1">## 9   2011     3         14         1     729     917    Continental</span>
<span class="c1">## 10  2011    12          5         1     724     847    Continental</span>
<span class="c1">## # ... with 789 more rows, and 14 more variables: FlightNum &lt;int&gt;,</span>
<span class="c1">## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,</span>
<span class="c1">## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,</span>
<span class="c1">## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,</span>
<span class="c1">## #   Diverted &lt;int&gt;</span>
</code></pre></div>
</td></tr></table>
<h3 id="4-summarise-and-the-pipe-operator">4, <code>summarise</code> and the Pipe Operator<a class="headerlink" href="#4-summarise-and-the-pipe-operator" title="Permanent link">&para;</a></h3>
<p><strong>The syntax of summarise</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Print out a summary with variables min_dist and max_dist</span>
<span class="nf">summarise</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="n">min_dist</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="n">Distance</span><span class="p">),</span> <span class="n">max_dist</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">Distance</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## # A tibble: 1 × 2
##   min_dist max_dist
##      &lt;int&gt;    &lt;int&gt;
## 1       79     3904
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Print out a summary with variable max_div</span>
<span class="nf">summarise</span><span class="p">(</span><span class="nf">filter</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="n">Diverted</span> <span class="o">==</span> <span class="m">1</span><span class="p">),</span> <span class="n">max_div</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">Distance</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## # A tibble: 1 × 1
##   max_div
##     &lt;int&gt;
## 1    3904
</code></pre></div>
</td></tr></table>
<p><strong>Aggregate functions</strong></p>
<p><code>summarise</code>:</p>
<ul>
<li><code>min(x)</code>; minimum value of vector x.</li>
<li><code>max(x)</code>; maximum value of vector x.</li>
<li><code>mean(x)</code>; mean value of vector x.</li>
<li><code>median(x)</code>; median value of vector x.</li>
<li><code>quantile(x, p)</code>; pth quantile of vector x.</li>
<li><code>sd(x)</code>; standard deviation of vector x.</li>
<li><code>var(x)</code>; variance of vector x.</li>
<li><code>IQR(x)</code>; Inter Quartile Range (IQR) of vector x.</li>
<li><code>diff(range(x))</code>; total range of vector x.</li>
</ul>
<!-- -->

<div class="highlight"><pre><span></span><code><span class="c1"># Remove rows that have NA ArrDelay: temp1</span>
<span class="n">temp1</span> <span class="o">&lt;-</span> <span class="nf">filter</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">ArrDelay</span><span class="p">))</span>

<span class="c1"># Generate summary about ArrDelay column of temp1</span>
<span class="nf">summarise</span><span class="p">(</span><span class="n">temp1</span><span class="p">,</span> <span class="n">earliest</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="n">ArrDelay</span><span class="p">),</span> <span class="n">average</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">ArrDelay</span><span class="p">),</span> <span class="n">latest</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">ArrDelay</span><span class="p">),</span> <span class="n">sd</span> <span class="o">=</span> <span class="nf">sd</span><span class="p">(</span><span class="n">ArrDelay</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## # A tibble: 1 × 4
##   earliest  average latest       sd
##      &lt;int&gt;    &lt;dbl&gt;  &lt;int&gt;    &lt;dbl&gt;
## 1      -70 7.094334    978 30.70852
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Keep rows that have no NA TaxiIn and no NA TaxiOut: temp2</span>
<span class="n">temp2</span> <span class="o">&lt;-</span> <span class="nf">filter</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">TaxiIn</span><span class="p">),</span> <span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">TaxiOut</span><span class="p">))</span>

<span class="c1"># Print the maximum taxiing difference of temp2 with summarise()</span>
<span class="nf">summarise</span><span class="p">(</span><span class="n">temp2</span><span class="p">,</span> <span class="n">max_taxi_diff</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">TaxiIn</span> <span class="o">-</span> <span class="n">TaxiOut</span><span class="p">)))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## # A tibble: 1 × 1
##   max_taxi_diff
##           &lt;int&gt;
## 1           160
</code></pre></div>
</td></tr></table>
<p><strong><code>dplyr</code> aggregate functions</strong></p>
<ul>
<li><code>first(x)</code>; the first element of vector <code>x</code>.</li>
<li><code>last(x)</code>; the last element of vector <code>x</code>.</li>
<li><code>nth(x, n)</code>; The <code>n</code>th element of vector <code>x</code>.</li>
<li><code>n()</code>; The number of rows in the data.frame or group of observations<br />
    that <code>summarise()</code> describes.</li>
<li><code>n_distinct(x)</code>; The number of unique values in vector <code>x</code>.</li>
</ul>
<!-- -->

<div class="highlight"><pre><span></span><code><span class="c1"># Generate summarizing statistics for hflights</span>
<span class="nf">summarise</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="n">n_obs</span> <span class="o">=</span> <span class="nf">n</span><span class="p">(),</span> <span class="n">n_carrier</span> <span class="o">=</span> <span class="nf">n_distinct</span><span class="p">(</span><span class="n">UniqueCarrier</span><span class="p">),</span> <span class="n">n_dest</span> <span class="o">=</span> <span class="nf">n_distinct</span><span class="p">(</span><span class="n">Dest</span><span class="p">),</span> <span class="n">dest100</span> <span class="o">=</span> <span class="nf">nth</span><span class="p">(</span><span class="n">Dest</span><span class="p">,</span> <span class="m">100</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## # A tibble: 1 × 4
##    n_obs n_carrier n_dest dest100
##    &lt;int&gt;     &lt;int&gt;  &lt;int&gt;   &lt;chr&gt;
## 1 227496        15    116     DFW
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Filter hflights to keep all American Airline flights: aa</span>
<span class="n">aa</span> <span class="o">&lt;-</span> <span class="nf">filter</span><span class="p">(</span><span class="n">hflights</span><span class="p">,</span> <span class="n">UniqueCarrier</span> <span class="o">==</span> <span class="s">&#39;American&#39;</span><span class="p">)</span>

<span class="c1"># Generate summarizing statistics for aa </span>
<span class="nf">summarise</span><span class="p">(</span><span class="n">aa</span><span class="p">,</span> <span class="n">n_flights</span> <span class="o">=</span> <span class="nf">n</span><span class="p">(),</span> <span class="n">n_canc</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">Cancelled</span><span class="p">),</span> <span class="n">p_canc</span> <span class="o">=</span> <span class="n">n_canc</span><span class="o">/</span><span class="n">n_flights</span><span class="o">*</span><span class="m">100</span><span class="p">,</span> <span class="n">avg_delay</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">ArrDelay</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## # A tibble: 1 × 4
##   n_flights n_canc   p_canc avg_delay
##       &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1      3244     60 1.849568 0.8917558
</code></pre></div>
</td></tr></table>
<p><strong>Overview of syntax</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Write the &#39;piped&#39; version of the English sentences</span>
<span class="n">hflights</span> <span class="o">%&gt;%</span>
    <span class="nf">mutate</span><span class="p">(</span><span class="n">diff</span> <span class="o">=</span> <span class="n">TaxiOut</span> <span class="o">-</span> <span class="n">TaxiIn</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">diff</span><span class="p">))</span> <span class="o">%&gt;%</span>
    <span class="nf">summarise</span><span class="p">(</span> <span class="n">avg</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">diff</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## # A tibble: 1 × 1
##        avg
##      &lt;dbl&gt;
## 1 8.992064
</code></pre></div>
</td></tr></table>
<p><strong>Drive or fly? Part 1 of 2</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Part 1, concerning the selection and creation of columns</span>
<span class="n">d</span> <span class="o">&lt;-</span> <span class="n">hflights</span> <span class="o">%&gt;%</span>
  <span class="nf">select</span><span class="p">(</span><span class="n">Dest</span><span class="p">,</span> <span class="n">UniqueCarrier</span><span class="p">,</span> <span class="n">Distance</span><span class="p">,</span> <span class="n">ActualElapsedTime</span><span class="p">)</span> <span class="o">%&gt;%</span>  
  <span class="nf">mutate</span><span class="p">(</span><span class="n">RealTime</span> <span class="o">=</span> <span class="n">ActualElapsedTime</span> <span class="o">+</span> <span class="m">100</span><span class="p">,</span> <span class="n">mph</span> <span class="o">=</span> <span class="n">Distance</span> <span class="o">/</span> <span class="n">RealTime</span> <span class="o">*</span> <span class="m">60</span><span class="p">)</span>

<span class="c1"># Part 2, concerning flights that had an actual average speed of &lt; 70 mph.</span>
<span class="n">d</span> <span class="o">%&gt;%</span>
  <span class="nf">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">mph</span><span class="p">),</span> <span class="n">mph</span> <span class="o">&lt;</span> <span class="m">70</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">summarise</span><span class="p">(</span> <span class="n">n_less</span> <span class="o">=</span> <span class="nf">n</span><span class="p">(),</span> 
             <span class="n">n_dest</span> <span class="o">=</span> <span class="nf">n_distinct</span><span class="p">(</span><span class="n">Dest</span><span class="p">),</span> 
             <span class="n">min_dist</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="n">Distance</span><span class="p">),</span> 
             <span class="n">max_dist</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">Distance</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## # A tibble: 1 × 4
##   n_less n_dest min_dist max_dist
##    &lt;int&gt;  &lt;int&gt;    &lt;int&gt;    &lt;int&gt;
## 1   6726     13       79      305
</code></pre></div>
</td></tr></table>
<p><strong>Drive or fly? Part 2 of 2</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Solve the exercise using a combination of dplyr verbs and %&gt;%</span>
<span class="n">hflights</span> <span class="o">%&gt;%</span>
    <span class="c1">#summarise(all_flights = n()) %&gt;%</span>
    <span class="nf">filter</span><span class="p">(((</span><span class="n">Distance</span> <span class="o">/</span> <span class="p">(</span><span class="n">ActualElapsedTime</span> <span class="o">+</span> <span class="m">100</span><span class="p">)</span> <span class="o">*</span> <span class="m">60</span><span class="p">)</span> <span class="o">&lt;</span> <span class="m">105</span><span class="p">)</span> <span class="o">|</span> <span class="n">Cancelled</span> <span class="o">==</span> <span class="m">1</span> <span class="o">|</span> <span class="n">Diverted</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">summarise</span><span class="p">(</span><span class="n">n_non</span> <span class="o">=</span> <span class="nf">n</span><span class="p">(),</span> <span class="n">p_non</span> <span class="o">=</span> <span class="n">n_non</span> <span class="o">/</span> <span class="m">22751</span> <span class="o">*</span><span class="m">100</span><span class="p">,</span> <span class="n">n_dest</span> <span class="o">=</span> <span class="nf">n_distinct</span><span class="p">(</span><span class="n">Dest</span><span class="p">),</span> <span class="n">min_dist</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="n">Distance</span><span class="p">),</span> <span class="n">max_dist</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">Distance</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## # A tibble: 1 × 5
##   n_non    p_non n_dest min_dist max_dist
##   &lt;int&gt;    &lt;dbl&gt;  &lt;int&gt;    &lt;int&gt;    &lt;int&gt;
## 1 42400 186.3654    113       79     3904
</code></pre></div>
</td></tr></table>
<p><strong>Advanced piping exercise</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Count the number of overnight flights</span>
<span class="n">hflights</span> <span class="o">%&gt;%</span>
    <span class="nf">filter</span><span class="p">(</span><span class="n">ArrTime</span> <span class="o">&lt;</span> <span class="n">DepTime</span> <span class="o">&amp;</span> <span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">DepTime</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">ArrTime</span><span class="p">))</span> <span class="o">%&gt;%</span>
    <span class="nf">summarise</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="nf">n</span><span class="p">())</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## # A tibble: 1 × 1
##       n
##   &lt;int&gt;
## 1  2718
</code></pre></div>
</td></tr></table>
<h3 id="5-group_by-and-working-with-data">5, <code>group_by</code> and working with data<a class="headerlink" href="#5-group_by-and-working-with-data" title="Permanent link">&para;</a></h3>
<p><strong>Unite and conquer using <code>group_by</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Make an ordered per-carrier summary of hflights</span>
<span class="n">hflights</span> <span class="o">%&gt;%</span>
   <span class="nf">group_by</span><span class="p">(</span><span class="n">UniqueCarrier</span><span class="p">)</span> <span class="o">%&gt;%</span>
   <span class="nf">summarise</span><span class="p">(</span><span class="n">n_flights</span> <span class="o">=</span> <span class="nf">n</span><span class="p">(),</span> 
             <span class="n">n_canc</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">Cancelled</span> <span class="o">==</span> <span class="m">1</span><span class="p">),</span> 
             <span class="n">p_canc</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">Cancelled</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span> <span class="o">*</span> <span class="m">100</span><span class="p">,</span> 
             <span class="n">avg_delay</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">ArrDelay</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">))</span> <span class="o">%&gt;%</span>
   <span class="nf">arrange</span><span class="p">(</span><span class="n">avg_delay</span><span class="p">,</span> <span class="n">p_canc</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## # A tibble: 15 × 5
##         UniqueCarrier n_flights n_canc    p_canc  avg_delay
##                 &lt;chr&gt;     &lt;int&gt;  &lt;int&gt;     &lt;dbl&gt;      &lt;dbl&gt;
## 1          US_Airways      4082     46 1.1268986 -0.6307692
## 2            American      3244     60 1.8495684  0.8917558
## 3             AirTran      2139     21 0.9817672  1.8536239
## 4              Alaska       365      0 0.0000000  3.1923077
## 5                Mesa        79      1 1.2658228  4.0128205
## 6               Delta      2641     42 1.5903067  6.0841374
## 7         Continental     70032    475 0.6782614  6.0986983
## 8      American_Eagle      4648    135 2.9044750  7.1529751
## 9  Atlantic_Southeast      2204     76 3.4482759  7.2569543
## 10          Southwest     45343    703 1.5504047  7.5871430
## 11           Frontier       838      6 0.7159905  7.6682692
## 12         ExpressJet     73053   1132 1.5495599  8.1865242
## 13            SkyWest     16061    224 1.3946828  8.6934922
## 14            JetBlue       695     18 2.5899281  9.8588410
## 15             United      2072     34 1.6409266 10.4628628
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Make an ordered per-day summary of hflights</span>
<span class="n">hflights</span> <span class="o">%&gt;%</span> 
   <span class="nf">group_by</span><span class="p">(</span><span class="n">DayOfWeek</span><span class="p">)</span> <span class="o">%&gt;%</span>
   <span class="nf">summarise</span><span class="p">(</span><span class="n">avg_taxi</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">TaxiIn</span> <span class="o">+</span> <span class="n">TaxiOut</span><span class="p">,</span> <span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span> <span class="o">%&gt;%</span>
   <span class="nf">arrange</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">avg_taxi</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## # A tibble: 7 × 2
##   DayOfWeek avg_taxi
##       &lt;int&gt;    &lt;dbl&gt;
## 1         1 21.77027
## 2         2 21.43505
## 3         4 21.26076
## 4         3 21.19055
## 5         5 21.15805
## 6         7 20.93726
## 7         6 20.43061
</code></pre></div>
</td></tr></table>
<p><strong>Combine <code>group_by</code> with <code>mutate</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Solution to first instruction</span>
<span class="n">hflights</span> <span class="o">%&gt;%</span>
    <span class="nf">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">ArrDelay</span><span class="p">))</span> <span class="o">%&gt;%</span>
    <span class="nf">group_by</span><span class="p">(</span><span class="n">UniqueCarrier</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">summarise</span><span class="p">(</span><span class="n">p_delay</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">ArrDelay</span> <span class="o">&gt;</span> <span class="m">0</span><span class="p">)</span> <span class="o">/</span> <span class="nf">n</span><span class="p">())</span> <span class="o">%&gt;%</span>
    <span class="nf">mutate</span><span class="p">(</span><span class="n">rank</span> <span class="o">=</span> <span class="nf">rank</span><span class="p">(</span><span class="n">p_delay</span><span class="p">))</span> <span class="o">%&gt;%</span>
    <span class="nf">arrange</span><span class="p">(</span><span class="n">rank</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## # A tibble: 15 × 3
##         UniqueCarrier   p_delay  rank
##                 &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;
## 1            American 0.3030208     1
## 2             AirTran 0.3112269     2
## 3          US_Airways 0.3267990     3
## 4  Atlantic_Southeast 0.3677511     4
## 5      American_Eagle 0.3696714     5
## 6               Delta 0.3871092     6
## 7             JetBlue 0.3952452     7
## 8              Alaska 0.4368132     8
## 9           Southwest 0.4644557     9
## 10               Mesa 0.4743590    10
## 11        Continental 0.4907385    11
## 12         ExpressJet 0.4943420    12
## 13             United 0.4963109    13
## 14            SkyWest 0.5350105    14
## 15           Frontier 0.5564904    15
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Solution to second instruction</span>
<span class="n">hflights</span> <span class="o">%&gt;%</span>
    <span class="nf">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">ArrDelay</span><span class="p">),</span> <span class="n">ArrDelay</span> <span class="o">&gt;</span> <span class="m">0</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">group_by</span><span class="p">(</span><span class="n">UniqueCarrier</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">summarise</span><span class="p">(</span><span class="n">avg</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">ArrDelay</span><span class="p">))</span> <span class="o">%&gt;%</span>
    <span class="nf">mutate</span><span class="p">(</span><span class="n">rank</span> <span class="o">=</span> <span class="nf">rank</span><span class="p">(</span><span class="n">avg</span><span class="p">))</span> <span class="o">%&gt;%</span>
    <span class="nf">arrange</span><span class="p">(</span><span class="n">rank</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## # A tibble: 15 × 3
##         UniqueCarrier      avg  rank
##                 &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;
## 1                Mesa 18.67568     1
## 2            Frontier 18.68683     2
## 3          US_Airways 20.70235     3
## 4         Continental 22.13374     4
## 5              Alaska 22.91195     5
## 6             SkyWest 24.14663     6
## 7          ExpressJet 24.19337     7
## 8           Southwest 25.27750     8
## 9             AirTran 27.85693     9
## 10           American 28.49740    10
## 11              Delta 32.12463    11
## 12             United 32.48067    12
## 13     American_Eagle 38.75135    13
## 14 Atlantic_Southeast 40.24231    14
## 15            JetBlue 45.47744    15
</code></pre></div>
</td></tr></table>
<p><strong>Advanced <code>group_by</code> exercises</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Which plane (by tail number) flew out of Houston the most times? How many times? adv1</span>
<span class="n">adv1</span> <span class="o">&lt;-</span> <span class="n">hflights</span> <span class="o">%&gt;%</span>
          <span class="nf">group_by</span><span class="p">(</span><span class="n">TailNum</span><span class="p">)</span> <span class="o">%&gt;%</span>
          <span class="nf">summarise</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="nf">n</span><span class="p">())</span> <span class="o">%&gt;%</span>
          <span class="nf">filter</span><span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="nf">max</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>

<span class="c1"># How many airplanes only flew to one destination from Houston? adv2</span>
<span class="n">adv2</span> <span class="o">&lt;-</span> <span class="n">hflights</span> <span class="o">%&gt;%</span>
          <span class="nf">group_by</span><span class="p">(</span><span class="n">TailNum</span><span class="p">)</span> <span class="o">%&gt;%</span>
          <span class="nf">summarise</span><span class="p">(</span><span class="n">ndest</span> <span class="o">=</span> <span class="nf">n_distinct</span><span class="p">(</span><span class="n">Dest</span><span class="p">))</span> <span class="o">%&gt;%</span>
          <span class="nf">filter</span><span class="p">(</span><span class="n">ndest</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span> <span class="o">%&gt;%</span>
          <span class="nf">summarise</span><span class="p">(</span><span class="n">nplanes</span> <span class="o">=</span> <span class="nf">n</span><span class="p">())</span>

<span class="c1"># Find the most visited destination for each carrier: adv3</span>
<span class="n">adv3</span> <span class="o">&lt;-</span> <span class="n">hflights</span> <span class="o">%&gt;%</span> 
          <span class="nf">group_by</span><span class="p">(</span><span class="n">UniqueCarrier</span><span class="p">,</span> <span class="n">Dest</span><span class="p">)</span> <span class="o">%&gt;%</span>
          <span class="nf">summarise</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="nf">n</span><span class="p">())</span> <span class="o">%&gt;%</span>
          <span class="nf">mutate</span><span class="p">(</span><span class="n">rank</span> <span class="o">=</span> <span class="nf">rank</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span> <span class="o">%&gt;%</span>
          <span class="nf">filter</span><span class="p">(</span><span class="n">rank</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span>

<span class="c1"># Find the carrier that travels to each destination the most: adv4</span>
<span class="n">adv4</span> <span class="o">&lt;-</span> <span class="n">hflights</span> <span class="o">%&gt;%</span> 
          <span class="nf">group_by</span><span class="p">(</span><span class="n">Dest</span><span class="p">,</span> <span class="n">UniqueCarrier</span><span class="p">)</span> <span class="o">%&gt;%</span>
          <span class="nf">summarise</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="nf">n</span><span class="p">())</span> <span class="o">%&gt;%</span>
          <span class="nf">mutate</span><span class="p">(</span><span class="n">rank</span> <span class="o">=</span> <span class="nf">rank</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span> <span class="o">%&gt;%</span>
          <span class="nf">filter</span><span class="p">(</span><span class="n">rank</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span>
</code></pre></div>
<p><strong><code>dplyr</code> deals with different types</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Use summarise to calculate n_carrier</span>
<span class="n">s2</span> <span class="o">&lt;-</span> <span class="n">hflights</span> <span class="o">%&gt;%</span>
    <span class="nf">summarise</span><span class="p">(</span><span class="n">n_carrier</span> <span class="o">=</span> <span class="nf">n_distinct</span><span class="p">(</span><span class="n">UniqueCarrier</span><span class="p">))</span>
</code></pre></div>
<p><strong><code>dplyr</code> and mySQL databases</strong></p>
<p>Code only.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># set up a src that connects to the mysql database (src_mysql is provided by dplyr)</span>
<span class="n">my_db</span> <span class="o">&lt;-</span> <span class="nf">src_mysql</span><span class="p">(</span><span class="n">dbname</span> <span class="o">=</span> <span class="s">&#39;dplyr&#39;</span><span class="p">,</span> 
                  <span class="n">host</span> <span class="o">=</span> <span class="s">&#39;dplyr.csrrinzqubik.us-east-1.rds.amazonaws.com&#39;</span><span class="p">,</span> 
                  <span class="n">port</span> <span class="o">=</span> <span class="m">3306</span><span class="p">,</span>
                  <span class="n">user</span> <span class="o">=</span> <span class="s">&#39;dplyr&#39;</span><span class="p">,</span>
                  <span class="n">password</span> <span class="o">=</span> <span class="s">&#39;dplyr&#39;</span><span class="p">)</span>

<span class="c1"># and reference a table within that src: nycflights is now available as an R object that references to the remote nycflights table</span>
<span class="n">nycflights</span> <span class="o">&lt;-</span> <span class="nf">tbl</span><span class="p">(</span><span class="n">my_db</span><span class="p">,</span> <span class="s">&#39;dplyr&#39;</span><span class="p">)</span>

<span class="c1"># glimpse at nycflights</span>
<span class="nf">glimpse</span><span class="p">(</span><span class="n">nycflights</span><span class="p">)</span>

<span class="c1"># Calculate the grouped summaries detailed in the instructions</span>
<span class="n">nycflights</span> <span class="o">%&gt;%</span>
   <span class="nf">group_by</span><span class="p">(</span><span class="n">carrier</span><span class="p">)</span> <span class="o">%&gt;%</span>
   <span class="nf">summarise</span><span class="p">(</span><span class="n">n_flights</span> <span class="o">=</span> <span class="nf">n</span><span class="p">(),</span> <span class="n">avg_delay</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">arr_delay</span><span class="p">))</span> <span class="o">%&gt;%</span>
   <span class="nf">arrange</span><span class="p">(</span><span class="n">avg_delay</span><span class="p">)</span>
</code></pre></div>
<h2 id="adding-tidyr-functions">Adding <code>tidyr</code> Functions<a class="headerlink" href="#adding-tidyr-functions" title="Permanent link">&para;</a></h2>
<ul>
<li><code>complete</code></li>
<li><code>drop_na</code></li>
<li><code>expand</code></li>
<li><code>extract</code></li>
<li><code>extract_numeric</code></li>
<li><code>complete</code></li>
<li><code>fill</code></li>
<li><code>full_seq</code></li>
<li><code>gather</code></li>
<li><code>nest</code></li>
<li><code>replace_na</code></li>
<li><code>separate</code></li>
<li><code>separate_rows</code></li>
<li><code>separate_rows_</code></li>
<li><code>smiths</code></li>
<li><code>spread</code></li>
<li><code>table1</code></li>
<li><code>unite</code></li>
<li><code>unnest</code></li>
<li><code>who</code></li>
</ul>
<hr />
<h2 id="extension-joining-data-in-r-with-dplyr">Extension: &lsquo;Joining Data in R with <code>dplyr</code>&lsquo;<a class="headerlink" href="#extension-joining-data-in-r-with-dplyr" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>## 1, Mutating Joins

## 2, Filtering Joins and Set Operations

## 3, Assembling Data

## 4, Advanced Joining

## 5, Case Study
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../data_manipulation_in_r_with_dplyr/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Data Manipulation in R with dplyr" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Data Manipulation in R with dplyr
            </div>
          </div>
        </a>
      
      
        
        <a href="../googlevis/" class="md-footer__link md-footer__link--next" aria-label="Next: googleVis (embed HTML plots)" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              googleVis (embed HTML plots)
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.f8263e09.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.4fc53ad4.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>