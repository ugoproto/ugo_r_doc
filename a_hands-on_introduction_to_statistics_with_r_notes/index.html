
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A R documentation website.">
      
      
      
      
      <link rel="icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.0">
    
    
      
        <title>Statistics with R, Notes - ugo_r_doc</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8b42a75e.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#2094f3">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700%7CUbuntu+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Ubuntu";--md-code-font-family:"Ubuntu Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue" data-md-color-accent="red">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#descriptive-statistics" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ugo_r_doc" class="md-header__button md-logo" aria-label="ugo_r_doc" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 16 7.36-5.73L21 9l-9-7-9 7 1.63 1.27M12 18.54l-7.38-5.73L3 14.07l9 7 9-7-1.63-1.27L12 18.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ugo_r_doc
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Statistics with R, Notes
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/ugoproto/ugo_r_doc.git/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ugo_r_doc
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ugo_r_doc" class="md-nav__button md-logo" aria-label="ugo_r_doc" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 16 7.36-5.73L21 9l-9-7-9 7 1.63 1.27M12 18.54l-7.38-5.73L3 14.07l9 7 9-7-1.63-1.27L12 18.54z"/></svg>

    </a>
    ugo_r_doc
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/ugoproto/ugo_r_doc.git/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ugo_r_doc
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Cheat Sheets
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cheat Sheets" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Cheat Sheets
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../basics_cs/" class="md-nav__link">
        Basics Cheat Sheets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../specializations_cs/" class="md-nav__link">
        Specialization Cheat Sheets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../visualization_cs/" class="md-nav__link">
        Visualization Cheat Sheets
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Code and Vade Mecum
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Code and Vade Mecum" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Code and Vade Mecum
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../frequentist_bayesian/" class="md-nav__link">
        Frequentist vs. Bayesian
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../intermediate_r/" class="md-nav__link">
        Intermediate R
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../intermediate_r_the_apply_family/" class="md-nav__link">
        Intermediate R - The apply Family
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Data Wrangling Snippets
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data Wrangling Snippets" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Data Wrangling Snippets
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../io_snippets_cleaning/" class="md-nav__link">
        I/O Snippets & Cleaning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reading_data_into_r_with_readr/" class="md-nav__link">
        Reading Data into R with readr
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data_analysis_in_r_the_data_table_way/" class="md-nav__link">
        Data Analysis in R, the data.table Way
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data_manipulation_in_r_with_dplyr/" class="md-nav__link">
        Data Manipulation in R with dplyr
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data_wrangling/" class="md-nav__link">
        Data Wrangling
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Packages
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Packages" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Packages
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../googlevis/" class="md-nav__link">
        googleVis (embed HTML plots)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gganimate/" class="md-nav__link">
        gganimate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../fast_and_frugal_decision_trees_in_r_with_fftrees/" class="md-nav__link">
        Fast-and-Frugal Decision Trees
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../big_data_analysis_with_revolution_r_enterprise/" class="md-nav__link">
        Big Data Analysis with Revolution R Enterprise
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../time_series_in_r_the_power_of_xts_and_zoo/" class="md-nav__link">
        Time Series in R, The Power of xts and zoo
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Plot Snippets
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Plot Snippets" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Plot Snippets
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plot_snippets_basics/" class="md-nav__link">
        Plot Snippets for Exploratory (and some Explanatory) Analyses
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plot_snippets_ggplot2/" class="md-nav__link">
        Plot Snippets - ggplot2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plot_snippets_ggvis/" class="md-nav__link">
        Plot Snippets - ggvis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plot_snippets_colours/" class="md-nav__link">
        Plot Snippets - Colours
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          RStudio
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="RStudio" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          RStudio
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../working_with_rstudio_ide/" class="md-nav__link">
        Working with the RStudio IDE
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Tables and Figures
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tables and Figures" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Tables and Figures
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tables/" class="md-nav__link">
        Tables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../embedding/" class="md-nav__link">
        Embedding HTML into HTML
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../embedding_2/" class="md-nav__link">
        Embedding Rmd into Rmd
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          A Hands-on Introduction to Statistics with R
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="A Hands-on Introduction to Statistics with R" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          A Hands-on Introduction to Statistics with R
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../a_hands-on_introduction_to_statistics_with_r_course_one_introduction/" class="md-nav__link">
        Statistics with R, Course One, Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../a_hands-on_introduction_to_statistics_with_r_course_two_student_s_t-test/" class="md-nav__link">
        Statistics with R, Course Two, Student's t-test
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../a_hands-on_introduction_to_statistics_with_r_course_three_analysis_of_variance/" class="md-nav__link">
        Statistics with R, Course Three, Analysis of Variance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../a_hands-on_introduction_to_statistics_with_r_course_four_repeated_measures_anova/" class="md-nav__link">
        Statistics with R, Course Four, Repeated Measures ANOVA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../a_hands-on_introduction_to_statistics_with_r_course_five_correlation_and_regression/" class="md-nav__link">
        Statistics with R, Course Five, Correlation and Regression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../a_hands-on_introduction_to_statistics_with_r_course_six_multiple_regression/" class="md-nav__link">
        Statistics with R, Course Six, Multiple Regression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../a_hands-on_introduction_to_statistics_with_r_course_seven_moderation_and_mediation/" class="md-nav__link">
        Statistics with R, Course Seven, Moderation and Mediation
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Statistics with R, Notes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Statistics with R, Notes
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#descriptive-statistics" class="md-nav__link">
    Descriptive Statistics
  </a>
  
    <nav class="md-nav" aria-label="Descriptive Statistics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#group-data" class="md-nav__link">
    Group data
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frequency-tables-crosstables-and-independence" class="md-nav__link">
    Frequency Tables, CrossTables, and Independence
  </a>
  
    <nav class="md-nav" aria-label="Frequency Tables, CrossTables, and Independence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2d-frequency-tables" class="md-nav__link">
    2D frequency tables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3d-frequency-tables" class="md-nav__link">
    3D frequency tables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crosstable" class="md-nav__link">
    CrossTable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tests-of-independence" class="md-nav__link">
    Tests of independence
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#measures-of-association" class="md-nav__link">
    Measures of association
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#correlations" class="md-nav__link">
    Correlations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#t-tests" class="md-nav__link">
    t-tests
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nonparametric-statistics" class="md-nav__link">
    Nonparametric statistics
  </a>
  
    <nav class="md-nav" aria-label="Nonparametric statistics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bivariate-tests" class="md-nav__link">
    Bivariate tests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anova" class="md-nav__link">
    ANOVA
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multiple-regressions" class="md-nav__link">
    Multiple Regressions
  </a>
  
    <nav class="md-nav" aria-label="Multiple Regressions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fitting-the-model" class="md-nav__link">
    Fitting the Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#diagnostic-plots" class="md-nav__link">
    Diagnostic plots
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comparing-two-models-with-anova" class="md-nav__link">
    Comparing two models with ANOVA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cross-validation" class="md-nav__link">
    Cross validation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variable-selection-heuristic-methods" class="md-nav__link">
    Variable selection -- Heuristic methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variable-selection-graphical-methods" class="md-nav__link">
    Variable selection -- Graphical methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variable-selection-relative-importance" class="md-nav__link">
    Variable selection -- Relative importance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#going-further" class="md-nav__link">
    Going further
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regression-diagnostics" class="md-nav__link">
    Regression diagnostics
  </a>
  
    <nav class="md-nav" aria-label="Regression diagnostics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outliers" class="md-nav__link">
    Outliers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#influential-observations" class="md-nav__link">
    Influential observations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nonnormality" class="md-nav__link">
    Nonnormality
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heteroscedasticity" class="md-nav__link">
    Heteroscedasticity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multicollinearity" class="md-nav__link">
    Multicollinearity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nonlinearity" class="md-nav__link">
    Nonlinearity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autocorrelation" class="md-nav__link">
    Autocorrelation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#global-diagnostic" class="md-nav__link">
    Global diagnostic
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#anova_1" class="md-nav__link">
    ANOVA
  </a>
  
    <nav class="md-nav" aria-label="ANOVA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evaluate-model-effects" class="md-nav__link">
    Evaluate model effects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compare-nested-models-directly" class="md-nav__link">
    Compare nested models directly
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-comparisons" class="md-nav__link">
    Multiple comparisons
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualizing-results" class="md-nav__link">
    Visualizing results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manova" class="md-nav__link">
    MANOVA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#going-further_1" class="md-nav__link">
    Going further
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manova-assumptions" class="md-nav__link">
    (M)ANOVA Assumptions
  </a>
  
    <nav class="md-nav" aria-label="(M)ANOVA Assumptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outliers_1" class="md-nav__link">
    Outliers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#univariate-normality" class="md-nav__link">
    Univariate normality
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multivariate-normality" class="md-nav__link">
    Multivariate normality
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heteroscedasticity_1" class="md-nav__link">
    Heteroscedasticity
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resampling-statistics" class="md-nav__link">
    Resampling Statistics
  </a>
  
    <nav class="md-nav" aria-label="Resampling Statistics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#independent-k-sample-location-tests" class="md-nav__link">
    Independent k-sample location tests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#symmetry-of-a-response-for-repeated-measurements" class="md-nav__link">
    Symmetry of a response for repeated measurements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#independence-of-two-numeric-variables" class="md-nav__link">
    Independence of two numeric variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#independence-in-contingency-tables" class="md-nav__link">
    Independence in contingency tables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#descriptive-statistics" class="md-nav__link">
    Descriptive Statistics
  </a>
  
    <nav class="md-nav" aria-label="Descriptive Statistics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#group-data" class="md-nav__link">
    Group data
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frequency-tables-crosstables-and-independence" class="md-nav__link">
    Frequency Tables, CrossTables, and Independence
  </a>
  
    <nav class="md-nav" aria-label="Frequency Tables, CrossTables, and Independence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2d-frequency-tables" class="md-nav__link">
    2D frequency tables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3d-frequency-tables" class="md-nav__link">
    3D frequency tables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crosstable" class="md-nav__link">
    CrossTable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tests-of-independence" class="md-nav__link">
    Tests of independence
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#measures-of-association" class="md-nav__link">
    Measures of association
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#correlations" class="md-nav__link">
    Correlations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#t-tests" class="md-nav__link">
    t-tests
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nonparametric-statistics" class="md-nav__link">
    Nonparametric statistics
  </a>
  
    <nav class="md-nav" aria-label="Nonparametric statistics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bivariate-tests" class="md-nav__link">
    Bivariate tests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anova" class="md-nav__link">
    ANOVA
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multiple-regressions" class="md-nav__link">
    Multiple Regressions
  </a>
  
    <nav class="md-nav" aria-label="Multiple Regressions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fitting-the-model" class="md-nav__link">
    Fitting the Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#diagnostic-plots" class="md-nav__link">
    Diagnostic plots
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comparing-two-models-with-anova" class="md-nav__link">
    Comparing two models with ANOVA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cross-validation" class="md-nav__link">
    Cross validation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variable-selection-heuristic-methods" class="md-nav__link">
    Variable selection -- Heuristic methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variable-selection-graphical-methods" class="md-nav__link">
    Variable selection -- Graphical methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variable-selection-relative-importance" class="md-nav__link">
    Variable selection -- Relative importance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#going-further" class="md-nav__link">
    Going further
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regression-diagnostics" class="md-nav__link">
    Regression diagnostics
  </a>
  
    <nav class="md-nav" aria-label="Regression diagnostics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outliers" class="md-nav__link">
    Outliers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#influential-observations" class="md-nav__link">
    Influential observations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nonnormality" class="md-nav__link">
    Nonnormality
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heteroscedasticity" class="md-nav__link">
    Heteroscedasticity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multicollinearity" class="md-nav__link">
    Multicollinearity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nonlinearity" class="md-nav__link">
    Nonlinearity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autocorrelation" class="md-nav__link">
    Autocorrelation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#global-diagnostic" class="md-nav__link">
    Global diagnostic
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#anova_1" class="md-nav__link">
    ANOVA
  </a>
  
    <nav class="md-nav" aria-label="ANOVA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evaluate-model-effects" class="md-nav__link">
    Evaluate model effects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compare-nested-models-directly" class="md-nav__link">
    Compare nested models directly
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-comparisons" class="md-nav__link">
    Multiple comparisons
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualizing-results" class="md-nav__link">
    Visualizing results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manova" class="md-nav__link">
    MANOVA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#going-further_1" class="md-nav__link">
    Going further
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manova-assumptions" class="md-nav__link">
    (M)ANOVA Assumptions
  </a>
  
    <nav class="md-nav" aria-label="(M)ANOVA Assumptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outliers_1" class="md-nav__link">
    Outliers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#univariate-normality" class="md-nav__link">
    Univariate normality
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multivariate-normality" class="md-nav__link">
    Multivariate normality
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heteroscedasticity_1" class="md-nav__link">
    Heteroscedasticity
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resampling-statistics" class="md-nav__link">
    Resampling Statistics
  </a>
  
    <nav class="md-nav" aria-label="Resampling Statistics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#independent-k-sample-location-tests" class="md-nav__link">
    Independent k-sample location tests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#symmetry-of-a-response-for-repeated-measurements" class="md-nav__link">
    Symmetry of a response for repeated measurements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#independence-of-two-numeric-variables" class="md-nav__link">
    Independence of two numeric variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#independence-in-contingency-tables" class="md-nav__link">
    Independence in contingency tables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ugoproto/ugo_r_doc.git/edit/master/docs/a_hands-on_introduction_to_statistics_with_r_notes.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>Statistics with R, Notes</h1>
                
                <!--
-   [1, Descriptive Statistics](#descriptive-statistics)
    -   [Group data](#group-data)
-   [2, Frequency Tables, CrossTables, and
    Independence](#frequency-tables-crosstables-and-independence)
    -   [2D frequency tables](#d-frequency-tables)
    -   [3D frequency tables](#d-frequency-tables-1)
    -   [CrossTable](#crosstable)
    -   [Tests of independence](#tests-of-independence)
    -   [Measures of association](#measures-of-association)
-   [3, Correlations](#correlations)
-   [4, t-tests](#t-tests)
-   [5, Nonparametric statistics](#nonparametric-statistics)
    -   [Bivariate tests](#bivariate-tests)
    -   [ANOVA](#anova)
-   [6, Multiple Regressions](#multiple-regressions)
    -   [Fitting the Model](#fitting-the-model)
    -   [Diagnostic plots](#diagnostic-plots)
    -   [Comparing two models with ANOVA](#comparing-two-models-with-anova)
    -   [Cross validation](#cross-validation)
    -   [Variable selection -- Heuristic methods](#variable-selection----heuristic-methods)
    -   [Variable selection -- Graphical methods](#variable-selection----graphical-methods)
    -   [Variable selection -- Relative importance](#variable-selection----relative-importance)
    -   [Going further](#going-further)
-   [7, Regression diagnostics](#regression-diagnostics)
    -   [Outliers](#outliers)
    -   [Influential observations](#influential-observations)
    -   [Nonnormality](#nonnormality)
    -   [Heteroscedasticity](#heteroscedasticity)
    -   [Multicollinearity](#multicollinearity)
    -   [Nonlinearity](#nonlinearity)
    -   [Autocorrelation](#autocorrelation)
    -   [Global diagnostic](#global-diagnostic)
-   [8, ANOVA](#anova-1)
    -   [Evaluate model effects](#evaluate-model-effects)
    -   [Compare nested models directly](#compare-nested-models-directly)
    -   [Multiple comparisons](#multiple-comparisons)
    -   [Visualizing results](#visualizing-results)
    -   [MANOVA](#manova)
    -   [Going further](#going-further-1)
-   [9, (M)ANOVA Assumptions](#manova-assumptions)
    -   [Outliers](#outliers-1)
    -   [Univariate normality](#univariate-normality)
    -   [Multivariate normality](#multivariate-normality)
    -   [Heteroscedasticity](#heteroscedasticity-1)
-   [10, Resampling Statistics](#resampling-statistics)
    -   [Independent k-sample location tests](#independent-k-sample-location-tests)
    -   [Symmetry of a response for repeated measurements](#symmetry-of-a-response-for-repeated-measurements)
    -   [Independence of two numeric variables](#independence-of-two-numeric-variables)
    -   [Independence in contingency tables](#independence-in-contingency-tables)
-->
<hr />
<p><strong>Foreword</strong></p>
<ul>
<li>Output options: the &lsquo;tango&rsquo; syntax and the &lsquo;readable&rsquo; theme.</li>
<li>Codes and snippets.</li>
</ul>
<hr />
<h2 id="descriptive-statistics">Descriptive Statistics<a class="headerlink" href="#descriptive-statistics" title="Permanent link">&para;</a></h2>
<p>Extract basic, exploratory statistics from datasets with <code>apply</code>, <code>summary</code>, <code>fivenum</code>, <code>describe</code>, and <code>stat.desc</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">longley</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##      GNP.deflator     GNP Unemployed Armed.Forces Population Year Employed
## 1947         83.0 234.289      235.6        159.0    107.608 1947   60.323
## 1948         88.5 259.426      232.5        145.6    108.632 1948   61.122
## 1949         88.2 258.054      368.2        161.6    109.773 1949   60.171
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># apply a function</span>
<span class="c1"># excluding missing values</span>
<span class="nf">sapply</span><span class="p">(</span><span class="n">longley</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> 
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## GNP.deflator          GNP   Unemployed Armed.Forces   Population 
##     101.6813     387.6984     319.3313     260.6687     117.4240 
##         Year     Employed 
##    1954.5000      65.3170
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># mean, median, 25th and 75th quartiles, min, max</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">longley</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##   GNP.deflator         GNP          Unemployed     Armed.Forces  
##  Min.   : 83.00   Min.   :234.3   Min.   :187.0   Min.   :145.6  
##  1st Qu.: 94.53   1st Qu.:317.9   1st Qu.:234.8   1st Qu.:229.8  
##  Median :100.60   Median :381.4   Median :314.4   Median :271.8  
##  Mean   :101.68   Mean   :387.7   Mean   :319.3   Mean   :260.7  
##  3rd Qu.:111.25   3rd Qu.:454.1   3rd Qu.:384.2   3rd Qu.:306.1  
##  Max.   :116.90   Max.   :554.9   Max.   :480.6   Max.   :359.4  
##    Population         Year         Employed    
##  Min.   :107.6   Min.   :1947   Min.   :60.17  
##  1st Qu.:111.8   1st Qu.:1951   1st Qu.:62.71  
##  Median :116.8   Median :1954   Median :65.50  
##  Mean   :117.4   Mean   :1954   Mean   :65.32  
##  3rd Qu.:122.3   3rd Qu.:1958   3rd Qu.:68.29  
##  Max.   :130.1   Max.   :1962   Max.   :70.55
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Tukey min, lower-hinge, median, upper-hinge, max</span>
<span class="nf">fivenum</span><span class="p">(</span><span class="n">longley</span><span class="o">$</span><span class="n">GNP</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## [1] 234.289 306.787 381.427 463.625 554.894
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># n, nmiss, unique, mean, 5, 10, 25, 50, 75, 90, 95th percentiles</span>
<span class="c1"># 5 lowest and 5 highest scores</span>
<span class="nf">library</span><span class="p">(</span><span class="n">Hmisc</span><span class="p">)</span>

<span class="nf">describe</span><span class="p">(</span><span class="n">longley</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## longley 
## 
##  7  Variables      16  Observations
## ---------------------------------------------------------------------------
## GNP.deflator 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##       16        0       16        1    101.7    12.74    86.90    88.35 
##      .25      .50      .75      .90      .95 
##    94.53   100.60   111.25   114.95   116.00 
##                                                                       
## Value       83.0  88.2  88.5  89.5  96.2  98.1  99.0 100.0 101.2 104.6
## Frequency      1     1     1     1     1     1     1     1     1     1
## Proportion 0.062 0.062 0.062 0.062 0.062 0.062 0.062 0.062 0.062 0.062
##                                               
## Value      108.4 110.8 112.6 114.2 115.7 116.9
## Frequency      1     1     1     1     1     1
## Proportion 0.062 0.062 0.062 0.062 0.062 0.062
## ---------------------------------------------------------------------------
## GNP 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##       16        0       16        1    387.7    117.8    252.1    258.7 
##      .25      .50      .75      .90      .95 
##    317.9    381.4    454.1    510.4    527.4 
##                                                                           
## Value      234.289 258.054 259.426 284.599 328.975 346.999 363.112 365.385
## Frequency        1       1       1       1       1       1       1       1
## Proportion   0.062   0.062   0.062   0.062   0.062   0.062   0.062   0.062
##                                                                           
## Value      397.469 419.180 442.769 444.546 482.704 502.601 518.173 554.894
## Frequency        1       1       1       1       1       1       1       1
## Proportion   0.062   0.062   0.062   0.062   0.062   0.062   0.062   0.062
## ---------------------------------------------------------------------------
## Unemployed 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##       16        0       16        1    319.3    110.1    191.6    201.6 
##      .25      .50      .75      .90      .95 
##    234.8    314.4    384.2    434.4    471.2 
##                                                                       
## Value      187.0 193.2 209.9 232.5 235.6 282.2 290.4 293.6 335.1 357.8
## Frequency      1     1     1     1     1     1     1     1     1     1
## Proportion 0.062 0.062 0.062 0.062 0.062 0.062 0.062 0.062 0.062 0.062
##                                               
## Value      368.2 381.3 393.1 400.7 468.1 480.6
## Frequency      1     1     1     1     1     1
## Proportion 0.062 0.062 0.062 0.062 0.062 0.062
## ---------------------------------------------------------------------------
## Armed.Forces 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##       16        0       16        1    260.7    79.85    155.7    160.3 
##      .25      .50      .75      .90      .95 
##    229.8    271.8    306.1    344.9    355.9 
##                                                                       
## Value      145.6 159.0 161.6 165.0 251.4 255.2 257.2 263.7 279.8 282.7
## Frequency      1     1     1     1     1     1     1     1     1     1
## Proportion 0.062 0.062 0.062 0.062 0.062 0.062 0.062 0.062 0.062 0.062
##                                               
## Value      285.7 304.8 309.9 335.0 354.7 359.4
## Frequency      1     1     1     1     1     1
## Proportion 0.062 0.062 0.062 0.062 0.062 0.062
## ---------------------------------------------------------------------------
## Population 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##       16        0       16        1    117.4    8.229    108.4    109.2 
##      .25      .50      .75      .90      .95 
##    111.8    116.8    122.3    126.6    128.4 
##                                                                           
## Value      107.608 108.632 109.773 110.929 112.075 113.270 115.094 116.219
## Frequency        1       1       1       1       1       1       1       1
## Proportion   0.062   0.062   0.062   0.062   0.062   0.062   0.062   0.062
##                                                                           
## Value      117.388 118.734 120.445 121.950 123.366 125.368 127.852 130.081
## Frequency        1       1       1       1       1       1       1       1
## Proportion   0.062   0.062   0.062   0.062   0.062   0.062   0.062   0.062
## ---------------------------------------------------------------------------
## Year 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##       16        0       16        1     1954    5.667     1948     1948 
##      .25      .50      .75      .90      .95 
##     1951     1954     1958     1960     1961 
##                                                                       
## Value       1947  1948  1949  1950  1951  1952  1953  1954  1955  1956
## Frequency      1     1     1     1     1     1     1     1     1     1
## Proportion 0.062 0.062 0.062 0.062 0.062 0.062 0.062 0.062 0.062 0.062
##                                               
## Value       1957  1958  1959  1960  1961  1962
## Frequency      1     1     1     1     1     1
## Proportion 0.062 0.062 0.062 0.062 0.062 0.062
## ---------------------------------------------------------------------------
## Employed 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##       16        0       16        1    65.32    4.153    60.28    60.72 
##      .25      .50      .75      .90      .95 
##    62.71    65.50    68.29    69.45    69.81 
##                                                                          
## Value      60.171 60.323 61.122 61.187 63.221 63.639 63.761 64.989 66.019
## Frequency       1      1      1      1      1      1      1      1      1
## Proportion  0.062  0.062  0.062  0.062  0.062  0.062  0.062  0.062  0.062
##                                                            
## Value      66.513 67.857 68.169 68.655 69.331 69.564 70.551
## Frequency       1      1      1      1      1      1      1
## Proportion  0.062  0.062  0.062  0.062  0.062  0.062  0.062
## ---------------------------------------------------------------------------
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># nbr.val, nbr.null, nbr.na, min max, range, sum,</span>
<span class="c1"># median, mean, SE.mean, CI.mean, var, std.dev, coef.var</span>
<span class="nf">library</span><span class="p">(</span><span class="n">pastecs</span><span class="p">)</span>

<span class="nf">stat.desc</span><span class="p">(</span><span class="n">longley</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">##              GNP.deflator          GNP   Unemployed Armed.Forces</span>
<span class="c1">## nbr.val        16.0000000   16.0000000   16.0000000   16.0000000</span>
<span class="c1">## nbr.null        0.0000000    0.0000000    0.0000000    0.0000000</span>
<span class="c1">## nbr.na          0.0000000    0.0000000    0.0000000    0.0000000</span>
<span class="c1">## min            83.0000000  234.2890000  187.0000000  145.6000000</span>
<span class="c1">## max           116.9000000  554.8940000  480.6000000  359.4000000</span>
<span class="c1">## range          33.9000000  320.6050000  293.6000000  213.8000000</span>
<span class="c1">## sum          1626.9000000 6203.1750000 5109.3000000 4170.7000000</span>
<span class="c1">## median        100.6000000  381.4270000  314.3500000  271.7500000</span>
<span class="c1">## mean          101.6812500  387.6984375  319.3312500  260.6687500</span>
<span class="c1">## SE.mean         2.6978884   24.8487344   23.3616062   17.3979901</span>
<span class="c1">## CI.mean.0.95    5.7504129   52.9638237   49.7940849   37.0829381</span>
<span class="c1">## var           116.4576250 9879.3536593 8732.2342917 4843.0409583</span>
<span class="c1">## std.dev        10.7915534   99.3949378   93.4464247   69.5919604</span>
<span class="c1">## coef.var        0.1061312    0.2563718    0.2926316    0.2669747</span>
<span class="c1">##                Population         Year     Employed</span>
<span class="c1">## nbr.val      1.600000e+01 1.600000e+01 1.600000e+01</span>
<span class="c1">## nbr.null     0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="c1">## nbr.na       0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="c1">## min          1.076080e+02 1.947000e+03 6.017100e+01</span>
<span class="c1">## max          1.300810e+02 1.962000e+03 7.055100e+01</span>
<span class="c1">## range        2.247300e+01 1.500000e+01 1.038000e+01</span>
<span class="c1">## sum          1.878784e+03 3.127200e+04 1.045072e+03</span>
<span class="c1">## median       1.168035e+02 1.954500e+03 6.550400e+01</span>
<span class="c1">## mean         1.174240e+02 1.954500e+03 6.531700e+01</span>
<span class="c1">## SE.mean      1.739025e+00 1.190238e+00 8.779921e-01</span>
<span class="c1">## CI.mean.0.95 3.706645e+00 2.536932e+00 1.871396e+00</span>
<span class="c1">## var          4.838735e+01 2.266667e+01 1.233392e+01</span>
<span class="c1">## std.dev      6.956102e+00 4.760952e+00 3.511968e+00</span>
<span class="c1">## coef.var     5.923918e-02 2.435893e-03 5.376806e-02</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># item name, item number, nvalid, mean, sd,</span>
<span class="c1"># median, mad, min, max, skew, kurtosis, se</span>
<span class="nf">library</span><span class="p">(</span><span class="n">psych</span><span class="p">)</span>

<span class="nf">describe</span><span class="p">(</span><span class="n">longley</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">##              vars  n    mean    sd  median trimmed    mad     min     max</span>
<span class="c1">## GNP.deflator    1 16  101.68 10.79  100.60  101.93  15.79   83.00  116.90</span>
<span class="c1">## GNP             2 16  387.70 99.39  381.43  386.71 118.57  234.29  554.89</span>
<span class="c1">## Unemployed      3 16  319.33 93.45  314.35  317.26 116.75  187.00  480.60</span>
<span class="c1">## Armed.Forces    4 16  260.67 69.59  271.75  261.84  52.78  145.60  359.40</span>
<span class="c1">## Population      5 16  117.42  6.96  116.80  117.22   8.17  107.61  130.08</span>
<span class="c1">## Year            6 16 1954.50  4.76 1954.50 1954.50   5.93 1947.00 1962.00</span>
<span class="c1">## Employed        7 16   65.32  3.51   65.50   65.31   4.31   60.17   70.55</span>
<span class="c1">##               range  skew kurtosis    se</span>
<span class="c1">## GNP.deflator  33.90 -0.13    -1.40  2.70</span>
<span class="c1">## GNP          320.61  0.02    -1.35 24.85</span>
<span class="c1">## Unemployed   293.60  0.14    -1.30 23.36</span>
<span class="c1">## Armed.Forces 213.80 -0.37    -1.20 17.40</span>
<span class="c1">## Population    22.47  0.26    -1.27  1.74</span>
<span class="c1">## Year          15.00  0.00    -1.43  1.19</span>
<span class="c1">## Employed      10.38 -0.09    -1.55  0.88</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># with</span>
<span class="nf">with</span><span class="p">(</span><span class="n">longley</span><span class="p">,</span> <span class="nf">median</span><span class="p">(</span><span class="n">GNP</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## [1] 381.427
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># vs.</span>
<span class="nf">median</span><span class="p">(</span><span class="n">longley</span><span class="o">$</span><span class="n">GNP</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## [1] 381.427
</code></pre></div>
</td></tr></table>
<h4 id="group-data">Group data<a class="headerlink" href="#group-data" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##                mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4     21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710    22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># variable grouped by one factor to show a function</span>
<span class="nf">by</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">,</span> <span class="n">mtcars</span><span class="o">$</span><span class="n">cyl</span><span class="p">,</span> <span class="n">FUN</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="nf">c</span><span class="p">(</span><span class="n">m</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">s</span> <span class="o">=</span> <span class="nf">sd</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="p">})</span> 
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c">## mtcars$cyl: 4</span>
<span class="c">##         m         s </span>
<span class="c">## 26</span><span class="nt">.</span><span class="c">663636  4</span><span class="nt">.</span><span class="c">509828 </span>
<span class="c">## </span><span class="nb">--------------------------------------------------------</span><span class="c"> </span>
<span class="c">## mtcars$cyl: 6</span>
<span class="c">##         m         s </span>
<span class="c">## 19</span><span class="nt">.</span><span class="c">742857  1</span><span class="nt">.</span><span class="c">453567 </span>
<span class="c">## </span><span class="nb">--------------------------------------------------------</span><span class="c"> </span>
<span class="c">## mtcars$cyl: 8</span>
<span class="c">##         m         s </span>
<span class="c">## 15</span><span class="nt">.</span><span class="c">100000  2</span><span class="nt">.</span><span class="c">560048</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># description statistics by group</span>
<span class="nf">library</span><span class="p">(</span><span class="n">psych</span><span class="p">)</span>

<span class="nf">describeBy</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">group</span> <span class="o">=</span> <span class="n">mtcars</span><span class="o">$</span><span class="n">am</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## </span>
<span class="c1">##  Descriptive statistics by group </span>
<span class="c1">## group: 0</span>
<span class="c1">##      vars  n   mean     sd median trimmed    mad    min    max  range</span>
<span class="c1">## mpg     1 19  17.15   3.83  17.30   17.12   3.11  10.40  24.40  14.00</span>
<span class="c1">## cyl     2 19   6.95   1.54   8.00    7.06   0.00   4.00   8.00   4.00</span>
<span class="c1">## disp    3 19 290.38 110.17 275.80  289.71 124.83 120.10 472.00 351.90</span>
<span class="c1">## hp      4 19 160.26  53.91 175.00  161.06  77.10  62.00 245.00 183.00</span>
<span class="c1">## drat    5 19   3.29   0.39   3.15    3.28   0.22   2.76   3.92   1.16</span>
<span class="c1">## wt      6 19   3.77   0.78   3.52    3.75   0.45   2.46   5.42   2.96</span>
<span class="c1">## qsec    7 19  18.18   1.75  17.82   18.07   1.19  15.41  22.90   7.49</span>
<span class="c1">## vs      8 19   0.37   0.50   0.00    0.35   0.00   0.00   1.00   1.00</span>
<span class="c1">## am      9 19   0.00   0.00   0.00    0.00   0.00   0.00   0.00   0.00</span>
<span class="c1">## gear   10 19   3.21   0.42   3.00    3.18   0.00   3.00   4.00   1.00</span>
<span class="c1">## carb   11 19   2.74   1.15   3.00    2.76   1.48   1.00   4.00   3.00</span>
<span class="c1">##       skew kurtosis    se</span>
<span class="c1">## mpg   0.01    -0.80  0.88</span>
<span class="c1">## cyl  -0.95    -0.74  0.35</span>
<span class="c1">## disp  0.05    -1.26 25.28</span>
<span class="c1">## hp   -0.01    -1.21 12.37</span>
<span class="c1">## drat  0.50    -1.30  0.09</span>
<span class="c1">## wt    0.98     0.14  0.18</span>
<span class="c1">## qsec  0.85     0.55  0.40</span>
<span class="c1">## vs    0.50    -1.84  0.11</span>
<span class="c1">## am     NaN      NaN  0.00</span>
<span class="c1">## gear  1.31    -0.29  0.10</span>
<span class="c1">## carb -0.14    -1.57  0.26</span>
<span class="c1">## -------------------------------------------------------- </span>
<span class="c1">## group: 1</span>
<span class="c1">##      vars  n   mean    sd median trimmed   mad   min    max  range  skew</span>
<span class="c1">## mpg     1 13  24.39  6.17  22.80   24.38  6.67 15.00  33.90  18.90  0.05</span>
<span class="c1">## cyl     2 13   5.08  1.55   4.00    4.91  0.00  4.00   8.00   4.00  0.87</span>
<span class="c1">## disp    3 13 143.53 87.20 120.30  131.25 58.86 71.10 351.00 279.90  1.33</span>
<span class="c1">## hp      4 13 126.85 84.06 109.00  114.73 63.75 52.00 335.00 283.00  1.36</span>
<span class="c1">## drat    5 13   4.05  0.36   4.08    4.02  0.27  3.54   4.93   1.39  0.79</span>
<span class="c1">## wt      6 13   2.41  0.62   2.32    2.39  0.68  1.51   3.57   2.06  0.21</span>
<span class="c1">## qsec    7 13  17.36  1.79  17.02   17.39  2.34 14.50  19.90   5.40 -0.23</span>
<span class="c1">## vs      8 13   0.54  0.52   1.00    0.55  0.00  0.00   1.00   1.00 -0.14</span>
<span class="c1">## am      9 13   1.00  0.00   1.00    1.00  0.00  1.00   1.00   0.00   NaN</span>
<span class="c1">## gear   10 13   4.38  0.51   4.00    4.36  0.00  4.00   5.00   1.00  0.42</span>
<span class="c1">## carb   11 13   2.92  2.18   2.00    2.64  1.48  1.00   8.00   7.00  0.98</span>
<span class="c1">##      kurtosis    se</span>
<span class="c1">## mpg     -1.46  1.71</span>
<span class="c1">## cyl     -0.90  0.43</span>
<span class="c1">## disp     0.40 24.19</span>
<span class="c1">## hp       0.56 23.31</span>
<span class="c1">## drat     0.21  0.10</span>
<span class="c1">## wt      -1.17  0.17</span>
<span class="c1">## qsec    -1.42  0.50</span>
<span class="c1">## vs      -2.13  0.14</span>
<span class="c1">## am        NaN  0.00</span>
<span class="c1">## gear    -1.96  0.14</span>
<span class="c1">## carb    -0.21  0.60</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># description statistics by group </span>
<span class="nf">library</span><span class="p">(</span><span class="n">doBy</span><span class="p">)</span>

<span class="nf">summaryBy</span><span class="p">(</span><span class="n">mpg</span> <span class="o">+</span> <span class="n">wt</span> <span class="o">~</span> <span class="n">cyl</span> <span class="o">+</span> <span class="n">vs</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">,</span> 
  <span class="n">FUN</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="nf">c</span><span class="p">(</span><span class="n">m</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">s</span> <span class="o">=</span> <span class="nf">sd</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="p">}</span> <span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##   cyl vs    mpg.m     mpg.s     wt.m      wt.s
## 1   4  0 26.00000        NA 2.140000        NA
## 2   4  1 26.73000 4.7481107 2.300300 0.5982073
## 3   6  0 20.56667 0.7505553 2.755000 0.1281601
## 4   6  1 19.12500 1.6317169 3.388750 0.1162164
## 5   8  0 15.10000 2.5600481 3.999214 0.7594047
</code></pre></div>
</td></tr></table>
<h2 id="frequency-tables-crosstables-and-independence">Frequency Tables, CrossTables, and Independence<a class="headerlink" href="#frequency-tables-crosstables-and-independence" title="Permanent link">&para;</a></h2>
<p>Create frequency and contingency tables from categorical variables. Perform tests of independence, measures of association, and graphically display results.</p>
<h3 id="2d-frequency-tables">2D frequency tables<a class="headerlink" href="#2d-frequency-tables" title="Permanent link">&para;</a></h3>
<p><code>mytable &lt;- table(A, B)</code> where A are rows, B are columns.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># dataset</span>
<span class="n">mytable</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">),</span> <span class="n">nrow</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
<span class="n">mytable</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##      [,1] [,2]
## [1,]    1    3
## [2,]    2    4
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># A frequencies (summed over columns = 1)</span>
<span class="nf">margin.table</span><span class="p">(</span><span class="n">mytable</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## [1] 4 6
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># B frequencies (summed over rows = 2)</span>
<span class="nf">margin.table</span><span class="p">(</span><span class="n">mytable</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## [1] 3 7
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># A/(A + B)</span>
<span class="c1"># cell percentages</span>
<span class="nf">prop.table</span><span class="p">(</span><span class="n">mytable</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##      [,1] [,2]
## [1,]  0.1  0.3
## [2,]  0.2  0.4
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># row percentages</span>
<span class="nf">prop.table</span><span class="p">(</span><span class="n">mytable</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##           [,1]      [,2]
## [1,] 0.2500000 0.7500000
## [2,] 0.3333333 0.6666667
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># column percentages </span>
<span class="nf">prop.table</span><span class="p">(</span><span class="n">mytable</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##           [,1]      [,2]
## [1,] 0.3333333 0.4285714
## [2,] 0.6666667 0.5714286
</code></pre></div>
</td></tr></table>
<h3 id="3d-frequency-tables">3D frequency tables<a class="headerlink" href="#3d-frequency-tables" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">CO2</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Grouped Data: uptake ~ conc | Plant
##   Plant   Type  Treatment conc uptake
## 1   Qn1 Quebec nonchilled   95   16.0
## 2   Qn1 Quebec nonchilled  175   30.4
## 3   Qn1 Quebec nonchilled  250   34.8
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="n">A</span> <span class="o">&lt;-</span> <span class="nf">as.numeric</span><span class="p">(</span><span class="n">CO2</span><span class="p">[,</span> <span class="s">&#39;Plant&#39;</span><span class="p">])</span>
<span class="n">B</span> <span class="o">&lt;-</span> <span class="n">CO2</span><span class="p">[,</span> <span class="s">&#39;conc&#39;</span><span class="p">]</span>
<span class="n">C</span> <span class="o">&lt;-</span> <span class="n">CO2</span><span class="p">[,</span> <span class="s">&#39;uptake&#39;</span><span class="p">]</span>
<span class="n">mytable</span> <span class="o">&lt;-</span> <span class="nf">table</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># several arrays (3D)</span>
<span class="nf">dim</span><span class="p">(</span><span class="n">mytable</span><span class="p">)</span> <span class="c1"># the printout is immense</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## [1] 12  7 76
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># folded table (2D)</span>
<span class="nf">dim</span><span class="p">(</span><span class="nf">ftable</span><span class="p">(</span><span class="n">mytable</span><span class="p">))</span> <span class="c1"># the printout is immense</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## [1] 84 76
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># 3-Way frequency Table</span>
<span class="n">mytable</span> <span class="o">&lt;-</span> <span class="nf">xtabs</span><span class="p">(</span><span class="o">~</span><span class="n">A</span> <span class="o">+</span> <span class="n">B</span> <span class="o">+</span> <span class="n">C</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mytable</span><span class="p">,</span> <span class="n">na.action</span> <span class="o">=</span> <span class="n">na.omit</span><span class="p">)</span>

<span class="nf">dim</span><span class="p">(</span><span class="nf">ftable</span><span class="p">(</span><span class="n">mytable</span><span class="p">))</span> <span class="c1"># the printout is immense</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## [1] 84 76
</code></pre></div>
</td></tr></table>
<h3 id="crosstable">CrossTable<a class="headerlink" href="#crosstable" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">A</span> <span class="o">&lt;-</span> <span class="nf">as.numeric</span><span class="p">(</span><span class="n">CO2</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">8</span><span class="p">,</span> <span class="s">&#39;Plant&#39;</span><span class="p">])</span>
<span class="n">A</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## [1] 1 1 1 1 1 1 1 2
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="n">B</span> <span class="o">&lt;-</span> <span class="n">CO2</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">8</span><span class="p">,</span> <span class="s">&#39;conc&#39;</span><span class="p">]</span>
<span class="n">B</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## [1]   95  175  250  350  500  675 1000   95
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># 2-way cross tabulation</span>
<span class="nf">library</span><span class="p">(</span><span class="n">gmodels</span><span class="p">)</span>

<span class="nf">CrossTable</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span> <span class="c1"># mydata$myrowvar x mydata$mycolvar</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  
##    Cell Contents
## |-------------------------|
## |                       N |
## | Chi-square contribution |
## |           N / Row Total |
## |           N / Col Total |
## |         N / Table Total |
## |-------------------------|
## 
##  
## Total Observations in Table:  8 
## 
##  
##              | B 
##            A |        95 |       175 |       250 |       350 |       500 |       675 |      1000 | Row Total | 
## -------------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|
##            1 |         1 |         1 |         1 |         1 |         1 |         1 |         1 |         7 | 
##              |     0.321 |     0.018 |     0.018 |     0.018 |     0.018 |     0.018 |     0.018 |           | 
##              |     0.143 |     0.143 |     0.143 |     0.143 |     0.143 |     0.143 |     0.143 |     0.875 | 
##              |     0.500 |     1.000 |     1.000 |     1.000 |     1.000 |     1.000 |     1.000 |           | 
##              |     0.125 |     0.125 |     0.125 |     0.125 |     0.125 |     0.125 |     0.125 |           | 
## -------------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|
##            2 |         1 |         0 |         0 |         0 |         0 |         0 |         0 |         1 | 
##              |     2.250 |     0.125 |     0.125 |     0.125 |     0.125 |     0.125 |     0.125 |           | 
##              |     1.000 |     0.000 |     0.000 |     0.000 |     0.000 |     0.000 |     0.000 |     0.125 | 
##              |     0.500 |     0.000 |     0.000 |     0.000 |     0.000 |     0.000 |     0.000 |           | 
##              |     0.125 |     0.000 |     0.000 |     0.000 |     0.000 |     0.000 |     0.000 |           | 
## -------------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|
## Column Total |         2 |         1 |         1 |         1 |         1 |         1 |         1 |         8 | 
##              |     0.250 |     0.125 |     0.125 |     0.125 |     0.125 |     0.125 |     0.125 |           | 
## -------------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|
## 
##
</code></pre></div>
</td></tr></table>
<h3 id="tests-of-independence">Tests of independence<a class="headerlink" href="#tests-of-independence" title="Permanent link">&para;</a></h3>
<p>There are more tests of independence in section 10, Resampling Statistics.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># dataset, a contingency table</span>
<span class="n">colors</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##             fair.hair red.hair medium.hair dark.hair black.hair
## blue eyes         326       38         241       110          3
## light eyes        688      116         584       188          4
## medium eyes       343       84         909       412         26
## dark eyes          98       48         403       681         85
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># chi-square test on 2-way tables</span>
<span class="c1"># test independence of the row and column variables, p-value is calculated from the asymptotic chi-squared distribution of the test statistic</span>
<span class="nf">chisq.test</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  colors
## X-squared = 1240, df = 12, p-value &lt; 2.2e-16
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># dataset, a contingency table in 2x2 matrix form</span>
<span class="n">TeaTasting</span> <span class="o">&lt;-</span>
<span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">3</span><span class="p">),</span>
       <span class="n">nrow</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span>
       <span class="n">dimnames</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">Guess</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;Milk&quot;</span><span class="p">,</span> <span class="s">&quot;Tea&quot;</span><span class="p">),</span>
                       <span class="n">Truth</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;Milk&quot;</span><span class="p">,</span> <span class="s">&quot;Tea&quot;</span><span class="p">)))</span>
<span class="n">TeaTasting</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##       Truth
## Guess  Milk Tea
##   Milk    3   1
##   Tea     1   3
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Fisher exact test</span>
<span class="nf">fisher.test</span><span class="p">(</span><span class="n">TeaTasting</span><span class="p">,</span> <span class="n">alternative</span> <span class="o">=</span> <span class="s">&quot;greater&quot;</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  <span class="nv">Fisher</span><span class="s1">&#39;</span><span class="s">s Exact Test for Count Data</span>
## 
## <span class="nv">data</span>:  <span class="nv">TeaTasting</span>
## <span class="nv">p</span><span class="o">-</span><span class="nv">value</span> <span class="o">=</span> <span class="mi">0</span>.<span class="mi">2429</span>
## <span class="nv">alternative</span> <span class="nv">hypothesis</span>: <span class="nv">true</span> <span class="nv">odds</span> <span class="nv">ratio</span> <span class="nv">is</span> <span class="nv">greater</span> <span class="nv">than</span> <span class="mi">1</span>
## <span class="mi">95</span> <span class="nv">percent</span> <span class="nv">confidence</span> <span class="nv">interval</span>:
##  <span class="mi">0</span>.<span class="mi">3135693</span>       <span class="nv">Inf</span>
## <span class="nv">sample</span> <span class="nv">estimates</span>:
## <span class="nv">odds</span> <span class="nv">ratio</span> 
##   <span class="mi">6</span>.<span class="mi">408309</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># 3D contingency table, where the last dimension refers to the strata</span>
<span class="n">Rabbits</span> <span class="o">&lt;-</span>
<span class="nf">array</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span>
        <span class="m">3</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span>
        <span class="m">6</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span>
        <span class="m">5</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span>
        <span class="m">2</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">),</span>
      <span class="n">dim</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">5</span><span class="p">),</span>
      <span class="n">dimnames</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span>
          <span class="n">Delay</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;None&quot;</span><span class="p">,</span> <span class="s">&quot;1.5h&quot;</span><span class="p">),</span>
          <span class="n">Response</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;Cured&quot;</span><span class="p">,</span> <span class="s">&quot;Died&quot;</span><span class="p">),</span>
          <span class="n">Penicillin.Level</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;1/8&quot;</span><span class="p">,</span> <span class="s">&quot;1/4&quot;</span><span class="p">,</span> <span class="s">&quot;1/2&quot;</span><span class="p">,</span> <span class="s">&quot;1&quot;</span><span class="p">,</span> <span class="s">&quot;4&quot;</span><span class="p">)))</span>
<span class="n">Rabbits</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## , , Penicillin.Level = 1/8
## 
##       Response
## Delay  Cured Died
##   None     0    6
##   1.5h     0    5
## 
## , , Penicillin.Level = 1/4
## 
##       Response
## Delay  Cured Died
##   None     3    3
##   1.5h     0    6
## 
## , , Penicillin.Level = 1/2
## 
##       Response
## Delay  Cured Died
##   None     6    0
##   1.5h     2    4
## 
## , , Penicillin.Level = 1
## 
##       Response
## Delay  Cured Died
##   None     5    1
##   1.5h     6    0
## 
## , , Penicillin.Level = 4
## 
##       Response
## Delay  Cured Died
##   None     2    0
##   1.5h     5    0
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Mantel-Haenszel test / Cochran-Mantel-Haenszel chi-squared test, hypothesis that two nominal variables are conditionally independent in each stratum, assuming that there is no three-way interaction.</span>
<span class="nf">mantelhaen.test</span><span class="p">(</span><span class="n">Rabbits</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  Mantel-Haenszel chi-squared test with continuity correction
## 
## data:  Rabbits
## Mantel-Haenszel X-squared = 3.9286, df = 1, p-value = 0.04747
## alternative hypothesis: true common odds ratio is not equal to 1
## 95 percent confidence interval:
##   1.026713 47.725133
## sample estimates:
## common odds ratio 
##                 7
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># dataset</span>
<span class="c1"># 3-way contingency table based on variables A, B, and C</span>
<span class="n">A</span> <span class="o">&lt;-</span> <span class="n">CO2</span><span class="p">[,</span> <span class="s">&#39;Plant&#39;</span><span class="p">]</span>
<span class="n">B</span> <span class="o">&lt;-</span> <span class="n">CO2</span><span class="p">[,</span> <span class="s">&#39;conc&#39;</span><span class="p">]</span>
<span class="n">C</span> <span class="o">&lt;-</span> <span class="n">CO2</span><span class="p">[,</span> <span class="s">&#39;uptake&#39;</span><span class="p">]</span>
<span class="n">mytable</span> <span class="o">&lt;-</span> <span class="nf">xtabs</span><span class="p">(</span><span class="o">~</span><span class="n">A</span><span class="o">+</span><span class="n">B</span><span class="o">+</span><span class="n">C</span><span class="p">)</span> <span class="c1"># a 3D array</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># loglinear Models</span>
<span class="c1"># mutual independence: A, B, and C are pairwise independent</span>
<span class="nf">library</span><span class="p">(</span><span class="n">MASS</span><span class="p">)</span>

<span class="nf">loglm</span><span class="p">(</span><span class="o">~</span><span class="n">A</span> <span class="o">+</span> <span class="n">B</span> <span class="o">+</span> <span class="n">C</span><span class="p">,</span> <span class="n">mytable</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Call:
## loglm(formula = ~A + B + C, data = mytable)
## 
## Statistics:
##                        X^2   df  P(&gt; X^2)
## Likelihood Ratio  720.1035 6291 1.0000000
## Pearson          6300.0000 6291 0.4656775
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># conditional independence: A is independent of B, given C</span>
<span class="nf">loglm</span><span class="p">(</span><span class="o">~</span><span class="n">A</span> <span class="o">+</span> <span class="n">B</span> <span class="o">+</span> <span class="n">C</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="n">C</span> <span class="o">+</span> <span class="n">B</span> <span class="o">*</span> <span class="n">C</span><span class="p">,</span> <span class="n">mytable</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Call:
## loglm(formula = ~A + B + C + A * C + B * C, data = mytable)
## 
## Statistics:
##                       X^2   df P(&gt; X^2)
## Likelihood Ratio 12.13685 5016        1
## Pearson               NaN 5016      NaN
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># no three-way interaction</span>
<span class="nf">loglm</span><span class="p">(</span><span class="o">~</span><span class="n">A</span> <span class="o">+</span> <span class="n">B</span> <span class="o">+</span> <span class="n">C</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="n">B</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="n">C</span> <span class="o">+</span> <span class="n">B</span> <span class="o">*</span> <span class="n">C</span><span class="p">,</span> <span class="n">mytable</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Call:
## loglm(formula = ~A + B + C + A * B + A * C + B * C, data = mytable)
## 
## Statistics:
##                       X^2   df P(&gt; X^2)
## Likelihood Ratio 1.038376 4950        1
## Pearson               NaN 4950      NaN
</code></pre></div>
</td></tr></table>
<h3 id="measures-of-association">Measures of association<a class="headerlink" href="#measures-of-association" title="Permanent link">&para;</a></h3>
<p>Association between two nominal variables, giving a value between 0 and +1 (inclusive). It is based on Pearson&rsquo;s chi-squared statistic.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Dataset</span>
<span class="nf">str</span><span class="p">(</span><span class="n">Arthritis</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## &#39;data.frame&#39;:    84 obs. of  5 variables:</span>
<span class="c1">##  $ ID       : int  57 46 77 17 36 23 75 39 33 55 ...</span>
<span class="c1">##  $ Treatment: Factor w/ 2 levels &quot;Placebo&quot;,&quot;Treated&quot;: 2 2 2 2 2 2 2 2 2 2 ...</span>
<span class="c1">##  $ Sex      : Factor w/ 2 levels &quot;Female&quot;,&quot;Male&quot;: 2 2 2 2 2 2 2 2 2 2 ...</span>
<span class="c1">##  $ Age      : int  27 29 30 32 46 58 59 59 63 63 ...</span>
<span class="c1">##  $ Improved : Ord.factor w/ 3 levels &quot;None&quot;&lt;&quot;Some&quot;&lt;..: 2 1 1 3 3 3 1 3 1 1 ...</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="n">tab</span> <span class="o">&lt;-</span> <span class="nf">xtabs</span><span class="p">(</span><span class="o">~</span><span class="n">Improved</span> <span class="o">+</span> <span class="n">Treatment</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">Arthritis</span><span class="p">)</span>
<span class="n">tab</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##         Treatment
## Improved Placebo Treated
##   None        29      13
##   Some         7       7
##   Marked       7      21
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">summary</span><span class="p">(</span><span class="nf">assocstats</span><span class="p">(</span><span class="n">tab</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
## <span class="nv">Call</span>: <span class="nv">xtabs</span><span class="ss">(</span><span class="nv">formula</span> <span class="o">=</span> <span class="o">~</span><span class="nv">Improved</span> <span class="o">+</span> <span class="nv">Treatment</span>, <span class="nv">data</span> <span class="o">=</span> <span class="nv">Arthritis</span><span class="ss">)</span>
## <span class="nv">Number</span> <span class="nv">of</span> <span class="nv">cases</span> <span class="nv">in</span> <span class="nv">table</span>: <span class="mi">84</span> 
## <span class="nv">Number</span> <span class="nv">of</span> <span class="nv">factors</span>: <span class="mi">2</span> 
## <span class="nv">Test</span> <span class="k">for</span> <span class="nv">independence</span> <span class="nv">of</span> <span class="nv">all</span> <span class="nv">factors</span>:
##  <span class="nv">Chisq</span> <span class="o">=</span> <span class="mi">13</span>.<span class="mi">055</span>, <span class="nv">df</span> <span class="o">=</span> <span class="mi">2</span>, <span class="nv">p</span><span class="o">-</span><span class="nv">value</span> <span class="o">=</span> <span class="mi">0</span>.<span class="mi">001463</span>
##                     <span class="nv">X</span><span class="o">^</span><span class="mi">2</span> <span class="nv">df</span>  <span class="nv">P</span><span class="ss">(</span><span class="o">&gt;</span> <span class="nv">X</span><span class="o">^</span><span class="mi">2</span><span class="ss">)</span>
## <span class="nv">Likelihood</span> <span class="nv">Ratio</span> <span class="mi">13</span>.<span class="mi">530</span>  <span class="mi">2</span> <span class="mi">0</span>.<span class="mi">0011536</span>
## <span class="nv">Pearson</span>          <span class="mi">13</span>.<span class="mi">055</span>  <span class="mi">2</span> <span class="mi">0</span>.<span class="mi">0014626</span>
## 
## <span class="nv">Phi</span><span class="o">-</span><span class="nv">Coefficient</span>   : <span class="nv">NA</span> 
## <span class="nv">Contingency</span> <span class="nv">Coeff</span>.: <span class="mi">0</span>.<span class="mi">367</span> 
## <span class="nv">Cramer</span><span class="s1">&#39;</span><span class="s">s V        : 0.394</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># phi coefficient, contingency coefficient, and Cramér&#39;s V for an 2D table</span>
<span class="nf">library</span><span class="p">(</span><span class="n">vcd</span><span class="p">)</span>

<span class="nf">assocstats</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##                     X^2 df  P(&gt; X^2)
## Likelihood Ratio 13.530  2 0.0011536
## Pearson          13.055  2 0.0014626
## 
## Phi-Coefficient   : NA 
## Contingency Coeff.: 0.367 
## Cramer&#39;s V        : 0.394
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Dataset</span>
<span class="n">TeaTasting</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##       Truth
## Guess  Milk Tea
##   Milk    3   1
##   Tea     1   3
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Cohen&#39;s kappa and weighted kappa for a confusion matrix</span>
<span class="nf">library</span><span class="p">(</span><span class="n">vcd</span><span class="p">)</span>

<span class="nf">kappa</span><span class="p">(</span><span class="n">TeaTasting</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## [1] 2.333333
</code></pre></div>
</td></tr></table>
<h2 id="correlations">Correlations<a class="headerlink" href="#correlations" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##                mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4     21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710    22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># correlations/covariances among numeric variables in</span>
<span class="c1"># a data frame</span>
<span class="nf">cor</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">use</span> <span class="o">=</span> <span class="s">&quot;complete.obs&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s">&quot;kendall&quot;</span><span class="p">)</span> <span class="c1"># method = &quot;pearson&quot;, &quot;spearman&quot; or &quot;kendall&quot;</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##             mpg        cyl       disp         hp        drat         wt
## mpg   1.0000000 -0.7953134 -0.7681311 -0.7428125  0.46454879 -0.7278321
## cyl  -0.7953134  1.0000000  0.8144263  0.7851865 -0.55131785  0.7282611
## disp -0.7681311  0.8144263  1.0000000  0.6659987 -0.49898277  0.7433824
## hp   -0.7428125  0.7851865  0.6659987  1.0000000 -0.38262689  0.6113081
## drat  0.4645488 -0.5513178 -0.4989828 -0.3826269  1.00000000 -0.5471495
## wt   -0.7278321  0.7282611  0.7433824  0.6113081 -0.54714953  1.0000000
## qsec  0.3153652 -0.4489698 -0.3008155 -0.4729061  0.03272155 -0.1419881
## vs    0.5896790 -0.7710007 -0.6033059 -0.6305926  0.37510111 -0.4884787
## am    0.4690128 -0.4946212 -0.5202739 -0.3039956  0.57554849 -0.6138790
## gear  0.4331509 -0.5125435 -0.4759795 -0.2794458  0.58392476 -0.5435956
## carb -0.5043945  0.4654299  0.4137360  0.5959842 -0.09535193  0.3713741
##             qsec         vs          am        gear        carb
## mpg   0.31536522  0.5896790  0.46901280  0.43315089 -0.50439455
## cyl  -0.44896982 -0.7710007 -0.49462115 -0.51254349  0.46542994
## disp -0.30081549 -0.6033059 -0.52027392 -0.47597955  0.41373600
## hp   -0.47290613 -0.6305926 -0.30399557 -0.27944584  0.59598416
## drat  0.03272155  0.3751011  0.57554849  0.58392476 -0.09535193
## wt   -0.14198812 -0.4884787 -0.61387896 -0.54359562  0.37137413
## qsec  1.00000000  0.6575431 -0.16890405 -0.09126069 -0.50643945
## vs    0.65754312  1.0000000  0.16834512  0.26974788 -0.57692729
## am   -0.16890405  0.1683451  1.00000000  0.77078758 -0.05859929
## gear -0.09126069  0.2697479  0.77078758  1.00000000  0.09801487
## carb -0.50643945 -0.5769273 -0.05859929  0.09801487  1.00000000
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">cov</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">use</span> <span class="o">=</span> <span class="s">&quot;complete.obs&quot;</span><span class="p">)</span> 
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##              mpg         cyl        disp          hp         drat
## mpg    36.324103  -9.1723790  -633.09721 -320.732056   2.19506351
## cyl    -9.172379   3.1895161   199.66028  101.931452  -0.66836694
## disp -633.097208 199.6602823 15360.79983 6721.158669 -47.06401915
## hp   -320.732056 101.9314516  6721.15867 4700.866935 -16.45110887
## drat    2.195064  -0.6683669   -47.06402  -16.451109   0.28588135
## wt     -5.116685   1.3673710   107.68420   44.192661  -0.37272073
## qsec    4.509149  -1.8868548   -96.05168  -86.770081   0.08714073
## vs      2.017137  -0.7298387   -44.37762  -24.987903   0.11864919
## am      1.803931  -0.4657258   -36.56401   -8.320565   0.19015121
## gear    2.135685  -0.6491935   -50.80262   -6.358871   0.27598790
## carb   -5.363105   1.5201613    79.06875   83.036290  -0.07840726
##               wt         qsec           vs           am        gear
## mpg   -5.1166847   4.50914919   2.01713710   1.80393145   2.1356855
## cyl    1.3673710  -1.88685484  -0.72983871  -0.46572581  -0.6491935
## disp 107.6842040 -96.05168145 -44.37762097 -36.56401210 -50.8026210
## hp    44.1926613 -86.77008065 -24.98790323  -8.32056452  -6.3588710
## drat  -0.3727207   0.08714073   0.11864919   0.19015121   0.2759879
## wt     0.9573790  -0.30548161  -0.27366129  -0.33810484  -0.4210806
## qsec  -0.3054816   3.19316613   0.67056452  -0.20495968  -0.2804032
## vs    -0.2736613   0.67056452   0.25403226   0.04233871   0.0766129
## am    -0.3381048  -0.20495968   0.04233871   0.24899194   0.2923387
## gear  -0.4210806  -0.28040323   0.07661290   0.29233871   0.5443548
## carb   0.6757903  -1.89411290  -0.46370968   0.04637097   0.3266129
##             carb
## mpg  -5.36310484
## cyl   1.52016129
## disp 79.06875000
## hp   83.03629032
## drat -0.07840726
## wt    0.67579032
## qsec -1.89411290
## vs   -0.46370968
## am    0.04637097
## gear  0.32661290
## carb  2.60887097
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># correlations with significance levels</span>
<span class="nf">library</span><span class="p">(</span><span class="n">Hmisc</span><span class="p">)</span>

<span class="nf">rcorr</span><span class="p">(</span><span class="nf">as.matrix</span><span class="p">(</span><span class="n">mtcars</span><span class="p">),</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&quot;pearson&quot;</span><span class="p">)</span> <span class="c1"># type can be pearson or spearman</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##        mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
## mpg   1.00 -0.85 -0.85 -0.78  0.68 -0.87  0.42  0.66  0.60  0.48 -0.55
## cyl  -0.85  1.00  0.90  0.83 -0.70  0.78 -0.59 -0.81 -0.52 -0.49  0.53
## disp -0.85  0.90  1.00  0.79 -0.71  0.89 -0.43 -0.71 -0.59 -0.56  0.39
## hp   -0.78  0.83  0.79  1.00 -0.45  0.66 -0.71 -0.72 -0.24 -0.13  0.75
## drat  0.68 -0.70 -0.71 -0.45  1.00 -0.71  0.09  0.44  0.71  0.70 -0.09
## wt   -0.87  0.78  0.89  0.66 -0.71  1.00 -0.17 -0.55 -0.69 -0.58  0.43
## qsec  0.42 -0.59 -0.43 -0.71  0.09 -0.17  1.00  0.74 -0.23 -0.21 -0.66
## vs    0.66 -0.81 -0.71 -0.72  0.44 -0.55  0.74  1.00  0.17  0.21 -0.57
## am    0.60 -0.52 -0.59 -0.24  0.71 -0.69 -0.23  0.17  1.00  0.79  0.06
## gear  0.48 -0.49 -0.56 -0.13  0.70 -0.58 -0.21  0.21  0.79  1.00  0.27
## carb -0.55  0.53  0.39  0.75 -0.09  0.43 -0.66 -0.57  0.06  0.27  1.00
## 
## n= 32 
## 
## 
## P
##      mpg    cyl    disp   hp     drat   wt     qsec   vs     am     gear  
## mpg         0.0000 0.0000 0.0000 0.0000 0.0000 0.0171 0.0000 0.0003 0.0054
## cyl  0.0000        0.0000 0.0000 0.0000 0.0000 0.0004 0.0000 0.0022 0.0042
## disp 0.0000 0.0000        0.0000 0.0000 0.0000 0.0131 0.0000 0.0004 0.0010
## hp   0.0000 0.0000 0.0000        0.0100 0.0000 0.0000 0.0000 0.1798 0.4930
## drat 0.0000 0.0000 0.0000 0.0100        0.0000 0.6196 0.0117 0.0000 0.0000
## wt   0.0000 0.0000 0.0000 0.0000 0.0000        0.3389 0.0010 0.0000 0.0005
## qsec 0.0171 0.0004 0.0131 0.0000 0.6196 0.3389        0.0000 0.2057 0.2425
## vs   0.0000 0.0000 0.0000 0.0000 0.0117 0.0010 0.0000        0.3570 0.2579
## am   0.0003 0.0022 0.0004 0.1798 0.0000 0.0000 0.2057 0.3570        0.0000
## gear 0.0054 0.0042 0.0010 0.4930 0.0000 0.0005 0.2425 0.2579 0.0000       
## carb 0.0011 0.0019 0.0253 0.0000 0.6212 0.0146 0.0000 0.0007 0.7545 0.1290
##      carb  
## mpg  0.0011
## cyl  0.0019
## disp 0.0253
## hp   0.0000
## drat 0.6212
## wt   0.0146
## qsec 0.0000
## vs   0.0007
## am   0.7545
## gear 0.1290
## carb
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># dataset</span>
<span class="n">x</span> <span class="o">&lt;-</span> <span class="n">mtcars</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">]</span>
<span class="n">y</span> <span class="o">&lt;-</span> <span class="n">mtcars</span><span class="p">[</span><span class="m">4</span><span class="o">:</span><span class="m">6</span><span class="p">]</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># correlation between two vectors</span>
<span class="nf">cor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##              hp       drat         wt
## mpg  -0.7761684  0.6811719 -0.8676594
## cyl   0.8324475 -0.6999381  0.7824958
## disp  0.7909486 -0.7102139  0.8879799
</code></pre></div>
</td></tr></table>
<p><strong>Polychoric correlation</strong></p>
<p>The correlation between two theorised normally distributed continuous latent variables, from two observed ordinal variables.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># dataset</span>
<span class="c1"># 2-way contingency table of counts</span>
<span class="n">colors</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##             fair.hair red.hair medium.hair dark.hair black.hair
## blue eyes         326       38         241       110          3
## light eyes        688      116         584       188          4
## medium eyes       343       84         909       412         26
## dark eyes          98       48         403       681         85
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># polychoric correlation</span>
<span class="nf">library</span><span class="p">(</span><span class="n">polycor</span><span class="p">)</span>

<span class="nf">polychor</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## [1] 0.4743984
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># heterogeneous correlations in one matrix</span>
<span class="c1"># pearson (numeric-numeric),</span>
<span class="c1"># polyserial (numeric-ordinal),</span>
<span class="c1"># and polychoric (ordinal-ordinal)</span>
<span class="c1"># a data frame with ordered factors and numeric variables</span>
<span class="nf">hetcor</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## </span>
<span class="c1">## Two-Step Estimates</span>
<span class="c1">## </span>
<span class="c1">## Correlations/Type of Correlation:</span>
<span class="c1">##             fair.hair red.hair medium.hair dark.hair black.hair</span>
<span class="c1">## fair.hair           1  Pearson     Pearson   Pearson    Pearson</span>
<span class="c1">## red.hair       0.8333        1     Pearson   Pearson    Pearson</span>
<span class="c1">## medium.hair    0.2597   0.6467           1   Pearson    Pearson</span>
<span class="c1">## dark.hair     -0.7091  -0.2251      0.1911         1    Pearson</span>
<span class="c1">## black.hair     -0.781  -0.3875    -0.06329    0.9674          1</span>
<span class="c1">## </span>
<span class="c1">## Standard Errors:</span>
<span class="c1">##             fair.hair red.hair medium.hair dark.hair</span>
<span class="c1">## fair.hair                                           </span>
<span class="c1">## red.hair      0.03628                               </span>
<span class="c1">## medium.hair    0.3607   0.1383                      </span>
<span class="c1">## dark.hair     0.09977   0.3733      0.3841          </span>
<span class="c1">## black.hair    0.06019   0.3004      0.4092  0.001491</span>
<span class="c1">## </span>
<span class="c1">## n = 4 </span>
<span class="c1">## </span>
<span class="c1">## P-values for Tests of Bivariate Normality:</span>
<span class="c1">##             fair.hair red.hair medium.hair dark.hair</span>
<span class="c1">## fair.hair                                           </span>
<span class="c1">## red.hair       0.8306                               </span>
<span class="c1">## medium.hair    0.6939   0.8609                      </span>
<span class="c1">## dark.hair      0.7465   0.6335      0.7161          </span>
<span class="c1">## black.hair     0.6582   0.5927      0.6711    0.9873</span>
</code></pre></div>
</td></tr></table>
<h2 id="t-tests">t-tests<a class="headerlink" href="#t-tests" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># independent 2-group t-test</span>
<span class="nf">t.test</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">x</span><span class="p">)</span> <span class="c1"># where y is numeric and x is a binary factor</span>

<span class="c1"># independent 2-group t-test</span>
<span class="nf">t.test</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span> <span class="c1"># where y1 and y2 are numeric </span>

<span class="c1"># paired t-test</span>
<span class="nf">t.test</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">paired</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="c1"># where y1 &amp; y2 are numeric </span>

<span class="c1"># one sample t-test</span>
<span class="nf">t.test</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">mu</span> <span class="o">=</span> <span class="m">3</span><span class="p">)</span> <span class="c1"># Ho: mu=3</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># dataset</span>
<span class="c1"># 2-way contingency table</span>
<span class="n">colors</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##             fair.hair red.hair medium.hair dark.hair black.hair
## blue eyes         326       38         241       110          3
## light eyes        688      116         584       188          4
## medium eyes       343       84         909       412         26
## dark eyes          98       48         403       681         85
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">mean</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="m">1</span><span class="p">,]))</span> <span class="c1"># row 1 average</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## [1] 143.6
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># independent 2-group t-test</span>
<span class="nf">t.test</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="m">1</span><span class="p">,]),</span> <span class="nf">as.numeric</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="m">2</span><span class="p">,]))</span> <span class="c1"># where y1 and y2 are numeric </span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  Welch Two Sample t-test
## 
## data:  as.numeric(colors[1, ]) and as.numeric(colors[2, ])
## t = -1.164, df = 5.5777, p-value = 0.2918
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -541.5725  196.7725
## sample estimates:
## mean of x mean of y 
##     143.6     316.0
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># one sample t-test</span>
<span class="nf">t.test</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="m">1</span><span class="p">,]),</span> <span class="n">mu</span> <span class="o">=</span> <span class="m">0</span><span class="p">)</span> <span class="c1"># Ho: mu=0</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  One Sample t-test
## 
## data:  as.numeric(colors[1, ])
## t = 2.348, df = 4, p-value = 0.07868
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  -26.2009 313.4009
## sample estimates:
## mean of x 
##     143.6
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">t.test</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="m">1</span><span class="p">,]),</span> <span class="n">mu</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s">&quot;greater&quot;</span><span class="p">)</span> <span class="c1"># Ho: mu=&lt;0</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  One Sample t-test
## 
## data:  as.numeric(colors[1, ])
## t = 2.348, df = 4, p-value = 0.03934
## alternative hypothesis: true mean is greater than 0
## 95 percent confidence interval:
##  13.22123      Inf
## sample estimates:
## mean of x 
##     143.6
</code></pre></div>
</td></tr></table>
<ul>
<li><code>alternative="less"</code> or <code>alternative="greater"</code> option to specify a one tailed test.</li>
<li><code>var.equal = TRUE</code> option to specify equal variances and a pooled variance estimate.</li>
</ul>
<p>For multivariate tests and ANOVA, see sections 8 and 9.</p>
<h2 id="nonparametric-statistics">Nonparametric statistics<a class="headerlink" href="#nonparametric-statistics" title="Permanent link">&para;</a></h2>
<p>Nonnormal distributions.</p>
<h3 id="bivariate-tests">Bivariate tests<a class="headerlink" href="#bivariate-tests" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># independent 2-group Mann-Whitney U test</span>
<span class="nf">wilcox.test</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">A</span><span class="p">)</span> <span class="c1"># where y is numeric and A is A binary factor</span>

<span class="c1"># independent 2-group Mann-Whitney U test</span>
<span class="nf">wilcox.test</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="c1"># where y and x are numeric</span>

<span class="c1"># dependent 2-group Wilcoxon signed rank test</span>
<span class="nf">wilcox.test</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">paired</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="c1"># where y1 and y2 are numeric</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># 2-way contingency table</span>
<span class="n">colors</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##             fair.hair red.hair medium.hair dark.hair black.hair
## blue eyes         326       38         241       110          3
## light eyes        688      116         584       188          4
## medium eyes       343       84         909       412         26
## dark eyes          98       48         403       681         85
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># independent 2-group Mann-Whitney U Test</span>
<span class="nf">wilcox.test</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="m">1</span><span class="p">,]),</span> <span class="nf">as.numeric</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="m">2</span><span class="p">,]))</span> <span class="c1"># where y and x are numeric</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  Wilcoxon rank sum test
## 
## data:  as.numeric(colors[1, ]) and as.numeric(colors[2, ])
## W = 8, p-value = 0.4206
## alternative hypothesis: true location shift is not equal to 0
</code></pre></div>
</td></tr></table>
<p><code>alternative="less"</code> or <code>alternative="greater"</code> option to specify a one<br />
tailed test.</p>
<h3 id="anova">ANOVA<a class="headerlink" href="#anova" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Kruskal Wallis test one-Way ANOVA by ranks</span>
<span class="nf">kruskal.test</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">A</span><span class="p">)</span> <span class="c1"># where y1 is numeric and A is a factor</span>

<span class="c1"># randomized block design - Friedman test</span>
<span class="nf">friedman.test</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">A</span> <span class="o">|</span> <span class="n">B</span><span class="p">)</span> <span class="c1"># where y are the data values, A is a grouping factor and B is a blocking factor</span>

<span class="c1"># Kruskal Wallis test one-way ANOVA by ranks</span>
<span class="nf">kruskal.test</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="c1"># where y and x are numeric</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># dataset</span>
<span class="c1"># 2-way contingency table</span>
<span class="n">colors</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##             fair.hair red.hair medium.hair dark.hair black.hair
## blue eyes         326       38         241       110          3
## light eyes        688      116         584       188          4
## medium eyes       343       84         909       412         26
## dark eyes          98       48         403       681         85
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Kruskal Wallis test one-way ANOVA by ranks</span>
<span class="nf">kruskal.test</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="m">1</span><span class="p">,]),</span> <span class="nf">as.numeric</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="m">2</span><span class="p">,]))</span> <span class="c1"># where y and x are numeric</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  as.numeric(colors[1, ]) and as.numeric(colors[2, ])
## Kruskal-Wallis chi-squared = 4, df = 4, p-value = 0.406
</code></pre></div>
</td></tr></table>
<h2 id="multiple-regressions">Multiple Regressions<a class="headerlink" href="#multiple-regressions" title="Permanent link">&para;</a></h2>
<h3 id="fitting-the-model">Fitting the Model<a class="headerlink" href="#fitting-the-model" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># multiple linear regression</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">x3</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mydata</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># show results</span>

<span class="c1"># useful functions</span>
<span class="nf">coefficients</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># model coefficients</span>
<span class="nf">confint</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="m">0.95</span><span class="p">)</span> <span class="c1"># CIs for model parameters</span>
<span class="nf">fitted</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># predicted values</span>
<span class="nf">residuals</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># residuals</span>
<span class="nf">anova</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># ANOVA table</span>
<span class="nf">vcov</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># covariance matrix for model parameters</span>
<span class="nf">influence</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># regression diagnostics </span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># dataset</span>
<span class="nf">str</span><span class="p">(</span><span class="n">longley</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## &#39;data.frame&#39;:    16 obs. of  7 variables:</span>
<span class="c1">##  $ GNP.deflator: num  83 88.5 88.2 89.5 96.2 ...</span>
<span class="c1">##  $ GNP         : num  234 259 258 285 329 ...</span>
<span class="c1">##  $ Unemployed  : num  236 232 368 335 210 ...</span>
<span class="c1">##  $ Armed.Forces: num  159 146 162 165 310 ...</span>
<span class="c1">##  $ Population  : num  108 109 110 111 112 ...</span>
<span class="c1">##  $ Year        : int  1947 1948 1949 1950 1951 1952 1953 1954 1955 1956 ...</span>
<span class="c1">##  $ Employed    : num  60.3 61.1 60.2 61.2 63.2 ...</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># multiple linear regression example</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">Armed.Forces</span> <span class="o">~</span> <span class="n">GNP</span> <span class="o">+</span> <span class="n">Population</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">longley</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># show results</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
## Call:
## lm(formula = Armed.Forces ~ GNP + Population, data = longley)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -70.349 -33.569   5.076  16.409 104.037 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept) 4123.922   1276.579   3.230  0.00657 **
## GNP            3.365      0.986   3.413  0.00463 **
## Population   -44.011     14.089  -3.124  0.00807 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 50.56 on 13 degrees of freedom
## Multiple R-squared:  0.5426, Adjusted R-squared:  0.4723 
## F-statistic: 7.712 on 2 and 13 DF,  p-value: 0.006191
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># other useful functions</span>
<span class="nf">coefficients</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># model coefficients</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## (Intercept)         GNP  Population 
## 4123.922484    3.365215  -44.010955
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">confint</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="m">0.95</span><span class="p">)</span> <span class="c1"># CIs for model parameters</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##                   2.5 %      97.5 %
## (Intercept) 1366.042123 6881.802846
## GNP            1.235097    5.495333
## Population   -74.447969  -13.573942
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">fitted</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># predicted values</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##     1947     1948     1949     1950     1951     1952     1953     1954 
## 176.4245 215.9487 161.1151 199.5681 298.4663 306.5279 288.1248 230.9633 
##     1955     1956     1957     1958     1959     1960     1961     1962 
## 295.1332 308.9566 313.0359 252.7794 318.8698 297.7176 240.7975 266.2711
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">residuals</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># residuals</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##        1947        1948        1949        1950        1951        1952 
## -17.4245114 -70.3487085   0.4848669 -34.5681071  11.4336564  52.8721086 
##        1953        1954        1955        1956        1957        1958 
##  66.5752438 104.0367029   9.6668098 -23.2566323 -33.2359499  10.9205505 
##        1959        1960        1961        1962 
## -63.6698197 -46.3175746  16.4025069  16.4288577
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">anova</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># ANOVA table</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Analysis of Variance Table
## 
## Response: Armed.Forces
##            Df Sum Sq Mean Sq F value   Pr(&gt;F)   
## GNP         1  14479 14478.7  5.6649 0.033301 * 
## Population  1  24941 24940.8  9.7583 0.008068 **
## Residuals  13  33226  2555.9                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">vcov</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># covariance matrix for model parameters</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##             (Intercept)          GNP   Population
## (Intercept) 1629652.882 1239.7478355 -17970.27388
## GNP            1239.748    0.9721911    -13.76775
## Population   -17970.274  -13.7677545    198.49444
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">influence</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># regression diagnostics </span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## $hat
##       1947       1948       1949       1950       1951       1952 
## 0.27412252 0.17438942 0.31563199 0.16765687 0.21219668 0.21127212 
##       1953       1954       1955       1956       1957       1958 
## 0.11339116 0.08602104 0.10270245 0.12845683 0.13251347 0.11070418 
##       1959       1960       1961       1962 
## 0.15598638 0.15164367 0.32488437 0.33842686 
## 
## $coefficients
##      (Intercept)          GNP  Population
## 1947  128.042531  0.131479474 -1.53731106
## 1948   29.040635  0.121992502 -0.69544934
## 1949   -6.396740 -0.005738655  0.07379997
## 1950  177.778426  0.175668519 -2.11609661
## 1951  133.333008  0.093997366 -1.43810938
## 1952  638.680267  0.462229807 -6.92955762
## 1953  422.107967  0.305133565 -4.56222462
## 1954 -385.998493 -0.325674565  4.42308458
## 1955   54.458118  0.042127997 -0.59713302
## 1956 -163.371695 -0.131240587  1.81041089
## 1957 -212.039316 -0.179084306  2.37664757
## 1958  -51.395691 -0.033854337  0.55600613
## 1959 -329.488802 -0.311550864  3.79446941
## 1960    3.116881 -0.049904757  0.10916689
## 1961 -242.199361 -0.158976865  2.60043035
## 1962 -194.416431 -0.113799395  2.04462752
## 
## $sigma
##     1947     1948     1949     1950     1951     1952     1953     1954 
## 52.28757 47.63741 52.61955 51.47046 52.48826 49.73420 48.50003 42.21357 
##     1955     1956     1957     1958     1959     1960     1961     1962 
## 52.53729 52.12610 51.60167 52.51353 48.66817 50.57779 52.30331 52.29577 
## 
## $wt.res
##        1947        1948        1949        1950        1951        1952 
## -17.4245114 -70.3487085   0.4848669 -34.5681071  11.4336564  52.8721086 
##        1953        1954        1955        1956        1957        1958 
##  66.5752438 104.0367029   9.6668098 -23.2566323 -33.2359499  10.9205505 
##        1959        1960        1961        1962 
## -63.6698197 -46.3175746  16.4025069  16.4288577
</code></pre></div>
</td></tr></table>
<h3 id="diagnostic-plots">Diagnostic plots<a class="headerlink" href="#diagnostic-plots" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># diagnostic plots</span>
<span class="nf">layout</span><span class="p">(</span><span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">),</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))</span> <span class="c1"># optional 4 graphs/page</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</code></pre></div>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Notes/unnamed-chunk-44-1.png" /></center></p>
<div class="highlight"><pre><span></span><code><span class="nf">layout</span><span class="p">(</span><span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
</code></pre></div>
<h3 id="comparing-two-models-with-anova">Comparing two models with ANOVA<a class="headerlink" href="#comparing-two-models-with-anova" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># compare models</span>
<span class="n">fit1</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">x3</span> <span class="o">+</span> <span class="n">x4</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mydata</span><span class="p">)</span>
<span class="n">fit2</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span><span class="p">)</span>

<span class="nf">anova</span><span class="p">(</span><span class="n">fit1</span><span class="p">,</span> <span class="n">fit2</span><span class="p">)</span> 
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># compare models</span>
<span class="n">fit1</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">Armed.Forces</span> <span class="o">~</span> <span class="n">GNP</span> <span class="o">+</span> <span class="n">Population</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">longley</span><span class="p">)</span>
<span class="n">fit2</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">Armed.Forces</span> <span class="o">~</span> <span class="n">GNP</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">longley</span><span class="p">)</span>

<span class="nf">anova</span><span class="p">(</span><span class="n">fit1</span><span class="p">,</span> <span class="n">fit2</span><span class="p">)</span> 
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Analysis of Variance Table
## 
## Model 1: Armed.Forces ~ GNP + Population
## Model 2: Armed.Forces ~ GNP
##   Res.Df   RSS Df Sum of Sq      F   Pr(&gt;F)   
## 1     13 33226                                
## 2     14 58167 -1    -24941 9.7583 0.008068 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre></div>
</td></tr></table>
<h3 id="cross-validation">Cross validation<a class="headerlink" href="#cross-validation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># dataset</span>
<span class="nf">library</span><span class="p">(</span><span class="n">DAAG</span><span class="p">)</span>

<span class="nf">data</span><span class="p">(</span><span class="n">houseprices</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">houseprices</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##    area bedrooms sale.price
## 9   694        4        192
## 10  905        4        215
## 11  802        4        215
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># k-fold cross-validation</span>
<span class="nf">library</span><span class="p">(</span><span class="n">DAAG</span><span class="p">)</span>

<span class="c1"># case 1, # 3 fold cross-validation</span>
<span class="nf">CVlm</span><span class="p">(</span><span class="n">houseprices</span><span class="p">,</span> <span class="n">form.lm</span> <span class="o">=</span> <span class="nf">formula</span><span class="p">(</span><span class="n">sale.price</span> <span class="o">~</span> <span class="n">area</span><span class="p">),</span> <span class="n">m</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">dots</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="m">29</span><span class="p">,</span> <span class="n">plotit</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;Observed&quot;</span><span class="p">,</span><span class="s">&quot;Residual&quot;</span><span class="p">),</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;Small symbols show cross-validation predicted values&quot;</span><span class="p">,</span> <span class="n">legend.pos</span> <span class="o">=</span> <span class="s">&quot;topleft&quot;</span><span class="p">,</span> <span class="n">printit</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Analysis of Variance Table
## 
## Response: sale.price
##           Df Sum Sq Mean Sq F value Pr(&gt;F)  
## area       1  18566   18566       8  0.014 *
## Residuals 13  30179    2321                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre></div>
</td></tr></table>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Notes/unnamed-chunk-48-1.png" /></center></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
## fold 1 
## Observations in test set: 5 
##              11  20    21     22   23
## area        802 696 771.0 1006.0 1191
## cvpred      204 188 199.3  234.7  262
## sale.price  215 255 260.0  293.0  375
## CV residual  11  67  60.7   58.3  113
## 
## Sum of squares = 24351    Mean square = 4870    n = 5 
## 
## fold 2 
## Observations in test set: 5 
##              10   13    14      17     18
## area        905  716 963.0 1018.00 887.00
## cvpred      255  224 264.4  273.38 252.06
## sale.price  215  113 185.0  276.00 260.00
## CV residual -40 -112 -79.4    2.62   7.94
## 
## Sum of squares = 20416    Mean square = 4083    n = 5 
## 
## fold 3 
## Observations in test set: 5 
##                 9   12     15    16     19
## area        694.0 1366 821.00 714.0 790.00
## cvpred      183.2  388 221.94 189.3 212.49
## sale.price  192.0  274 212.00 220.0 221.50
## CV residual   8.8 -114  -9.94  30.7   9.01
## 
## Sum of squares = 14241    Mean square = 2848    n = 5 
## 
## Overall (Sum over all 5 folds) 
##   ms 
## 3934
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">longley</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##      GNP.deflator GNP Unemployed Armed.Forces Population Year Employed
## 1947         83.0 234        236          159        108 1947     60.3
## 1948         88.5 259        232          146        109 1948     61.1
## 1949         88.2 258        368          162        110 1949     60.2
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># case 2, # 3 fold cross-validation</span>
<span class="nf">CVlm</span><span class="p">(</span><span class="n">longley</span><span class="p">,</span> <span class="n">form.lm</span> <span class="o">=</span> <span class="nf">formula</span><span class="p">(</span><span class="n">Armed.Forces</span> <span class="o">~</span> <span class="n">GNP</span> <span class="o">+</span> <span class="n">Population</span><span class="p">),</span> <span class="n">m</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">dots</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="m">29</span><span class="p">,</span> <span class="n">plotit</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;Observed&quot;</span><span class="p">,</span><span class="s">&quot;Residual&quot;</span><span class="p">),</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;Small symbols show cross-validation predicted values&quot;</span><span class="p">,</span> <span class="n">legend.pos</span> <span class="o">=</span> <span class="s">&quot;topleft&quot;</span><span class="p">,</span> <span class="n">printit</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Analysis of Variance Table
## 
## Response: Armed.Forces
##            Df Sum Sq Mean Sq F value Pr(&gt;F)   
## GNP         1  14479   14479    5.66 0.0333 * 
## Population  1  24941   24941    9.76 0.0081 **
## Residuals  13  33226    2556                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre></div>
</td></tr></table>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Notes/unnamed-chunk-50-1.png" /></center></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
## fold 1 
## Observations in test set: 5 
##               1953 1954  1957  1960  1962
## Predicted    288.1  231 313.0 297.7 266.3
## cvpred       281.4  219 310.6 295.7 263.1
## Armed.Forces 354.7  335 279.8 251.4 282.7
## CV residual   73.3  116 -30.8 -44.3  19.6
## 
## Sum of squares = 22004    Mean square = 4401    n = 5 
## 
## fold 2 
## Observations in test set: 6 
##               1948   1949   1955   1958  1959  1961
## Predicted    215.9 161.12 295.13 252.78 318.9 240.8
## cvpred       231.9 171.41 306.33 255.07 324.5 234.9
## Armed.Forces 145.6 161.60 304.80 263.70 255.2 257.2
## CV residual  -86.3  -9.81  -1.53   8.63 -69.3  22.3
## 
## Sum of squares = 12917    Mean square = 2153    n = 6 
## 
## fold 3 
## Observations in test set: 5 
##               1947  1950  1951  1952   1956
## Predicted    176.4 199.6 298.5 306.5 308.96
## cvpred       192.8 211.9 282.3 288.9 295.17
## Armed.Forces 159.0 165.0 309.9 359.4 285.70
## CV residual  -33.8 -46.9  27.6  70.5  -9.47
## 
## Sum of squares = 9161    Mean square = 1832    n = 5 
## 
## Overall (Sum over all 5 folds) 
##   ms 
## 2755
</code></pre></div>
</td></tr></table>
<h3 id="variable-selection-heuristic-methods">Variable selection &ndash; Heuristic methods<a class="headerlink" href="#variable-selection-heuristic-methods" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">longley</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##      GNP.deflator GNP Unemployed Armed.Forces Population Year Employed
## 1947         83.0 234        236          159        108 1947     60.3
## 1948         88.5 259        232          146        109 1948     61.1
## 1949         88.2 258        368          162        110 1949     60.2
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Stepwise Regression</span>
<span class="nf">library</span><span class="p">(</span><span class="n">MASS</span><span class="p">)</span>

<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">Armed.Forces</span> <span class="o">~</span> <span class="n">GNP</span> <span class="o">+</span> <span class="n">Population</span> <span class="o">+</span> <span class="n">Employed</span> <span class="o">+</span> <span class="n">Unemployed</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">longley</span><span class="p">)</span>
<span class="n">step</span> <span class="o">&lt;-</span> <span class="nf">stepAIC</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s">&quot;both&quot;</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Start:  AIC=125
## Armed.Forces ~ GNP + Population + Employed + Unemployed
## 
##              Df Sum of Sq   RSS AIC
## &lt;none&gt;                    21655 125
## - Unemployed  1      4508 26163 126
## - Population  1      5522 27177 127
## - Employed    1     10208 31863 130
## - GNP         1     15323 36978 132
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="n">step</span><span class="o">$</span><span class="n">anova</span> <span class="c1"># display results</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## Armed.Forces ~ GNP + Population + Employed + Unemployed
## 
## Final Model:
## Armed.Forces ~ GNP + Population + Employed + Unemployed
## 
## 
##   Step Df Deviance Resid. Df Resid. Dev AIC
## 1                         11      21655 125
</code></pre></div>
</td></tr></table>
<p>The goal is to reduce the AIC. Adding variable does not improve the model. Let&rsquo;s opt for the most valuable variable.</p>
<div class="highlight"><pre><span></span><code><span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">Armed.Forces</span> <span class="o">~</span> <span class="n">Unemployed</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">longley</span><span class="p">)</span>
<span class="n">step</span> <span class="o">&lt;-</span> <span class="nf">stepAIC</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s">&quot;both&quot;</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Start:  AIC=138
## Armed.Forces ~ Unemployed
## 
##              Df Sum of Sq   RSS AIC
## - Unemployed  1      2287 72646 137
## &lt;none&gt;                    70359 138
## 
## Step:  AIC=137
## Armed.Forces ~ 1
## 
##              Df Sum of Sq   RSS AIC
## &lt;none&gt;                    72646 137
## + Unemployed  1      2287 70359 138
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="n">step</span><span class="o">$</span><span class="n">anova</span> <span class="c1"># display results</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## Armed.Forces ~ Unemployed
## 
## Final Model:
## Armed.Forces ~ 1
## 
## 
##           Step Df Deviance Resid. Df Resid. Dev AIC
## 1                                 14      70359 138
## 2 - Unemployed  1     2287        15      72646 137
</code></pre></div>
</td></tr></table>
<h3 id="variable-selection-graphical-methods">Variable selection &ndash; Graphical methods<a class="headerlink" href="#variable-selection-graphical-methods" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># model</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">Armed.Forces</span> <span class="o">~</span> <span class="n">GNP</span> <span class="o">+</span> <span class="n">Population</span> <span class="o">+</span> <span class="n">Employed</span> <span class="o">+</span> <span class="n">Unemployed</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">longley</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># all Subsets Regression</span>
<span class="nf">library</span><span class="p">(</span><span class="n">leaps</span><span class="p">)</span>

<span class="n">leaps</span> <span class="o">&lt;-</span> <span class="nf">regsubsets</span><span class="p">(</span><span class="n">Armed.Forces</span> <span class="o">~</span> <span class="n">GNP</span> <span class="o">+</span> <span class="n">Population</span> <span class="o">+</span> <span class="n">Employed</span> <span class="o">+</span> <span class="n">Unemployed</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">longley</span><span class="p">,</span> <span class="n">nbest</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span>

<span class="c1"># view results</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">leaps</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="p">##</span> <span class="n">Subset</span> <span class="n">selection</span> <span class="n">object</span>
<span class="p">##</span> <span class="nl">Call:</span> <span class="n">regsubsets</span><span class="p">.</span><span class="n">formula</span><span class="p">(</span><span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span> <span class="o">~</span> <span class="n">GNP</span> <span class="o">+</span> <span class="n">Population</span> <span class="o">+</span> <span class="n">Employed</span> <span class="o">+</span> 
<span class="p">##</span>     <span class="n">Unemployed</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">longley</span><span class="p">,</span> <span class="n">nbest</span> <span class="o">=</span> <span class="mh">10</span><span class="p">)</span>
<span class="p">##</span> <span class="mh">4</span> <span class="n">Variables</span>  <span class="p">(</span><span class="k">and</span> <span class="n">intercept</span><span class="p">)</span>
<span class="p">##</span>            <span class="n">Forced</span> <span class="n">in</span> <span class="n">Forced</span> <span class="n">out</span>
<span class="p">##</span> <span class="n">GNP</span>            <span class="n">FALSE</span>      <span class="n">FALSE</span>
<span class="p">##</span> <span class="n">Population</span>     <span class="n">FALSE</span>      <span class="n">FALSE</span>
<span class="p">##</span> <span class="n">Employed</span>       <span class="n">FALSE</span>      <span class="n">FALSE</span>
<span class="p">##</span> <span class="n">Unemployed</span>     <span class="n">FALSE</span>      <span class="n">FALSE</span>
<span class="p">##</span> <span class="mh">10</span> <span class="n">subsets</span> <span class="n">of</span> <span class="n">each</span> <span class="n">size</span> <span class="n">up</span> <span class="n">to</span> <span class="mh">4</span>
<span class="p">##</span> <span class="n">Selection</span> <span class="nl">Algorithm:</span> <span class="n">exhaustive</span>
<span class="p">##</span>          <span class="n">GNP</span> <span class="n">Population</span> <span class="n">Employed</span> <span class="n">Unemployed</span>
<span class="p">##</span> <span class="mh">1</span>  <span class="p">(</span> <span class="mh">1</span> <span class="p">)</span> <span class="s">&quot; &quot;</span> <span class="s">&quot; &quot;</span>        <span class="s">&quot;*&quot;</span>      <span class="s">&quot; &quot;</span>       
<span class="p">##</span> <span class="mh">1</span>  <span class="p">(</span> <span class="mh">2</span> <span class="p">)</span> <span class="s">&quot;*&quot;</span> <span class="s">&quot; &quot;</span>        <span class="s">&quot; &quot;</span>      <span class="s">&quot; &quot;</span>       
<span class="p">##</span> <span class="mh">1</span>  <span class="p">(</span> <span class="mh">3</span> <span class="p">)</span> <span class="s">&quot; &quot;</span> <span class="s">&quot;*&quot;</span>        <span class="s">&quot; &quot;</span>      <span class="s">&quot; &quot;</span>       
<span class="p">##</span> <span class="mh">1</span>  <span class="p">(</span> <span class="mh">4</span> <span class="p">)</span> <span class="s">&quot; &quot;</span> <span class="s">&quot; &quot;</span>        <span class="s">&quot; &quot;</span>      <span class="s">&quot;*&quot;</span>       
<span class="p">##</span> <span class="mh">2</span>  <span class="p">(</span> <span class="mh">1</span> <span class="p">)</span> <span class="s">&quot;*&quot;</span> <span class="s">&quot;*&quot;</span>        <span class="s">&quot; &quot;</span>      <span class="s">&quot; &quot;</span>       
<span class="p">##</span> <span class="mh">2</span>  <span class="p">(</span> <span class="mh">2</span> <span class="p">)</span> <span class="s">&quot;*&quot;</span> <span class="s">&quot; &quot;</span>        <span class="s">&quot; &quot;</span>      <span class="s">&quot;*&quot;</span>       
<span class="p">##</span> <span class="mh">2</span>  <span class="p">(</span> <span class="mh">3</span> <span class="p">)</span> <span class="s">&quot; &quot;</span> <span class="s">&quot;*&quot;</span>        <span class="s">&quot; &quot;</span>      <span class="s">&quot;*&quot;</span>       
<span class="p">##</span> <span class="mh">2</span>  <span class="p">(</span> <span class="mh">4</span> <span class="p">)</span> <span class="s">&quot; &quot;</span> <span class="s">&quot; &quot;</span>        <span class="s">&quot;*&quot;</span>      <span class="s">&quot;*&quot;</span>       
<span class="p">##</span> <span class="mh">2</span>  <span class="p">(</span> <span class="mh">5</span> <span class="p">)</span> <span class="s">&quot; &quot;</span> <span class="s">&quot;*&quot;</span>        <span class="s">&quot;*&quot;</span>      <span class="s">&quot; &quot;</span>       
<span class="p">##</span> <span class="mh">2</span>  <span class="p">(</span> <span class="mh">6</span> <span class="p">)</span> <span class="s">&quot;*&quot;</span> <span class="s">&quot; &quot;</span>        <span class="s">&quot;*&quot;</span>      <span class="s">&quot; &quot;</span>       
<span class="p">##</span> <span class="mh">3</span>  <span class="p">(</span> <span class="mh">1</span> <span class="p">)</span> <span class="s">&quot;*&quot;</span> <span class="s">&quot;*&quot;</span>        <span class="s">&quot;*&quot;</span>      <span class="s">&quot; &quot;</span>       
<span class="p">##</span> <span class="mh">3</span>  <span class="p">(</span> <span class="mh">2</span> <span class="p">)</span> <span class="s">&quot;*&quot;</span> <span class="s">&quot; &quot;</span>        <span class="s">&quot;*&quot;</span>      <span class="s">&quot;*&quot;</span>       
<span class="p">##</span> <span class="mh">3</span>  <span class="p">(</span> <span class="mh">3</span> <span class="p">)</span> <span class="s">&quot;*&quot;</span> <span class="s">&quot;*&quot;</span>        <span class="s">&quot; &quot;</span>      <span class="s">&quot;*&quot;</span>       
<span class="p">##</span> <span class="mh">3</span>  <span class="p">(</span> <span class="mh">4</span> <span class="p">)</span> <span class="s">&quot; &quot;</span> <span class="s">&quot;*&quot;</span>        <span class="s">&quot;*&quot;</span>      <span class="s">&quot;*&quot;</span>       
<span class="p">##</span> <span class="mh">4</span>  <span class="p">(</span> <span class="mh">1</span> <span class="p">)</span> <span class="s">&quot;*&quot;</span> <span class="s">&quot;*&quot;</span>        <span class="s">&quot;*&quot;</span>      <span class="s">&quot;*&quot;</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># plot a table of models showing variables in each model</span>
<span class="c1"># models are ordered by the selection statistic</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">leaps</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="s">&quot;r2&quot;</span><span class="p">)</span>
</code></pre></div>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Notes/unnamed-chunk-55-1.png" /></center></p>
<div class="highlight"><pre><span></span><code><span class="c1"># plot statistic by subset size</span>
<span class="nf">library</span><span class="p">(</span><span class="n">car</span><span class="p">)</span>

<span class="nf">subsets</span><span class="p">(</span><span class="n">leaps</span><span class="p">,</span> <span class="n">statistic</span> <span class="o">=</span> <span class="s">&quot;rsq&quot;</span><span class="p">,</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span> <span class="c1"># available criteria are rsq, rss, adjr2, cp, bic</span>
</code></pre></div>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Notes/unnamed-chunk-55-2.png" /></center></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##            Abbreviation
## GNP                   G
## Population            P
## Employed              E
## Unemployed            U
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">subsets</span><span class="p">(</span><span class="n">leaps</span><span class="p">,</span> <span class="n">statistic</span> <span class="o">=</span> <span class="s">&quot;bic&quot;</span><span class="p">,</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span> <span class="c1"># available criteria are rsq, rss, adjr2, cp, bic</span>
</code></pre></div>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Notes/unnamed-chunk-55-3.png" /></center></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##            Abbreviation
## GNP                   G
## Population            P
## Employed              E
## Unemployed            U
</code></pre></div>
</td></tr></table>
<h3 id="variable-selection-relative-importance">Variable selection &ndash; Relative importance<a class="headerlink" href="#variable-selection-relative-importance" title="Permanent link">&para;</a></h3>
<p>Model: <code>fit &lt;- lm(Armed.Forces ~ GNP + Population + Employed + Unemployed, data = longley)</code>.</p>
<p>Warning: <code>eval=FALSE</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># calculate the relative importance of each predictor</span>
<span class="nf">library</span><span class="p">(</span><span class="n">relaimpo</span><span class="p">)</span>

<span class="nf">calc.relimp</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;lmg&quot;</span><span class="p">,</span> <span class="s">&quot;last&quot;</span><span class="p">,</span> <span class="s">&quot;first&quot;</span><span class="p">,</span> <span class="s">&quot;pratt&quot;</span><span class="p">),</span> <span class="n">rela</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</code></pre></div>
<p>Results.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">Response</span> <span class="n">variable</span><span class="p">:</span> <span class="n">Armed</span><span class="o">.</span><span class="n">Forces</span> 
<span class="n">Total</span> <span class="n">response</span> <span class="n">variance</span><span class="p">:</span> <span class="mi">4843</span> 
<span class="n">Analysis</span> <span class="n">based</span> <span class="n">on</span> <span class="mi">16</span> <span class="n">observations</span>

<span class="mi">4</span> <span class="n">Regressors</span><span class="p">:</span> 
<span class="n">GNP</span> <span class="n">Population</span> <span class="n">Employed</span> <span class="n">Unemployed</span> 
<span class="n">Proportion</span> <span class="n">of</span> <span class="n">variance</span> <span class="n">explained</span> <span class="n">by</span> <span class="n">model</span><span class="p">:</span> <span class="mf">70.2</span><span class="o">%</span>
<span class="n">Metrics</span> <span class="n">are</span> <span class="n">normalized</span> <span class="n">to</span> <span class="n">sum</span> <span class="n">to</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="n">rela</span><span class="o">=</span><span class="n">TRUE</span><span class="p">)</span><span class="o">.</span>

<span class="n">Relative</span> <span class="n">importance</span> <span class="n">metrics</span><span class="p">:</span>

             <span class="n">lmg</span>  <span class="n">last</span> <span class="n">first</span>  <span class="n">pratt</span>
<span class="n">GNP</span>        <span class="mf">0.328</span> <span class="mf">0.431</span> <span class="mf">0.348</span>  <span class="mf">4.566</span>
<span class="n">Population</span> <span class="mf">0.241</span> <span class="mf">0.155</span> <span class="mf">0.232</span> <span class="o">-</span><span class="mf">1.934</span>
<span class="n">Employed</span>   <span class="mf">0.217</span> <span class="mf">0.287</span> <span class="mf">0.365</span> <span class="o">-</span><span class="mf">1.780</span>
<span class="n">Unemployed</span> <span class="mf">0.215</span> <span class="mf">0.127</span> <span class="mf">0.055</span>  <span class="mf">0.148</span>

<span class="n">Average</span> <span class="n">coefficients</span> <span class="k">for</span> <span class="n">different</span> <span class="n">model</span> <span class="n">sizes</span><span class="p">:</span>

               <span class="mi">1</span><span class="n">X</span>     <span class="mi">2</span><span class="n">Xs</span>     <span class="mi">3</span><span class="n">Xs</span>     <span class="mi">4</span><span class="n">Xs</span>
<span class="n">GNP</span>         <span class="mf">0.313</span>   <span class="mf">1.301</span>   <span class="mf">3.641</span>   <span class="mf">5.026</span>
<span class="n">Population</span>  <span class="mf">3.646</span> <span class="o">-</span><span class="mf">14.815</span> <span class="o">-</span><span class="mf">24.637</span> <span class="o">-</span><span class="mf">37.260</span>
<span class="n">Employed</span>    <span class="mf">9.062</span>  <span class="mf">17.646</span> <span class="o">-</span><span class="mf">34.249</span> <span class="o">-</span><span class="mf">54.144</span>
<span class="n">Unemployed</span> <span class="o">-</span><span class="mf">0.132</span>  <span class="o">-</span><span class="mf">0.511</span>  <span class="o">-</span><span class="mf">0.584</span>  <span class="o">-</span><span class="mf">0.436</span>
</code></pre></div>
</td></tr></table>
<p><strong>Bootstrapping</strong></p>
<p>Model: <code>fit &lt;- lm(Armed.Forces ~ GNP + Population + Employed + Unemployed, data = longley)</code>.</p>
<p>Warning: <code>eval=FALSE</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># bootstrap measures of relative importance (1000 samples)</span>
<span class="n">boot</span> <span class="o">&lt;-</span> <span class="nf">boot.relimp</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="m">1000</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;lmg&quot;</span><span class="p">,</span> <span class="s">&quot;last&quot;</span><span class="p">,</span> <span class="s">&quot;first&quot;</span><span class="p">,</span> <span class="s">&quot;pratt&quot;</span><span class="p">),</span> <span class="n">rank</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="n">diff</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="n">rela</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">booteval.relimp</span><span class="p">(</span><span class="n">boot</span><span class="p">)</span> <span class="c1"># print result</span>
</code></pre></div>
<p>Results.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">Response</span> <span class="n">variable</span><span class="p">:</span> <span class="n">Armed</span><span class="o">.</span><span class="n">Forces</span> 
<span class="n">Total</span> <span class="n">response</span> <span class="n">variance</span><span class="p">:</span> <span class="mi">4843</span> 
<span class="n">Analysis</span> <span class="n">based</span> <span class="n">on</span> <span class="mi">16</span> <span class="n">observations</span>

<span class="mi">4</span> <span class="n">Regressors</span><span class="p">:</span> 
<span class="n">GNP</span> <span class="n">Population</span> <span class="n">Employed</span> <span class="n">Unemployed</span> 
<span class="n">Proportion</span> <span class="n">of</span> <span class="n">variance</span> <span class="n">explained</span> <span class="n">by</span> <span class="n">model</span><span class="p">:</span> <span class="mf">70.2</span><span class="o">%</span>
<span class="n">Metrics</span> <span class="n">are</span> <span class="n">normalized</span> <span class="n">to</span> <span class="n">sum</span> <span class="n">to</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="n">rela</span><span class="o">=</span><span class="n">TRUE</span><span class="p">)</span><span class="o">.</span>

<span class="n">Relative</span> <span class="n">importance</span> <span class="n">metrics</span><span class="p">:</span>

             <span class="n">lmg</span>  <span class="n">last</span> <span class="n">first</span>  <span class="n">pratt</span>
<span class="n">GNP</span>        <span class="mf">0.328</span> <span class="mf">0.431</span> <span class="mf">0.348</span>  <span class="mf">4.566</span>
<span class="n">Population</span> <span class="mf">0.241</span> <span class="mf">0.155</span> <span class="mf">0.232</span> <span class="o">-</span><span class="mf">1.934</span>
<span class="n">Employed</span>   <span class="mf">0.217</span> <span class="mf">0.287</span> <span class="mf">0.365</span> <span class="o">-</span><span class="mf">1.780</span>
<span class="n">Unemployed</span> <span class="mf">0.215</span> <span class="mf">0.127</span> <span class="mf">0.055</span>  <span class="mf">0.148</span>

<span class="n">Average</span> <span class="n">coefficients</span> <span class="k">for</span> <span class="n">different</span> <span class="n">model</span> <span class="n">sizes</span><span class="p">:</span>

               <span class="mi">1</span><span class="n">X</span>     <span class="mi">2</span><span class="n">Xs</span>     <span class="mi">3</span><span class="n">Xs</span>     <span class="mi">4</span><span class="n">Xs</span>
<span class="n">GNP</span>         <span class="mf">0.313</span>   <span class="mf">1.301</span>   <span class="mf">3.641</span>   <span class="mf">5.026</span>
<span class="n">Population</span>  <span class="mf">3.646</span> <span class="o">-</span><span class="mf">14.815</span> <span class="o">-</span><span class="mf">24.637</span> <span class="o">-</span><span class="mf">37.260</span>
<span class="n">Employed</span>    <span class="mf">9.062</span>  <span class="mf">17.646</span> <span class="o">-</span><span class="mf">34.249</span> <span class="o">-</span><span class="mf">54.144</span>
<span class="n">Unemployed</span> <span class="o">-</span><span class="mf">0.132</span>  <span class="o">-</span><span class="mf">0.511</span>  <span class="o">-</span><span class="mf">0.584</span>  <span class="o">-</span><span class="mf">0.436</span>


 <span class="n">Confidence</span> <span class="n">interval</span> <span class="n">information</span> <span class="p">(</span> <span class="mi">1000</span> <span class="n">bootstrap</span> <span class="n">replicates</span><span class="p">,</span> <span class="n">bty</span><span class="o">=</span> <span class="n">perc</span> <span class="p">):</span> 
<span class="n">Relative</span> <span class="n">Contributions</span> <span class="n">with</span> <span class="n">confidence</span> <span class="n">intervals</span><span class="p">:</span>

                                 <span class="n">Lower</span>  <span class="n">Upper</span>
                 <span class="n">percentage</span> <span class="mf">0.95</span> <span class="mf">0.95</span>    <span class="mf">0.95</span>   
<span class="n">GNP</span><span class="o">.</span><span class="n">lmg</span>           <span class="mf">0.3280</span>    <span class="n">ABC_</span>  <span class="mf">0.1488</span>  <span class="mf">0.4030</span>
<span class="n">Population</span><span class="o">.</span><span class="n">lmg</span>    <span class="mf">0.2410</span>    <span class="n">_BCD</span>  <span class="mf">0.1572</span>  <span class="mf">0.3060</span>
<span class="n">Employed</span><span class="o">.</span><span class="n">lmg</span>      <span class="mf">0.2170</span>    <span class="n">ABCD</span>  <span class="mf">0.1107</span>  <span class="mf">0.3240</span>
<span class="n">Unemployed</span><span class="o">.</span><span class="n">lmg</span>    <span class="mf">0.2150</span>    <span class="n">ABCD</span>  <span class="mf">0.0586</span>  <span class="mf">0.5550</span>

<span class="n">GNP</span><span class="o">.</span><span class="n">last</span>          <span class="mf">0.4310</span>    <span class="n">ABCD</span>  <span class="mf">0.0101</span>  <span class="mf">0.5660</span>
<span class="n">Population</span><span class="o">.</span><span class="n">last</span>   <span class="mf">0.1550</span>    <span class="n">_BCD</span>  <span class="mf">0.0003</span>  <span class="mf">0.3850</span>
<span class="n">Employed</span><span class="o">.</span><span class="n">last</span>     <span class="mf">0.2870</span>    <span class="n">ABCD</span>  <span class="mf">0.0476</span>  <span class="mf">0.6280</span>
<span class="n">Unemployed</span><span class="o">.</span><span class="n">last</span>   <span class="mf">0.1270</span>    <span class="n">ABCD</span>  <span class="mf">0.0009</span>  <span class="mf">0.7810</span>

<span class="n">GNP</span><span class="o">.</span><span class="n">first</span>         <span class="mf">0.3480</span>    <span class="n">ABCD</span>  <span class="mf">0.0151</span>  <span class="mf">0.3960</span>
<span class="n">Population</span><span class="o">.</span><span class="n">first</span>  <span class="mf">0.2320</span>    <span class="n">_BCD</span>  <span class="mf">0.0070</span>  <span class="mf">0.3060</span>
<span class="n">Employed</span><span class="o">.</span><span class="n">first</span>    <span class="mf">0.3650</span>    <span class="n">ABCD</span>  <span class="mf">0.0159</span>  <span class="mf">0.4020</span>
<span class="n">Unemployed</span><span class="o">.</span><span class="n">first</span>  <span class="mf">0.0550</span>    <span class="n">ABCD</span>  <span class="mf">0.0004</span>  <span class="mf">0.9280</span>

<span class="n">GNP</span><span class="o">.</span><span class="n">pratt</span>         <span class="mf">4.5660</span>    <span class="n">ABCD</span> <span class="o">-</span><span class="mf">1.0160</span> <span class="mf">10.5380</span>
<span class="n">Population</span><span class="o">.</span><span class="n">pratt</span> <span class="o">-</span><span class="mf">1.9340</span>    <span class="n">ABCD</span> <span class="o">-</span><span class="mf">6.0800</span>  <span class="mf">2.2050</span>
<span class="n">Employed</span><span class="o">.</span><span class="n">pratt</span>   <span class="o">-</span><span class="mf">1.7800</span>    <span class="n">_BCD</span> <span class="o">-</span><span class="mf">5.0290</span>  <span class="mf">0.8510</span>
<span class="n">Unemployed</span><span class="o">.</span><span class="n">pratt</span>  <span class="mf">0.1480</span>    <span class="n">ABC_</span> <span class="o">-</span><span class="mf">0.3250</span>  <span class="mf">1.0910</span>

<span class="n">Letters</span> <span class="n">indicate</span> <span class="n">the</span> <span class="n">ranks</span> <span class="n">covered</span> <span class="n">by</span> <span class="n">bootstrap</span> <span class="n">CIs</span><span class="o">.</span> 
<span class="p">(</span><span class="n">Rank</span> <span class="n">bootstrap</span> <span class="n">confidence</span> <span class="n">intervals</span> <span class="n">always</span> <span class="n">obtained</span> <span class="n">by</span> <span class="n">percentile</span> <span class="n">method</span><span class="p">)</span> 
<span class="n">CAUTION</span><span class="p">:</span> <span class="n">Bootstrap</span> <span class="n">confidence</span> <span class="n">intervals</span> <span class="n">can</span> <span class="n">be</span> <span class="n">somewhat</span> <span class="n">liberal</span><span class="o">.</span>


 <span class="n">Differences</span> <span class="n">between</span> <span class="n">Relative</span> <span class="n">Contributions</span><span class="p">:</span>

                                            <span class="n">Lower</span>   <span class="n">Upper</span>
                            <span class="n">difference</span> <span class="mf">0.95</span> <span class="mf">0.95</span>    <span class="mf">0.95</span>   
<span class="n">GNP</span><span class="o">-</span><span class="n">Population</span><span class="o">.</span><span class="n">lmg</span>           <span class="mf">0.0871</span>         <span class="o">-</span><span class="mf">0.0188</span>  <span class="mf">0.1521</span>
<span class="n">GNP</span><span class="o">-</span><span class="n">Employed</span><span class="o">.</span><span class="n">lmg</span>             <span class="mf">0.1106</span>         <span class="o">-</span><span class="mf">0.0479</span>  <span class="mf">0.1949</span>
<span class="n">GNP</span><span class="o">-</span><span class="n">Unemployed</span><span class="o">.</span><span class="n">lmg</span>           <span class="mf">0.1130</span>         <span class="o">-</span><span class="mf">0.4021</span>  <span class="mf">0.3281</span>
<span class="n">Population</span><span class="o">-</span><span class="n">Employed</span><span class="o">.</span><span class="n">lmg</span>      <span class="mf">0.0236</span>         <span class="o">-</span><span class="mf">0.1091</span>  <span class="mf">0.1124</span>
<span class="n">Population</span><span class="o">-</span><span class="n">Unemployed</span><span class="o">.</span><span class="n">lmg</span>    <span class="mf">0.0259</span>         <span class="o">-</span><span class="mf">0.3904</span>  <span class="mf">0.2417</span>
<span class="n">Employed</span><span class="o">-</span><span class="n">Unemployed</span><span class="o">.</span><span class="n">lmg</span>      <span class="mf">0.0023</span>         <span class="o">-</span><span class="mf">0.4315</span>  <span class="mf">0.2295</span>

<span class="n">GNP</span><span class="o">-</span><span class="n">Population</span><span class="o">.</span><span class="n">last</span>          <span class="mf">0.2756</span>         <span class="o">-</span><span class="mf">0.1062</span>  <span class="mf">0.4502</span>
<span class="n">GNP</span><span class="o">-</span><span class="n">Employed</span><span class="o">.</span><span class="n">last</span>            <span class="mf">0.1438</span>         <span class="o">-</span><span class="mf">0.5564</span>  <span class="mf">0.4011</span>
<span class="n">GNP</span><span class="o">-</span><span class="n">Unemployed</span><span class="o">.</span><span class="n">last</span>          <span class="mf">0.3041</span>         <span class="o">-</span><span class="mf">0.7408</span>  <span class="mf">0.5502</span>
<span class="n">Population</span><span class="o">-</span><span class="n">Employed</span><span class="o">.</span><span class="n">last</span>    <span class="o">-</span><span class="mf">0.1318</span>         <span class="o">-</span><span class="mf">0.6191</span>  <span class="mf">0.2653</span>
<span class="n">Population</span><span class="o">-</span><span class="n">Unemployed</span><span class="o">.</span><span class="n">last</span>   <span class="mf">0.0285</span>         <span class="o">-</span><span class="mf">0.7382</span>  <span class="mf">0.3622</span>
<span class="n">Employed</span><span class="o">-</span><span class="n">Unemployed</span><span class="o">.</span><span class="n">last</span>     <span class="mf">0.1603</span>         <span class="o">-</span><span class="mf">0.6784</span>  <span class="mf">0.4852</span>

<span class="n">GNP</span><span class="o">-</span><span class="n">Population</span><span class="o">.</span><span class="n">first</span>         <span class="mf">0.1161</span>         <span class="o">-</span><span class="mf">0.0590</span>  <span class="mf">0.1736</span>
<span class="n">GNP</span><span class="o">-</span><span class="n">Employed</span><span class="o">.</span><span class="n">first</span>          <span class="o">-</span><span class="mf">0.0172</span>         <span class="o">-</span><span class="mf">0.0893</span>  <span class="mf">0.0934</span>
<span class="n">GNP</span><span class="o">-</span><span class="n">Unemployed</span><span class="o">.</span><span class="n">first</span>         <span class="mf">0.2930</span>         <span class="o">-</span><span class="mf">0.9047</span>  <span class="mf">0.3766</span>
<span class="n">Population</span><span class="o">-</span><span class="n">Employed</span><span class="o">.</span><span class="n">first</span>   <span class="o">-</span><span class="mf">0.1333</span>         <span class="o">-</span><span class="mf">0.2134</span>  <span class="mf">0.0688</span>
<span class="n">Population</span><span class="o">-</span><span class="n">Unemployed</span><span class="o">.</span><span class="n">first</span>  <span class="mf">0.1769</span>         <span class="o">-</span><span class="mf">0.8967</span>  <span class="mf">0.2969</span>
<span class="n">Employed</span><span class="o">-</span><span class="n">Unemployed</span><span class="o">.</span><span class="n">first</span>    <span class="mf">0.3102</span>         <span class="o">-</span><span class="mf">0.8937</span>  <span class="mf">0.3823</span>

<span class="n">GNP</span><span class="o">-</span><span class="n">Population</span><span class="o">.</span><span class="n">pratt</span>         <span class="mf">6.4995</span>         <span class="o">-</span><span class="mf">2.2069</span> <span class="mf">15.7978</span>
<span class="n">GNP</span><span class="o">-</span><span class="n">Employed</span><span class="o">.</span><span class="n">pratt</span>           <span class="mf">6.3461</span>         <span class="o">-</span><span class="mf">1.3879</span> <span class="mf">15.0093</span>
<span class="n">GNP</span><span class="o">-</span><span class="n">Unemployed</span><span class="o">.</span><span class="n">pratt</span>         <span class="mf">4.4180</span>         <span class="o">-</span><span class="mf">1.9134</span> <span class="mf">10.6456</span>
<span class="n">Population</span><span class="o">-</span><span class="n">Employed</span><span class="o">.</span><span class="n">pratt</span>   <span class="o">-</span><span class="mf">0.1534</span>         <span class="o">-</span><span class="mf">4.1860</span>  <span class="mf">5.9691</span>
<span class="n">Population</span><span class="o">-</span><span class="n">Unemployed</span><span class="o">.</span><span class="n">pratt</span> <span class="o">-</span><span class="mf">2.0815</span>         <span class="o">-</span><span class="mf">6.1439</span>  <span class="mf">2.2348</span>
<span class="n">Employed</span><span class="o">-</span><span class="n">Unemployed</span><span class="o">.</span><span class="n">pratt</span>   <span class="o">-</span><span class="mf">1.9281</span>         <span class="o">-</span><span class="mf">5.2057</span>  <span class="mf">0.1725</span>

<span class="o">*</span> <span class="n">indicates</span> <span class="n">that</span> <span class="n">CI</span> <span class="k">for</span> <span class="n">difference</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">include</span> <span class="mf">0.</span> 
<span class="n">CAUTION</span><span class="p">:</span> <span class="n">Bootstrap</span> <span class="n">confidence</span> <span class="n">intervals</span> <span class="n">can</span> <span class="n">be</span> <span class="n">somewhat</span> <span class="n">liberal</span><span class="o">.</span>
</code></pre></div>
</td></tr></table>
<p>Warning: <code>eval=FALSE</code>.</p>
<div class="highlight"><pre><span></span><code><span class="nf">plot</span><span class="p">(</span><span class="nf">booteval.relimp</span><span class="p">(</span><span class="n">boot</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">))</span> <span class="c1"># to plot the results</span>
</code></pre></div>
<p>The .png file.</p>
<p><center><br />
<img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Notes/relimpResults.png" /><br />
</center></p>
<h3 id="going-further">Going further<a class="headerlink" href="#going-further" title="Permanent link">&para;</a></h3>
<ul>
<li>The <code>nls</code> package provides functions for nonlinear regression.</li>
<li>Perform robust regression with the <code>rlm</code> function in the <code>MASS</code> package.</li>
<li>The <code>robust</code> package provides a comprehensive library of robust methods, including regression.</li>
<li>The <code>robustbase</code> package also provides basic robust statistics including model selection methods.</li>
</ul>
<h2 id="regression-diagnostics">Regression diagnostics<a class="headerlink" href="#regression-diagnostics" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># assume that we are fitting a multiple linear regression</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="n">disp</span> <span class="o">+</span> <span class="n">hp</span> <span class="o">+</span> <span class="n">wt</span> <span class="o">+</span> <span class="n">drat</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">)</span>
<span class="n">fit</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
## Call:
## lm(formula = mpg ~ disp + hp + wt + drat, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           hp           wt         drat  
##    29.14874      0.00382     -0.03478     -3.47967      1.76805
</code></pre></div>
</td></tr></table>
<h3 id="outliers">Outliers<a class="headerlink" href="#outliers" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">car</span><span class="p">)</span>

<span class="c1"># assessing outliers</span>
<span class="nf">outlierTest</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># Bonferonni p-value for most extreme obs</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
## No Studentized residuals with Bonferonni p &lt; 0.05
## Largest |rstudent|:
##                rstudent unadjusted p-value Bonferonni p
## Toyota Corolla     2.52             0.0184        0.588
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">qqPlot</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;QQ Plot&quot;</span><span class="p">)</span> <span class="c1">#qq plot for studentized resid</span>
</code></pre></div>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Notes/unnamed-chunk-60-1.png" /></center></p>
<div class="highlight"><pre><span></span><code><span class="nf">leveragePlots</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># leverage plots</span>
</code></pre></div>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Notes/unnamed-chunk-60-2.png" /></center></p>
<h3 id="influential-observations">Influential observations<a class="headerlink" href="#influential-observations" title="Permanent link">&para;</a></h3>
<p>Model: <code>fit &lt;- lm(mpg ~ disp + hp + wt + drat, data = mtcars)</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># influential observations</span>
<span class="c1"># added variable plots</span>
<span class="nf">library</span><span class="p">(</span><span class="n">car</span><span class="p">)</span>

<span class="nf">avPlots</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</code></pre></div>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Notes/unnamed-chunk-61-1.png" /></center></p>
<div class="highlight"><pre><span></span><code><span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>

<span class="c1"># Cook&#39;s D plot</span>
<span class="c1"># identify D values &gt; 4/(n-k-1)</span>
<span class="n">cutoff</span> <span class="o">&lt;-</span> <span class="m">4</span><span class="o">/</span><span class="p">((</span><span class="nf">nrow</span><span class="p">(</span><span class="n">mtcars</span><span class="p">)</span> <span class="o">-</span> <span class="nf">length</span><span class="p">(</span><span class="n">fit</span><span class="o">$</span><span class="n">coefficients</span><span class="p">)</span> <span class="o">-</span> <span class="m">2</span><span class="p">))</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span> <span class="m">4</span><span class="p">,</span> <span class="n">cook.levels</span> <span class="o">=</span> <span class="n">cutoff</span><span class="p">)</span>
</code></pre></div>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Notes/unnamed-chunk-61-2.png" /></center></p>
<p>Warning: <code>eval=FALSE</code>; interactive function.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># influence plot</span>
<span class="nf">influencePlot</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">id.method</span> <span class="o">=</span> <span class="s">&quot;identify&quot;</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;Influence Plot&quot;</span><span class="p">,</span> <span class="n">sub</span> <span class="o">=</span> <span class="s">&quot;Circle size is proportial to Cook&#39;s Distance&quot;</span> <span class="p">)</span>
</code></pre></div>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Notes/unnamed-chunk-62-1.png" /></center></p>
<h3 id="nonnormality">Nonnormality<a class="headerlink" href="#nonnormality" title="Permanent link">&para;</a></h3>
<p>Model: <code>fit &lt;- lm(mpg ~ disp + hp + wt + drat, data = mtcars)</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># normality of residuals</span>
<span class="c1"># qq plot for studentized resid</span>
<span class="nf">library</span><span class="p">(</span><span class="n">car</span><span class="p">)</span>

<span class="nf">qqPlot</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;QQ Plot&quot;</span><span class="p">)</span>
</code></pre></div>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Notes/unnamed-chunk-63-1.png" /></center></p>
<div class="highlight"><pre><span></span><code><span class="c1"># distribution of studentized residuals</span>
<span class="nf">library</span><span class="p">(</span><span class="n">MASS</span><span class="p">)</span>

<span class="n">sresid</span> <span class="o">&lt;-</span> <span class="nf">studres</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
<span class="nf">hist</span><span class="p">(</span><span class="n">sresid</span><span class="p">,</span> <span class="n">freq</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;Distribution of Studentized Residuals&quot;</span><span class="p">)</span>
<span class="n">xfit</span> <span class="o">&lt;-</span> <span class="nf">seq</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">sresid</span><span class="p">),</span> <span class="nf">max</span><span class="p">(</span><span class="n">sresid</span><span class="p">),</span><span class="n">length</span> <span class="o">=</span> <span class="m">40</span><span class="p">)</span>
<span class="n">yfit</span> <span class="o">&lt;-</span> <span class="nf">dnorm</span><span class="p">(</span><span class="n">xfit</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">xfit</span><span class="p">,</span> <span class="n">yfit</span><span class="p">)</span> 
</code></pre></div>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Notes/unnamed-chunk-63-2.png" /></center></p>
<h3 id="heteroscedasticity">Heteroscedasticity<a class="headerlink" href="#heteroscedasticity" title="Permanent link">&para;</a></h3>
<p>Nonconstant error variance.</p>
<p>Model: <code>fit &lt;- lm(mpg ~ disp + hp + wt + drat, data = mtcars)</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># evaluate homoscedasticity</span>
<span class="c1"># non-constant error variance test</span>
<span class="nf">ncvTest</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## Non-constant Variance Score Test </span>
<span class="c1">## Variance formula: ~ fitted.values </span>
<span class="c1">## Chisquare = 1.43    Df = 1     p = 0.232</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># plot studentized residuals vs. fitted values</span>
<span class="nf">spreadLevelPlot</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</code></pre></div>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Notes/unnamed-chunk-64-1.png" /></center></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
## Suggested power transformation:  0.662
</code></pre></div>
</td></tr></table>
<h3 id="multicollinearity">Multicollinearity<a class="headerlink" href="#multicollinearity" title="Permanent link">&para;</a></h3>
<p>Model: <code>fit &lt;- lm(mpg ~ disp + hp + wt + drat, data = mtcars)</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># evaluatecCollinearity</span>
<span class="nf">vif</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## disp   hp   wt drat 
## 8.21 2.89 5.10 2.28
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">sqrt</span><span class="p">(</span><span class="nf">vif</span><span class="p">(</span><span class="n">fit</span><span class="p">))</span> <span class="o">&gt;</span> <span class="m">2</span> <span class="c1"># benchmark = 1.96, rounded to 2</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##  disp    hp    wt  drat 
##  TRUE FALSE  TRUE FALSE
</code></pre></div>
</td></tr></table>
<h3 id="nonlinearity">Nonlinearity<a class="headerlink" href="#nonlinearity" title="Permanent link">&para;</a></h3>
<p>Model: <code>fit &lt;- lm(mpg ~ disp + hp + wt + drat, data = mtcars)</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># evaluate nonlinearity</span>
<span class="c1"># component + residual plot</span>
<span class="nf">crPlots</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</code></pre></div>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Notes/unnamed-chunk-66-1.png" /></center></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Ceres plots</span>
<span class="nf">ceresPlots</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</code></pre></div>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Notes/unnamed-chunk-66-2.png" /></center></p>
<h3 id="autocorrelation">Autocorrelation<a class="headerlink" href="#autocorrelation" title="Permanent link">&para;</a></h3>
<p>Serial correlation or non-independence of errors.</p>
<p>Model: <code>fit &lt;- lm(mpg ~ disp + hp + wt + drat, data = mtcars)</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># test for autocorrelated errors</span>
<span class="nf">durbinWatsonTest</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##  lag Autocorrelation D-W Statistic p-value
##    1           0.101          1.74    0.29
##  Alternative hypothesis: rho != 0
</code></pre></div>
</td></tr></table>
<h3 id="global-diagnostic">Global diagnostic<a class="headerlink" href="#global-diagnostic" title="Permanent link">&para;</a></h3>
<p>Model: <code>fit &lt;- lm(mpg ~ disp + hp + wt + drat, data = mtcars)</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># global test of model assumptions</span>
<span class="nf">library</span><span class="p">(</span><span class="n">gvlma</span><span class="p">)</span>

<span class="n">gvmodel</span> <span class="o">&lt;-</span> <span class="nf">gvlma</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">gvmodel</span><span class="p">)</span> 
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
## Call:
## lm(formula = mpg ~ disp + hp + wt + drat, data = mtcars)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -3.508 -1.905 -0.506  0.982  5.688 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 29.14874    6.29359    4.63  8.2e-05 ***
## disp         0.00382    0.01080    0.35   0.7268    
## hp          -0.03478    0.01160   -3.00   0.0058 ** 
## wt          -3.47967    1.07837   -3.23   0.0033 ** 
## drat         1.76805    1.31978    1.34   0.1915    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.6 on 27 degrees of freedom
## Multiple R-squared:  0.838,  Adjusted R-squared:  0.814 
## F-statistic: 34.8 on 4 and 27 DF,  p-value: 2.7e-10
## 
## 
## ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
## USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
## Level of Significance =  0.05 
## 
## Call:
##  gvlma(x = fit) 
## 
##                      Value p-value                   Decision
## Global Stat        13.9382 0.00750 Assumptions NOT satisfied!
## Skewness            4.3131 0.03782 Assumptions NOT satisfied!
## Kurtosis            0.0138 0.90654    Assumptions acceptable.
## Link Function       8.7166 0.00315 Assumptions NOT satisfied!
## Heteroscedasticity  0.8947 0.34421    Assumptions acceptable.
</code></pre></div>
</td></tr></table>
<h2 id="anova_1">ANOVA<a class="headerlink" href="#anova_1" title="Permanent link">&para;</a></h2>
<p>Analysis of variance (ANOVA) is an alternative to regressions among other applications.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># lower case letters are numeric variables</span>
<span class="c1"># upper case letters are factors</span>

<span class="c1"># one-way ANOVA (completely randomized design)</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">A</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mydataframe</span><span class="p">)</span>

<span class="c1"># randomized block design (B is the blocking factor)</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">A</span> <span class="o">+</span> <span class="n">B</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mydataframe</span><span class="p">)</span>

<span class="c1"># two-way factorial design</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">A</span> <span class="o">+</span> <span class="n">B</span> <span class="o">+</span> <span class="n">A</span><span class="o">:</span><span class="n">B</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mydataframe</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">A</span><span class="o">*</span><span class="n">B</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mydataframe</span><span class="p">)</span> <span class="c1"># same thing</span>

<span class="c1"># analysis of covariance</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">A</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mydataframe</span><span class="p">)</span> 
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">CO2</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Grouped Data: uptake ~ conc | Plant
##   Plant   Type  Treatment conc uptake
## 1   Qn1 Quebec nonchilled   95   16.0
## 2   Qn1 Quebec nonchilled  175   30.4
## 3   Qn1 Quebec nonchilled  250   34.8
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># one-way ANOVA (completely randomized design)</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>
<span class="n">fit</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Call:
##    aov(formula = uptake ~ Plant, data = CO2)
## 
## Terms:
##                 Plant Residuals
## Sum of Squares   4862      4845
## Deg. of Freedom    11        72
## 
## Residual standard error: 8.2
## Estimated effects are balanced
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## Plant       11   4862     442    6.57 1.8e-07 ***
## Residuals   72   4845      67                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># randomized block design (B is the blocking factor)</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span> <span class="o">+</span> <span class="n">Type</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>
<span class="n">fit</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Call:
##    aov(formula = uptake ~ Plant + Type, data = CO2)
## 
## Terms:
##                 Plant Residuals
## Sum of Squares   4862      4845
## Deg. of Freedom    11        72
## 
## Residual standard error: 8.2
## 1 out of 13 effects not estimable
## Estimated effects are balanced
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## Plant       11   4862     442    6.57 1.8e-07 ***
## Residuals   72   4845      67                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># two-way factorial design</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span> <span class="o">+</span> <span class="n">Type</span> <span class="o">+</span> <span class="n">Plant</span><span class="o">:</span><span class="n">Type</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>
<span class="n">fit</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Call:
##    aov(formula = uptake ~ Plant + Type + Plant:Type, data = CO2)
## 
## Terms:
##                 Plant Residuals
## Sum of Squares   4862      4845
## Deg. of Freedom    11        72
## 
## Residual standard error: 8.2
## 12 out of 24 effects not estimable
## Estimated effects are balanced
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## Plant       11   4862     442    6.57 1.8e-07 ***
## Residuals   72   4845      67                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span><span class="o">*</span><span class="n">Type</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span> <span class="c1"># same thing</span>
<span class="n">fit</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Call:
##    aov(formula = uptake ~ Plant * Type, data = CO2)
## 
## Terms:
##                 Plant Residuals
## Sum of Squares   4862      4845
## Deg. of Freedom    11        72
## 
## Residual standard error: 8.2
## 12 out of 24 effects not estimable
## Estimated effects are balanced
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## Plant       11   4862     442    6.57 1.8e-07 ***
## Residuals   72   4845      67                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Analysis of Covariance</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">uptake</span> <span class="o">+</span> <span class="n">conc</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>
<span class="n">fit</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Call:
##    aov(formula = uptake ~ uptake + conc, data = CO2)
## 
## Terms:
##                 conc Residuals
## Sum of Squares  2285      7422
## Deg. of Freedom    1        82
## 
## Residual standard error: 9.51
## Estimated effects may be unbalanced
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## conc         1   2285    2285    25.2 2.9e-06 ***
## Residuals   82   7422      91                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre></div>
</td></tr></table>
<h3 id="evaluate-model-effects">Evaluate model effects<a class="headerlink" href="#evaluate-model-effects" title="Permanent link">&para;</a></h3>
<ul>
<li>Type I sequential SS: A+B and B+A will produce different results!</li>
<li>Use the <code>drop1</code> to produce the familiar Type III results; compare each term with the full model.</li>
</ul>
<!-- -->

<div class="highlight"><pre><span></span><code><span class="c1"># display Type I ANOVA table</span>
<span class="n">fit1</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span> <span class="o">+</span> <span class="n">Type</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit1</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## Plant       11   4862     442    6.57 1.8e-07 ***
## Residuals   72   4845      67                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># display Type I ANOVA table</span>
<span class="n">fit2</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">Type</span> <span class="o">+</span> <span class="n">Plant</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit2</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## Type         1   3366    3366   50.02 8.1e-10 ***
## Plant       10   1497     150    2.22   0.026 *  
## Residuals   72   4845      67                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># display type III SS and F tests</span>
<span class="nf">drop1</span><span class="p">(</span><span class="n">fit1</span><span class="p">,</span> <span class="o">~</span> <span class="n">.</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="s">&quot;F&quot;</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Single term deletions
## 
## Model:
## uptake ~ Plant + Type
##        Df Sum of Sq  RSS AIC F value Pr(&gt;F)  
## &lt;none&gt;              4845 365                 
## Plant  10      1497 6341 367    2.22  0.026 *
## Type    0         0 4845 365                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">drop1</span><span class="p">(</span><span class="n">fit2</span><span class="p">,</span> <span class="o">~</span> <span class="n">.</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="s">&quot;F&quot;</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Single term deletions
## 
## Model:
## uptake ~ Type + Plant
##        Df Sum of Sq  RSS AIC F value Pr(&gt;F)  
## &lt;none&gt;              4845 365                 
## Type    0         0 4845 365                 
## Plant  10      1497 6341 367    2.22  0.026 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre></div>
</td></tr></table>
<h3 id="compare-nested-models-directly">Compare nested models directly<a class="headerlink" href="#compare-nested-models-directly" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">fit1</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span> <span class="o">+</span> <span class="n">Type</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>
<span class="n">fit2</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>

<span class="nf">anova</span><span class="p">(</span><span class="n">fit1</span><span class="p">,</span> <span class="n">fit2</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Analysis of Variance Table
## 
## Model 1: uptake ~ Plant + Type
## Model 2: uptake ~ Plant
##   Res.Df  RSS Df Sum of Sq F Pr(&gt;F)
## 1     72 4845                      
## 2     72 4845  0         0
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="n">fit2</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span> <span class="o">+</span> <span class="n">Type</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>
<span class="n">fit1</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>

<span class="nf">anova</span><span class="p">(</span><span class="n">fit1</span><span class="p">,</span> <span class="n">fit2</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Analysis of Variance Table
## 
## Model 1: uptake ~ Plant
## Model 2: uptake ~ Plant + Type
##   Res.Df  RSS Df Sum of Sq F Pr(&gt;F)
## 1     72 4845                      
## 2     72 4845  0         0
</code></pre></div>
</td></tr></table>
<h3 id="multiple-comparisons">Multiple comparisons<a class="headerlink" href="#multiple-comparisons" title="Permanent link">&para;</a></h3>
<ul>
<li>Tukey HSD tests for post hoc comparisons on each factor in the model.</li>
<li>Factors as an option.</li>
<li>Type I SS.</li>
</ul>
<!-- -->

<div class="highlight"><pre><span></span><code><span class="c1"># model</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span> <span class="o">+</span> <span class="n">Type</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>

<span class="c1"># Tukey honestly significant differences</span>
<span class="nf">TukeyHSD</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = uptake ~ Plant + Type, data = CO2)
## 
## $Plant
##            diff    lwr     upr p adj
## Qn2-Qn1   1.929 -12.88  16.739 1.000
## Qn3-Qn1   4.386 -10.42  19.196 0.997
## Qc1-Qn1  -3.257 -18.07  11.553 1.000
## Qc3-Qn1  -0.643 -15.45  14.168 1.000
## Qc2-Qn1  -0.529 -15.34  14.282 1.000
## Mn3-Qn1  -9.114 -23.92   5.696 0.639
## Mn2-Qn1  -5.886 -20.70   8.925 0.970
## Mn1-Qn1  -6.829 -21.64   7.982 0.918
## Mc2-Qn1 -21.086 -35.90  -6.275 0.000
## Mc3-Qn1 -15.929 -30.74  -1.118 0.024
## Mc1-Qn1 -15.229 -30.04  -0.418 0.038
## Qn3-Qn2   2.457 -12.35  17.268 1.000
## Qc1-Qn2  -5.186 -20.00   9.625 0.989
## Qc3-Qn2  -2.571 -17.38  12.239 1.000
## Qc2-Qn2  -2.457 -17.27  12.353 1.000
## Mn3-Qn2 -11.043 -25.85   3.768 0.346
## Mn2-Qn2  -7.814 -22.62   6.996 0.822
## Mn1-Qn2  -8.757 -23.57   6.053 0.694
## Mc2-Qn2 -23.014 -37.82  -8.204 0.000
## Mc3-Qn2 -17.857 -32.67  -3.047 0.006
## Mc1-Qn2 -17.157 -31.97  -2.347 0.010
## Qc1-Qn3  -7.643 -22.45   7.168 0.842
## Qc3-Qn3  -5.029 -19.84   9.782 0.991
## Qc2-Qn3  -4.914 -19.72   9.896 0.993
## Mn3-Qn3 -13.500 -28.31   1.311 0.108
## Mn2-Qn3 -10.271 -25.08   4.539 0.457
## Mn1-Qn3 -11.214 -26.02   3.596 0.323
## Mc2-Qn3 -25.471 -40.28 -10.661 0.000
## Mc3-Qn3 -20.314 -35.12  -5.504 0.001
## Mc1-Qn3 -19.614 -34.42  -4.804 0.002
## Qc3-Qc1   2.614 -12.20  17.425 1.000
## Qc2-Qc1   2.729 -12.08  17.539 1.000
## Mn3-Qc1  -5.857 -20.67   8.953 0.971
## Mn2-Qc1  -2.629 -17.44  12.182 1.000
## Mn1-Qc1  -3.571 -18.38  11.239 1.000
## Mc2-Qc1 -17.829 -32.64  -3.018 0.006
## Mc3-Qc1 -12.671 -27.48   2.139 0.167
## Mc1-Qc1 -11.971 -26.78   2.839 0.233
## Qc2-Qc3   0.114 -14.70  14.925 1.000
## Mn3-Qc3  -8.471 -23.28   6.339 0.735
## Mn2-Qc3  -5.243 -20.05   9.568 0.988
## Mn1-Qc3  -6.186 -21.00   8.625 0.958
## Mc2-Qc3 -20.443 -35.25  -5.632 0.001
## Mc3-Qc3 -15.286 -30.10  -0.475 0.037
## Mc1-Qc3 -14.586 -29.40   0.225 0.057
## Mn3-Qc2  -8.586 -23.40   6.225 0.719
## Mn2-Qc2  -5.357 -20.17   9.453 0.985
## Mn1-Qc2  -6.300 -21.11   8.511 0.952
## Mc2-Qc2 -20.557 -35.37  -5.747 0.001
## Mc3-Qc2 -15.400 -30.21  -0.589 0.034
## Mc1-Qc2 -14.700 -29.51   0.111 0.054
## Mn2-Mn3   3.229 -11.58  18.039 1.000
## Mn1-Mn3   2.286 -12.52  17.096 1.000
## Mc2-Mn3 -11.971 -26.78   2.839 0.233
## Mc3-Mn3  -6.814 -21.62   7.996 0.919
## Mc1-Mn3  -6.114 -20.92   8.696 0.961
## Mn1-Mn2  -0.943 -15.75  13.868 1.000
## Mc2-Mn2 -15.200 -30.01  -0.389 0.039
## Mc3-Mn2 -10.043 -24.85   4.768 0.493
## Mc1-Mn2  -9.343 -24.15   5.468 0.603
## Mc2-Mn1 -14.257 -29.07   0.553 0.070
## Mc3-Mn1  -9.100 -23.91   5.711 0.641
## Mc1-Mn1  -8.400 -23.21   6.411 0.746
## Mc3-Mc2   5.157  -9.65  19.968 0.989
## Mc1-Mc2   5.857  -8.95  20.668 0.971
## Mc1-Mc3   0.700 -14.11  15.511 1.000
</code></pre></div>
</td></tr></table>
<h3 id="visualizing-results">Visualizing results<a class="headerlink" href="#visualizing-results" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># two-way interaction plot</span>
<span class="nf">attach</span><span class="p">(</span><span class="n">mtcars</span><span class="p">)</span>

<span class="n">gear</span> <span class="o">&lt;-</span> <span class="nf">factor</span><span class="p">(</span><span class="n">gear</span><span class="p">)</span>
<span class="n">cyl</span> <span class="o">&lt;-</span> <span class="nf">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">)</span>

<span class="c1"># two-way interactions</span>
<span class="nf">library</span><span class="p">(</span><span class="n">car</span><span class="p">)</span>

<span class="nf">interaction.plot</span><span class="p">(</span><span class="n">cyl</span><span class="p">,</span> <span class="n">gear</span><span class="p">,</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">),</span> <span class="n">leg.bty</span> <span class="o">=</span> <span class="s">&quot;o&quot;</span><span class="p">,</span> <span class="n">leg.bg</span> <span class="o">=</span> <span class="s">&quot;beige&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">pch</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">18</span><span class="p">,</span><span class="m">24</span><span class="p">,</span><span class="m">22</span><span class="p">),</span> <span class="n">xlab</span> <span class="o">=</span> <span class="s">&quot;Number of Cylinders&quot;</span><span class="p">,</span> <span class="n">ylab</span> <span class="o">=</span> <span class="s">&quot;Mean Miles Per Gallon&quot;</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;Interaction Plot&quot;</span><span class="p">)</span>
</code></pre></div>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Notes/unnamed-chunk-75-1.png" /></center></p>
<div class="highlight"><pre><span></span><code><span class="c1"># mean plots for single factors, and includes confidence intervals</span>
<span class="nf">library</span><span class="p">(</span><span class="n">gplots</span><span class="p">)</span>

<span class="nf">plotmeans</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="n">cyl</span><span class="p">,</span> <span class="n">xlab</span> <span class="o">=</span> <span class="s">&quot;Number of Cylinders&quot;</span><span class="p">,</span> <span class="n">ylab</span> <span class="o">=</span> <span class="s">&quot;Miles Per Gallon&quot;</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;Mean Plot\nwith 95% CI&quot;</span><span class="p">)</span>
</code></pre></div>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Notes/unnamed-chunk-75-2.png" /></center></p>
<div class="highlight"><pre><span></span><code><span class="nf">detach</span><span class="p">(</span><span class="n">mtcars</span><span class="p">)</span>
</code></pre></div>
<h3 id="manova">MANOVA<a class="headerlink" href="#manova" title="Permanent link">&para;</a></h3>
<p>Multivariate analysis of variance (MANOVA) With more than one dependent variable Y. We can run several ANOVA over different Y, or one MANOVA with one Y built with several variables.</p>
<div class="highlight"><pre><span></span><code><span class="nf">head</span><span class="p">(</span><span class="n">longley</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##      GNP.deflator GNP Unemployed Armed.Forces Population Year Employed
## 1947         83.0 234        236          159        108 1947     60.3
## 1948         88.5 259        232          146        109 1948     61.1
## 1949         88.2 258        368          162        110 1949     60.2
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">attach</span><span class="p">(</span><span class="n">longley</span><span class="p">)</span>

<span class="c1"># 2x2 factorial MANOVA with 3 dependent variables, Y</span>
<span class="n">Y</span> <span class="o">&lt;-</span> <span class="nf">cbind</span><span class="p">(</span><span class="n">Unemployed</span><span class="p">,</span> <span class="n">Armed.Forces</span><span class="p">,</span> <span class="n">Employed</span><span class="p">)</span> <span class="c1"># Y</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">manova</span><span class="p">(</span><span class="n">Y</span> <span class="o">~</span> <span class="n">Population</span><span class="o">*</span><span class="n">GNP</span><span class="p">)</span> <span class="c1"># Y ~ X</span>

<span class="c1"># display type I SS</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="s">&quot;Pillai&quot;</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##                Df Pillai approx F num Df den Df  Pr(&gt;F)    
## Population      1  0.997     1074      3     10 7.7e-13 ***
## GNP             1  0.888       26      3     10 4.6e-05 ***
## Population:GNP  1  0.870       22      3     10 9.4e-05 ***
## Residuals      12                                          
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># test = &quot;Wilks&quot;, &quot;Hotelling-Lawley&quot;, and &quot;Roy&quot;</span>

<span class="c1"># display univariate statistics</span>
<span class="nf">summary.aov</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##  Response Unemployed :
##                Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## Population      1  61739   61739   45.92   2e-05 ***
## GNP             1  42841   42841   31.87 0.00011 ***
## Population:GNP  1  10270   10270    7.64 0.01715 *  
## Residuals      12  16133    1344                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##  Response Armed.Forces :
##                Df Sum Sq Mean Sq F value Pr(&gt;F)   
## Population      1   9647    9647    4.25 0.0617 . 
## GNP             1  29772   29772   13.10 0.0035 **
## Population:GNP  1   5958    5958    2.62 0.1314   
## Residuals      12  27268    2272                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##  Response Employed :
##                Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## Population      1  170.6   170.6  546.45 2.2e-11 ***
## GNP             1   10.5    10.5   33.60 8.5e-05 ***
## Population:GNP  1    0.1     0.1    0.41    0.54    
## Residuals      12    3.7     0.3                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># display type III SS</span>
<span class="n">fit1</span> <span class="o">&lt;-</span> <span class="nf">manova</span><span class="p">(</span><span class="n">Y</span> <span class="o">~</span> <span class="n">Population</span><span class="o">*</span><span class="n">GNP</span><span class="p">)</span>
<span class="n">fit2</span> <span class="o">&lt;-</span> <span class="nf">manova</span><span class="p">(</span><span class="n">Y</span> <span class="o">~</span> <span class="n">GNP</span><span class="o">*</span><span class="n">Population</span><span class="p">)</span>
<span class="c1"># type III GNP effect</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit1</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##                Df Pillai approx F num Df den Df  Pr(&gt;F)    
## Population      1  0.997     1074      3     10 7.7e-13 ***
## GNP             1  0.888       26      3     10 4.6e-05 ***
## Population:GNP  1  0.870       22      3     10 9.4e-05 ***
## Residuals      12                                          
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># type III Population effect</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit2</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##                Df Pillai approx F num Df den Df  Pr(&gt;F)    
## GNP             1  0.997     1088      3     10 7.2e-13 ***
## Population      1  0.786       12      3     10  0.0011 ** 
## GNP:Population  1  0.870       22      3     10 9.4e-05 ***
## Residuals      12                                          
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre></div>
</td></tr></table>
<p><strong>Multiple comparisons</strong></p>
<p><code>TukeyHSD</code> and <code>plot</code> do work with a MANOVA fit. Run each dependent variable separately to obtain them&hellip; or proceed with ANOVA on each dependent variable.</p>
<h3 id="going-further_1">Going further<a class="headerlink" href="#going-further_1" title="Permanent link">&para;</a></h3>
<p>Package <code>lme4</code> has excellent facilities for fitting linear and generalized linear mixed-effects models.</p>
<h2 id="manova-assumptions">(M)ANOVA Assumptions<a class="headerlink" href="#manova-assumptions" title="Permanent link">&para;</a></h2>
<h3 id="outliers_1">Outliers<a class="headerlink" href="#outliers_1" title="Permanent link">&para;</a></h3>
<p>Outliers can severely affect normality and homogeneity of variance.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##                mpg cyl disp  hp drat   wt qsec vs am gear carb
## Mazda RX4     21.0   6  160 110 3.90 2.62 16.5  0  1    4    4
## Mazda RX4 Wag 21.0   6  160 110 3.90 2.88 17.0  0  1    4    4
## Datsun 710    22.8   4  108  93 3.85 2.32 18.6  1  1    4    1
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># detect outliers</span>
<span class="c1"># ordered squared robust Mahalanobis distances of the observations against the empirical distribution function of the MD2i</span>
<span class="nf">library</span><span class="p">(</span><span class="n">mvoutlier</span><span class="p">)</span>

<span class="n">outliers</span> <span class="o">&lt;-</span>
<span class="nf">aq.plot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;mpg&quot;</span><span class="p">,</span> <span class="s">&quot;disp&quot;</span><span class="p">,</span> <span class="s">&quot;hp&quot;</span><span class="p">,</span> <span class="s">&quot;drat&quot;</span><span class="p">,</span> <span class="s">&quot;wt&quot;</span><span class="p">,</span> <span class="s">&quot;qsec&quot;</span><span class="p">)])</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## Projection to the first and second robust principal components.</span>
<span class="c1">## Proportion of total variation (explained variance): 0.974</span>
</code></pre></div>
</td></tr></table>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Notes/unnamed-chunk-79-1.png" /></center></p>
<div class="highlight"><pre><span></span><code><span class="n">outliers</span> <span class="c1"># show list of outliers</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## $outliers
##           Mazda RX4       Mazda RX4 Wag          Datsun 710 
##               FALSE               FALSE               FALSE 
##      Hornet 4 Drive   Hornet Sportabout             Valiant 
##               FALSE               FALSE               FALSE 
##          Duster 360           Merc 240D            Merc 230 
##                TRUE                TRUE                TRUE 
##            Merc 280           Merc 280C          Merc 450SE 
##               FALSE               FALSE               FALSE 
##          Merc 450SL         Merc 450SLC  Cadillac Fleetwood 
##               FALSE               FALSE               FALSE 
## Lincoln Continental   Chrysler Imperial            Fiat 128 
##               FALSE               FALSE                TRUE 
##         Honda Civic      Toyota Corolla       Toyota Corona 
##               FALSE               FALSE               FALSE 
##    Dodge Challenger         AMC Javelin          Camaro Z28 
##               FALSE               FALSE                TRUE 
##    Pontiac Firebird           Fiat X1-9       Porsche 914-2 
##               FALSE               FALSE               FALSE 
##        Lotus Europa      Ford Pantera L        Ferrari Dino 
##               FALSE                TRUE               FALSE 
##       Maserati Bora          Volvo 142E 
##                TRUE               FALSE
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
</code></pre></div>
<h3 id="univariate-normality">Univariate normality<a class="headerlink" href="#univariate-normality" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Q-Q plot</span>
<span class="nf">qqnorm</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span>
<span class="nf">qqline</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span>
</code></pre></div>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Notes/unnamed-chunk-80-1.png" /></center></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Shapiro-Wilk test of normality</span>
<span class="nf">shapiro.test</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  Shapiro-Wilk normality test
## 
## data:  mtcars$mpg
## W = 0.9, p-value = 0.1
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">nortest</span><span class="p">)</span>

<span class="c1"># Anderson-Darling test for normality</span>
<span class="nf">ad.test</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  Anderson-Darling normality test
## 
## data:  mtcars$mpg
## A = 0.6, p-value = 0.1
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Cramer-von Mises test for normality</span>
<span class="nf">cvm.test</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  Cramer-von Mises normality test
## 
## data:  mtcars$mpg
## W = 0.09, p-value = 0.2
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Lilliefors (Kolmogorov-Smirnov) test for normality</span>
<span class="nf">lillie.test</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  mtcars$mpg
## D = 0.1, p-value = 0.2
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Pearson chi-square test for normality</span>
<span class="nf">pearson.test</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  Pearson chi-square normality test
## 
## data:  mtcars$mpg
## P = 8, p-value = 0.2
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Shapiro-Francia test for normality</span>
<span class="nf">sf.test</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  Shapiro-Francia normality test
## 
## data:  mtcars$mpg
## W = 1, p-value = 0.1
</code></pre></div>
</td></tr></table>
<h3 id="multivariate-normality">Multivariate normality<a class="headerlink" href="#multivariate-normality" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nf">head</span><span class="p">(</span><span class="n">EuStockMarkets</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##       DAX  SMI  CAC FTSE
## [1,] 1629 1678 1773 2444
## [2,] 1614 1688 1750 2460
## [3,] 1607 1679 1718 2448
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">mvnormtest</span><span class="p">)</span>

<span class="c1"># Shapiro-Wilk test for multivariate normality of numeric matrix</span>
<span class="nf">mshapiro.test</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">EuStockMarkets</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  Shapiro-Wilk normality test
## 
## data:  Z
## W = 0.9, p-value &lt;2e-16
</code></pre></div>
</td></tr></table>
<p>With a p x 1 multivariate normal random vector x vector, the squared Mahalanobis distance between x and ?? is going to be chi-square distributed with p degrees of freedom.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># graphical assessment of multivariate normality</span>
<span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">as.matrix</span><span class="p">(</span><span class="n">EuStockMarkets</span><span class="p">)</span> <span class="c1"># n x p numeric matrix</span>
<span class="n">center</span> <span class="o">&lt;-</span> <span class="nf">colMeans</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1"># centroid</span>
<span class="n">n</span> <span class="o">&lt;-</span> <span class="nf">nrow</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="n">p</span> <span class="o">&lt;-</span> <span class="nf">ncol</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">cov</span> <span class="o">&lt;-</span> <span class="nf">cov</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span> <span class="o">&lt;-</span> <span class="nf">mahalanobis</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">cov</span><span class="p">)</span> <span class="c1"># distances</span>

<span class="nf">qqplot</span><span class="p">(</span><span class="nf">qchisq</span><span class="p">(</span><span class="nf">ppoints</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">df</span> <span class="o">=</span> <span class="n">p</span><span class="p">),</span> <span class="n">d</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;QQ Plot Assessing Multivariate Normality&quot;</span><span class="p">,</span> <span class="n">ylab</span> <span class="o">=</span> <span class="s">&quot;Mahalanobis D2&quot;</span><span class="p">)</span>
<span class="nf">abline</span><span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span> 
</code></pre></div>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Notes/unnamed-chunk-84-1.png" /></center></p>
<h3 id="heteroscedasticity_1">Heteroscedasticity<a class="headerlink" href="#heteroscedasticity_1" title="Permanent link">&para;</a></h3>
<p>Nonconstant error variance or non-homogeneity of variances.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##                mpg cyl disp  hp drat   wt qsec vs am gear carb
## Mazda RX4     21.0   6  160 110 3.90 2.62 16.5  0  1    4    4
## Mazda RX4 Wag 21.0   6  160 110 3.90 2.88 17.0  0  1    4    4
## Datsun 710    22.8   4  108  93 3.85 2.32 18.6  1  1    4    1
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># y is a numeric variable and G is the grouping variable</span>
<span class="c1"># Bartlett parametric test of homogeneity of variances</span>
<span class="nf">bartlett.test</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="n">cyl</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## </span>
<span class="c1">##  Bartlett test of homogeneity of variances</span>
<span class="c1">## </span>
<span class="c1">## data:  mpg by cyl</span>
<span class="c1">## Bartlett&#39;s K-squared = 8, df = 2, p-value = 0.02</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Figner-Killeen non-parametric test of homogeneity of variances</span>
<span class="nf">fligner.test</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="n">cyl</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">)</span> 
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## </span>
<span class="c1">##  Fligner-Killeen test of homogeneity of variances</span>
<span class="c1">## </span>
<span class="c1">## data:  mpg by cyl</span>
<span class="c1">## Fligner-Killeen:med chi-squared = 7, df = 2, p-value = 0.03</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">HH</span><span class="p">)</span>

<span class="c1"># y is numeric and G is a grouping factor</span>
<span class="c1"># G must be of type factor</span>
<span class="nf">hov</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="nf">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## </span>
<span class="c1">##  hov: Brown-Forsyth</span>
<span class="c1">## </span>
<span class="c1">## data:  mpg</span>
<span class="c1">## F = 6, df:factor(cyl) = 2, df:Residuals = 30, p-value = 0.009</span>
<span class="c1">## alternative hypothesis: variances are not identical</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># homogeneity of variance plot</span>
<span class="c1"># graphic test of homogeneity of variances based on Brown-Forsyth</span>
<span class="nf">hovPlot</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="nf">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">)</span> 
</code></pre></div>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Notes/unnamed-chunk-87-1.png" /></center></p>
<p><strong>Non-homogeneity of covariance matrices</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">biotools</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## ---</span>
<span class="c1">## biotools version 3.0</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Box&#39;s M test</span>
<span class="c1"># very sensitive to violations of normality, leading to rejection in most typical cases</span>
<span class="nf">boxM</span><span class="p">(</span><span class="n">iris</span><span class="p">[,</span> <span class="m">-5</span><span class="p">],</span> <span class="n">iris</span><span class="p">[,</span> <span class="m">5</span><span class="p">])</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## </span>
<span class="c1">##  Box&#39;s M-test for Homogeneity of Covariance Matrices</span>
<span class="c1">## </span>
<span class="c1">## data:  iris[, -5]</span>
<span class="c1">## Chi-Sq (approx.) = 100, df = 20, p-value &lt;2e-16</span>
</code></pre></div>
</td></tr></table>
<h2 id="resampling-statistics">Resampling Statistics<a class="headerlink" href="#resampling-statistics" title="Permanent link">&para;</a></h2>
<h3 id="independent-k-sample-location-tests">Independent k-sample location tests<a class="headerlink" href="#independent-k-sample-location-tests" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##                mpg cyl disp  hp drat   wt qsec vs am gear carb
## Mazda RX4     21.0   6  160 110 3.90 2.62 16.5  0  1    4    4
## Mazda RX4 Wag 21.0   6  160 110 3.90 2.88 17.0  0  1    4    4
## Datsun 710    22.8   4  108  93 3.85 2.32 18.6  1  1    4    1
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># exact Wilcoxon Mann Whitney rank sum test</span>
<span class="c1"># re-randomization or permutation based statistical tests</span>
<span class="c1"># where y is numeric and A is a binary factor</span>
<span class="nf">library</span><span class="p">(</span><span class="n">coin</span><span class="p">)</span>

<span class="nf">wilcox_test</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="nf">factor</span><span class="p">(</span><span class="n">am</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">,</span> <span class="n">distribution</span> <span class="o">=</span> <span class="s">&quot;exact&quot;</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  Exact Wilcoxon-Mann-Whitney Test
## 
## data:  mpg by factor(am) (0, 1)
## Z = -3, p-value = 0.001
## alternative hypothesis: true mu is not equal to 0
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># lower case letters represent numerical variables and upper case letters represent categorical factors</span>
</code></pre></div>
<ul>
<li>Monte-Carlo simulations are available for all tests. Exact tests are available for 2 group procedures.</li>
<li>These tests do not assume random sampling from well-defined populations. They can be a reasonable alternative to     classical procedures when test assumptions can not be met.</li>
</ul>
<!-- -->

<div class="highlight"><pre><span></span><code><span class="c1"># one-way permutation test based on 9999 Monte-Carlo</span>
<span class="c1"># resamplings</span>
<span class="c1"># y is numeric and A is a categorical factor</span>
<span class="nf">library</span><span class="p">(</span><span class="n">coin</span><span class="p">)</span>

<span class="nf">oneway_test</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="nf">factor</span><span class="p">(</span><span class="n">am</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">,</span> <span class="n">distribution</span> <span class="o">=</span> <span class="nf">approximate</span><span class="p">(</span><span class="n">B</span> <span class="o">=</span> <span class="m">9999</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  Approximative Two-Sample Fisher-Pitman Permutation Test
## 
## data:  mpg by factor(am) (0, 1)
## Z = -3, p-value = 5e-04
## alternative hypothesis: true mu is not equal to 0
</code></pre></div>
</td></tr></table>
<h3 id="symmetry-of-a-response-for-repeated-measurements">Symmetry of a response for repeated measurements<a class="headerlink" href="#symmetry-of-a-response-for-repeated-measurements" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># exact Wilcoxon signed rank test</span>
<span class="c1"># where y1 and y2 are repeated measures</span>
<span class="nf">library</span><span class="p">(</span><span class="n">coin</span><span class="p">)</span>

<span class="nf">wilcoxsign_test</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="nf">factor</span><span class="p">(</span><span class="n">am</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">,</span> <span class="n">distribution</span> <span class="o">=</span> <span class="s">&quot;exact&quot;</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  Exact Wilcoxon-Pratt Signed-Rank Test
## 
## data:  y by x (pos, neg) 
##   stratified by block
## Z = 5, p-value = 5e-10
## alternative hypothesis: true mu is not equal to 0
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Freidman Test based on 9999 Monte-Carlo resamplings.</span>
<span class="c1"># y is numeric, A is a grouping factor, and B is a</span>
<span class="c1"># blocking factor</span>
<span class="nf">friedman_test</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">A</span> <span class="o">|</span> <span class="n">B</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mydata</span><span class="p">,</span>  <span class="n">distribution</span> <span class="o">=</span> <span class="nf">approximate</span><span class="p">(</span><span class="n">B</span> <span class="o">=</span> <span class="m">9999</span><span class="p">))</span>
</code></pre></div>
<h3 id="independence-of-two-numeric-variables">Independence of two numeric variables<a class="headerlink" href="#independence-of-two-numeric-variables" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Spearman Test of independence based on 9999 Monte-Carlo</span>
<span class="c1"># resamplings. x and y are numeric variables</span>
<span class="nf">library</span><span class="p">(</span><span class="n">coin</span><span class="p">)</span>

<span class="nf">spearman_test</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="n">am</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">,</span> <span class="n">distribution</span> <span class="o">=</span> <span class="nf">approximate</span><span class="p">(</span><span class="n">B</span> <span class="o">=</span> <span class="m">9999</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  Approximative Spearman Correlation Test
## 
## data:  mpg by am
## Z = 3, p-value = 0.001
## alternative hypothesis: true rho is not equal to 0
</code></pre></div>
</td></tr></table>
<h3 id="independence-in-contingency-tables">Independence in contingency tables<a class="headerlink" href="#independence-in-contingency-tables" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">CO2</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## Grouped Data: uptake ~ conc | Plant
##   Plant   Type  Treatment conc uptake
## 1   Qn1 Quebec nonchilled   95   16.0
## 2   Qn1 Quebec nonchilled  175   30.4
## 3   Qn1 Quebec nonchilled  250   34.8
## 4   Qn1 Quebec nonchilled  350   37.2
## 5   Qn1 Quebec nonchilled  500   35.3
## 6   Qn1 Quebec nonchilled  675   39.2
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="n">cases</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">59</span><span class="p">)</span>
<span class="n">n</span> <span class="o">&lt;-</span> <span class="nf">sum</span><span class="p">(</span><span class="n">cases</span><span class="p">)</span>
<span class="n">cochran</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span>
    <span class="n">diphtheria</span> <span class="o">=</span> <span class="nf">factor</span><span class="p">(</span>
        <span class="nf">unlist</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span>
                        <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span>
                        <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span>
                        <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span>
                        <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">)),</span>
                   <span class="n">cases</span><span class="p">))</span>
    <span class="p">),</span>
    <span class="n">media</span> <span class="o">=</span> <span class="nf">factor</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="kc">LETTERS</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span> <span class="n">n</span><span class="p">)),</span>
    <span class="n">case</span> <span class="o">=</span>  <span class="nf">factor</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="nf">seq_len</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">each</span> <span class="o">=</span> <span class="m">4</span><span class="p">))</span>
<span class="p">)</span>

<span class="nf">head</span><span class="p">(</span><span class="n">cochran</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##   diphtheria media case
## 1          1     A    1
## 2          1     B    1
## 3          1     C    1
## 4          1     D    1
## 5          1     A    2
## 6          1     B    2
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># independence in 2-way contingency table based on</span>
<span class="c1"># 9999 Monte-Carlo resamplings. A and B are factors</span>
<span class="nf">library</span><span class="p">(</span><span class="n">coin</span><span class="p">)</span>

<span class="nf">chisq_test</span><span class="p">(</span><span class="n">Plant</span> <span class="o">~</span> <span class="n">Type</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">,</span> <span class="n">distribution</span> <span class="o">=</span> <span class="nf">approximate</span><span class="p">(</span><span class="n">B</span> <span class="o">=</span> <span class="m">9999</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  Approximative Linear-by-Linear Association Test
## 
## data:  Plant (ordered) by Type (Quebec, Mississippi)
## Z = -8, p-value &lt;2e-16
## alternative hypothesis: two.sided
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Cochran-Mantel-Haenzsel Test of 3-way Contingency Table</span>
<span class="c1"># based on 9999 Monte-Carlo resamplings. A, B, are factors</span>
<span class="c1"># and C is a stratefying factor</span>
<span class="nf">mh_test</span><span class="p">(</span><span class="n">diphtheria</span> <span class="o">~</span> <span class="n">media</span> <span class="o">|</span> <span class="n">case</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">cochran</span><span class="p">,</span> <span class="n">distribution</span> <span class="o">=</span> <span class="nf">approximate</span><span class="p">(</span><span class="n">B</span> <span class="o">=</span> <span class="m">9999</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  Approximative Marginal Homogeneity Test
## 
## data:  diphtheria by
##   media (A, B, C, D) 
##   stratified by case
## chi-squared = 8, p-value = 0.05
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># linear by linear association test based on 9999</span>
<span class="c1"># Monte-Carlo resamplings</span>
<span class="c1"># A and B are ordered factors</span>
<span class="nf">library</span><span class="p">(</span><span class="n">coin</span><span class="p">)</span>

<span class="nf">lbl_test</span><span class="p">(</span><span class="n">Plant</span> <span class="o">~</span> <span class="n">Type</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">,</span> <span class="n">distribution</span> <span class="o">=</span> <span class="nf">approximate</span><span class="p">(</span><span class="n">B</span> <span class="o">=</span> <span class="m">9999</span><span class="p">))</span> 
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  Approximative Linear-by-Linear Association Test
## 
## data:  Plant (ordered) by Type (Quebec, Mississippi)
## Z = -8, p-value &lt;2e-16
## alternative hypothesis: two.sided
</code></pre></div>
</td></tr></table>
<p>Many other univariate and multivariate tests are possible using the functions in the <code>coin</code> package.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../a_hands-on_introduction_to_statistics_with_r_course_seven_moderation_and_mediation/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Statistics with R, Course Seven, Moderation and Mediation" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Statistics with R, Course Seven, Moderation and Mediation
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.f8263e09.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.4fc53ad4.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>