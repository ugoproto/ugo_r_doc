



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="A R documentation website.">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.2">
    
    
      
        <title>Statistics with R, Notes - ugo_r_doc</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.30686662.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../extra.css">
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-93008985-1", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#descriptive-statistics" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="ugo_r_doc" class="md-header-nav__button md-logo">
          
            <i class="md-icon">layers</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              ugo_r_doc
            </span>
            <span class="md-header-nav__topic">
              
                Statistics with R, Notes
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/ugoproto/ugo_r_doc.git/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ugo_r_doc
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="ugo_r_doc" class="md-nav__button md-logo">
      
        <i class="md-icon">layers</i>
      
    </a>
    ugo_r_doc
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/ugoproto/ugo_r_doc.git/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ugo_r_doc
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Cheat Sheets
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Cheat Sheets
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basics_cs/" title="Basics Cheat Sheets" class="md-nav__link">
      Basics Cheat Sheets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../specializations_cs/" title="Specialization Cheat Sheets" class="md-nav__link">
      Specialization Cheat Sheets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../visualization_cs/" title="Visualization Cheat Sheets" class="md-nav__link">
      Visualization Cheat Sheets
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Code and Vade Mecum
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Code and Vade Mecum
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../frequentist_bayesian/" title="Frequentist vs. Bayesian" class="md-nav__link">
      Frequentist vs. Bayesian
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../intermediate_r/" title="Intermediate R" class="md-nav__link">
      Intermediate R
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../intermediate_r_the_apply_family/" title="Intermediate R - The apply Family" class="md-nav__link">
      Intermediate R - The apply Family
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Data Wrangling Snippets
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Data Wrangling Snippets
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../io_snippets_cleaning/" title="I/O Snippets & Cleaning" class="md-nav__link">
      I/O Snippets & Cleaning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../reading_data_into_r_with_readr/" title="Reading Data into R with readr" class="md-nav__link">
      Reading Data into R with readr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data_analysis_in_r_the_data_table_way/" title="Data Analysis in R, the data.table Way" class="md-nav__link">
      Data Analysis in R, the data.table Way
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data_manipulation_in_r_with_dplyr/" title="Data Manipulation in R with dplyr" class="md-nav__link">
      Data Manipulation in R with dplyr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data_wrangling/" title="Data Wrangling" class="md-nav__link">
      Data Wrangling
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Packages
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Packages
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../googlevis/" title="googleVis (embed HTML plots)" class="md-nav__link">
      googleVis (embed HTML plots)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gganimate/" title="gganimate" class="md-nav__link">
      gganimate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fast_and_frugal_decision_trees_in_r_with_fftrees/" title="Fast-and-Frugal Decision Trees" class="md-nav__link">
      Fast-and-Frugal Decision Trees
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../big_data_analysis_with_revolution_r_enterprise/" title="Big Data Analysis with Revolution R Enterprise" class="md-nav__link">
      Big Data Analysis with Revolution R Enterprise
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../time_series_in_r_the_power_of_xts_and_zoo/" title="Time Series in R, The Power of xts and zoo" class="md-nav__link">
      Time Series in R, The Power of xts and zoo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Plot Snippets
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Plot Snippets
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../plot_snippets_basics/" title="Plot Snippets for Exploratory (and some Explanatory) Analyses" class="md-nav__link">
      Plot Snippets for Exploratory (and some Explanatory) Analyses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../plot_snippets_ggplot2/" title="Plot Snippets - ggplot2" class="md-nav__link">
      Plot Snippets - ggplot2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../plot_snippets_ggvis/" title="Plot Snippets - ggvis" class="md-nav__link">
      Plot Snippets - ggvis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../plot_snippets_colours/" title="Plot Snippets - Colours" class="md-nav__link">
      Plot Snippets - Colours
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      RStudio
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        RStudio
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../working_with_rstudio_ide/" title="Working with the RStudio IDE" class="md-nav__link">
      Working with the RStudio IDE
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Tables and Figures
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Tables and Figures
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../tables/" title="Tables" class="md-nav__link">
      Tables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../embedding/" title="Embedding HTML into HTML" class="md-nav__link">
      Embedding HTML into HTML
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../embedding_2/" title="Embedding Rmd into Rmd" class="md-nav__link">
      Embedding Rmd into Rmd
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9" checked>
    
    <label class="md-nav__link" for="nav-9">
      A Hands-on Introduction to Statistics with R
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        A Hands-on Introduction to Statistics with R
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../a_hands-on_introduction_to_statistics_with_r_course_one_introduction/" title="Statistics with R, Course One, Introduction" class="md-nav__link">
      Statistics with R, Course One, Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../a_hands-on_introduction_to_statistics_with_r_course_two_student_s_t-test/" title="Statistics with R, Course Two, Student's t-test" class="md-nav__link">
      Statistics with R, Course Two, Student's t-test
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../a_hands-on_introduction_to_statistics_with_r_course_three_analysis_of_variance/" title="Statistics with R, Course Three, Analysis of Variance" class="md-nav__link">
      Statistics with R, Course Three, Analysis of Variance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../a_hands-on_introduction_to_statistics_with_r_course_four_repeated_measures_anova/" title="Statistics with R, Course Four, Repeated Measures ANOVA" class="md-nav__link">
      Statistics with R, Course Four, Repeated Measures ANOVA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../a_hands-on_introduction_to_statistics_with_r_course_five_correlation_and_regression/" title="Statistics with R, Course Five, Correlation and Regression" class="md-nav__link">
      Statistics with R, Course Five, Correlation and Regression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../a_hands-on_introduction_to_statistics_with_r_course_six_multiple_regression/" title="Statistics with R, Course Six, Multiple Regression" class="md-nav__link">
      Statistics with R, Course Six, Multiple Regression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../a_hands-on_introduction_to_statistics_with_r_course_seven_moderation_and_mediation/" title="Statistics with R, Course Seven, Moderation and Mediation" class="md-nav__link">
      Statistics with R, Course Seven, Moderation and Mediation
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Statistics with R, Notes
      </label>
    
    <a href="./" title="Statistics with R, Notes" class="md-nav__link md-nav__link--active">
      Statistics with R, Notes
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#descriptive-statistics" class="md-nav__link">
    Descriptive Statistics
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#group-data" class="md-nav__link">
    Group data
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frequency-tables-crosstables-and-independence" class="md-nav__link">
    Frequency Tables, CrossTables, and Independence
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2d-frequency-tables" class="md-nav__link">
    2D frequency tables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3d-frequency-tables" class="md-nav__link">
    3D frequency tables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crosstable" class="md-nav__link">
    CrossTable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tests-of-independence" class="md-nav__link">
    Tests of independence
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#measures-of-association" class="md-nav__link">
    Measures of association
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#correlations" class="md-nav__link">
    Correlations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#t-tests" class="md-nav__link">
    t-tests
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nonparametric-statistics" class="md-nav__link">
    Nonparametric statistics
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bivariate-tests" class="md-nav__link">
    Bivariate tests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anova" class="md-nav__link">
    ANOVA
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multiple-regressions" class="md-nav__link">
    Multiple Regressions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fitting-the-model" class="md-nav__link">
    Fitting the Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#diagnostic-plots" class="md-nav__link">
    Diagnostic plots
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comparing-two-models-with-anova" class="md-nav__link">
    Comparing two models with ANOVA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cross-validation" class="md-nav__link">
    Cross validation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variable-selection-heuristic-methods" class="md-nav__link">
    Variable selection -- Heuristic methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variable-selection-graphical-methods" class="md-nav__link">
    Variable selection -- Graphical methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variable-selection-relative-importance" class="md-nav__link">
    Variable selection -- Relative importance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#going-further" class="md-nav__link">
    Going further
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regression-diagnostics" class="md-nav__link">
    Regression diagnostics
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outliers" class="md-nav__link">
    Outliers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#influential-observations" class="md-nav__link">
    Influential observations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nonnormality" class="md-nav__link">
    Nonnormality
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heteroscedasticity" class="md-nav__link">
    Heteroscedasticity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multicollinearity" class="md-nav__link">
    Multicollinearity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nonlinearity" class="md-nav__link">
    Nonlinearity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autocorrelation" class="md-nav__link">
    Autocorrelation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#global-diagnostic" class="md-nav__link">
    Global diagnostic
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#anova_1" class="md-nav__link">
    ANOVA
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evaluate-model-effects" class="md-nav__link">
    Evaluate model effects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compare-nested-models-directly" class="md-nav__link">
    Compare nested models directly
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-comparisons" class="md-nav__link">
    Multiple comparisons
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualizing-results" class="md-nav__link">
    Visualizing results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manova" class="md-nav__link">
    MANOVA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#going-further_1" class="md-nav__link">
    Going further
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manova-assumptions" class="md-nav__link">
    (M)ANOVA Assumptions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outliers_1" class="md-nav__link">
    Outliers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#univariate-normality" class="md-nav__link">
    Univariate normality
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multivariate-normality" class="md-nav__link">
    Multivariate normality
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heteroscedasticity_1" class="md-nav__link">
    Heteroscedasticity
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resampling-statistics" class="md-nav__link">
    Resampling Statistics
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#independent-k-sample-location-tests" class="md-nav__link">
    Independent k-sample location tests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#symmetry-of-a-response-for-repeated-measurements" class="md-nav__link">
    Symmetry of a response for repeated measurements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#independence-of-two-numeric-variables" class="md-nav__link">
    Independence of two numeric variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#independence-in-contingency-tables" class="md-nav__link">
    Independence in contingency tables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#descriptive-statistics" class="md-nav__link">
    Descriptive Statistics
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#group-data" class="md-nav__link">
    Group data
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frequency-tables-crosstables-and-independence" class="md-nav__link">
    Frequency Tables, CrossTables, and Independence
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2d-frequency-tables" class="md-nav__link">
    2D frequency tables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3d-frequency-tables" class="md-nav__link">
    3D frequency tables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crosstable" class="md-nav__link">
    CrossTable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tests-of-independence" class="md-nav__link">
    Tests of independence
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#measures-of-association" class="md-nav__link">
    Measures of association
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#correlations" class="md-nav__link">
    Correlations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#t-tests" class="md-nav__link">
    t-tests
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nonparametric-statistics" class="md-nav__link">
    Nonparametric statistics
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bivariate-tests" class="md-nav__link">
    Bivariate tests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anova" class="md-nav__link">
    ANOVA
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multiple-regressions" class="md-nav__link">
    Multiple Regressions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fitting-the-model" class="md-nav__link">
    Fitting the Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#diagnostic-plots" class="md-nav__link">
    Diagnostic plots
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comparing-two-models-with-anova" class="md-nav__link">
    Comparing two models with ANOVA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cross-validation" class="md-nav__link">
    Cross validation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variable-selection-heuristic-methods" class="md-nav__link">
    Variable selection -- Heuristic methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variable-selection-graphical-methods" class="md-nav__link">
    Variable selection -- Graphical methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variable-selection-relative-importance" class="md-nav__link">
    Variable selection -- Relative importance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#going-further" class="md-nav__link">
    Going further
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regression-diagnostics" class="md-nav__link">
    Regression diagnostics
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outliers" class="md-nav__link">
    Outliers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#influential-observations" class="md-nav__link">
    Influential observations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nonnormality" class="md-nav__link">
    Nonnormality
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heteroscedasticity" class="md-nav__link">
    Heteroscedasticity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multicollinearity" class="md-nav__link">
    Multicollinearity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nonlinearity" class="md-nav__link">
    Nonlinearity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autocorrelation" class="md-nav__link">
    Autocorrelation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#global-diagnostic" class="md-nav__link">
    Global diagnostic
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#anova_1" class="md-nav__link">
    ANOVA
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evaluate-model-effects" class="md-nav__link">
    Evaluate model effects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compare-nested-models-directly" class="md-nav__link">
    Compare nested models directly
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-comparisons" class="md-nav__link">
    Multiple comparisons
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualizing-results" class="md-nav__link">
    Visualizing results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manova" class="md-nav__link">
    MANOVA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#going-further_1" class="md-nav__link">
    Going further
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manova-assumptions" class="md-nav__link">
    (M)ANOVA Assumptions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outliers_1" class="md-nav__link">
    Outliers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#univariate-normality" class="md-nav__link">
    Univariate normality
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multivariate-normality" class="md-nav__link">
    Multivariate normality
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heteroscedasticity_1" class="md-nav__link">
    Heteroscedasticity
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resampling-statistics" class="md-nav__link">
    Resampling Statistics
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#independent-k-sample-location-tests" class="md-nav__link">
    Independent k-sample location tests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#symmetry-of-a-response-for-repeated-measurements" class="md-nav__link">
    Symmetry of a response for repeated measurements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#independence-of-two-numeric-variables" class="md-nav__link">
    Independence of two numeric variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#independence-in-contingency-tables" class="md-nav__link">
    Independence in contingency tables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ugoproto/ugo_r_doc.git/edit/master/docs/a_hands-on_introduction_to_statistics_with_r_notes.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Statistics with R, Notes</h1>
                
                <!--
-   [1, Descriptive Statistics](#descriptive-statistics)
    -   [Group data](#group-data)
-   [2, Frequency Tables, CrossTables, and
    Independence](#frequency-tables-crosstables-and-independence)
    -   [2D frequency tables](#d-frequency-tables)
    -   [3D frequency tables](#d-frequency-tables-1)
    -   [CrossTable](#crosstable)
    -   [Tests of independence](#tests-of-independence)
    -   [Measures of association](#measures-of-association)
-   [3, Correlations](#correlations)
-   [4, t-tests](#t-tests)
-   [5, Nonparametric statistics](#nonparametric-statistics)
    -   [Bivariate tests](#bivariate-tests)
    -   [ANOVA](#anova)
-   [6, Multiple Regressions](#multiple-regressions)
    -   [Fitting the Model](#fitting-the-model)
    -   [Diagnostic plots](#diagnostic-plots)
    -   [Comparing two models with ANOVA](#comparing-two-models-with-anova)
    -   [Cross validation](#cross-validation)
    -   [Variable selection -- Heuristic methods](#variable-selection----heuristic-methods)
    -   [Variable selection -- Graphical methods](#variable-selection----graphical-methods)
    -   [Variable selection -- Relative importance](#variable-selection----relative-importance)
    -   [Going further](#going-further)
-   [7, Regression diagnostics](#regression-diagnostics)
    -   [Outliers](#outliers)
    -   [Influential observations](#influential-observations)
    -   [Nonnormality](#nonnormality)
    -   [Heteroscedasticity](#heteroscedasticity)
    -   [Multicollinearity](#multicollinearity)
    -   [Nonlinearity](#nonlinearity)
    -   [Autocorrelation](#autocorrelation)
    -   [Global diagnostic](#global-diagnostic)
-   [8, ANOVA](#anova-1)
    -   [Evaluate model effects](#evaluate-model-effects)
    -   [Compare nested models directly](#compare-nested-models-directly)
    -   [Multiple comparisons](#multiple-comparisons)
    -   [Visualizing results](#visualizing-results)
    -   [MANOVA](#manova)
    -   [Going further](#going-further-1)
-   [9, (M)ANOVA Assumptions](#manova-assumptions)
    -   [Outliers](#outliers-1)
    -   [Univariate normality](#univariate-normality)
    -   [Multivariate normality](#multivariate-normality)
    -   [Heteroscedasticity](#heteroscedasticity-1)
-   [10, Resampling Statistics](#resampling-statistics)
    -   [Independent k-sample location tests](#independent-k-sample-location-tests)
    -   [Symmetry of a response for repeated measurements](#symmetry-of-a-response-for-repeated-measurements)
    -   [Independence of two numeric variables](#independence-of-two-numeric-variables)
    -   [Independence in contingency tables](#independence-in-contingency-tables)
-->

<hr />
<p><strong>Foreword</strong></p>
<ul>
<li>Output options: the &lsquo;tango&rsquo; syntax and the &lsquo;readable&rsquo; theme.</li>
<li>Codes and snippets.</li>
</ul>
<hr />
<h2 id="descriptive-statistics">Descriptive Statistics<a class="headerlink" href="#descriptive-statistics" title="Permanent link">&para;</a></h2>
<p>Extract basic, exploratory statistics from datasets with <code class="codehilite"><span class="n">apply</span></code>, <code class="codehilite"><span class="n">summary</span></code>, <code class="codehilite"><span class="n">fivenum</span></code>, <code class="codehilite"><span class="k">describe</span></code>, and <code class="codehilite"><span class="n">stat</span><span class="p">.</span><span class="k">desc</span></code>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">longley</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>      <span class="n">GNP</span><span class="p">.</span><span class="n">deflator</span>     <span class="n">GNP</span> <span class="n">Unemployed</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span> <span class="n">Population</span> <span class="k">Year</span> <span class="n">Employed</span>
<span class="o">##</span> <span class="mi">1947</span>         <span class="mi">83</span><span class="p">.</span><span class="mi">0</span> <span class="mi">234</span><span class="p">.</span><span class="mi">289</span>      <span class="mi">235</span><span class="p">.</span><span class="mi">6</span>        <span class="mi">159</span><span class="p">.</span><span class="mi">0</span>    <span class="mi">107</span><span class="p">.</span><span class="mi">608</span> <span class="mi">1947</span>   <span class="mi">60</span><span class="p">.</span><span class="mi">323</span>
<span class="o">##</span> <span class="mi">1948</span>         <span class="mi">88</span><span class="p">.</span><span class="mi">5</span> <span class="mi">259</span><span class="p">.</span><span class="mi">426</span>      <span class="mi">232</span><span class="p">.</span><span class="mi">5</span>        <span class="mi">145</span><span class="p">.</span><span class="mi">6</span>    <span class="mi">108</span><span class="p">.</span><span class="mi">632</span> <span class="mi">1948</span>   <span class="mi">61</span><span class="p">.</span><span class="mi">122</span>
<span class="o">##</span> <span class="mi">1949</span>         <span class="mi">88</span><span class="p">.</span><span class="mi">2</span> <span class="mi">258</span><span class="p">.</span><span class="mi">054</span>      <span class="mi">368</span><span class="p">.</span><span class="mi">2</span>        <span class="mi">161</span><span class="p">.</span><span class="mi">6</span>    <span class="mi">109</span><span class="p">.</span><span class="mi">773</span> <span class="mi">1949</span>   <span class="mi">60</span><span class="p">.</span><span class="mi">171</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># apply a function</span>
<span class="c1"># excluding missing values</span>
<span class="nf">sapply</span><span class="p">(</span><span class="n">longley</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> 
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="n">GNP</span><span class="p">.</span><span class="n">deflator</span>          <span class="n">GNP</span>   <span class="n">Unemployed</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span>   <span class="n">Population</span> 
<span class="o">##</span>     <span class="mi">101</span><span class="p">.</span><span class="mi">6813</span>     <span class="mi">387</span><span class="p">.</span><span class="mi">6984</span>     <span class="mi">319</span><span class="p">.</span><span class="mi">3313</span>     <span class="mi">260</span><span class="p">.</span><span class="mi">6687</span>     <span class="mi">117</span><span class="p">.</span><span class="mi">4240</span> 
<span class="o">##</span>         <span class="k">Year</span>     <span class="n">Employed</span> 
<span class="o">##</span>    <span class="mi">1954</span><span class="p">.</span><span class="mi">5000</span>      <span class="mi">65</span><span class="p">.</span><span class="mi">3170</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># mean, median, 25th and 75th quartiles, min, max</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">longley</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>   <span class="n">GNP</span><span class="p">.</span><span class="n">deflator</span>         <span class="n">GNP</span>          <span class="n">Unemployed</span>     <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span>  
<span class="o">##</span>  <span class="k">Min</span><span class="p">.</span>   <span class="p">:</span> <span class="mi">83</span><span class="p">.</span><span class="mi">00</span>   <span class="k">Min</span><span class="p">.</span>   <span class="p">:</span><span class="mi">234</span><span class="p">.</span><span class="mi">3</span>   <span class="k">Min</span><span class="p">.</span>   <span class="p">:</span><span class="mi">187</span><span class="p">.</span><span class="mi">0</span>   <span class="k">Min</span><span class="p">.</span>   <span class="p">:</span><span class="mi">145</span><span class="p">.</span><span class="mi">6</span>  
<span class="o">##</span>  <span class="mi">1</span><span class="n">st</span> <span class="n">Qu</span><span class="p">.:</span> <span class="mi">94</span><span class="p">.</span><span class="mi">53</span>   <span class="mi">1</span><span class="n">st</span> <span class="n">Qu</span><span class="p">.:</span><span class="mi">317</span><span class="p">.</span><span class="mi">9</span>   <span class="mi">1</span><span class="n">st</span> <span class="n">Qu</span><span class="p">.:</span><span class="mi">234</span><span class="p">.</span><span class="mi">8</span>   <span class="mi">1</span><span class="n">st</span> <span class="n">Qu</span><span class="p">.:</span><span class="mi">229</span><span class="p">.</span><span class="mi">8</span>  
<span class="o">##</span>  <span class="n">Median</span> <span class="p">:</span><span class="mi">100</span><span class="p">.</span><span class="mi">60</span>   <span class="n">Median</span> <span class="p">:</span><span class="mi">381</span><span class="p">.</span><span class="mi">4</span>   <span class="n">Median</span> <span class="p">:</span><span class="mi">314</span><span class="p">.</span><span class="mi">4</span>   <span class="n">Median</span> <span class="p">:</span><span class="mi">271</span><span class="p">.</span><span class="mi">8</span>  
<span class="o">##</span>  <span class="n">Mean</span>   <span class="p">:</span><span class="mi">101</span><span class="p">.</span><span class="mi">68</span>   <span class="n">Mean</span>   <span class="p">:</span><span class="mi">387</span><span class="p">.</span><span class="mi">7</span>   <span class="n">Mean</span>   <span class="p">:</span><span class="mi">319</span><span class="p">.</span><span class="mi">3</span>   <span class="n">Mean</span>   <span class="p">:</span><span class="mi">260</span><span class="p">.</span><span class="mi">7</span>  
<span class="o">##</span>  <span class="mi">3</span><span class="n">rd</span> <span class="n">Qu</span><span class="p">.:</span><span class="mi">111</span><span class="p">.</span><span class="mi">25</span>   <span class="mi">3</span><span class="n">rd</span> <span class="n">Qu</span><span class="p">.:</span><span class="mi">454</span><span class="p">.</span><span class="mi">1</span>   <span class="mi">3</span><span class="n">rd</span> <span class="n">Qu</span><span class="p">.:</span><span class="mi">384</span><span class="p">.</span><span class="mi">2</span>   <span class="mi">3</span><span class="n">rd</span> <span class="n">Qu</span><span class="p">.:</span><span class="mi">306</span><span class="p">.</span><span class="mi">1</span>  
<span class="o">##</span>  <span class="k">Max</span><span class="p">.</span>   <span class="p">:</span><span class="mi">116</span><span class="p">.</span><span class="mi">90</span>   <span class="k">Max</span><span class="p">.</span>   <span class="p">:</span><span class="mi">554</span><span class="p">.</span><span class="mi">9</span>   <span class="k">Max</span><span class="p">.</span>   <span class="p">:</span><span class="mi">480</span><span class="p">.</span><span class="mi">6</span>   <span class="k">Max</span><span class="p">.</span>   <span class="p">:</span><span class="mi">359</span><span class="p">.</span><span class="mi">4</span>  
<span class="o">##</span>    <span class="n">Population</span>         <span class="k">Year</span>         <span class="n">Employed</span>    
<span class="o">##</span>  <span class="k">Min</span><span class="p">.</span>   <span class="p">:</span><span class="mi">107</span><span class="p">.</span><span class="mi">6</span>   <span class="k">Min</span><span class="p">.</span>   <span class="p">:</span><span class="mi">1947</span>   <span class="k">Min</span><span class="p">.</span>   <span class="p">:</span><span class="mi">60</span><span class="p">.</span><span class="mi">17</span>  
<span class="o">##</span>  <span class="mi">1</span><span class="n">st</span> <span class="n">Qu</span><span class="p">.:</span><span class="mi">111</span><span class="p">.</span><span class="mi">8</span>   <span class="mi">1</span><span class="n">st</span> <span class="n">Qu</span><span class="p">.:</span><span class="mi">1951</span>   <span class="mi">1</span><span class="n">st</span> <span class="n">Qu</span><span class="p">.:</span><span class="mi">62</span><span class="p">.</span><span class="mi">71</span>  
<span class="o">##</span>  <span class="n">Median</span> <span class="p">:</span><span class="mi">116</span><span class="p">.</span><span class="mi">8</span>   <span class="n">Median</span> <span class="p">:</span><span class="mi">1954</span>   <span class="n">Median</span> <span class="p">:</span><span class="mi">65</span><span class="p">.</span><span class="mi">50</span>  
<span class="o">##</span>  <span class="n">Mean</span>   <span class="p">:</span><span class="mi">117</span><span class="p">.</span><span class="mi">4</span>   <span class="n">Mean</span>   <span class="p">:</span><span class="mi">1954</span>   <span class="n">Mean</span>   <span class="p">:</span><span class="mi">65</span><span class="p">.</span><span class="mi">32</span>  
<span class="o">##</span>  <span class="mi">3</span><span class="n">rd</span> <span class="n">Qu</span><span class="p">.:</span><span class="mi">122</span><span class="p">.</span><span class="mi">3</span>   <span class="mi">3</span><span class="n">rd</span> <span class="n">Qu</span><span class="p">.:</span><span class="mi">1958</span>   <span class="mi">3</span><span class="n">rd</span> <span class="n">Qu</span><span class="p">.:</span><span class="mi">68</span><span class="p">.</span><span class="mi">29</span>  
<span class="o">##</span>  <span class="k">Max</span><span class="p">.</span>   <span class="p">:</span><span class="mi">130</span><span class="p">.</span><span class="mi">1</span>   <span class="k">Max</span><span class="p">.</span>   <span class="p">:</span><span class="mi">1962</span>   <span class="k">Max</span><span class="p">.</span>   <span class="p">:</span><span class="mi">70</span><span class="p">.</span><span class="mi">55</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Tukey min, lower-hinge, median, upper-hinge, max</span>
<span class="nf">fivenum</span><span class="p">(</span><span class="n">longley</span><span class="o">$</span><span class="n">GNP</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">234</span><span class="p">.</span><span class="mi">289</span> <span class="mi">306</span><span class="p">.</span><span class="mi">787</span> <span class="mi">381</span><span class="p">.</span><span class="mi">427</span> <span class="mi">463</span><span class="p">.</span><span class="mi">625</span> <span class="mi">554</span><span class="p">.</span><span class="mi">894</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># n, nmiss, unique, mean, 5, 10, 25, 50, 75, 90, 95th percentiles</span>
<span class="c1"># 5 lowest and 5 highest scores</span>
<span class="nf">library</span><span class="p">(</span><span class="n">Hmisc</span><span class="p">)</span>

<span class="nf">describe</span><span class="p">(</span><span class="n">longley</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="n">longley</span> 
<span class="o">##</span> 
<span class="o">##</span>  <span class="mi">7</span>  <span class="n">Variables</span>      <span class="mi">16</span>  <span class="n">Observations</span>
<span class="o">##</span> <span class="c1">---------------------------------------------------------------------------</span>
<span class="o">##</span> <span class="n">GNP</span><span class="p">.</span><span class="n">deflator</span> 
<span class="o">##</span>        <span class="n">n</span>  <span class="n">missing</span> <span class="k">distinct</span>     <span class="n">Info</span>     <span class="n">Mean</span>      <span class="n">Gmd</span>      <span class="p">.</span><span class="mi">05</span>      <span class="p">.</span><span class="mi">10</span> 
<span class="o">##</span>       <span class="mi">16</span>        <span class="mi">0</span>       <span class="mi">16</span>        <span class="mi">1</span>    <span class="mi">101</span><span class="p">.</span><span class="mi">7</span>    <span class="mi">12</span><span class="p">.</span><span class="mi">74</span>    <span class="mi">86</span><span class="p">.</span><span class="mi">90</span>    <span class="mi">88</span><span class="p">.</span><span class="mi">35</span> 
<span class="o">##</span>      <span class="p">.</span><span class="mi">25</span>      <span class="p">.</span><span class="mi">50</span>      <span class="p">.</span><span class="mi">75</span>      <span class="p">.</span><span class="mi">90</span>      <span class="p">.</span><span class="mi">95</span> 
<span class="o">##</span>    <span class="mi">94</span><span class="p">.</span><span class="mi">53</span>   <span class="mi">100</span><span class="p">.</span><span class="mi">60</span>   <span class="mi">111</span><span class="p">.</span><span class="mi">25</span>   <span class="mi">114</span><span class="p">.</span><span class="mi">95</span>   <span class="mi">116</span><span class="p">.</span><span class="mi">00</span> 
<span class="o">##</span>                                                                       
<span class="o">##</span> <span class="n">Value</span>       <span class="mi">83</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">88</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">88</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">89</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">96</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">98</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">99</span><span class="p">.</span><span class="mi">0</span> <span class="mi">100</span><span class="p">.</span><span class="mi">0</span> <span class="mi">101</span><span class="p">.</span><span class="mi">2</span> <span class="mi">104</span><span class="p">.</span><span class="mi">6</span>
<span class="o">##</span> <span class="n">Frequency</span>      <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>
<span class="o">##</span> <span class="n">Proportion</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>
<span class="o">##</span>                                               
<span class="o">##</span> <span class="n">Value</span>      <span class="mi">108</span><span class="p">.</span><span class="mi">4</span> <span class="mi">110</span><span class="p">.</span><span class="mi">8</span> <span class="mi">112</span><span class="p">.</span><span class="mi">6</span> <span class="mi">114</span><span class="p">.</span><span class="mi">2</span> <span class="mi">115</span><span class="p">.</span><span class="mi">7</span> <span class="mi">116</span><span class="p">.</span><span class="mi">9</span>
<span class="o">##</span> <span class="n">Frequency</span>      <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>
<span class="o">##</span> <span class="n">Proportion</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>
<span class="o">##</span> <span class="c1">---------------------------------------------------------------------------</span>
<span class="o">##</span> <span class="n">GNP</span> 
<span class="o">##</span>        <span class="n">n</span>  <span class="n">missing</span> <span class="k">distinct</span>     <span class="n">Info</span>     <span class="n">Mean</span>      <span class="n">Gmd</span>      <span class="p">.</span><span class="mi">05</span>      <span class="p">.</span><span class="mi">10</span> 
<span class="o">##</span>       <span class="mi">16</span>        <span class="mi">0</span>       <span class="mi">16</span>        <span class="mi">1</span>    <span class="mi">387</span><span class="p">.</span><span class="mi">7</span>    <span class="mi">117</span><span class="p">.</span><span class="mi">8</span>    <span class="mi">252</span><span class="p">.</span><span class="mi">1</span>    <span class="mi">258</span><span class="p">.</span><span class="mi">7</span> 
<span class="o">##</span>      <span class="p">.</span><span class="mi">25</span>      <span class="p">.</span><span class="mi">50</span>      <span class="p">.</span><span class="mi">75</span>      <span class="p">.</span><span class="mi">90</span>      <span class="p">.</span><span class="mi">95</span> 
<span class="o">##</span>    <span class="mi">317</span><span class="p">.</span><span class="mi">9</span>    <span class="mi">381</span><span class="p">.</span><span class="mi">4</span>    <span class="mi">454</span><span class="p">.</span><span class="mi">1</span>    <span class="mi">510</span><span class="p">.</span><span class="mi">4</span>    <span class="mi">527</span><span class="p">.</span><span class="mi">4</span> 
<span class="o">##</span>                                                                           
<span class="o">##</span> <span class="n">Value</span>      <span class="mi">234</span><span class="p">.</span><span class="mi">289</span> <span class="mi">258</span><span class="p">.</span><span class="mi">054</span> <span class="mi">259</span><span class="p">.</span><span class="mi">426</span> <span class="mi">284</span><span class="p">.</span><span class="mi">599</span> <span class="mi">328</span><span class="p">.</span><span class="mi">975</span> <span class="mi">346</span><span class="p">.</span><span class="mi">999</span> <span class="mi">363</span><span class="p">.</span><span class="mi">112</span> <span class="mi">365</span><span class="p">.</span><span class="mi">385</span>
<span class="o">##</span> <span class="n">Frequency</span>        <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>
<span class="o">##</span> <span class="n">Proportion</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>
<span class="o">##</span>                                                                           
<span class="o">##</span> <span class="n">Value</span>      <span class="mi">397</span><span class="p">.</span><span class="mi">469</span> <span class="mi">419</span><span class="p">.</span><span class="mi">180</span> <span class="mi">442</span><span class="p">.</span><span class="mi">769</span> <span class="mi">444</span><span class="p">.</span><span class="mi">546</span> <span class="mi">482</span><span class="p">.</span><span class="mi">704</span> <span class="mi">502</span><span class="p">.</span><span class="mi">601</span> <span class="mi">518</span><span class="p">.</span><span class="mi">173</span> <span class="mi">554</span><span class="p">.</span><span class="mi">894</span>
<span class="o">##</span> <span class="n">Frequency</span>        <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>
<span class="o">##</span> <span class="n">Proportion</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>
<span class="o">##</span> <span class="c1">---------------------------------------------------------------------------</span>
<span class="o">##</span> <span class="n">Unemployed</span> 
<span class="o">##</span>        <span class="n">n</span>  <span class="n">missing</span> <span class="k">distinct</span>     <span class="n">Info</span>     <span class="n">Mean</span>      <span class="n">Gmd</span>      <span class="p">.</span><span class="mi">05</span>      <span class="p">.</span><span class="mi">10</span> 
<span class="o">##</span>       <span class="mi">16</span>        <span class="mi">0</span>       <span class="mi">16</span>        <span class="mi">1</span>    <span class="mi">319</span><span class="p">.</span><span class="mi">3</span>    <span class="mi">110</span><span class="p">.</span><span class="mi">1</span>    <span class="mi">191</span><span class="p">.</span><span class="mi">6</span>    <span class="mi">201</span><span class="p">.</span><span class="mi">6</span> 
<span class="o">##</span>      <span class="p">.</span><span class="mi">25</span>      <span class="p">.</span><span class="mi">50</span>      <span class="p">.</span><span class="mi">75</span>      <span class="p">.</span><span class="mi">90</span>      <span class="p">.</span><span class="mi">95</span> 
<span class="o">##</span>    <span class="mi">234</span><span class="p">.</span><span class="mi">8</span>    <span class="mi">314</span><span class="p">.</span><span class="mi">4</span>    <span class="mi">384</span><span class="p">.</span><span class="mi">2</span>    <span class="mi">434</span><span class="p">.</span><span class="mi">4</span>    <span class="mi">471</span><span class="p">.</span><span class="mi">2</span> 
<span class="o">##</span>                                                                       
<span class="o">##</span> <span class="n">Value</span>      <span class="mi">187</span><span class="p">.</span><span class="mi">0</span> <span class="mi">193</span><span class="p">.</span><span class="mi">2</span> <span class="mi">209</span><span class="p">.</span><span class="mi">9</span> <span class="mi">232</span><span class="p">.</span><span class="mi">5</span> <span class="mi">235</span><span class="p">.</span><span class="mi">6</span> <span class="mi">282</span><span class="p">.</span><span class="mi">2</span> <span class="mi">290</span><span class="p">.</span><span class="mi">4</span> <span class="mi">293</span><span class="p">.</span><span class="mi">6</span> <span class="mi">335</span><span class="p">.</span><span class="mi">1</span> <span class="mi">357</span><span class="p">.</span><span class="mi">8</span>
<span class="o">##</span> <span class="n">Frequency</span>      <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>
<span class="o">##</span> <span class="n">Proportion</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>
<span class="o">##</span>                                               
<span class="o">##</span> <span class="n">Value</span>      <span class="mi">368</span><span class="p">.</span><span class="mi">2</span> <span class="mi">381</span><span class="p">.</span><span class="mi">3</span> <span class="mi">393</span><span class="p">.</span><span class="mi">1</span> <span class="mi">400</span><span class="p">.</span><span class="mi">7</span> <span class="mi">468</span><span class="p">.</span><span class="mi">1</span> <span class="mi">480</span><span class="p">.</span><span class="mi">6</span>
<span class="o">##</span> <span class="n">Frequency</span>      <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>
<span class="o">##</span> <span class="n">Proportion</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>
<span class="o">##</span> <span class="c1">---------------------------------------------------------------------------</span>
<span class="o">##</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span> 
<span class="o">##</span>        <span class="n">n</span>  <span class="n">missing</span> <span class="k">distinct</span>     <span class="n">Info</span>     <span class="n">Mean</span>      <span class="n">Gmd</span>      <span class="p">.</span><span class="mi">05</span>      <span class="p">.</span><span class="mi">10</span> 
<span class="o">##</span>       <span class="mi">16</span>        <span class="mi">0</span>       <span class="mi">16</span>        <span class="mi">1</span>    <span class="mi">260</span><span class="p">.</span><span class="mi">7</span>    <span class="mi">79</span><span class="p">.</span><span class="mi">85</span>    <span class="mi">155</span><span class="p">.</span><span class="mi">7</span>    <span class="mi">160</span><span class="p">.</span><span class="mi">3</span> 
<span class="o">##</span>      <span class="p">.</span><span class="mi">25</span>      <span class="p">.</span><span class="mi">50</span>      <span class="p">.</span><span class="mi">75</span>      <span class="p">.</span><span class="mi">90</span>      <span class="p">.</span><span class="mi">95</span> 
<span class="o">##</span>    <span class="mi">229</span><span class="p">.</span><span class="mi">8</span>    <span class="mi">271</span><span class="p">.</span><span class="mi">8</span>    <span class="mi">306</span><span class="p">.</span><span class="mi">1</span>    <span class="mi">344</span><span class="p">.</span><span class="mi">9</span>    <span class="mi">355</span><span class="p">.</span><span class="mi">9</span> 
<span class="o">##</span>                                                                       
<span class="o">##</span> <span class="n">Value</span>      <span class="mi">145</span><span class="p">.</span><span class="mi">6</span> <span class="mi">159</span><span class="p">.</span><span class="mi">0</span> <span class="mi">161</span><span class="p">.</span><span class="mi">6</span> <span class="mi">165</span><span class="p">.</span><span class="mi">0</span> <span class="mi">251</span><span class="p">.</span><span class="mi">4</span> <span class="mi">255</span><span class="p">.</span><span class="mi">2</span> <span class="mi">257</span><span class="p">.</span><span class="mi">2</span> <span class="mi">263</span><span class="p">.</span><span class="mi">7</span> <span class="mi">279</span><span class="p">.</span><span class="mi">8</span> <span class="mi">282</span><span class="p">.</span><span class="mi">7</span>
<span class="o">##</span> <span class="n">Frequency</span>      <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>
<span class="o">##</span> <span class="n">Proportion</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>
<span class="o">##</span>                                               
<span class="o">##</span> <span class="n">Value</span>      <span class="mi">285</span><span class="p">.</span><span class="mi">7</span> <span class="mi">304</span><span class="p">.</span><span class="mi">8</span> <span class="mi">309</span><span class="p">.</span><span class="mi">9</span> <span class="mi">335</span><span class="p">.</span><span class="mi">0</span> <span class="mi">354</span><span class="p">.</span><span class="mi">7</span> <span class="mi">359</span><span class="p">.</span><span class="mi">4</span>
<span class="o">##</span> <span class="n">Frequency</span>      <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>
<span class="o">##</span> <span class="n">Proportion</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>
<span class="o">##</span> <span class="c1">---------------------------------------------------------------------------</span>
<span class="o">##</span> <span class="n">Population</span> 
<span class="o">##</span>        <span class="n">n</span>  <span class="n">missing</span> <span class="k">distinct</span>     <span class="n">Info</span>     <span class="n">Mean</span>      <span class="n">Gmd</span>      <span class="p">.</span><span class="mi">05</span>      <span class="p">.</span><span class="mi">10</span> 
<span class="o">##</span>       <span class="mi">16</span>        <span class="mi">0</span>       <span class="mi">16</span>        <span class="mi">1</span>    <span class="mi">117</span><span class="p">.</span><span class="mi">4</span>    <span class="mi">8</span><span class="p">.</span><span class="mi">229</span>    <span class="mi">108</span><span class="p">.</span><span class="mi">4</span>    <span class="mi">109</span><span class="p">.</span><span class="mi">2</span> 
<span class="o">##</span>      <span class="p">.</span><span class="mi">25</span>      <span class="p">.</span><span class="mi">50</span>      <span class="p">.</span><span class="mi">75</span>      <span class="p">.</span><span class="mi">90</span>      <span class="p">.</span><span class="mi">95</span> 
<span class="o">##</span>    <span class="mi">111</span><span class="p">.</span><span class="mi">8</span>    <span class="mi">116</span><span class="p">.</span><span class="mi">8</span>    <span class="mi">122</span><span class="p">.</span><span class="mi">3</span>    <span class="mi">126</span><span class="p">.</span><span class="mi">6</span>    <span class="mi">128</span><span class="p">.</span><span class="mi">4</span> 
<span class="o">##</span>                                                                           
<span class="o">##</span> <span class="n">Value</span>      <span class="mi">107</span><span class="p">.</span><span class="mi">608</span> <span class="mi">108</span><span class="p">.</span><span class="mi">632</span> <span class="mi">109</span><span class="p">.</span><span class="mi">773</span> <span class="mi">110</span><span class="p">.</span><span class="mi">929</span> <span class="mi">112</span><span class="p">.</span><span class="mi">075</span> <span class="mi">113</span><span class="p">.</span><span class="mi">270</span> <span class="mi">115</span><span class="p">.</span><span class="mi">094</span> <span class="mi">116</span><span class="p">.</span><span class="mi">219</span>
<span class="o">##</span> <span class="n">Frequency</span>        <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>
<span class="o">##</span> <span class="n">Proportion</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>
<span class="o">##</span>                                                                           
<span class="o">##</span> <span class="n">Value</span>      <span class="mi">117</span><span class="p">.</span><span class="mi">388</span> <span class="mi">118</span><span class="p">.</span><span class="mi">734</span> <span class="mi">120</span><span class="p">.</span><span class="mi">445</span> <span class="mi">121</span><span class="p">.</span><span class="mi">950</span> <span class="mi">123</span><span class="p">.</span><span class="mi">366</span> <span class="mi">125</span><span class="p">.</span><span class="mi">368</span> <span class="mi">127</span><span class="p">.</span><span class="mi">852</span> <span class="mi">130</span><span class="p">.</span><span class="mi">081</span>
<span class="o">##</span> <span class="n">Frequency</span>        <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>
<span class="o">##</span> <span class="n">Proportion</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>
<span class="o">##</span> <span class="c1">---------------------------------------------------------------------------</span>
<span class="o">##</span> <span class="k">Year</span> 
<span class="o">##</span>        <span class="n">n</span>  <span class="n">missing</span> <span class="k">distinct</span>     <span class="n">Info</span>     <span class="n">Mean</span>      <span class="n">Gmd</span>      <span class="p">.</span><span class="mi">05</span>      <span class="p">.</span><span class="mi">10</span> 
<span class="o">##</span>       <span class="mi">16</span>        <span class="mi">0</span>       <span class="mi">16</span>        <span class="mi">1</span>     <span class="mi">1954</span>    <span class="mi">5</span><span class="p">.</span><span class="mi">667</span>     <span class="mi">1948</span>     <span class="mi">1948</span> 
<span class="o">##</span>      <span class="p">.</span><span class="mi">25</span>      <span class="p">.</span><span class="mi">50</span>      <span class="p">.</span><span class="mi">75</span>      <span class="p">.</span><span class="mi">90</span>      <span class="p">.</span><span class="mi">95</span> 
<span class="o">##</span>     <span class="mi">1951</span>     <span class="mi">1954</span>     <span class="mi">1958</span>     <span class="mi">1960</span>     <span class="mi">1961</span> 
<span class="o">##</span>                                                                       
<span class="o">##</span> <span class="n">Value</span>       <span class="mi">1947</span>  <span class="mi">1948</span>  <span class="mi">1949</span>  <span class="mi">1950</span>  <span class="mi">1951</span>  <span class="mi">1952</span>  <span class="mi">1953</span>  <span class="mi">1954</span>  <span class="mi">1955</span>  <span class="mi">1956</span>
<span class="o">##</span> <span class="n">Frequency</span>      <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>
<span class="o">##</span> <span class="n">Proportion</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>
<span class="o">##</span>                                               
<span class="o">##</span> <span class="n">Value</span>       <span class="mi">1957</span>  <span class="mi">1958</span>  <span class="mi">1959</span>  <span class="mi">1960</span>  <span class="mi">1961</span>  <span class="mi">1962</span>
<span class="o">##</span> <span class="n">Frequency</span>      <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>
<span class="o">##</span> <span class="n">Proportion</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span> <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>
<span class="o">##</span> <span class="c1">---------------------------------------------------------------------------</span>
<span class="o">##</span> <span class="n">Employed</span> 
<span class="o">##</span>        <span class="n">n</span>  <span class="n">missing</span> <span class="k">distinct</span>     <span class="n">Info</span>     <span class="n">Mean</span>      <span class="n">Gmd</span>      <span class="p">.</span><span class="mi">05</span>      <span class="p">.</span><span class="mi">10</span> 
<span class="o">##</span>       <span class="mi">16</span>        <span class="mi">0</span>       <span class="mi">16</span>        <span class="mi">1</span>    <span class="mi">65</span><span class="p">.</span><span class="mi">32</span>    <span class="mi">4</span><span class="p">.</span><span class="mi">153</span>    <span class="mi">60</span><span class="p">.</span><span class="mi">28</span>    <span class="mi">60</span><span class="p">.</span><span class="mi">72</span> 
<span class="o">##</span>      <span class="p">.</span><span class="mi">25</span>      <span class="p">.</span><span class="mi">50</span>      <span class="p">.</span><span class="mi">75</span>      <span class="p">.</span><span class="mi">90</span>      <span class="p">.</span><span class="mi">95</span> 
<span class="o">##</span>    <span class="mi">62</span><span class="p">.</span><span class="mi">71</span>    <span class="mi">65</span><span class="p">.</span><span class="mi">50</span>    <span class="mi">68</span><span class="p">.</span><span class="mi">29</span>    <span class="mi">69</span><span class="p">.</span><span class="mi">45</span>    <span class="mi">69</span><span class="p">.</span><span class="mi">81</span> 
<span class="o">##</span>                                                                          
<span class="o">##</span> <span class="n">Value</span>      <span class="mi">60</span><span class="p">.</span><span class="mi">171</span> <span class="mi">60</span><span class="p">.</span><span class="mi">323</span> <span class="mi">61</span><span class="p">.</span><span class="mi">122</span> <span class="mi">61</span><span class="p">.</span><span class="mi">187</span> <span class="mi">63</span><span class="p">.</span><span class="mi">221</span> <span class="mi">63</span><span class="p">.</span><span class="mi">639</span> <span class="mi">63</span><span class="p">.</span><span class="mi">761</span> <span class="mi">64</span><span class="p">.</span><span class="mi">989</span> <span class="mi">66</span><span class="p">.</span><span class="mi">019</span>
<span class="o">##</span> <span class="n">Frequency</span>       <span class="mi">1</span>      <span class="mi">1</span>      <span class="mi">1</span>      <span class="mi">1</span>      <span class="mi">1</span>      <span class="mi">1</span>      <span class="mi">1</span>      <span class="mi">1</span>      <span class="mi">1</span>
<span class="o">##</span> <span class="n">Proportion</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>
<span class="o">##</span>                                                            
<span class="o">##</span> <span class="n">Value</span>      <span class="mi">66</span><span class="p">.</span><span class="mi">513</span> <span class="mi">67</span><span class="p">.</span><span class="mi">857</span> <span class="mi">68</span><span class="p">.</span><span class="mi">169</span> <span class="mi">68</span><span class="p">.</span><span class="mi">655</span> <span class="mi">69</span><span class="p">.</span><span class="mi">331</span> <span class="mi">69</span><span class="p">.</span><span class="mi">564</span> <span class="mi">70</span><span class="p">.</span><span class="mi">551</span>
<span class="o">##</span> <span class="n">Frequency</span>       <span class="mi">1</span>      <span class="mi">1</span>      <span class="mi">1</span>      <span class="mi">1</span>      <span class="mi">1</span>      <span class="mi">1</span>      <span class="mi">1</span>
<span class="o">##</span> <span class="n">Proportion</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">062</span>
<span class="o">##</span> <span class="c1">---------------------------------------------------------------------------</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># nbr.val, nbr.null, nbr.na, min max, range, sum,</span>
<span class="c1"># median, mean, SE.mean, CI.mean, var, std.dev, coef.var</span>
<span class="nf">library</span><span class="p">(</span><span class="n">pastecs</span><span class="p">)</span>

<span class="nf">stat.desc</span><span class="p">(</span><span class="n">longley</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>              <span class="n">GNP</span><span class="p">.</span><span class="n">deflator</span>          <span class="n">GNP</span>   <span class="n">Unemployed</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span>
<span class="o">##</span> <span class="n">nbr</span><span class="p">.</span><span class="n">val</span>        <span class="mi">16</span><span class="p">.</span><span class="mi">0000000</span>   <span class="mi">16</span><span class="p">.</span><span class="mi">0000000</span>   <span class="mi">16</span><span class="p">.</span><span class="mi">0000000</span>   <span class="mi">16</span><span class="p">.</span><span class="mi">0000000</span>
<span class="o">##</span> <span class="n">nbr</span><span class="p">.</span><span class="k">null</span>        <span class="mi">0</span><span class="p">.</span><span class="mi">0000000</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">0000000</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">0000000</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">0000000</span>
<span class="o">##</span> <span class="n">nbr</span><span class="p">.</span><span class="n">na</span>          <span class="mi">0</span><span class="p">.</span><span class="mi">0000000</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">0000000</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">0000000</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">0000000</span>
<span class="o">##</span> <span class="k">min</span>            <span class="mi">83</span><span class="p">.</span><span class="mi">0000000</span>  <span class="mi">234</span><span class="p">.</span><span class="mi">2890000</span>  <span class="mi">187</span><span class="p">.</span><span class="mi">0000000</span>  <span class="mi">145</span><span class="p">.</span><span class="mi">6000000</span>
<span class="o">##</span> <span class="k">max</span>           <span class="mi">116</span><span class="p">.</span><span class="mi">9000000</span>  <span class="mi">554</span><span class="p">.</span><span class="mi">8940000</span>  <span class="mi">480</span><span class="p">.</span><span class="mi">6000000</span>  <span class="mi">359</span><span class="p">.</span><span class="mi">4000000</span>
<span class="o">##</span> <span class="n">range</span>          <span class="mi">33</span><span class="p">.</span><span class="mi">9000000</span>  <span class="mi">320</span><span class="p">.</span><span class="mi">6050000</span>  <span class="mi">293</span><span class="p">.</span><span class="mi">6000000</span>  <span class="mi">213</span><span class="p">.</span><span class="mi">8000000</span>
<span class="o">##</span> <span class="k">sum</span>          <span class="mi">1626</span><span class="p">.</span><span class="mi">9000000</span> <span class="mi">6203</span><span class="p">.</span><span class="mi">1750000</span> <span class="mi">5109</span><span class="p">.</span><span class="mi">3000000</span> <span class="mi">4170</span><span class="p">.</span><span class="mi">7000000</span>
<span class="o">##</span> <span class="n">median</span>        <span class="mi">100</span><span class="p">.</span><span class="mi">6000000</span>  <span class="mi">381</span><span class="p">.</span><span class="mi">4270000</span>  <span class="mi">314</span><span class="p">.</span><span class="mi">3500000</span>  <span class="mi">271</span><span class="p">.</span><span class="mi">7500000</span>
<span class="o">##</span> <span class="n">mean</span>          <span class="mi">101</span><span class="p">.</span><span class="mi">6812500</span>  <span class="mi">387</span><span class="p">.</span><span class="mi">6984375</span>  <span class="mi">319</span><span class="p">.</span><span class="mi">3312500</span>  <span class="mi">260</span><span class="p">.</span><span class="mi">6687500</span>
<span class="o">##</span> <span class="n">SE</span><span class="p">.</span><span class="n">mean</span>         <span class="mi">2</span><span class="p">.</span><span class="mi">6978884</span>   <span class="mi">24</span><span class="p">.</span><span class="mi">8487344</span>   <span class="mi">23</span><span class="p">.</span><span class="mi">3616062</span>   <span class="mi">17</span><span class="p">.</span><span class="mi">3979901</span>
<span class="o">##</span> <span class="n">CI</span><span class="p">.</span><span class="n">mean</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">95</span>    <span class="mi">5</span><span class="p">.</span><span class="mi">7504129</span>   <span class="mi">52</span><span class="p">.</span><span class="mi">9638237</span>   <span class="mi">49</span><span class="p">.</span><span class="mi">7940849</span>   <span class="mi">37</span><span class="p">.</span><span class="mi">0829381</span>
<span class="o">##</span> <span class="n">var</span>           <span class="mi">116</span><span class="p">.</span><span class="mi">4576250</span> <span class="mi">9879</span><span class="p">.</span><span class="mi">3536593</span> <span class="mi">8732</span><span class="p">.</span><span class="mi">2342917</span> <span class="mi">4843</span><span class="p">.</span><span class="mi">0409583</span>
<span class="o">##</span> <span class="n">std</span><span class="p">.</span><span class="n">dev</span>        <span class="mi">10</span><span class="p">.</span><span class="mi">7915534</span>   <span class="mi">99</span><span class="p">.</span><span class="mi">3949378</span>   <span class="mi">93</span><span class="p">.</span><span class="mi">4464247</span>   <span class="mi">69</span><span class="p">.</span><span class="mi">5919604</span>
<span class="o">##</span> <span class="n">coef</span><span class="p">.</span><span class="n">var</span>        <span class="mi">0</span><span class="p">.</span><span class="mi">1061312</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">2563718</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">2926316</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">2669747</span>
<span class="o">##</span>                <span class="n">Population</span>         <span class="k">Year</span>     <span class="n">Employed</span>
<span class="o">##</span> <span class="n">nbr</span><span class="p">.</span><span class="n">val</span>      <span class="mi">1</span><span class="p">.</span><span class="mi">600000</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span> <span class="mi">1</span><span class="p">.</span><span class="mi">600000</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span> <span class="mi">1</span><span class="p">.</span><span class="mi">600000</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span>
<span class="o">##</span> <span class="n">nbr</span><span class="p">.</span><span class="k">null</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">000000</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span> <span class="mi">0</span><span class="p">.</span><span class="mi">000000</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span> <span class="mi">0</span><span class="p">.</span><span class="mi">000000</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span>
<span class="o">##</span> <span class="n">nbr</span><span class="p">.</span><span class="n">na</span>       <span class="mi">0</span><span class="p">.</span><span class="mi">000000</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span> <span class="mi">0</span><span class="p">.</span><span class="mi">000000</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span> <span class="mi">0</span><span class="p">.</span><span class="mi">000000</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span>
<span class="o">##</span> <span class="k">min</span>          <span class="mi">1</span><span class="p">.</span><span class="mi">076080</span><span class="n">e</span><span class="o">+</span><span class="mi">02</span> <span class="mi">1</span><span class="p">.</span><span class="mi">947000</span><span class="n">e</span><span class="o">+</span><span class="mi">03</span> <span class="mi">6</span><span class="p">.</span><span class="mi">017100</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span>
<span class="o">##</span> <span class="k">max</span>          <span class="mi">1</span><span class="p">.</span><span class="mi">300810</span><span class="n">e</span><span class="o">+</span><span class="mi">02</span> <span class="mi">1</span><span class="p">.</span><span class="mi">962000</span><span class="n">e</span><span class="o">+</span><span class="mi">03</span> <span class="mi">7</span><span class="p">.</span><span class="mi">055100</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span>
<span class="o">##</span> <span class="n">range</span>        <span class="mi">2</span><span class="p">.</span><span class="mi">247300</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span> <span class="mi">1</span><span class="p">.</span><span class="mi">500000</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span> <span class="mi">1</span><span class="p">.</span><span class="mi">038000</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span>
<span class="o">##</span> <span class="k">sum</span>          <span class="mi">1</span><span class="p">.</span><span class="mi">878784</span><span class="n">e</span><span class="o">+</span><span class="mi">03</span> <span class="mi">3</span><span class="p">.</span><span class="mi">127200</span><span class="n">e</span><span class="o">+</span><span class="mi">04</span> <span class="mi">1</span><span class="p">.</span><span class="mi">045072</span><span class="n">e</span><span class="o">+</span><span class="mi">03</span>
<span class="o">##</span> <span class="n">median</span>       <span class="mi">1</span><span class="p">.</span><span class="mi">168035</span><span class="n">e</span><span class="o">+</span><span class="mi">02</span> <span class="mi">1</span><span class="p">.</span><span class="mi">954500</span><span class="n">e</span><span class="o">+</span><span class="mi">03</span> <span class="mi">6</span><span class="p">.</span><span class="mi">550400</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span>
<span class="o">##</span> <span class="n">mean</span>         <span class="mi">1</span><span class="p">.</span><span class="mi">174240</span><span class="n">e</span><span class="o">+</span><span class="mi">02</span> <span class="mi">1</span><span class="p">.</span><span class="mi">954500</span><span class="n">e</span><span class="o">+</span><span class="mi">03</span> <span class="mi">6</span><span class="p">.</span><span class="mi">531700</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span>
<span class="o">##</span> <span class="n">SE</span><span class="p">.</span><span class="n">mean</span>      <span class="mi">1</span><span class="p">.</span><span class="mi">739025</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span> <span class="mi">1</span><span class="p">.</span><span class="mi">190238</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span> <span class="mi">8</span><span class="p">.</span><span class="mi">779921</span><span class="n">e</span><span class="o">-</span><span class="mi">01</span>
<span class="o">##</span> <span class="n">CI</span><span class="p">.</span><span class="n">mean</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">95</span> <span class="mi">3</span><span class="p">.</span><span class="mi">706645</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span> <span class="mi">2</span><span class="p">.</span><span class="mi">536932</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span> <span class="mi">1</span><span class="p">.</span><span class="mi">871396</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span>
<span class="o">##</span> <span class="n">var</span>          <span class="mi">4</span><span class="p">.</span><span class="mi">838735</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span> <span class="mi">2</span><span class="p">.</span><span class="mi">266667</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span> <span class="mi">1</span><span class="p">.</span><span class="mi">233392</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span>
<span class="o">##</span> <span class="n">std</span><span class="p">.</span><span class="n">dev</span>      <span class="mi">6</span><span class="p">.</span><span class="mi">956102</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span> <span class="mi">4</span><span class="p">.</span><span class="mi">760952</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span> <span class="mi">3</span><span class="p">.</span><span class="mi">511968</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span>
<span class="o">##</span> <span class="n">coef</span><span class="p">.</span><span class="n">var</span>     <span class="mi">5</span><span class="p">.</span><span class="mi">923918</span><span class="n">e</span><span class="o">-</span><span class="mi">02</span> <span class="mi">2</span><span class="p">.</span><span class="mi">435893</span><span class="n">e</span><span class="o">-</span><span class="mi">03</span> <span class="mi">5</span><span class="p">.</span><span class="mi">376806</span><span class="n">e</span><span class="o">-</span><span class="mi">02</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># item name, item number, nvalid, mean, sd,</span>
<span class="c1"># median, mad, min, max, skew, kurtosis, se</span>
<span class="nf">library</span><span class="p">(</span><span class="n">psych</span><span class="p">)</span>

<span class="nf">describe</span><span class="p">(</span><span class="n">longley</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>              <span class="n">vars</span>  <span class="n">n</span>    <span class="n">mean</span>    <span class="n">sd</span>  <span class="n">median</span> <span class="n">trimmed</span>    <span class="n">mad</span>     <span class="k">min</span>     <span class="k">max</span>
<span class="o">##</span> <span class="n">GNP</span><span class="p">.</span><span class="n">deflator</span>    <span class="mi">1</span> <span class="mi">16</span>  <span class="mi">101</span><span class="p">.</span><span class="mi">68</span> <span class="mi">10</span><span class="p">.</span><span class="mi">79</span>  <span class="mi">100</span><span class="p">.</span><span class="mi">60</span>  <span class="mi">101</span><span class="p">.</span><span class="mi">93</span>  <span class="mi">15</span><span class="p">.</span><span class="mi">79</span>   <span class="mi">83</span><span class="p">.</span><span class="mi">00</span>  <span class="mi">116</span><span class="p">.</span><span class="mi">90</span>
<span class="o">##</span> <span class="n">GNP</span>             <span class="mi">2</span> <span class="mi">16</span>  <span class="mi">387</span><span class="p">.</span><span class="mi">70</span> <span class="mi">99</span><span class="p">.</span><span class="mi">39</span>  <span class="mi">381</span><span class="p">.</span><span class="mi">43</span>  <span class="mi">386</span><span class="p">.</span><span class="mi">71</span> <span class="mi">118</span><span class="p">.</span><span class="mi">57</span>  <span class="mi">234</span><span class="p">.</span><span class="mi">29</span>  <span class="mi">554</span><span class="p">.</span><span class="mi">89</span>
<span class="o">##</span> <span class="n">Unemployed</span>      <span class="mi">3</span> <span class="mi">16</span>  <span class="mi">319</span><span class="p">.</span><span class="mi">33</span> <span class="mi">93</span><span class="p">.</span><span class="mi">45</span>  <span class="mi">314</span><span class="p">.</span><span class="mi">35</span>  <span class="mi">317</span><span class="p">.</span><span class="mi">26</span> <span class="mi">116</span><span class="p">.</span><span class="mi">75</span>  <span class="mi">187</span><span class="p">.</span><span class="mi">00</span>  <span class="mi">480</span><span class="p">.</span><span class="mi">60</span>
<span class="o">##</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span>    <span class="mi">4</span> <span class="mi">16</span>  <span class="mi">260</span><span class="p">.</span><span class="mi">67</span> <span class="mi">69</span><span class="p">.</span><span class="mi">59</span>  <span class="mi">271</span><span class="p">.</span><span class="mi">75</span>  <span class="mi">261</span><span class="p">.</span><span class="mi">84</span>  <span class="mi">52</span><span class="p">.</span><span class="mi">78</span>  <span class="mi">145</span><span class="p">.</span><span class="mi">60</span>  <span class="mi">359</span><span class="p">.</span><span class="mi">40</span>
<span class="o">##</span> <span class="n">Population</span>      <span class="mi">5</span> <span class="mi">16</span>  <span class="mi">117</span><span class="p">.</span><span class="mi">42</span>  <span class="mi">6</span><span class="p">.</span><span class="mi">96</span>  <span class="mi">116</span><span class="p">.</span><span class="mi">80</span>  <span class="mi">117</span><span class="p">.</span><span class="mi">22</span>   <span class="mi">8</span><span class="p">.</span><span class="mi">17</span>  <span class="mi">107</span><span class="p">.</span><span class="mi">61</span>  <span class="mi">130</span><span class="p">.</span><span class="mi">08</span>
<span class="o">##</span> <span class="k">Year</span>            <span class="mi">6</span> <span class="mi">16</span> <span class="mi">1954</span><span class="p">.</span><span class="mi">50</span>  <span class="mi">4</span><span class="p">.</span><span class="mi">76</span> <span class="mi">1954</span><span class="p">.</span><span class="mi">50</span> <span class="mi">1954</span><span class="p">.</span><span class="mi">50</span>   <span class="mi">5</span><span class="p">.</span><span class="mi">93</span> <span class="mi">1947</span><span class="p">.</span><span class="mi">00</span> <span class="mi">1962</span><span class="p">.</span><span class="mi">00</span>
<span class="o">##</span> <span class="n">Employed</span>        <span class="mi">7</span> <span class="mi">16</span>   <span class="mi">65</span><span class="p">.</span><span class="mi">32</span>  <span class="mi">3</span><span class="p">.</span><span class="mi">51</span>   <span class="mi">65</span><span class="p">.</span><span class="mi">50</span>   <span class="mi">65</span><span class="p">.</span><span class="mi">31</span>   <span class="mi">4</span><span class="p">.</span><span class="mi">31</span>   <span class="mi">60</span><span class="p">.</span><span class="mi">17</span>   <span class="mi">70</span><span class="p">.</span><span class="mi">55</span>
<span class="o">##</span>               <span class="n">range</span>  <span class="n">skew</span> <span class="n">kurtosis</span>    <span class="n">se</span>
<span class="o">##</span> <span class="n">GNP</span><span class="p">.</span><span class="n">deflator</span>  <span class="mi">33</span><span class="p">.</span><span class="mi">90</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">13</span>    <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">40</span>  <span class="mi">2</span><span class="p">.</span><span class="mi">70</span>
<span class="o">##</span> <span class="n">GNP</span>          <span class="mi">320</span><span class="p">.</span><span class="mi">61</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">02</span>    <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">35</span> <span class="mi">24</span><span class="p">.</span><span class="mi">85</span>
<span class="o">##</span> <span class="n">Unemployed</span>   <span class="mi">293</span><span class="p">.</span><span class="mi">60</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">14</span>    <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">30</span> <span class="mi">23</span><span class="p">.</span><span class="mi">36</span>
<span class="o">##</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span> <span class="mi">213</span><span class="p">.</span><span class="mi">80</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">37</span>    <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">20</span> <span class="mi">17</span><span class="p">.</span><span class="mi">40</span>
<span class="o">##</span> <span class="n">Population</span>    <span class="mi">22</span><span class="p">.</span><span class="mi">47</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">26</span>    <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">27</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">74</span>
<span class="o">##</span> <span class="k">Year</span>          <span class="mi">15</span><span class="p">.</span><span class="mi">00</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>    <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">43</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">19</span>
<span class="o">##</span> <span class="n">Employed</span>      <span class="mi">10</span><span class="p">.</span><span class="mi">38</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">09</span>    <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">55</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">88</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># with</span>
<span class="nf">with</span><span class="p">(</span><span class="n">longley</span><span class="p">,</span> <span class="nf">median</span><span class="p">(</span><span class="n">GNP</span><span class="p">))</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">381</span><span class="p">.</span><span class="mi">427</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># vs.</span>
<span class="nf">median</span><span class="p">(</span><span class="n">longley</span><span class="o">$</span><span class="n">GNP</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">381</span><span class="p">.</span><span class="mi">427</span>
</pre></div>
</td></tr></table>

<h4 id="group-data">Group data<a class="headerlink" href="#group-data" title="Permanent link">&para;</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>                <span class="n">mpg</span> <span class="n">cyl</span> <span class="n">disp</span>  <span class="n">hp</span> <span class="n">drat</span>    <span class="n">wt</span>  <span class="n">qsec</span> <span class="n">vs</span> <span class="n">am</span> <span class="n">gear</span> <span class="n">carb</span>
<span class="o">##</span> <span class="n">Mazda</span> <span class="n">RX4</span>     <span class="mi">21</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">6</span>  <span class="mi">160</span> <span class="mi">110</span> <span class="mi">3</span><span class="p">.</span><span class="mi">90</span> <span class="mi">2</span><span class="p">.</span><span class="mi">620</span> <span class="mi">16</span><span class="p">.</span><span class="mi">46</span>  <span class="mi">0</span>  <span class="mi">1</span>    <span class="mi">4</span>    <span class="mi">4</span>
<span class="o">##</span> <span class="n">Mazda</span> <span class="n">RX4</span> <span class="n">Wag</span> <span class="mi">21</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">6</span>  <span class="mi">160</span> <span class="mi">110</span> <span class="mi">3</span><span class="p">.</span><span class="mi">90</span> <span class="mi">2</span><span class="p">.</span><span class="mi">875</span> <span class="mi">17</span><span class="p">.</span><span class="mi">02</span>  <span class="mi">0</span>  <span class="mi">1</span>    <span class="mi">4</span>    <span class="mi">4</span>
<span class="o">##</span> <span class="n">Datsun</span> <span class="mi">710</span>    <span class="mi">22</span><span class="p">.</span><span class="mi">8</span>   <span class="mi">4</span>  <span class="mi">108</span>  <span class="mi">93</span> <span class="mi">3</span><span class="p">.</span><span class="mi">85</span> <span class="mi">2</span><span class="p">.</span><span class="mi">320</span> <span class="mi">18</span><span class="p">.</span><span class="mi">61</span>  <span class="mi">1</span>  <span class="mi">1</span>    <span class="mi">4</span>    <span class="mi">1</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># variable grouped by one factor to show a function</span>
<span class="nf">by</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">,</span> <span class="n">mtcars</span><span class="o">$</span><span class="n">cyl</span><span class="p">,</span> <span class="n">FUN</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="nf">c</span><span class="p">(</span><span class="n">m</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">s</span> <span class="o">=</span> <span class="nf">sd</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="p">})</span> 
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="n">mtcars$cyl</span><span class="p">:</span> <span class="mi">4</span>
<span class="o">##</span>         <span class="n">m</span>         <span class="n">s</span> 
<span class="o">##</span> <span class="mi">26</span><span class="p">.</span><span class="mi">663636</span>  <span class="mi">4</span><span class="p">.</span><span class="mi">509828</span> 
<span class="o">##</span> <span class="c1">-------------------------------------------------------- </span>
<span class="o">##</span> <span class="n">mtcars$cyl</span><span class="p">:</span> <span class="mi">6</span>
<span class="o">##</span>         <span class="n">m</span>         <span class="n">s</span> 
<span class="o">##</span> <span class="mi">19</span><span class="p">.</span><span class="mi">742857</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">453567</span> 
<span class="o">##</span> <span class="c1">-------------------------------------------------------- </span>
<span class="o">##</span> <span class="n">mtcars$cyl</span><span class="p">:</span> <span class="mi">8</span>
<span class="o">##</span>         <span class="n">m</span>         <span class="n">s</span> 
<span class="o">##</span> <span class="mi">15</span><span class="p">.</span><span class="mi">100000</span>  <span class="mi">2</span><span class="p">.</span><span class="mi">560048</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># description statistics by group</span>
<span class="nf">library</span><span class="p">(</span><span class="n">psych</span><span class="p">)</span>

<span class="nf">describeBy</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">group</span> <span class="o">=</span> <span class="n">mtcars</span><span class="o">$</span><span class="n">am</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">Descriptive</span> <span class="k">statistics</span> <span class="k">by</span> <span class="k">group</span> 
<span class="o">##</span> <span class="k">group</span><span class="p">:</span> <span class="mi">0</span>
<span class="o">##</span>      <span class="n">vars</span>  <span class="n">n</span>   <span class="n">mean</span>     <span class="n">sd</span> <span class="n">median</span> <span class="n">trimmed</span>    <span class="n">mad</span>    <span class="k">min</span>    <span class="k">max</span>  <span class="n">range</span>
<span class="o">##</span> <span class="n">mpg</span>     <span class="mi">1</span> <span class="mi">19</span>  <span class="mi">17</span><span class="p">.</span><span class="mi">15</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">83</span>  <span class="mi">17</span><span class="p">.</span><span class="mi">30</span>   <span class="mi">17</span><span class="p">.</span><span class="mi">12</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">11</span>  <span class="mi">10</span><span class="p">.</span><span class="mi">40</span>  <span class="mi">24</span><span class="p">.</span><span class="mi">40</span>  <span class="mi">14</span><span class="p">.</span><span class="mi">00</span>
<span class="o">##</span> <span class="n">cyl</span>     <span class="mi">2</span> <span class="mi">19</span>   <span class="mi">6</span><span class="p">.</span><span class="mi">95</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">54</span>   <span class="mi">8</span><span class="p">.</span><span class="mi">00</span>    <span class="mi">7</span><span class="p">.</span><span class="mi">06</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">4</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">8</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">4</span><span class="p">.</span><span class="mi">00</span>
<span class="o">##</span> <span class="n">disp</span>    <span class="mi">3</span> <span class="mi">19</span> <span class="mi">290</span><span class="p">.</span><span class="mi">38</span> <span class="mi">110</span><span class="p">.</span><span class="mi">17</span> <span class="mi">275</span><span class="p">.</span><span class="mi">80</span>  <span class="mi">289</span><span class="p">.</span><span class="mi">71</span> <span class="mi">124</span><span class="p">.</span><span class="mi">83</span> <span class="mi">120</span><span class="p">.</span><span class="mi">10</span> <span class="mi">472</span><span class="p">.</span><span class="mi">00</span> <span class="mi">351</span><span class="p">.</span><span class="mi">90</span>
<span class="o">##</span> <span class="n">hp</span>      <span class="mi">4</span> <span class="mi">19</span> <span class="mi">160</span><span class="p">.</span><span class="mi">26</span>  <span class="mi">53</span><span class="p">.</span><span class="mi">91</span> <span class="mi">175</span><span class="p">.</span><span class="mi">00</span>  <span class="mi">161</span><span class="p">.</span><span class="mi">06</span>  <span class="mi">77</span><span class="p">.</span><span class="mi">10</span>  <span class="mi">62</span><span class="p">.</span><span class="mi">00</span> <span class="mi">245</span><span class="p">.</span><span class="mi">00</span> <span class="mi">183</span><span class="p">.</span><span class="mi">00</span>
<span class="o">##</span> <span class="n">drat</span>    <span class="mi">5</span> <span class="mi">19</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">29</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">39</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">15</span>    <span class="mi">3</span><span class="p">.</span><span class="mi">28</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">22</span>   <span class="mi">2</span><span class="p">.</span><span class="mi">76</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">92</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">16</span>
<span class="o">##</span> <span class="n">wt</span>      <span class="mi">6</span> <span class="mi">19</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">77</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">78</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">52</span>    <span class="mi">3</span><span class="p">.</span><span class="mi">75</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">45</span>   <span class="mi">2</span><span class="p">.</span><span class="mi">46</span>   <span class="mi">5</span><span class="p">.</span><span class="mi">42</span>   <span class="mi">2</span><span class="p">.</span><span class="mi">96</span>
<span class="o">##</span> <span class="n">qsec</span>    <span class="mi">7</span> <span class="mi">19</span>  <span class="mi">18</span><span class="p">.</span><span class="mi">18</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">75</span>  <span class="mi">17</span><span class="p">.</span><span class="mi">82</span>   <span class="mi">18</span><span class="p">.</span><span class="mi">07</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">19</span>  <span class="mi">15</span><span class="p">.</span><span class="mi">41</span>  <span class="mi">22</span><span class="p">.</span><span class="mi">90</span>   <span class="mi">7</span><span class="p">.</span><span class="mi">49</span>
<span class="o">##</span> <span class="n">vs</span>      <span class="mi">8</span> <span class="mi">19</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">37</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">50</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">35</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>
<span class="o">##</span> <span class="n">am</span>      <span class="mi">9</span> <span class="mi">19</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>
<span class="o">##</span> <span class="n">gear</span>   <span class="mi">10</span> <span class="mi">19</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">21</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">42</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">00</span>    <span class="mi">3</span><span class="p">.</span><span class="mi">18</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">4</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>
<span class="o">##</span> <span class="n">carb</span>   <span class="mi">11</span> <span class="mi">19</span>   <span class="mi">2</span><span class="p">.</span><span class="mi">74</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">15</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">00</span>    <span class="mi">2</span><span class="p">.</span><span class="mi">76</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">48</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">4</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">00</span>
<span class="o">##</span>       <span class="n">skew</span> <span class="n">kurtosis</span>    <span class="n">se</span>
<span class="o">##</span> <span class="n">mpg</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">01</span>    <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">80</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">88</span>
<span class="o">##</span> <span class="n">cyl</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">95</span>    <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">74</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">35</span>
<span class="o">##</span> <span class="n">disp</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">05</span>    <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">26</span> <span class="mi">25</span><span class="p">.</span><span class="mi">28</span>
<span class="o">##</span> <span class="n">hp</span>   <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span>    <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">21</span> <span class="mi">12</span><span class="p">.</span><span class="mi">37</span>
<span class="o">##</span> <span class="n">drat</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">50</span>    <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">30</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">09</span>
<span class="o">##</span> <span class="n">wt</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">98</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">14</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">18</span>
<span class="o">##</span> <span class="n">qsec</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">85</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">55</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">40</span>
<span class="o">##</span> <span class="n">vs</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">50</span>    <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">84</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">11</span>
<span class="o">##</span> <span class="n">am</span>     <span class="n">NaN</span>      <span class="n">NaN</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>
<span class="o">##</span> <span class="n">gear</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">31</span>    <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">29</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">10</span>
<span class="o">##</span> <span class="n">carb</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">14</span>    <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">57</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">26</span>
<span class="o">##</span> <span class="c1">-------------------------------------------------------- </span>
<span class="o">##</span> <span class="k">group</span><span class="p">:</span> <span class="mi">1</span>
<span class="o">##</span>      <span class="n">vars</span>  <span class="n">n</span>   <span class="n">mean</span>    <span class="n">sd</span> <span class="n">median</span> <span class="n">trimmed</span>   <span class="n">mad</span>   <span class="k">min</span>    <span class="k">max</span>  <span class="n">range</span>  <span class="n">skew</span>
<span class="o">##</span> <span class="n">mpg</span>     <span class="mi">1</span> <span class="mi">13</span>  <span class="mi">24</span><span class="p">.</span><span class="mi">39</span>  <span class="mi">6</span><span class="p">.</span><span class="mi">17</span>  <span class="mi">22</span><span class="p">.</span><span class="mi">80</span>   <span class="mi">24</span><span class="p">.</span><span class="mi">38</span>  <span class="mi">6</span><span class="p">.</span><span class="mi">67</span> <span class="mi">15</span><span class="p">.</span><span class="mi">00</span>  <span class="mi">33</span><span class="p">.</span><span class="mi">90</span>  <span class="mi">18</span><span class="p">.</span><span class="mi">90</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">05</span>
<span class="o">##</span> <span class="n">cyl</span>     <span class="mi">2</span> <span class="mi">13</span>   <span class="mi">5</span><span class="p">.</span><span class="mi">08</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">55</span>   <span class="mi">4</span><span class="p">.</span><span class="mi">00</span>    <span class="mi">4</span><span class="p">.</span><span class="mi">91</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>  <span class="mi">4</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">8</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">4</span><span class="p">.</span><span class="mi">00</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">87</span>
<span class="o">##</span> <span class="n">disp</span>    <span class="mi">3</span> <span class="mi">13</span> <span class="mi">143</span><span class="p">.</span><span class="mi">53</span> <span class="mi">87</span><span class="p">.</span><span class="mi">20</span> <span class="mi">120</span><span class="p">.</span><span class="mi">30</span>  <span class="mi">131</span><span class="p">.</span><span class="mi">25</span> <span class="mi">58</span><span class="p">.</span><span class="mi">86</span> <span class="mi">71</span><span class="p">.</span><span class="mi">10</span> <span class="mi">351</span><span class="p">.</span><span class="mi">00</span> <span class="mi">279</span><span class="p">.</span><span class="mi">90</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">33</span>
<span class="o">##</span> <span class="n">hp</span>      <span class="mi">4</span> <span class="mi">13</span> <span class="mi">126</span><span class="p">.</span><span class="mi">85</span> <span class="mi">84</span><span class="p">.</span><span class="mi">06</span> <span class="mi">109</span><span class="p">.</span><span class="mi">00</span>  <span class="mi">114</span><span class="p">.</span><span class="mi">73</span> <span class="mi">63</span><span class="p">.</span><span class="mi">75</span> <span class="mi">52</span><span class="p">.</span><span class="mi">00</span> <span class="mi">335</span><span class="p">.</span><span class="mi">00</span> <span class="mi">283</span><span class="p">.</span><span class="mi">00</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">36</span>
<span class="o">##</span> <span class="n">drat</span>    <span class="mi">5</span> <span class="mi">13</span>   <span class="mi">4</span><span class="p">.</span><span class="mi">05</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">36</span>   <span class="mi">4</span><span class="p">.</span><span class="mi">08</span>    <span class="mi">4</span><span class="p">.</span><span class="mi">02</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">27</span>  <span class="mi">3</span><span class="p">.</span><span class="mi">54</span>   <span class="mi">4</span><span class="p">.</span><span class="mi">93</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">39</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">79</span>
<span class="o">##</span> <span class="n">wt</span>      <span class="mi">6</span> <span class="mi">13</span>   <span class="mi">2</span><span class="p">.</span><span class="mi">41</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">62</span>   <span class="mi">2</span><span class="p">.</span><span class="mi">32</span>    <span class="mi">2</span><span class="p">.</span><span class="mi">39</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">68</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">51</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">57</span>   <span class="mi">2</span><span class="p">.</span><span class="mi">06</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">21</span>
<span class="o">##</span> <span class="n">qsec</span>    <span class="mi">7</span> <span class="mi">13</span>  <span class="mi">17</span><span class="p">.</span><span class="mi">36</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">79</span>  <span class="mi">17</span><span class="p">.</span><span class="mi">02</span>   <span class="mi">17</span><span class="p">.</span><span class="mi">39</span>  <span class="mi">2</span><span class="p">.</span><span class="mi">34</span> <span class="mi">14</span><span class="p">.</span><span class="mi">50</span>  <span class="mi">19</span><span class="p">.</span><span class="mi">90</span>   <span class="mi">5</span><span class="p">.</span><span class="mi">40</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">23</span>
<span class="o">##</span> <span class="n">vs</span>      <span class="mi">8</span> <span class="mi">13</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">54</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">52</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">55</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">00</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">14</span>
<span class="o">##</span> <span class="n">am</span>      <span class="mi">9</span> <span class="mi">13</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>    <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>   <span class="n">NaN</span>
<span class="o">##</span> <span class="n">gear</span>   <span class="mi">10</span> <span class="mi">13</span>   <span class="mi">4</span><span class="p">.</span><span class="mi">38</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">51</span>   <span class="mi">4</span><span class="p">.</span><span class="mi">00</span>    <span class="mi">4</span><span class="p">.</span><span class="mi">36</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>  <span class="mi">4</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">5</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">42</span>
<span class="o">##</span> <span class="n">carb</span>   <span class="mi">11</span> <span class="mi">13</span>   <span class="mi">2</span><span class="p">.</span><span class="mi">92</span>  <span class="mi">2</span><span class="p">.</span><span class="mi">18</span>   <span class="mi">2</span><span class="p">.</span><span class="mi">00</span>    <span class="mi">2</span><span class="p">.</span><span class="mi">64</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">48</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">8</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">7</span><span class="p">.</span><span class="mi">00</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">98</span>
<span class="o">##</span>      <span class="n">kurtosis</span>    <span class="n">se</span>
<span class="o">##</span> <span class="n">mpg</span>     <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">46</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">71</span>
<span class="o">##</span> <span class="n">cyl</span>     <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">90</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">43</span>
<span class="o">##</span> <span class="n">disp</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">40</span> <span class="mi">24</span><span class="p">.</span><span class="mi">19</span>
<span class="o">##</span> <span class="n">hp</span>       <span class="mi">0</span><span class="p">.</span><span class="mi">56</span> <span class="mi">23</span><span class="p">.</span><span class="mi">31</span>
<span class="o">##</span> <span class="n">drat</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">21</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">10</span>
<span class="o">##</span> <span class="n">wt</span>      <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">17</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">17</span>
<span class="o">##</span> <span class="n">qsec</span>    <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">42</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">50</span>
<span class="o">##</span> <span class="n">vs</span>      <span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="mi">13</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">14</span>
<span class="o">##</span> <span class="n">am</span>        <span class="n">NaN</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>
<span class="o">##</span> <span class="n">gear</span>    <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">96</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">14</span>
<span class="o">##</span> <span class="n">carb</span>    <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">21</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">60</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># description statistics by group </span>
<span class="nf">library</span><span class="p">(</span><span class="n">doBy</span><span class="p">)</span>

<span class="nf">summaryBy</span><span class="p">(</span><span class="n">mpg</span> <span class="o">+</span> <span class="n">wt</span> <span class="o">~</span> <span class="n">cyl</span> <span class="o">+</span> <span class="n">vs</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">,</span> 
  <span class="n">FUN</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="nf">c</span><span class="p">(</span><span class="n">m</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">s</span> <span class="o">=</span> <span class="nf">sd</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="p">}</span> <span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>   <span class="n">cyl</span> <span class="n">vs</span>    <span class="n">mpg</span><span class="p">.</span><span class="n">m</span>     <span class="n">mpg</span><span class="p">.</span><span class="n">s</span>     <span class="n">wt</span><span class="p">.</span><span class="n">m</span>      <span class="n">wt</span><span class="p">.</span><span class="n">s</span>
<span class="o">##</span> <span class="mi">1</span>   <span class="mi">4</span>  <span class="mi">0</span> <span class="mi">26</span><span class="p">.</span><span class="mi">00000</span>        <span class="n">NA</span> <span class="mi">2</span><span class="p">.</span><span class="mi">140000</span>        <span class="n">NA</span>
<span class="o">##</span> <span class="mi">2</span>   <span class="mi">4</span>  <span class="mi">1</span> <span class="mi">26</span><span class="p">.</span><span class="mi">73000</span> <span class="mi">4</span><span class="p">.</span><span class="mi">7481107</span> <span class="mi">2</span><span class="p">.</span><span class="mi">300300</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5982073</span>
<span class="o">##</span> <span class="mi">3</span>   <span class="mi">6</span>  <span class="mi">0</span> <span class="mi">20</span><span class="p">.</span><span class="mi">56667</span> <span class="mi">0</span><span class="p">.</span><span class="mi">7505553</span> <span class="mi">2</span><span class="p">.</span><span class="mi">755000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1281601</span>
<span class="o">##</span> <span class="mi">4</span>   <span class="mi">6</span>  <span class="mi">1</span> <span class="mi">19</span><span class="p">.</span><span class="mi">12500</span> <span class="mi">1</span><span class="p">.</span><span class="mi">6317169</span> <span class="mi">3</span><span class="p">.</span><span class="mi">388750</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1162164</span>
<span class="o">##</span> <span class="mi">5</span>   <span class="mi">8</span>  <span class="mi">0</span> <span class="mi">15</span><span class="p">.</span><span class="mi">10000</span> <span class="mi">2</span><span class="p">.</span><span class="mi">5600481</span> <span class="mi">3</span><span class="p">.</span><span class="mi">999214</span> <span class="mi">0</span><span class="p">.</span><span class="mi">7594047</span>
</pre></div>
</td></tr></table>

<h2 id="frequency-tables-crosstables-and-independence">Frequency Tables, CrossTables, and Independence<a class="headerlink" href="#frequency-tables-crosstables-and-independence" title="Permanent link">&para;</a></h2>
<p>Create frequency and contingency tables from categorical variables. Perform tests of independence, measures of association, and graphically display results.</p>
<h3 id="2d-frequency-tables">2D frequency tables<a class="headerlink" href="#2d-frequency-tables" title="Permanent link">&para;</a></h3>
<p><code class="codehilite"><span class="n">mytable</span> <span class="o">&lt;-</span> <span class="nf">table</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span></code> where A are rows, B are columns.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># dataset</span>
<span class="n">mytable</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">),</span> <span class="n">nrow</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
<span class="n">mytable</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>      <span class="p">[,</span><span class="mi">1</span><span class="p">]</span> <span class="p">[,</span><span class="mi">2</span><span class="p">]</span>
<span class="o">##</span> <span class="p">[</span><span class="mi">1</span><span class="p">,]</span>    <span class="mi">1</span>    <span class="mi">3</span>
<span class="o">##</span> <span class="p">[</span><span class="mi">2</span><span class="p">,]</span>    <span class="mi">2</span>    <span class="mi">4</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># A frequencies (summed over columns = 1)</span>
<span class="nf">margin.table</span><span class="p">(</span><span class="n">mytable</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">4</span> <span class="mi">6</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># B frequencies (summed over rows = 2)</span>
<span class="nf">margin.table</span><span class="p">(</span><span class="n">mytable</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">3</span> <span class="mi">7</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># A/(A + B)</span>
<span class="c1"># cell percentages</span>
<span class="nf">prop.table</span><span class="p">(</span><span class="n">mytable</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>      <span class="p">[,</span><span class="mi">1</span><span class="p">]</span> <span class="p">[,</span><span class="mi">2</span><span class="p">]</span>
<span class="o">##</span> <span class="p">[</span><span class="mi">1</span><span class="p">,]</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">3</span>
<span class="o">##</span> <span class="p">[</span><span class="mi">2</span><span class="p">,]</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">4</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># row percentages</span>
<span class="nf">prop.table</span><span class="p">(</span><span class="n">mytable</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>           <span class="p">[,</span><span class="mi">1</span><span class="p">]</span>      <span class="p">[,</span><span class="mi">2</span><span class="p">]</span>
<span class="o">##</span> <span class="p">[</span><span class="mi">1</span><span class="p">,]</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2500000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">7500000</span>
<span class="o">##</span> <span class="p">[</span><span class="mi">2</span><span class="p">,]</span> <span class="mi">0</span><span class="p">.</span><span class="mi">3333333</span> <span class="mi">0</span><span class="p">.</span><span class="mi">6666667</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># column percentages </span>
<span class="nf">prop.table</span><span class="p">(</span><span class="n">mytable</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>           <span class="p">[,</span><span class="mi">1</span><span class="p">]</span>      <span class="p">[,</span><span class="mi">2</span><span class="p">]</span>
<span class="o">##</span> <span class="p">[</span><span class="mi">1</span><span class="p">,]</span> <span class="mi">0</span><span class="p">.</span><span class="mi">3333333</span> <span class="mi">0</span><span class="p">.</span><span class="mi">4285714</span>
<span class="o">##</span> <span class="p">[</span><span class="mi">2</span><span class="p">,]</span> <span class="mi">0</span><span class="p">.</span><span class="mi">6666667</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5714286</span>
</pre></div>
</td></tr></table>

<h3 id="3d-frequency-tables">3D frequency tables<a class="headerlink" href="#3d-frequency-tables" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">CO2</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="n">Grouped</span> <span class="k">Data</span><span class="p">:</span> <span class="n">uptake</span> <span class="o">~</span> <span class="n">conc</span> <span class="o">|</span> <span class="n">Plant</span>
<span class="o">##</span>   <span class="n">Plant</span>   <span class="k">Type</span>  <span class="n">Treatment</span> <span class="n">conc</span> <span class="n">uptake</span>
<span class="o">##</span> <span class="mi">1</span>   <span class="n">Qn1</span> <span class="n">Quebec</span> <span class="n">nonchilled</span>   <span class="mi">95</span>   <span class="mi">16</span><span class="p">.</span><span class="mi">0</span>
<span class="o">##</span> <span class="mi">2</span>   <span class="n">Qn1</span> <span class="n">Quebec</span> <span class="n">nonchilled</span>  <span class="mi">175</span>   <span class="mi">30</span><span class="p">.</span><span class="mi">4</span>
<span class="o">##</span> <span class="mi">3</span>   <span class="n">Qn1</span> <span class="n">Quebec</span> <span class="n">nonchilled</span>  <span class="mi">250</span>   <span class="mi">34</span><span class="p">.</span><span class="mi">8</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">A</span> <span class="o">&lt;-</span> <span class="nf">as.numeric</span><span class="p">(</span><span class="n">CO2[</span><span class="p">,</span> <span class="s">&#39;Plant&#39;</span><span class="n">]</span><span class="p">)</span>
<span class="n">B</span> <span class="o">&lt;-</span> <span class="n">CO2[</span><span class="p">,</span> <span class="s">&#39;conc&#39;</span><span class="n">]</span>
<span class="n">C</span> <span class="o">&lt;-</span> <span class="n">CO2[</span><span class="p">,</span> <span class="s">&#39;uptake&#39;</span><span class="n">]</span>
<span class="n">mytable</span> <span class="o">&lt;-</span> <span class="nf">table</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># several arrays (3D)</span>
<span class="nf">dim</span><span class="p">(</span><span class="n">mytable</span><span class="p">)</span> <span class="c1"># the printout is immense</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">12</span>  <span class="mi">7</span> <span class="mi">76</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># folded table (2D)</span>
<span class="nf">dim</span><span class="p">(</span><span class="nf">ftable</span><span class="p">(</span><span class="n">mytable</span><span class="p">))</span> <span class="c1"># the printout is immense</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">84</span> <span class="mi">76</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># 3-Way frequency Table</span>
<span class="n">mytable</span> <span class="o">&lt;-</span> <span class="nf">xtabs</span><span class="p">(</span><span class="o">~</span><span class="n">A</span> <span class="o">+</span> <span class="n">B</span> <span class="o">+</span> <span class="n">C</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mytable</span><span class="p">,</span> <span class="n">na.action</span> <span class="o">=</span> <span class="n">na.omit</span><span class="p">)</span>

<span class="nf">dim</span><span class="p">(</span><span class="nf">ftable</span><span class="p">(</span><span class="n">mytable</span><span class="p">))</span> <span class="c1"># the printout is immense</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">84</span> <span class="mi">76</span>
</pre></div>
</td></tr></table>

<h3 id="crosstable">CrossTable<a class="headerlink" href="#crosstable" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">A</span> <span class="o">&lt;-</span> <span class="nf">as.numeric</span><span class="p">(</span><span class="n">CO2[1</span><span class="o">:</span><span class="m">8</span><span class="p">,</span> <span class="s">&#39;Plant&#39;</span><span class="n">]</span><span class="p">)</span>
<span class="n">A</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">2</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">B</span> <span class="o">&lt;-</span> <span class="n">CO2[1</span><span class="o">:</span><span class="m">8</span><span class="p">,</span> <span class="s">&#39;conc&#39;</span><span class="n">]</span>
<span class="n">B</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>   <span class="mi">95</span>  <span class="mi">175</span>  <span class="mi">250</span>  <span class="mi">350</span>  <span class="mi">500</span>  <span class="mi">675</span> <span class="mi">1000</span>   <span class="mi">95</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># 2-way cross tabulation</span>
<span class="nf">library</span><span class="p">(</span><span class="n">gmodels</span><span class="p">)</span>

<span class="nf">CrossTable</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span> <span class="c1"># mydata$myrowvar x mydata$mycolvar</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  
<span class="o">##</span>    <span class="n">Cell</span> <span class="n">Contents</span>
<span class="o">##</span> <span class="o">|</span><span class="c1">-------------------------|</span>
<span class="o">##</span> <span class="o">|</span>                       <span class="n">N</span> <span class="o">|</span>
<span class="o">##</span> <span class="o">|</span> <span class="n">Chi</span><span class="o">-</span><span class="n">square</span> <span class="n">contribution</span> <span class="o">|</span>
<span class="o">##</span> <span class="o">|</span>           <span class="n">N</span> <span class="o">/</span> <span class="k">Row</span> <span class="n">Total</span> <span class="o">|</span>
<span class="o">##</span> <span class="o">|</span>           <span class="n">N</span> <span class="o">/</span> <span class="n">Col</span> <span class="n">Total</span> <span class="o">|</span>
<span class="o">##</span> <span class="o">|</span>         <span class="n">N</span> <span class="o">/</span> <span class="k">Table</span> <span class="n">Total</span> <span class="o">|</span>
<span class="o">##</span> <span class="o">|</span><span class="c1">-------------------------|</span>
<span class="o">##</span> 
<span class="o">##</span>  
<span class="o">##</span> <span class="n">Total</span> <span class="n">Observations</span> <span class="k">in</span> <span class="k">Table</span><span class="p">:</span>  <span class="mi">8</span> 
<span class="o">##</span> 
<span class="o">##</span>  
<span class="o">##</span>              <span class="o">|</span> <span class="n">B</span> 
<span class="o">##</span>            <span class="n">A</span> <span class="o">|</span>        <span class="mi">95</span> <span class="o">|</span>       <span class="mi">175</span> <span class="o">|</span>       <span class="mi">250</span> <span class="o">|</span>       <span class="mi">350</span> <span class="o">|</span>       <span class="mi">500</span> <span class="o">|</span>       <span class="mi">675</span> <span class="o">|</span>      <span class="mi">1000</span> <span class="o">|</span> <span class="k">Row</span> <span class="n">Total</span> <span class="o">|</span> 
<span class="o">##</span> <span class="c1">-------------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|</span>
<span class="o">##</span>            <span class="mi">1</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>         <span class="mi">7</span> <span class="o">|</span> 
<span class="o">##</span>              <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">321</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">018</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">018</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">018</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">018</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">018</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">018</span> <span class="o">|</span>           <span class="o">|</span> 
<span class="o">##</span>              <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">143</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">143</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">143</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">143</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">143</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">143</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">143</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">875</span> <span class="o">|</span> 
<span class="o">##</span>              <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">500</span> <span class="o">|</span>     <span class="mi">1</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>     <span class="mi">1</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>     <span class="mi">1</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>     <span class="mi">1</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>     <span class="mi">1</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>     <span class="mi">1</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>           <span class="o">|</span> 
<span class="o">##</span>              <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">125</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">125</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">125</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">125</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">125</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">125</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">125</span> <span class="o">|</span>           <span class="o">|</span> 
<span class="o">##</span> <span class="c1">-------------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|</span>
<span class="o">##</span>            <span class="mi">2</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>         <span class="mi">0</span> <span class="o">|</span>         <span class="mi">0</span> <span class="o">|</span>         <span class="mi">0</span> <span class="o">|</span>         <span class="mi">0</span> <span class="o">|</span>         <span class="mi">0</span> <span class="o">|</span>         <span class="mi">0</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span> 
<span class="o">##</span>              <span class="o">|</span>     <span class="mi">2</span><span class="p">.</span><span class="mi">250</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">125</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">125</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">125</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">125</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">125</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">125</span> <span class="o">|</span>           <span class="o">|</span> 
<span class="o">##</span>              <span class="o">|</span>     <span class="mi">1</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">125</span> <span class="o">|</span> 
<span class="o">##</span>              <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">500</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>           <span class="o">|</span> 
<span class="o">##</span>              <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">125</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">000</span> <span class="o">|</span>           <span class="o">|</span> 
<span class="o">##</span> <span class="c1">-------------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|</span>
<span class="o">##</span> <span class="k">Column</span> <span class="n">Total</span> <span class="o">|</span>         <span class="mi">2</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>         <span class="mi">8</span> <span class="o">|</span> 
<span class="o">##</span>              <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">250</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">125</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">125</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">125</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">125</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">125</span> <span class="o">|</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">125</span> <span class="o">|</span>           <span class="o">|</span> 
<span class="o">##</span> <span class="c1">-------------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|</span>
<span class="o">##</span> 
<span class="o">##</span>
</pre></div>
</td></tr></table>

<h3 id="tests-of-independence">Tests of independence<a class="headerlink" href="#tests-of-independence" title="Permanent link">&para;</a></h3>
<p>There are more tests of independence in section 10, Resampling Statistics.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># dataset, a contingency table</span>
<span class="n">colors</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>             <span class="n">fair</span><span class="p">.</span><span class="n">hair</span> <span class="n">red</span><span class="p">.</span><span class="n">hair</span> <span class="n">medium</span><span class="p">.</span><span class="n">hair</span> <span class="n">dark</span><span class="p">.</span><span class="n">hair</span> <span class="n">black</span><span class="p">.</span><span class="n">hair</span>
<span class="o">##</span> <span class="n">blue</span> <span class="n">eyes</span>         <span class="mi">326</span>       <span class="mi">38</span>         <span class="mi">241</span>       <span class="mi">110</span>          <span class="mi">3</span>
<span class="o">##</span> <span class="n">light</span> <span class="n">eyes</span>        <span class="mi">688</span>      <span class="mi">116</span>         <span class="mi">584</span>       <span class="mi">188</span>          <span class="mi">4</span>
<span class="o">##</span> <span class="n">medium</span> <span class="n">eyes</span>       <span class="mi">343</span>       <span class="mi">84</span>         <span class="mi">909</span>       <span class="mi">412</span>         <span class="mi">26</span>
<span class="o">##</span> <span class="n">dark</span> <span class="n">eyes</span>          <span class="mi">98</span>       <span class="mi">48</span>         <span class="mi">403</span>       <span class="mi">681</span>         <span class="mi">85</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># chi-square test on 2-way tables</span>
<span class="c1"># test independence of the row and column variables, p-value is calculated from the asymptotic chi-squared distribution of the test statistic</span>
<span class="nf">chisq.test</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">Pearson</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">Chi</span><span class="o">-</span><span class="n">squared</span> <span class="n">test</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="n">colors</span>
<span class="o">##</span> <span class="n">X</span><span class="o">-</span><span class="n">squared</span> <span class="o">=</span> <span class="mi">1240</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="n">e</span><span class="o">-</span><span class="mi">16</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># dataset, a contingency table in 2x2 matrix form</span>
<span class="n">TeaTasting</span> <span class="o">&lt;-</span>
<span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">3</span><span class="p">),</span>
       <span class="n">nrow</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span>
       <span class="n">dimnames</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">Guess</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;Milk&quot;</span><span class="p">,</span> <span class="s">&quot;Tea&quot;</span><span class="p">),</span>
                       <span class="n">Truth</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;Milk&quot;</span><span class="p">,</span> <span class="s">&quot;Tea&quot;</span><span class="p">)))</span>
<span class="n">TeaTasting</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>       <span class="n">Truth</span>
<span class="o">##</span> <span class="n">Guess</span>  <span class="n">Milk</span> <span class="n">Tea</span>
<span class="o">##</span>   <span class="n">Milk</span>    <span class="mi">3</span>   <span class="mi">1</span>
<span class="o">##</span>   <span class="n">Tea</span>     <span class="mi">1</span>   <span class="mi">3</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Fisher exact test</span>
<span class="nf">fisher.test</span><span class="p">(</span><span class="n">TeaTasting</span><span class="p">,</span> <span class="n">alternative</span> <span class="o">=</span> <span class="s">&quot;greater&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>## 
##  <span class="nv">Fisher</span><span class="s1">&#39;</span><span class="s">s Exact Test for Count Data</span>
## 
## <span class="nv">data</span>:  <span class="nv">TeaTasting</span>
## <span class="nv">p</span><span class="o">-</span><span class="nv">value</span> <span class="o">=</span> <span class="mi">0</span>.<span class="mi">2429</span>
## <span class="nv">alternative</span> <span class="nv">hypothesis</span>: <span class="nv">true</span> <span class="nv">odds</span> <span class="nv">ratio</span> <span class="nv">is</span> <span class="nv">greater</span> <span class="nv">than</span> <span class="mi">1</span>
## <span class="mi">95</span> <span class="nv">percent</span> <span class="nv">confidence</span> <span class="nv">interval</span>:
##  <span class="mi">0</span>.<span class="mi">3135693</span>       <span class="nv">Inf</span>
## <span class="nv">sample</span> <span class="nv">estimates</span>:
## <span class="nv">odds</span> <span class="nv">ratio</span> 
##   <span class="mi">6</span>.<span class="mi">408309</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># 3D contingency table, where the last dimension refers to the strata</span>
<span class="n">Rabbits</span> <span class="o">&lt;-</span>
<span class="nf">array</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span>
        <span class="m">3</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span>
        <span class="m">6</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span>
        <span class="m">5</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span>
        <span class="m">2</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">),</span>
      <span class="n">dim</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">5</span><span class="p">),</span>
      <span class="n">dimnames</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span>
          <span class="n">Delay</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;None&quot;</span><span class="p">,</span> <span class="s">&quot;1.5h&quot;</span><span class="p">),</span>
          <span class="n">Response</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;Cured&quot;</span><span class="p">,</span> <span class="s">&quot;Died&quot;</span><span class="p">),</span>
          <span class="n">Penicillin.Level</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;1/8&quot;</span><span class="p">,</span> <span class="s">&quot;1/4&quot;</span><span class="p">,</span> <span class="s">&quot;1/2&quot;</span><span class="p">,</span> <span class="s">&quot;1&quot;</span><span class="p">,</span> <span class="s">&quot;4&quot;</span><span class="p">)))</span>
<span class="n">Rabbits</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="p">,</span> <span class="p">,</span> <span class="n">Penicillin</span><span class="p">.</span><span class="k">Level</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span>
<span class="o">##</span> 
<span class="o">##</span>       <span class="n">Response</span>
<span class="o">##</span> <span class="n">Delay</span>  <span class="n">Cured</span> <span class="n">Died</span>
<span class="o">##</span>   <span class="k">None</span>     <span class="mi">0</span>    <span class="mi">6</span>
<span class="o">##</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">5</span><span class="n">h</span>     <span class="mi">0</span>    <span class="mi">5</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="p">,</span> <span class="p">,</span> <span class="n">Penicillin</span><span class="p">.</span><span class="k">Level</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span>
<span class="o">##</span> 
<span class="o">##</span>       <span class="n">Response</span>
<span class="o">##</span> <span class="n">Delay</span>  <span class="n">Cured</span> <span class="n">Died</span>
<span class="o">##</span>   <span class="k">None</span>     <span class="mi">3</span>    <span class="mi">3</span>
<span class="o">##</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">5</span><span class="n">h</span>     <span class="mi">0</span>    <span class="mi">6</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="p">,</span> <span class="p">,</span> <span class="n">Penicillin</span><span class="p">.</span><span class="k">Level</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
<span class="o">##</span> 
<span class="o">##</span>       <span class="n">Response</span>
<span class="o">##</span> <span class="n">Delay</span>  <span class="n">Cured</span> <span class="n">Died</span>
<span class="o">##</span>   <span class="k">None</span>     <span class="mi">6</span>    <span class="mi">0</span>
<span class="o">##</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">5</span><span class="n">h</span>     <span class="mi">2</span>    <span class="mi">4</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="p">,</span> <span class="p">,</span> <span class="n">Penicillin</span><span class="p">.</span><span class="k">Level</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">##</span> 
<span class="o">##</span>       <span class="n">Response</span>
<span class="o">##</span> <span class="n">Delay</span>  <span class="n">Cured</span> <span class="n">Died</span>
<span class="o">##</span>   <span class="k">None</span>     <span class="mi">5</span>    <span class="mi">1</span>
<span class="o">##</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">5</span><span class="n">h</span>     <span class="mi">6</span>    <span class="mi">0</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="p">,</span> <span class="p">,</span> <span class="n">Penicillin</span><span class="p">.</span><span class="k">Level</span> <span class="o">=</span> <span class="mi">4</span>
<span class="o">##</span> 
<span class="o">##</span>       <span class="n">Response</span>
<span class="o">##</span> <span class="n">Delay</span>  <span class="n">Cured</span> <span class="n">Died</span>
<span class="o">##</span>   <span class="k">None</span>     <span class="mi">2</span>    <span class="mi">0</span>
<span class="o">##</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">5</span><span class="n">h</span>     <span class="mi">5</span>    <span class="mi">0</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Mantel-Haenszel test / Cochran-Mantel-Haenszel chi-squared test, hypothesis that two nominal variables are conditionally independent in each stratum, assuming that there is no three-way interaction.</span>
<span class="nf">mantelhaen.test</span><span class="p">(</span><span class="n">Rabbits</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">Mantel</span><span class="o">-</span><span class="n">Haenszel</span> <span class="n">chi</span><span class="o">-</span><span class="n">squared</span> <span class="n">test</span> <span class="k">with</span> <span class="n">continuity</span> <span class="n">correction</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="n">Rabbits</span>
<span class="o">##</span> <span class="n">Mantel</span><span class="o">-</span><span class="n">Haenszel</span> <span class="n">X</span><span class="o">-</span><span class="n">squared</span> <span class="o">=</span> <span class="mi">3</span><span class="p">.</span><span class="mi">9286</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">04747</span>
<span class="o">##</span> <span class="n">alternative</span> <span class="n">hypothesis</span><span class="p">:</span> <span class="k">true</span> <span class="n">common</span> <span class="n">odds</span> <span class="n">ratio</span> <span class="k">is</span> <span class="k">not</span> <span class="n">equal</span> <span class="k">to</span> <span class="mi">1</span>
<span class="o">##</span> <span class="mi">95</span> <span class="n">percent</span> <span class="n">confidence</span> <span class="nb">interval</span><span class="p">:</span>
<span class="o">##</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">026713</span> <span class="mi">47</span><span class="p">.</span><span class="mi">725133</span>
<span class="o">##</span> <span class="n">sample</span> <span class="n">estimates</span><span class="p">:</span>
<span class="o">##</span> <span class="n">common</span> <span class="n">odds</span> <span class="n">ratio</span> 
<span class="o">##</span>                 <span class="mi">7</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># dataset</span>
<span class="c1"># 3-way contingency table based on variables A, B, and C</span>
<span class="n">A</span> <span class="o">&lt;-</span> <span class="n">CO2[</span><span class="p">,</span> <span class="s">&#39;Plant&#39;</span><span class="n">]</span>
<span class="n">B</span> <span class="o">&lt;-</span> <span class="n">CO2[</span><span class="p">,</span> <span class="s">&#39;conc&#39;</span><span class="n">]</span>
<span class="n">C</span> <span class="o">&lt;-</span> <span class="n">CO2[</span><span class="p">,</span> <span class="s">&#39;uptake&#39;</span><span class="n">]</span>
<span class="n">mytable</span> <span class="o">&lt;-</span> <span class="nf">xtabs</span><span class="p">(</span><span class="o">~</span><span class="n">A</span><span class="o">+</span><span class="n">B</span><span class="o">+</span><span class="n">C</span><span class="p">)</span> <span class="c1"># a 3D array</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># loglinear Models</span>
<span class="c1"># mutual independence: A, B, and C are pairwise independent</span>
<span class="nf">library</span><span class="p">(</span><span class="n">MASS</span><span class="p">)</span>

<span class="nf">loglm</span><span class="p">(</span><span class="o">~</span><span class="n">A</span> <span class="o">+</span> <span class="n">B</span> <span class="o">+</span> <span class="n">C</span><span class="p">,</span> <span class="n">mytable</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="k">Call</span><span class="p">:</span>
<span class="o">##</span> <span class="n">loglm</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="o">~</span><span class="n">A</span> <span class="o">+</span> <span class="n">B</span> <span class="o">+</span> <span class="k">C</span><span class="p">,</span> <span class="k">data</span> <span class="o">=</span> <span class="n">mytable</span><span class="p">)</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">Statistics</span><span class="p">:</span>
<span class="o">##</span>                        <span class="n">X</span><span class="o">^</span><span class="mi">2</span>   <span class="n">df</span>  <span class="n">P</span><span class="p">(</span><span class="o">&gt;</span> <span class="n">X</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="o">##</span> <span class="n">Likelihood</span> <span class="n">Ratio</span>  <span class="mi">720</span><span class="p">.</span><span class="mi">1035</span> <span class="mi">6291</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0000000</span>
<span class="o">##</span> <span class="n">Pearson</span>          <span class="mi">6300</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">6291</span> <span class="mi">0</span><span class="p">.</span><span class="mi">4656775</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># conditional independence: A is independent of B, given C</span>
<span class="nf">loglm</span><span class="p">(</span><span class="o">~</span><span class="n">A</span> <span class="o">+</span> <span class="n">B</span> <span class="o">+</span> <span class="n">C</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="n">C</span> <span class="o">+</span> <span class="n">B</span> <span class="o">*</span> <span class="n">C</span><span class="p">,</span> <span class="n">mytable</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="k">Call</span><span class="p">:</span>
<span class="o">##</span> <span class="n">loglm</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="o">~</span><span class="n">A</span> <span class="o">+</span> <span class="n">B</span> <span class="o">+</span> <span class="k">C</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="k">C</span> <span class="o">+</span> <span class="n">B</span> <span class="o">*</span> <span class="k">C</span><span class="p">,</span> <span class="k">data</span> <span class="o">=</span> <span class="n">mytable</span><span class="p">)</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">Statistics</span><span class="p">:</span>
<span class="o">##</span>                       <span class="n">X</span><span class="o">^</span><span class="mi">2</span>   <span class="n">df</span> <span class="n">P</span><span class="p">(</span><span class="o">&gt;</span> <span class="n">X</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="o">##</span> <span class="n">Likelihood</span> <span class="n">Ratio</span> <span class="mi">12</span><span class="p">.</span><span class="mi">13685</span> <span class="mi">5016</span>        <span class="mi">1</span>
<span class="o">##</span> <span class="n">Pearson</span>               <span class="n">NaN</span> <span class="mi">5016</span>      <span class="n">NaN</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># no three-way interaction</span>
<span class="nf">loglm</span><span class="p">(</span><span class="o">~</span><span class="n">A</span> <span class="o">+</span> <span class="n">B</span> <span class="o">+</span> <span class="n">C</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="n">B</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="n">C</span> <span class="o">+</span> <span class="n">B</span> <span class="o">*</span> <span class="n">C</span><span class="p">,</span> <span class="n">mytable</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="k">Call</span><span class="p">:</span>
<span class="o">##</span> <span class="n">loglm</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="o">~</span><span class="n">A</span> <span class="o">+</span> <span class="n">B</span> <span class="o">+</span> <span class="k">C</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="n">B</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="k">C</span> <span class="o">+</span> <span class="n">B</span> <span class="o">*</span> <span class="k">C</span><span class="p">,</span> <span class="k">data</span> <span class="o">=</span> <span class="n">mytable</span><span class="p">)</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">Statistics</span><span class="p">:</span>
<span class="o">##</span>                       <span class="n">X</span><span class="o">^</span><span class="mi">2</span>   <span class="n">df</span> <span class="n">P</span><span class="p">(</span><span class="o">&gt;</span> <span class="n">X</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="o">##</span> <span class="n">Likelihood</span> <span class="n">Ratio</span> <span class="mi">1</span><span class="p">.</span><span class="mi">038376</span> <span class="mi">4950</span>        <span class="mi">1</span>
<span class="o">##</span> <span class="n">Pearson</span>               <span class="n">NaN</span> <span class="mi">4950</span>      <span class="n">NaN</span>
</pre></div>
</td></tr></table>

<h3 id="measures-of-association">Measures of association<a class="headerlink" href="#measures-of-association" title="Permanent link">&para;</a></h3>
<p>Association between two nominal variables, giving a value between 0 and +1 (inclusive). It is based on Pearson&rsquo;s chi-squared statistic.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Dataset</span>
<span class="nf">str</span><span class="p">(</span><span class="n">Arthritis</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="s1">&#39;data.frame&#39;</span><span class="p">:</span>    <span class="mi">84</span> <span class="n">obs</span><span class="p">.</span> <span class="k">of</span>  <span class="mi">5</span> <span class="n">variables</span><span class="p">:</span>
<span class="o">##</span>  <span class="err">$</span> <span class="n">ID</span>       <span class="p">:</span> <span class="nb">int</span>  <span class="mi">57</span> <span class="mi">46</span> <span class="mi">77</span> <span class="mi">17</span> <span class="mi">36</span> <span class="mi">23</span> <span class="mi">75</span> <span class="mi">39</span> <span class="mi">33</span> <span class="mi">55</span> <span class="p">...</span>
<span class="o">##</span>  <span class="err">$</span> <span class="n">Treatment</span><span class="p">:</span> <span class="n">Factor</span> <span class="n">w</span><span class="o">/</span> <span class="mi">2</span> <span class="n">levels</span> <span class="ss">&quot;Placebo&quot;</span><span class="p">,</span><span class="ss">&quot;Treated&quot;</span><span class="p">:</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="p">...</span>
<span class="o">##</span>  <span class="err">$</span> <span class="n">Sex</span>      <span class="p">:</span> <span class="n">Factor</span> <span class="n">w</span><span class="o">/</span> <span class="mi">2</span> <span class="n">levels</span> <span class="ss">&quot;Female&quot;</span><span class="p">,</span><span class="ss">&quot;Male&quot;</span><span class="p">:</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="p">...</span>
<span class="o">##</span>  <span class="err">$</span> <span class="n">Age</span>      <span class="p">:</span> <span class="nb">int</span>  <span class="mi">27</span> <span class="mi">29</span> <span class="mi">30</span> <span class="mi">32</span> <span class="mi">46</span> <span class="mi">58</span> <span class="mi">59</span> <span class="mi">59</span> <span class="mi">63</span> <span class="mi">63</span> <span class="p">...</span>
<span class="o">##</span>  <span class="err">$</span> <span class="n">Improved</span> <span class="p">:</span> <span class="n">Ord</span><span class="p">.</span><span class="n">factor</span> <span class="n">w</span><span class="o">/</span> <span class="mi">3</span> <span class="n">levels</span> <span class="ss">&quot;None&quot;</span><span class="o">&lt;</span><span class="ss">&quot;Some&quot;</span><span class="o">&lt;</span><span class="p">..:</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">3</span> <span class="mi">3</span> <span class="mi">3</span> <span class="mi">1</span> <span class="mi">3</span> <span class="mi">1</span> <span class="mi">1</span> <span class="p">...</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">tab</span> <span class="o">&lt;-</span> <span class="nf">xtabs</span><span class="p">(</span><span class="o">~</span><span class="n">Improved</span> <span class="o">+</span> <span class="n">Treatment</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">Arthritis</span><span class="p">)</span>
<span class="n">tab</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>         <span class="n">Treatment</span>
<span class="o">##</span> <span class="n">Improved</span> <span class="n">Placebo</span> <span class="n">Treated</span>
<span class="o">##</span>   <span class="k">None</span>        <span class="mi">29</span>      <span class="mi">13</span>
<span class="o">##</span>   <span class="k">Some</span>         <span class="mi">7</span>       <span class="mi">7</span>
<span class="o">##</span>   <span class="n">Marked</span>       <span class="mi">7</span>      <span class="mi">21</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="nf">assocstats</span><span class="p">(</span><span class="n">tab</span><span class="p">))</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>## 
## <span class="nv">Call</span>: <span class="nv">xtabs</span><span class="ss">(</span><span class="nv">formula</span> <span class="o">=</span> <span class="o">~</span><span class="nv">Improved</span> <span class="o">+</span> <span class="nv">Treatment</span>, <span class="nv">data</span> <span class="o">=</span> <span class="nv">Arthritis</span><span class="ss">)</span>
## <span class="nv">Number</span> <span class="nv">of</span> <span class="nv">cases</span> <span class="nv">in</span> <span class="nv">table</span>: <span class="mi">84</span> 
## <span class="nv">Number</span> <span class="nv">of</span> <span class="nv">factors</span>: <span class="mi">2</span> 
## <span class="nv">Test</span> <span class="k">for</span> <span class="nv">independence</span> <span class="nv">of</span> <span class="nv">all</span> <span class="nv">factors</span>:
##  <span class="nv">Chisq</span> <span class="o">=</span> <span class="mi">13</span>.<span class="mi">055</span>, <span class="nv">df</span> <span class="o">=</span> <span class="mi">2</span>, <span class="nv">p</span><span class="o">-</span><span class="nv">value</span> <span class="o">=</span> <span class="mi">0</span>.<span class="mi">001463</span>
##                     <span class="nv">X</span><span class="o">^</span><span class="mi">2</span> <span class="nv">df</span>  <span class="nv">P</span><span class="ss">(</span><span class="o">&gt;</span> <span class="nv">X</span><span class="o">^</span><span class="mi">2</span><span class="ss">)</span>
## <span class="nv">Likelihood</span> <span class="nv">Ratio</span> <span class="mi">13</span>.<span class="mi">530</span>  <span class="mi">2</span> <span class="mi">0</span>.<span class="mi">0011536</span>
## <span class="nv">Pearson</span>          <span class="mi">13</span>.<span class="mi">055</span>  <span class="mi">2</span> <span class="mi">0</span>.<span class="mi">0014626</span>
## 
## <span class="nv">Phi</span><span class="o">-</span><span class="nv">Coefficient</span>   : <span class="nv">NA</span> 
## <span class="nv">Contingency</span> <span class="nv">Coeff</span>.: <span class="mi">0</span>.<span class="mi">367</span> 
## <span class="nv">Cramer</span><span class="s1">&#39;</span><span class="s">s V        : 0.394</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># phi coefficient, contingency coefficient, and Cramér&#39;s V for an 2D table</span>
<span class="nf">library</span><span class="p">(</span><span class="n">vcd</span><span class="p">)</span>

<span class="nf">assocstats</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>                     <span class="n">X</span><span class="o">^</span><span class="mi">2</span> <span class="n">df</span>  <span class="n">P</span><span class="p">(</span><span class="o">&gt;</span> <span class="n">X</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="o">##</span> <span class="n">Likelihood</span> <span class="n">Ratio</span> <span class="mi">13</span><span class="p">.</span><span class="mi">530</span>  <span class="mi">2</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0011536</span>
<span class="o">##</span> <span class="n">Pearson</span>          <span class="mi">13</span><span class="p">.</span><span class="mi">055</span>  <span class="mi">2</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0014626</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Phi</span><span class="o">-</span><span class="n">Coefficient</span>   <span class="p">:</span> <span class="n">NA</span> 
<span class="o">##</span> <span class="n">Contingency</span> <span class="n">Coeff</span><span class="p">.:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">367</span> 
<span class="o">##</span> <span class="n">Cramer</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">V</span>        <span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">394</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Dataset</span>
<span class="n">TeaTasting</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>       <span class="n">Truth</span>
<span class="o">##</span> <span class="n">Guess</span>  <span class="n">Milk</span> <span class="n">Tea</span>
<span class="o">##</span>   <span class="n">Milk</span>    <span class="mi">3</span>   <span class="mi">1</span>
<span class="o">##</span>   <span class="n">Tea</span>     <span class="mi">1</span>   <span class="mi">3</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Cohen&#39;s kappa and weighted kappa for a confusion matrix</span>
<span class="nf">library</span><span class="p">(</span><span class="n">vcd</span><span class="p">)</span>

<span class="nf">kappa</span><span class="p">(</span><span class="n">TeaTasting</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">2</span><span class="p">.</span><span class="mi">333333</span>
</pre></div>
</td></tr></table>

<h2 id="correlations">Correlations<a class="headerlink" href="#correlations" title="Permanent link">&para;</a></h2>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>                <span class="n">mpg</span> <span class="n">cyl</span> <span class="n">disp</span>  <span class="n">hp</span> <span class="n">drat</span>    <span class="n">wt</span>  <span class="n">qsec</span> <span class="n">vs</span> <span class="n">am</span> <span class="n">gear</span> <span class="n">carb</span>
<span class="o">##</span> <span class="n">Mazda</span> <span class="n">RX4</span>     <span class="mi">21</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">6</span>  <span class="mi">160</span> <span class="mi">110</span> <span class="mi">3</span><span class="p">.</span><span class="mi">90</span> <span class="mi">2</span><span class="p">.</span><span class="mi">620</span> <span class="mi">16</span><span class="p">.</span><span class="mi">46</span>  <span class="mi">0</span>  <span class="mi">1</span>    <span class="mi">4</span>    <span class="mi">4</span>
<span class="o">##</span> <span class="n">Mazda</span> <span class="n">RX4</span> <span class="n">Wag</span> <span class="mi">21</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">6</span>  <span class="mi">160</span> <span class="mi">110</span> <span class="mi">3</span><span class="p">.</span><span class="mi">90</span> <span class="mi">2</span><span class="p">.</span><span class="mi">875</span> <span class="mi">17</span><span class="p">.</span><span class="mi">02</span>  <span class="mi">0</span>  <span class="mi">1</span>    <span class="mi">4</span>    <span class="mi">4</span>
<span class="o">##</span> <span class="n">Datsun</span> <span class="mi">710</span>    <span class="mi">22</span><span class="p">.</span><span class="mi">8</span>   <span class="mi">4</span>  <span class="mi">108</span>  <span class="mi">93</span> <span class="mi">3</span><span class="p">.</span><span class="mi">85</span> <span class="mi">2</span><span class="p">.</span><span class="mi">320</span> <span class="mi">18</span><span class="p">.</span><span class="mi">61</span>  <span class="mi">1</span>  <span class="mi">1</span>    <span class="mi">4</span>    <span class="mi">1</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># correlations/covariances among numeric variables in</span>
<span class="c1"># a data frame</span>
<span class="nf">cor</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">use</span> <span class="o">=</span> <span class="s">&quot;complete.obs&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s">&quot;kendall&quot;</span><span class="p">)</span> <span class="c1"># method = &quot;pearson&quot;, &quot;spearman&quot; or &quot;kendall&quot;</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>             <span class="n">mpg</span>        <span class="n">cyl</span>       <span class="n">disp</span>         <span class="n">hp</span>        <span class="n">drat</span>         <span class="n">wt</span>
<span class="o">##</span> <span class="n">mpg</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">0000000</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">7953134</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">7681311</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">7428125</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">46454879</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">7278321</span>
<span class="o">##</span> <span class="n">cyl</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">7953134</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">0000000</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">8144263</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">7851865</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">55131785</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">7282611</span>
<span class="o">##</span> <span class="n">disp</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">7681311</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">8144263</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">0000000</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">6659987</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">49898277</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">7433824</span>
<span class="o">##</span> <span class="n">hp</span>   <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">7428125</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">7851865</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">6659987</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">0000000</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">38262689</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">6113081</span>
<span class="o">##</span> <span class="n">drat</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">4645488</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">5513178</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">4989828</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">3826269</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">00000000</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">5471495</span>
<span class="o">##</span> <span class="n">wt</span>   <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">7278321</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">7282611</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">7433824</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">6113081</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">54714953</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">0000000</span>
<span class="o">##</span> <span class="n">qsec</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">3153652</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">4489698</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">3008155</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">4729061</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">03272155</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">1419881</span>
<span class="o">##</span> <span class="n">vs</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">5896790</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">7710007</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">6033059</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">6305926</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">37510111</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">4884787</span>
<span class="o">##</span> <span class="n">am</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">4690128</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">4946212</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">5202739</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">3039956</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">57554849</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">6138790</span>
<span class="o">##</span> <span class="n">gear</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">4331509</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">5125435</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">4759795</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">2794458</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">58392476</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">5435956</span>
<span class="o">##</span> <span class="n">carb</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">5043945</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">4654299</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">4137360</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">5959842</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">09535193</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">3713741</span>
<span class="o">##</span>             <span class="n">qsec</span>         <span class="n">vs</span>          <span class="n">am</span>        <span class="n">gear</span>        <span class="n">carb</span>
<span class="o">##</span> <span class="n">mpg</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">31536522</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">5896790</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">46901280</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">43315089</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">50439455</span>
<span class="o">##</span> <span class="n">cyl</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">44896982</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">7710007</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">49462115</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">51254349</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">46542994</span>
<span class="o">##</span> <span class="n">disp</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">30081549</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">6033059</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">52027392</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">47597955</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">41373600</span>
<span class="o">##</span> <span class="n">hp</span>   <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">47290613</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">6305926</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">30399557</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">27944584</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">59598416</span>
<span class="o">##</span> <span class="n">drat</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">03272155</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">3751011</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">57554849</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">58392476</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">09535193</span>
<span class="o">##</span> <span class="n">wt</span>   <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">14198812</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">4884787</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">61387896</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">54359562</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">37137413</span>
<span class="o">##</span> <span class="n">qsec</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">00000000</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">6575431</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">16890405</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">09126069</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">50643945</span>
<span class="o">##</span> <span class="n">vs</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">65754312</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">0000000</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">16834512</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">26974788</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">57692729</span>
<span class="o">##</span> <span class="n">am</span>   <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">16890405</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">1683451</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">00000000</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">77078758</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">05859929</span>
<span class="o">##</span> <span class="n">gear</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">09126069</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">2697479</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">77078758</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">00000000</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">09801487</span>
<span class="o">##</span> <span class="n">carb</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">50643945</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">5769273</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">05859929</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">09801487</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">00000000</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">cov</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">use</span> <span class="o">=</span> <span class="s">&quot;complete.obs&quot;</span><span class="p">)</span> 
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>              <span class="n">mpg</span>         <span class="n">cyl</span>        <span class="n">disp</span>          <span class="n">hp</span>         <span class="n">drat</span>
<span class="o">##</span> <span class="n">mpg</span>    <span class="mi">36</span><span class="p">.</span><span class="mi">324103</span>  <span class="o">-</span><span class="mi">9</span><span class="p">.</span><span class="mi">1723790</span>  <span class="o">-</span><span class="mi">633</span><span class="p">.</span><span class="mi">09721</span> <span class="o">-</span><span class="mi">320</span><span class="p">.</span><span class="mi">732056</span>   <span class="mi">2</span><span class="p">.</span><span class="mi">19506351</span>
<span class="o">##</span> <span class="n">cyl</span>    <span class="o">-</span><span class="mi">9</span><span class="p">.</span><span class="mi">172379</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">1895161</span>   <span class="mi">199</span><span class="p">.</span><span class="mi">66028</span>  <span class="mi">101</span><span class="p">.</span><span class="mi">931452</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">66836694</span>
<span class="o">##</span> <span class="n">disp</span> <span class="o">-</span><span class="mi">633</span><span class="p">.</span><span class="mi">097208</span> <span class="mi">199</span><span class="p">.</span><span class="mi">6602823</span> <span class="mi">15360</span><span class="p">.</span><span class="mi">79983</span> <span class="mi">6721</span><span class="p">.</span><span class="mi">158669</span> <span class="o">-</span><span class="mi">47</span><span class="p">.</span><span class="mi">06401915</span>
<span class="o">##</span> <span class="n">hp</span>   <span class="o">-</span><span class="mi">320</span><span class="p">.</span><span class="mi">732056</span> <span class="mi">101</span><span class="p">.</span><span class="mi">9314516</span>  <span class="mi">6721</span><span class="p">.</span><span class="mi">15867</span> <span class="mi">4700</span><span class="p">.</span><span class="mi">866935</span> <span class="o">-</span><span class="mi">16</span><span class="p">.</span><span class="mi">45110887</span>
<span class="o">##</span> <span class="n">drat</span>    <span class="mi">2</span><span class="p">.</span><span class="mi">195064</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">6683669</span>   <span class="o">-</span><span class="mi">47</span><span class="p">.</span><span class="mi">06402</span>  <span class="o">-</span><span class="mi">16</span><span class="p">.</span><span class="mi">451109</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">28588135</span>
<span class="o">##</span> <span class="n">wt</span>     <span class="o">-</span><span class="mi">5</span><span class="p">.</span><span class="mi">116685</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">3673710</span>   <span class="mi">107</span><span class="p">.</span><span class="mi">68420</span>   <span class="mi">44</span><span class="p">.</span><span class="mi">192661</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">37272073</span>
<span class="o">##</span> <span class="n">qsec</span>    <span class="mi">4</span><span class="p">.</span><span class="mi">509149</span>  <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">8868548</span>   <span class="o">-</span><span class="mi">96</span><span class="p">.</span><span class="mi">05168</span>  <span class="o">-</span><span class="mi">86</span><span class="p">.</span><span class="mi">770081</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">08714073</span>
<span class="o">##</span> <span class="n">vs</span>      <span class="mi">2</span><span class="p">.</span><span class="mi">017137</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">7298387</span>   <span class="o">-</span><span class="mi">44</span><span class="p">.</span><span class="mi">37762</span>  <span class="o">-</span><span class="mi">24</span><span class="p">.</span><span class="mi">987903</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">11864919</span>
<span class="o">##</span> <span class="n">am</span>      <span class="mi">1</span><span class="p">.</span><span class="mi">803931</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">4657258</span>   <span class="o">-</span><span class="mi">36</span><span class="p">.</span><span class="mi">56401</span>   <span class="o">-</span><span class="mi">8</span><span class="p">.</span><span class="mi">320565</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">19015121</span>
<span class="o">##</span> <span class="n">gear</span>    <span class="mi">2</span><span class="p">.</span><span class="mi">135685</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">6491935</span>   <span class="o">-</span><span class="mi">50</span><span class="p">.</span><span class="mi">80262</span>   <span class="o">-</span><span class="mi">6</span><span class="p">.</span><span class="mi">358871</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">27598790</span>
<span class="o">##</span> <span class="n">carb</span>   <span class="o">-</span><span class="mi">5</span><span class="p">.</span><span class="mi">363105</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">5201613</span>    <span class="mi">79</span><span class="p">.</span><span class="mi">06875</span>   <span class="mi">83</span><span class="p">.</span><span class="mi">036290</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">07840726</span>
<span class="o">##</span>               <span class="n">wt</span>         <span class="n">qsec</span>           <span class="n">vs</span>           <span class="n">am</span>        <span class="n">gear</span>
<span class="o">##</span> <span class="n">mpg</span>   <span class="o">-</span><span class="mi">5</span><span class="p">.</span><span class="mi">1166847</span>   <span class="mi">4</span><span class="p">.</span><span class="mi">50914919</span>   <span class="mi">2</span><span class="p">.</span><span class="mi">01713710</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">80393145</span>   <span class="mi">2</span><span class="p">.</span><span class="mi">1356855</span>
<span class="o">##</span> <span class="n">cyl</span>    <span class="mi">1</span><span class="p">.</span><span class="mi">3673710</span>  <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">88685484</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">72983871</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">46572581</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">6491935</span>
<span class="o">##</span> <span class="n">disp</span> <span class="mi">107</span><span class="p">.</span><span class="mi">6842040</span> <span class="o">-</span><span class="mi">96</span><span class="p">.</span><span class="mi">05168145</span> <span class="o">-</span><span class="mi">44</span><span class="p">.</span><span class="mi">37762097</span> <span class="o">-</span><span class="mi">36</span><span class="p">.</span><span class="mi">56401210</span> <span class="o">-</span><span class="mi">50</span><span class="p">.</span><span class="mi">8026210</span>
<span class="o">##</span> <span class="n">hp</span>    <span class="mi">44</span><span class="p">.</span><span class="mi">1926613</span> <span class="o">-</span><span class="mi">86</span><span class="p">.</span><span class="mi">77008065</span> <span class="o">-</span><span class="mi">24</span><span class="p">.</span><span class="mi">98790323</span>  <span class="o">-</span><span class="mi">8</span><span class="p">.</span><span class="mi">32056452</span>  <span class="o">-</span><span class="mi">6</span><span class="p">.</span><span class="mi">3588710</span>
<span class="o">##</span> <span class="n">drat</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">3727207</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">08714073</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">11864919</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">19015121</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">2759879</span>
<span class="o">##</span> <span class="n">wt</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">9573790</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">30548161</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">27366129</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">33810484</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">4210806</span>
<span class="o">##</span> <span class="n">qsec</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">3054816</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">19316613</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">67056452</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">20495968</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">2804032</span>
<span class="o">##</span> <span class="n">vs</span>    <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">2736613</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">67056452</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">25403226</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">04233871</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">0766129</span>
<span class="o">##</span> <span class="n">am</span>    <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">3381048</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">20495968</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">04233871</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">24899194</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">2923387</span>
<span class="o">##</span> <span class="n">gear</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">4210806</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">28040323</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">07661290</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">29233871</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">5443548</span>
<span class="o">##</span> <span class="n">carb</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">6757903</span>  <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">89411290</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">46370968</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">04637097</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">3266129</span>
<span class="o">##</span>             <span class="n">carb</span>
<span class="o">##</span> <span class="n">mpg</span>  <span class="o">-</span><span class="mi">5</span><span class="p">.</span><span class="mi">36310484</span>
<span class="o">##</span> <span class="n">cyl</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">52016129</span>
<span class="o">##</span> <span class="n">disp</span> <span class="mi">79</span><span class="p">.</span><span class="mi">06875000</span>
<span class="o">##</span> <span class="n">hp</span>   <span class="mi">83</span><span class="p">.</span><span class="mi">03629032</span>
<span class="o">##</span> <span class="n">drat</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">07840726</span>
<span class="o">##</span> <span class="n">wt</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">67579032</span>
<span class="o">##</span> <span class="n">qsec</span> <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">89411290</span>
<span class="o">##</span> <span class="n">vs</span>   <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">46370968</span>
<span class="o">##</span> <span class="n">am</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">04637097</span>
<span class="o">##</span> <span class="n">gear</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">32661290</span>
<span class="o">##</span> <span class="n">carb</span>  <span class="mi">2</span><span class="p">.</span><span class="mi">60887097</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># correlations with significance levels</span>
<span class="nf">library</span><span class="p">(</span><span class="n">Hmisc</span><span class="p">)</span>

<span class="nf">rcorr</span><span class="p">(</span><span class="nf">as.matrix</span><span class="p">(</span><span class="n">mtcars</span><span class="p">),</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&quot;pearson&quot;</span><span class="p">)</span> <span class="c1"># type can be pearson or spearman</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>        <span class="n">mpg</span>   <span class="n">cyl</span>  <span class="n">disp</span>    <span class="n">hp</span>  <span class="n">drat</span>    <span class="n">wt</span>  <span class="n">qsec</span>    <span class="n">vs</span>    <span class="n">am</span>  <span class="n">gear</span>  <span class="n">carb</span>
<span class="o">##</span> <span class="n">mpg</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">00</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">85</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">85</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">78</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">68</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">87</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">42</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">66</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">60</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">48</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">55</span>
<span class="o">##</span> <span class="n">cyl</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">85</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">90</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">83</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">70</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">78</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">59</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">81</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">52</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">49</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">53</span>
<span class="o">##</span> <span class="n">disp</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">85</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">90</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">79</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">71</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">89</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">43</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">71</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">59</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">56</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">39</span>
<span class="o">##</span> <span class="n">hp</span>   <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">78</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">83</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">79</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">00</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">45</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">66</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">71</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">72</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">24</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">13</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">75</span>
<span class="o">##</span> <span class="n">drat</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">68</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">70</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">71</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">45</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">00</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">71</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">09</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">44</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">71</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">70</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">09</span>
<span class="o">##</span> <span class="n">wt</span>   <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">87</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">78</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">89</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">66</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">71</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">00</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">17</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">55</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">69</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">58</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">43</span>
<span class="o">##</span> <span class="n">qsec</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">42</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">59</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">43</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">71</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">09</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">17</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">74</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">23</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">21</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">66</span>
<span class="o">##</span> <span class="n">vs</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">66</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">81</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">71</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">72</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">44</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">55</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">74</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">17</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">21</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">57</span>
<span class="o">##</span> <span class="n">am</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">60</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">52</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">59</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">24</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">71</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">69</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">23</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">17</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">79</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">06</span>
<span class="o">##</span> <span class="n">gear</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">48</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">49</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">56</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">13</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">70</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">58</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">21</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">21</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">79</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">27</span>
<span class="o">##</span> <span class="n">carb</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">55</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">53</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">39</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">75</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">09</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">43</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">66</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">57</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">06</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">27</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">n</span><span class="o">=</span> <span class="mi">32</span> 
<span class="o">##</span> 
<span class="o">##</span> 
<span class="o">##</span> <span class="n">P</span>
<span class="o">##</span>      <span class="n">mpg</span>    <span class="n">cyl</span>    <span class="n">disp</span>   <span class="n">hp</span>     <span class="n">drat</span>   <span class="n">wt</span>     <span class="n">qsec</span>   <span class="n">vs</span>     <span class="n">am</span>     <span class="n">gear</span>  
<span class="o">##</span> <span class="n">mpg</span>         <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0171</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0003</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0054</span>
<span class="o">##</span> <span class="n">cyl</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span>        <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0004</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0022</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0042</span>
<span class="o">##</span> <span class="n">disp</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span>        <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0131</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0004</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0010</span>
<span class="o">##</span> <span class="n">hp</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span>        <span class="mi">0</span><span class="p">.</span><span class="mi">0100</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1798</span> <span class="mi">0</span><span class="p">.</span><span class="mi">4930</span>
<span class="o">##</span> <span class="n">drat</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0100</span>        <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">6196</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0117</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span>
<span class="o">##</span> <span class="n">wt</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span>        <span class="mi">0</span><span class="p">.</span><span class="mi">3389</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0010</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0005</span>
<span class="o">##</span> <span class="n">qsec</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0171</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0004</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0131</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">6196</span> <span class="mi">0</span><span class="p">.</span><span class="mi">3389</span>        <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2057</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2425</span>
<span class="o">##</span> <span class="n">vs</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0117</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0010</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span>        <span class="mi">0</span><span class="p">.</span><span class="mi">3570</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2579</span>
<span class="o">##</span> <span class="n">am</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">0003</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0022</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0004</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1798</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2057</span> <span class="mi">0</span><span class="p">.</span><span class="mi">3570</span>        <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span>
<span class="o">##</span> <span class="n">gear</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0054</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0042</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0010</span> <span class="mi">0</span><span class="p">.</span><span class="mi">4930</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0005</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2425</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2579</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span>       
<span class="o">##</span> <span class="n">carb</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0011</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0019</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0253</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">6212</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0146</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0007</span> <span class="mi">0</span><span class="p">.</span><span class="mi">7545</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1290</span>
<span class="o">##</span>      <span class="n">carb</span>  
<span class="o">##</span> <span class="n">mpg</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0011</span>
<span class="o">##</span> <span class="n">cyl</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0019</span>
<span class="o">##</span> <span class="n">disp</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0253</span>
<span class="o">##</span> <span class="n">hp</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span>
<span class="o">##</span> <span class="n">drat</span> <span class="mi">0</span><span class="p">.</span><span class="mi">6212</span>
<span class="o">##</span> <span class="n">wt</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">0146</span>
<span class="o">##</span> <span class="n">qsec</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span>
<span class="o">##</span> <span class="n">vs</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">0007</span>
<span class="o">##</span> <span class="n">am</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">7545</span>
<span class="o">##</span> <span class="n">gear</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1290</span>
<span class="o">##</span> <span class="n">carb</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># dataset</span>
<span class="n">x</span> <span class="o">&lt;-</span> <span class="n">mtcars[1</span><span class="o">:</span><span class="m">3</span><span class="n">]</span>
<span class="n">y</span> <span class="o">&lt;-</span> <span class="n">mtcars[4</span><span class="o">:</span><span class="m">6</span><span class="n">]</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># correlation between two vectors</span>
<span class="nf">cor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>              <span class="n">hp</span>       <span class="n">drat</span>         <span class="n">wt</span>
<span class="o">##</span> <span class="n">mpg</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">7761684</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">6811719</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">8676594</span>
<span class="o">##</span> <span class="n">cyl</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">8324475</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">6999381</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">7824958</span>
<span class="o">##</span> <span class="n">disp</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">7909486</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">7102139</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">8879799</span>
</pre></div>
</td></tr></table>

<p><strong>Polychoric correlation</strong></p>
<p>The correlation between two theorised normally distributed continuous latent variables, from two observed ordinal variables.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># dataset</span>
<span class="c1"># 2-way contingency table of counts</span>
<span class="n">colors</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>             <span class="n">fair</span><span class="p">.</span><span class="n">hair</span> <span class="n">red</span><span class="p">.</span><span class="n">hair</span> <span class="n">medium</span><span class="p">.</span><span class="n">hair</span> <span class="n">dark</span><span class="p">.</span><span class="n">hair</span> <span class="n">black</span><span class="p">.</span><span class="n">hair</span>
<span class="o">##</span> <span class="n">blue</span> <span class="n">eyes</span>         <span class="mi">326</span>       <span class="mi">38</span>         <span class="mi">241</span>       <span class="mi">110</span>          <span class="mi">3</span>
<span class="o">##</span> <span class="n">light</span> <span class="n">eyes</span>        <span class="mi">688</span>      <span class="mi">116</span>         <span class="mi">584</span>       <span class="mi">188</span>          <span class="mi">4</span>
<span class="o">##</span> <span class="n">medium</span> <span class="n">eyes</span>       <span class="mi">343</span>       <span class="mi">84</span>         <span class="mi">909</span>       <span class="mi">412</span>         <span class="mi">26</span>
<span class="o">##</span> <span class="n">dark</span> <span class="n">eyes</span>          <span class="mi">98</span>       <span class="mi">48</span>         <span class="mi">403</span>       <span class="mi">681</span>         <span class="mi">85</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># polychoric correlation</span>
<span class="nf">library</span><span class="p">(</span><span class="n">polycor</span><span class="p">)</span>

<span class="nf">polychor</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">0</span><span class="p">.</span><span class="mi">4743984</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># heterogeneous correlations in one matrix</span>
<span class="c1"># pearson (numeric-numeric),</span>
<span class="c1"># polyserial (numeric-ordinal),</span>
<span class="c1"># and polychoric (ordinal-ordinal)</span>
<span class="c1"># a data frame with ordered factors and numeric variables</span>
<span class="nf">hetcor</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>## 
## <span class="nv">Two</span><span class="o">-</span><span class="nv">Step</span> <span class="nv">Estimates</span>
## 
## <span class="nv">Correlations</span><span class="o">/</span><span class="nv">Type</span> <span class="nv">of</span> <span class="nv">Correlation</span>:
##             <span class="nv">fair</span>.<span class="nv">hair</span> <span class="nv">red</span>.<span class="nv">hair</span> <span class="nv">medium</span>.<span class="nv">hair</span> <span class="nv">dark</span>.<span class="nv">hair</span> <span class="nv">black</span>.<span class="nv">hair</span>
## <span class="nv">fair</span>.<span class="nv">hair</span>           <span class="mi">1</span>  <span class="nv">Pearson</span>     <span class="nv">Pearson</span>   <span class="nv">Pearson</span>    <span class="nv">Pearson</span>
## <span class="nv">red</span>.<span class="nv">hair</span>       <span class="mi">0</span>.<span class="mi">8333</span>        <span class="mi">1</span>     <span class="nv">Pearson</span>   <span class="nv">Pearson</span>    <span class="nv">Pearson</span>
## <span class="nv">medium</span>.<span class="nv">hair</span>    <span class="mi">0</span>.<span class="mi">2597</span>   <span class="mi">0</span>.<span class="mi">6467</span>           <span class="mi">1</span>   <span class="nv">Pearson</span>    <span class="nv">Pearson</span>
## <span class="nv">dark</span>.<span class="nv">hair</span>     <span class="o">-</span><span class="mi">0</span>.<span class="mi">7091</span>  <span class="o">-</span><span class="mi">0</span>.<span class="mi">2251</span>      <span class="mi">0</span>.<span class="mi">1911</span>         <span class="mi">1</span>    <span class="nv">Pearson</span>
## <span class="nv">black</span>.<span class="nv">hair</span>     <span class="o">-</span><span class="mi">0</span>.<span class="mi">781</span>  <span class="o">-</span><span class="mi">0</span>.<span class="mi">3875</span>    <span class="o">-</span><span class="mi">0</span>.<span class="mi">06329</span>    <span class="mi">0</span>.<span class="mi">9674</span>          <span class="mi">1</span>
## 
## <span class="nv">Standard</span> <span class="nv">Errors</span>:
##             <span class="nv">fair</span>.<span class="nv">hair</span> <span class="nv">red</span>.<span class="nv">hair</span> <span class="nv">medium</span>.<span class="nv">hair</span> <span class="nv">dark</span>.<span class="nv">hair</span>
## <span class="nv">fair</span>.<span class="nv">hair</span>                                           
## <span class="nv">red</span>.<span class="nv">hair</span>      <span class="mi">0</span>.<span class="mi">03628</span>                               
## <span class="nv">medium</span>.<span class="nv">hair</span>    <span class="mi">0</span>.<span class="mi">3607</span>   <span class="mi">0</span>.<span class="mi">1383</span>                      
## <span class="nv">dark</span>.<span class="nv">hair</span>     <span class="mi">0</span>.<span class="mi">09977</span>   <span class="mi">0</span>.<span class="mi">3733</span>      <span class="mi">0</span>.<span class="mi">3841</span>          
## <span class="nv">black</span>.<span class="nv">hair</span>    <span class="mi">0</span>.<span class="mi">06019</span>   <span class="mi">0</span>.<span class="mi">3004</span>      <span class="mi">0</span>.<span class="mi">4092</span>  <span class="mi">0</span>.<span class="mi">001491</span>
## 
## <span class="nv">n</span> <span class="o">=</span> <span class="mi">4</span> 
## 
## <span class="nv">P</span><span class="o">-</span><span class="nv">values</span> <span class="k">for</span> <span class="nv">Tests</span> <span class="nv">of</span> <span class="nv">Bivariate</span> <span class="nv">Normality</span>:
##             <span class="nv">fair</span>.<span class="nv">hair</span> <span class="nv">red</span>.<span class="nv">hair</span> <span class="nv">medium</span>.<span class="nv">hair</span> <span class="nv">dark</span>.<span class="nv">hair</span>
## <span class="nv">fair</span>.<span class="nv">hair</span>                                           
## <span class="nv">red</span>.<span class="nv">hair</span>       <span class="mi">0</span>.<span class="mi">8306</span>                               
## <span class="nv">medium</span>.<span class="nv">hair</span>    <span class="mi">0</span>.<span class="mi">6939</span>   <span class="mi">0</span>.<span class="mi">8609</span>                      
## <span class="nv">dark</span>.<span class="nv">hair</span>      <span class="mi">0</span>.<span class="mi">7465</span>   <span class="mi">0</span>.<span class="mi">6335</span>      <span class="mi">0</span>.<span class="mi">7161</span>          
## <span class="nv">black</span>.<span class="nv">hair</span>     <span class="mi">0</span>.<span class="mi">6582</span>   <span class="mi">0</span>.<span class="mi">5927</span>      <span class="mi">0</span>.<span class="mi">6711</span>    <span class="mi">0</span>.<span class="mi">9873</span>
</pre></div>
</td></tr></table>

<h2 id="t-tests">t-tests<a class="headerlink" href="#t-tests" title="Permanent link">&para;</a></h2>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># independent 2-group t-test</span>
<span class="nf">t.test</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">x</span><span class="p">)</span> <span class="c1"># where y is numeric and x is a binary factor</span>

<span class="c1"># independent 2-group t-test</span>
<span class="nf">t.test</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span> <span class="c1"># where y1 and y2 are numeric </span>

<span class="c1"># paired t-test</span>
<span class="nf">t.test</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">paired</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="c1"># where y1 &amp; y2 are numeric </span>

<span class="c1"># one sample t-test</span>
<span class="nf">t.test</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">mu</span> <span class="o">=</span> <span class="m">3</span><span class="p">)</span> <span class="c1"># Ho: mu=3</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># dataset</span>
<span class="c1"># 2-way contingency table</span>
<span class="n">colors</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>             <span class="n">fair</span><span class="p">.</span><span class="n">hair</span> <span class="n">red</span><span class="p">.</span><span class="n">hair</span> <span class="n">medium</span><span class="p">.</span><span class="n">hair</span> <span class="n">dark</span><span class="p">.</span><span class="n">hair</span> <span class="n">black</span><span class="p">.</span><span class="n">hair</span>
<span class="o">##</span> <span class="n">blue</span> <span class="n">eyes</span>         <span class="mi">326</span>       <span class="mi">38</span>         <span class="mi">241</span>       <span class="mi">110</span>          <span class="mi">3</span>
<span class="o">##</span> <span class="n">light</span> <span class="n">eyes</span>        <span class="mi">688</span>      <span class="mi">116</span>         <span class="mi">584</span>       <span class="mi">188</span>          <span class="mi">4</span>
<span class="o">##</span> <span class="n">medium</span> <span class="n">eyes</span>       <span class="mi">343</span>       <span class="mi">84</span>         <span class="mi">909</span>       <span class="mi">412</span>         <span class="mi">26</span>
<span class="o">##</span> <span class="n">dark</span> <span class="n">eyes</span>          <span class="mi">98</span>       <span class="mi">48</span>         <span class="mi">403</span>       <span class="mi">681</span>         <span class="mi">85</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">mean</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">colors[1</span><span class="p">,</span><span class="n">]</span><span class="p">))</span> <span class="c1"># row 1 average</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">143</span><span class="p">.</span><span class="mi">6</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># independent 2-group t-test</span>
<span class="nf">t.test</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">colors[1</span><span class="p">,</span><span class="n">]</span><span class="p">),</span> <span class="nf">as.numeric</span><span class="p">(</span><span class="n">colors[2</span><span class="p">,</span><span class="n">]</span><span class="p">))</span> <span class="c1"># where y1 and y2 are numeric </span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">Welch</span> <span class="n">Two</span> <span class="n">Sample</span> <span class="n">t</span><span class="o">-</span><span class="n">test</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="k">as</span><span class="p">.</span><span class="nb">numeric</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">])</span> <span class="k">and</span> <span class="k">as</span><span class="p">.</span><span class="nb">numeric</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">])</span>
<span class="o">##</span> <span class="n">t</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">164</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="mi">5</span><span class="p">.</span><span class="mi">5777</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2918</span>
<span class="o">##</span> <span class="n">alternative</span> <span class="n">hypothesis</span><span class="p">:</span> <span class="k">true</span> <span class="n">difference</span> <span class="k">in</span> <span class="n">means</span> <span class="k">is</span> <span class="k">not</span> <span class="n">equal</span> <span class="k">to</span> <span class="mi">0</span>
<span class="o">##</span> <span class="mi">95</span> <span class="n">percent</span> <span class="n">confidence</span> <span class="nb">interval</span><span class="p">:</span>
<span class="o">##</span>  <span class="o">-</span><span class="mi">541</span><span class="p">.</span><span class="mi">5725</span>  <span class="mi">196</span><span class="p">.</span><span class="mi">7725</span>
<span class="o">##</span> <span class="n">sample</span> <span class="n">estimates</span><span class="p">:</span>
<span class="o">##</span> <span class="n">mean</span> <span class="k">of</span> <span class="n">x</span> <span class="n">mean</span> <span class="k">of</span> <span class="n">y</span> 
<span class="o">##</span>     <span class="mi">143</span><span class="p">.</span><span class="mi">6</span>     <span class="mi">316</span><span class="p">.</span><span class="mi">0</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># one sample t-test</span>
<span class="nf">t.test</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">colors[1</span><span class="p">,</span><span class="n">]</span><span class="p">),</span> <span class="n">mu</span> <span class="o">=</span> <span class="m">0</span><span class="p">)</span> <span class="c1"># Ho: mu=0</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">One</span> <span class="n">Sample</span> <span class="n">t</span><span class="o">-</span><span class="n">test</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="k">as</span><span class="p">.</span><span class="nb">numeric</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">])</span>
<span class="o">##</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">2</span><span class="p">.</span><span class="mi">348</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">07868</span>
<span class="o">##</span> <span class="n">alternative</span> <span class="n">hypothesis</span><span class="p">:</span> <span class="k">true</span> <span class="n">mean</span> <span class="k">is</span> <span class="k">not</span> <span class="n">equal</span> <span class="k">to</span> <span class="mi">0</span>
<span class="o">##</span> <span class="mi">95</span> <span class="n">percent</span> <span class="n">confidence</span> <span class="nb">interval</span><span class="p">:</span>
<span class="o">##</span>  <span class="o">-</span><span class="mi">26</span><span class="p">.</span><span class="mi">2009</span> <span class="mi">313</span><span class="p">.</span><span class="mi">4009</span>
<span class="o">##</span> <span class="n">sample</span> <span class="n">estimates</span><span class="p">:</span>
<span class="o">##</span> <span class="n">mean</span> <span class="k">of</span> <span class="n">x</span> 
<span class="o">##</span>     <span class="mi">143</span><span class="p">.</span><span class="mi">6</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">t.test</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">colors[1</span><span class="p">,</span><span class="n">]</span><span class="p">),</span> <span class="n">mu</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s">&quot;greater&quot;</span><span class="p">)</span> <span class="c1"># Ho: mu=&lt;0</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">One</span> <span class="n">Sample</span> <span class="n">t</span><span class="o">-</span><span class="n">test</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="k">as</span><span class="p">.</span><span class="nb">numeric</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">])</span>
<span class="o">##</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">2</span><span class="p">.</span><span class="mi">348</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">03934</span>
<span class="o">##</span> <span class="n">alternative</span> <span class="n">hypothesis</span><span class="p">:</span> <span class="k">true</span> <span class="n">mean</span> <span class="k">is</span> <span class="n">greater</span> <span class="k">than</span> <span class="mi">0</span>
<span class="o">##</span> <span class="mi">95</span> <span class="n">percent</span> <span class="n">confidence</span> <span class="nb">interval</span><span class="p">:</span>
<span class="o">##</span>  <span class="mi">13</span><span class="p">.</span><span class="mi">22123</span>      <span class="n">Inf</span>
<span class="o">##</span> <span class="n">sample</span> <span class="n">estimates</span><span class="p">:</span>
<span class="o">##</span> <span class="n">mean</span> <span class="k">of</span> <span class="n">x</span> 
<span class="o">##</span>     <span class="mi">143</span><span class="p">.</span><span class="mi">6</span>
</pre></div>
</td></tr></table>

<ul>
<li><code class="codehilite"><span class="n">alternative</span><span class="o">=</span><span class="ss">&quot;less&quot;</span></code> or <code class="codehilite"><span class="n">alternative</span><span class="o">=</span><span class="ss">&quot;greater&quot;</span></code> option to specify a one tailed test.</li>
<li><code class="codehilite"><span class="n">var</span><span class="p">.</span><span class="n">equal</span> <span class="o">=</span> <span class="k">TRUE</span></code> option to specify equal variances and a pooled variance estimate.</li>
</ul>
<p>For multivariate tests and ANOVA, see sections 8 and 9.</p>
<h2 id="nonparametric-statistics">Nonparametric statistics<a class="headerlink" href="#nonparametric-statistics" title="Permanent link">&para;</a></h2>
<p>Nonnormal distributions.</p>
<h3 id="bivariate-tests">Bivariate tests<a class="headerlink" href="#bivariate-tests" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># independent 2-group Mann-Whitney U test</span>
<span class="nf">wilcox.test</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">A</span><span class="p">)</span> <span class="c1"># where y is numeric and A is A binary factor</span>

<span class="c1"># independent 2-group Mann-Whitney U test</span>
<span class="nf">wilcox.test</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="c1"># where y and x are numeric</span>

<span class="c1"># dependent 2-group Wilcoxon signed rank test</span>
<span class="nf">wilcox.test</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">paired</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="c1"># where y1 and y2 are numeric</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># 2-way contingency table</span>
<span class="n">colors</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>             <span class="n">fair</span><span class="p">.</span><span class="n">hair</span> <span class="n">red</span><span class="p">.</span><span class="n">hair</span> <span class="n">medium</span><span class="p">.</span><span class="n">hair</span> <span class="n">dark</span><span class="p">.</span><span class="n">hair</span> <span class="n">black</span><span class="p">.</span><span class="n">hair</span>
<span class="o">##</span> <span class="n">blue</span> <span class="n">eyes</span>         <span class="mi">326</span>       <span class="mi">38</span>         <span class="mi">241</span>       <span class="mi">110</span>          <span class="mi">3</span>
<span class="o">##</span> <span class="n">light</span> <span class="n">eyes</span>        <span class="mi">688</span>      <span class="mi">116</span>         <span class="mi">584</span>       <span class="mi">188</span>          <span class="mi">4</span>
<span class="o">##</span> <span class="n">medium</span> <span class="n">eyes</span>       <span class="mi">343</span>       <span class="mi">84</span>         <span class="mi">909</span>       <span class="mi">412</span>         <span class="mi">26</span>
<span class="o">##</span> <span class="n">dark</span> <span class="n">eyes</span>          <span class="mi">98</span>       <span class="mi">48</span>         <span class="mi">403</span>       <span class="mi">681</span>         <span class="mi">85</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># independent 2-group Mann-Whitney U Test</span>
<span class="nf">wilcox.test</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">colors[1</span><span class="p">,</span><span class="n">]</span><span class="p">),</span> <span class="nf">as.numeric</span><span class="p">(</span><span class="n">colors[2</span><span class="p">,</span><span class="n">]</span><span class="p">))</span> <span class="c1"># where y and x are numeric</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">Wilcoxon</span> <span class="n">rank</span> <span class="k">sum</span> <span class="n">test</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="k">as</span><span class="p">.</span><span class="nb">numeric</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">])</span> <span class="k">and</span> <span class="k">as</span><span class="p">.</span><span class="nb">numeric</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">])</span>
<span class="o">##</span> <span class="n">W</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">4206</span>
<span class="o">##</span> <span class="n">alternative</span> <span class="n">hypothesis</span><span class="p">:</span> <span class="k">true</span> <span class="k">location</span> <span class="n">shift</span> <span class="k">is</span> <span class="k">not</span> <span class="n">equal</span> <span class="k">to</span> <span class="mi">0</span>
</pre></div>
</td></tr></table>

<p><code class="codehilite"><span class="n">alternative</span><span class="o">=</span><span class="ss">&quot;less&quot;</span></code> or <code class="codehilite"><span class="n">alternative</span><span class="o">=</span><span class="ss">&quot;greater&quot;</span></code> option to specify a one<br />
tailed test.</p>
<h3 id="anova">ANOVA<a class="headerlink" href="#anova" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Kruskal Wallis test one-Way ANOVA by ranks</span>
<span class="nf">kruskal.test</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">A</span><span class="p">)</span> <span class="c1"># where y1 is numeric and A is a factor</span>

<span class="c1"># randomized block design - Friedman test</span>
<span class="nf">friedman.test</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">A</span> <span class="o">|</span> <span class="n">B</span><span class="p">)</span> <span class="c1"># where y are the data values, A is a grouping factor and B is a blocking factor</span>

<span class="c1"># Kruskal Wallis test one-way ANOVA by ranks</span>
<span class="nf">kruskal.test</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="c1"># where y and x are numeric</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># dataset</span>
<span class="c1"># 2-way contingency table</span>
<span class="n">colors</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>             <span class="n">fair</span><span class="p">.</span><span class="n">hair</span> <span class="n">red</span><span class="p">.</span><span class="n">hair</span> <span class="n">medium</span><span class="p">.</span><span class="n">hair</span> <span class="n">dark</span><span class="p">.</span><span class="n">hair</span> <span class="n">black</span><span class="p">.</span><span class="n">hair</span>
<span class="o">##</span> <span class="n">blue</span> <span class="n">eyes</span>         <span class="mi">326</span>       <span class="mi">38</span>         <span class="mi">241</span>       <span class="mi">110</span>          <span class="mi">3</span>
<span class="o">##</span> <span class="n">light</span> <span class="n">eyes</span>        <span class="mi">688</span>      <span class="mi">116</span>         <span class="mi">584</span>       <span class="mi">188</span>          <span class="mi">4</span>
<span class="o">##</span> <span class="n">medium</span> <span class="n">eyes</span>       <span class="mi">343</span>       <span class="mi">84</span>         <span class="mi">909</span>       <span class="mi">412</span>         <span class="mi">26</span>
<span class="o">##</span> <span class="n">dark</span> <span class="n">eyes</span>          <span class="mi">98</span>       <span class="mi">48</span>         <span class="mi">403</span>       <span class="mi">681</span>         <span class="mi">85</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Kruskal Wallis test one-way ANOVA by ranks</span>
<span class="nf">kruskal.test</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">colors[1</span><span class="p">,</span><span class="n">]</span><span class="p">),</span> <span class="nf">as.numeric</span><span class="p">(</span><span class="n">colors[2</span><span class="p">,</span><span class="n">]</span><span class="p">))</span> <span class="c1"># where y and x are numeric</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">Kruskal</span><span class="o">-</span><span class="n">Wallis</span> <span class="n">rank</span> <span class="k">sum</span> <span class="n">test</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="k">as</span><span class="p">.</span><span class="nb">numeric</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">])</span> <span class="k">and</span> <span class="k">as</span><span class="p">.</span><span class="nb">numeric</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">])</span>
<span class="o">##</span> <span class="n">Kruskal</span><span class="o">-</span><span class="n">Wallis</span> <span class="n">chi</span><span class="o">-</span><span class="n">squared</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">406</span>
</pre></div>
</td></tr></table>

<h2 id="multiple-regressions">Multiple Regressions<a class="headerlink" href="#multiple-regressions" title="Permanent link">&para;</a></h2>
<h3 id="fitting-the-model">Fitting the Model<a class="headerlink" href="#fitting-the-model" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># multiple linear regression</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">x3</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mydata</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># show results</span>

<span class="c1"># useful functions</span>
<span class="nf">coefficients</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># model coefficients</span>
<span class="nf">confint</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="m">0.95</span><span class="p">)</span> <span class="c1"># CIs for model parameters</span>
<span class="nf">fitted</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># predicted values</span>
<span class="nf">residuals</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># residuals</span>
<span class="nf">anova</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># ANOVA table</span>
<span class="nf">vcov</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># covariance matrix for model parameters</span>
<span class="nf">influence</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># regression diagnostics </span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># dataset</span>
<span class="nf">str</span><span class="p">(</span><span class="n">longley</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="s1">&#39;data.frame&#39;</span><span class="p">:</span>    <span class="mi">16</span> <span class="n">obs</span><span class="p">.</span> <span class="k">of</span>  <span class="mi">7</span> <span class="n">variables</span><span class="p">:</span>
<span class="o">##</span>  <span class="err">$</span> <span class="n">GNP</span><span class="p">.</span><span class="n">deflator</span><span class="p">:</span> <span class="n">num</span>  <span class="mi">83</span> <span class="mi">88</span><span class="p">.</span><span class="mi">5</span> <span class="mi">88</span><span class="p">.</span><span class="mi">2</span> <span class="mi">89</span><span class="p">.</span><span class="mi">5</span> <span class="mi">96</span><span class="p">.</span><span class="mi">2</span> <span class="p">...</span>
<span class="o">##</span>  <span class="err">$</span> <span class="n">GNP</span>         <span class="p">:</span> <span class="n">num</span>  <span class="mi">234</span> <span class="mi">259</span> <span class="mi">258</span> <span class="mi">285</span> <span class="mi">329</span> <span class="p">...</span>
<span class="o">##</span>  <span class="err">$</span> <span class="n">Unemployed</span>  <span class="p">:</span> <span class="n">num</span>  <span class="mi">236</span> <span class="mi">232</span> <span class="mi">368</span> <span class="mi">335</span> <span class="mi">210</span> <span class="p">...</span>
<span class="o">##</span>  <span class="err">$</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span><span class="p">:</span> <span class="n">num</span>  <span class="mi">159</span> <span class="mi">146</span> <span class="mi">162</span> <span class="mi">165</span> <span class="mi">310</span> <span class="p">...</span>
<span class="o">##</span>  <span class="err">$</span> <span class="n">Population</span>  <span class="p">:</span> <span class="n">num</span>  <span class="mi">108</span> <span class="mi">109</span> <span class="mi">110</span> <span class="mi">111</span> <span class="mi">112</span> <span class="p">...</span>
<span class="o">##</span>  <span class="err">$</span> <span class="k">Year</span>        <span class="p">:</span> <span class="nb">int</span>  <span class="mi">1947</span> <span class="mi">1948</span> <span class="mi">1949</span> <span class="mi">1950</span> <span class="mi">1951</span> <span class="mi">1952</span> <span class="mi">1953</span> <span class="mi">1954</span> <span class="mi">1955</span> <span class="mi">1956</span> <span class="p">...</span>
<span class="o">##</span>  <span class="err">$</span> <span class="n">Employed</span>    <span class="p">:</span> <span class="n">num</span>  <span class="mi">60</span><span class="p">.</span><span class="mi">3</span> <span class="mi">61</span><span class="p">.</span><span class="mi">1</span> <span class="mi">60</span><span class="p">.</span><span class="mi">2</span> <span class="mi">61</span><span class="p">.</span><span class="mi">2</span> <span class="mi">63</span><span class="p">.</span><span class="mi">2</span> <span class="p">...</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># multiple linear regression example</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">Armed.Forces</span> <span class="o">~</span> <span class="n">GNP</span> <span class="o">+</span> <span class="n">Population</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">longley</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># show results</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span> <span class="k">Call</span><span class="p">:</span>
<span class="o">##</span> <span class="n">lm</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span> <span class="o">~</span> <span class="n">GNP</span> <span class="o">+</span> <span class="n">Population</span><span class="p">,</span> <span class="k">data</span> <span class="o">=</span> <span class="n">longley</span><span class="p">)</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Residuals</span><span class="p">:</span>
<span class="o">##</span>     <span class="k">Min</span>      <span class="mi">1</span><span class="n">Q</span>  <span class="n">Median</span>      <span class="mi">3</span><span class="n">Q</span>     <span class="k">Max</span> 
<span class="o">##</span> <span class="o">-</span><span class="mi">70</span><span class="p">.</span><span class="mi">349</span> <span class="o">-</span><span class="mi">33</span><span class="p">.</span><span class="mi">569</span>   <span class="mi">5</span><span class="p">.</span><span class="mi">076</span>  <span class="mi">16</span><span class="p">.</span><span class="mi">409</span> <span class="mi">104</span><span class="p">.</span><span class="mi">037</span> 
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Coefficients</span><span class="p">:</span>
<span class="o">##</span>             <span class="n">Estimate</span> <span class="n">Std</span><span class="p">.</span> <span class="n">Error</span> <span class="n">t</span> <span class="n">value</span> <span class="n">Pr</span><span class="p">(</span><span class="o">&gt;|</span><span class="n">t</span><span class="o">|</span><span class="p">)</span>   
<span class="o">##</span> <span class="p">(</span><span class="n">Intercept</span><span class="p">)</span> <span class="mi">4123</span><span class="p">.</span><span class="mi">922</span>   <span class="mi">1276</span><span class="p">.</span><span class="mi">579</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">230</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">00657</span> <span class="o">**</span>
<span class="o">##</span> <span class="n">GNP</span>            <span class="mi">3</span><span class="p">.</span><span class="mi">365</span>      <span class="mi">0</span><span class="p">.</span><span class="mi">986</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">413</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">00463</span> <span class="o">**</span>
<span class="o">##</span> <span class="n">Population</span>   <span class="o">-</span><span class="mi">44</span><span class="p">.</span><span class="mi">011</span>     <span class="mi">14</span><span class="p">.</span><span class="mi">089</span>  <span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">124</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">00807</span> <span class="o">**</span>
<span class="o">##</span> <span class="c1">---</span>
<span class="o">##</span> <span class="n">Signif</span><span class="p">.</span> <span class="n">codes</span><span class="p">:</span>  <span class="mi">0</span> <span class="s1">&#39;***&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span> <span class="s1">&#39;**&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="s1">&#39;*&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span> <span class="s1">&#39;.&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="s1">&#39; &#39;</span> <span class="mi">1</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Residual</span> <span class="n">standard</span> <span class="n">error</span><span class="p">:</span> <span class="mi">50</span><span class="p">.</span><span class="mi">56</span> <span class="k">on</span> <span class="mi">13</span> <span class="n">degrees</span> <span class="k">of</span> <span class="n">freedom</span>
<span class="o">##</span> <span class="n">Multiple</span> <span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="p">:</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">5426</span><span class="p">,</span> <span class="n">Adjusted</span> <span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="p">:</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">4723</span> 
<span class="o">##</span> <span class="n">F</span><span class="o">-</span><span class="n">statistic</span><span class="p">:</span> <span class="mi">7</span><span class="p">.</span><span class="mi">712</span> <span class="k">on</span> <span class="mi">2</span> <span class="k">and</span> <span class="mi">13</span> <span class="n">DF</span><span class="p">,</span>  <span class="n">p</span><span class="o">-</span><span class="n">value</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">006191</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># other useful functions</span>
<span class="nf">coefficients</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># model coefficients</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="p">(</span><span class="n">Intercept</span><span class="p">)</span>         <span class="n">GNP</span>  <span class="n">Population</span> 
<span class="o">##</span> <span class="mi">4123</span><span class="p">.</span><span class="mi">922484</span>    <span class="mi">3</span><span class="p">.</span><span class="mi">365215</span>  <span class="o">-</span><span class="mi">44</span><span class="p">.</span><span class="mi">010955</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">confint</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="m">0.95</span><span class="p">)</span> <span class="c1"># CIs for model parameters</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>                   <span class="mi">2</span><span class="p">.</span><span class="mi">5</span> <span class="o">%</span>      <span class="mi">97</span><span class="p">.</span><span class="mi">5</span> <span class="o">%</span>
<span class="o">##</span> <span class="p">(</span><span class="n">Intercept</span><span class="p">)</span> <span class="mi">1366</span><span class="p">.</span><span class="mi">042123</span> <span class="mi">6881</span><span class="p">.</span><span class="mi">802846</span>
<span class="o">##</span> <span class="n">GNP</span>            <span class="mi">1</span><span class="p">.</span><span class="mi">235097</span>    <span class="mi">5</span><span class="p">.</span><span class="mi">495333</span>
<span class="o">##</span> <span class="n">Population</span>   <span class="o">-</span><span class="mi">74</span><span class="p">.</span><span class="mi">447969</span>  <span class="o">-</span><span class="mi">13</span><span class="p">.</span><span class="mi">573942</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">fitted</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># predicted values</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>     <span class="mi">1947</span>     <span class="mi">1948</span>     <span class="mi">1949</span>     <span class="mi">1950</span>     <span class="mi">1951</span>     <span class="mi">1952</span>     <span class="mi">1953</span>     <span class="mi">1954</span> 
<span class="o">##</span> <span class="mi">176</span><span class="p">.</span><span class="mi">4245</span> <span class="mi">215</span><span class="p">.</span><span class="mi">9487</span> <span class="mi">161</span><span class="p">.</span><span class="mi">1151</span> <span class="mi">199</span><span class="p">.</span><span class="mi">5681</span> <span class="mi">298</span><span class="p">.</span><span class="mi">4663</span> <span class="mi">306</span><span class="p">.</span><span class="mi">5279</span> <span class="mi">288</span><span class="p">.</span><span class="mi">1248</span> <span class="mi">230</span><span class="p">.</span><span class="mi">9633</span> 
<span class="o">##</span>     <span class="mi">1955</span>     <span class="mi">1956</span>     <span class="mi">1957</span>     <span class="mi">1958</span>     <span class="mi">1959</span>     <span class="mi">1960</span>     <span class="mi">1961</span>     <span class="mi">1962</span> 
<span class="o">##</span> <span class="mi">295</span><span class="p">.</span><span class="mi">1332</span> <span class="mi">308</span><span class="p">.</span><span class="mi">9566</span> <span class="mi">313</span><span class="p">.</span><span class="mi">0359</span> <span class="mi">252</span><span class="p">.</span><span class="mi">7794</span> <span class="mi">318</span><span class="p">.</span><span class="mi">8698</span> <span class="mi">297</span><span class="p">.</span><span class="mi">7176</span> <span class="mi">240</span><span class="p">.</span><span class="mi">7975</span> <span class="mi">266</span><span class="p">.</span><span class="mi">2711</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">residuals</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># residuals</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>        <span class="mi">1947</span>        <span class="mi">1948</span>        <span class="mi">1949</span>        <span class="mi">1950</span>        <span class="mi">1951</span>        <span class="mi">1952</span> 
<span class="o">##</span> <span class="o">-</span><span class="mi">17</span><span class="p">.</span><span class="mi">4245114</span> <span class="o">-</span><span class="mi">70</span><span class="p">.</span><span class="mi">3487085</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">4848669</span> <span class="o">-</span><span class="mi">34</span><span class="p">.</span><span class="mi">5681071</span>  <span class="mi">11</span><span class="p">.</span><span class="mi">4336564</span>  <span class="mi">52</span><span class="p">.</span><span class="mi">8721086</span> 
<span class="o">##</span>        <span class="mi">1953</span>        <span class="mi">1954</span>        <span class="mi">1955</span>        <span class="mi">1956</span>        <span class="mi">1957</span>        <span class="mi">1958</span> 
<span class="o">##</span>  <span class="mi">66</span><span class="p">.</span><span class="mi">5752438</span> <span class="mi">104</span><span class="p">.</span><span class="mi">0367029</span>   <span class="mi">9</span><span class="p">.</span><span class="mi">6668098</span> <span class="o">-</span><span class="mi">23</span><span class="p">.</span><span class="mi">2566323</span> <span class="o">-</span><span class="mi">33</span><span class="p">.</span><span class="mi">2359499</span>  <span class="mi">10</span><span class="p">.</span><span class="mi">9205505</span> 
<span class="o">##</span>        <span class="mi">1959</span>        <span class="mi">1960</span>        <span class="mi">1961</span>        <span class="mi">1962</span> 
<span class="o">##</span> <span class="o">-</span><span class="mi">63</span><span class="p">.</span><span class="mi">6698197</span> <span class="o">-</span><span class="mi">46</span><span class="p">.</span><span class="mi">3175746</span>  <span class="mi">16</span><span class="p">.</span><span class="mi">4025069</span>  <span class="mi">16</span><span class="p">.</span><span class="mi">4288577</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">anova</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># ANOVA table</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="n">Analysis</span> <span class="k">of</span> <span class="n">Variance</span> <span class="k">Table</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Response</span><span class="p">:</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span>
<span class="o">##</span>            <span class="n">Df</span> <span class="k">Sum</span> <span class="n">Sq</span> <span class="n">Mean</span> <span class="n">Sq</span> <span class="n">F</span> <span class="n">value</span>   <span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span>   
<span class="o">##</span> <span class="n">GNP</span>         <span class="mi">1</span>  <span class="mi">14479</span> <span class="mi">14478</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">5</span><span class="p">.</span><span class="mi">6649</span> <span class="mi">0</span><span class="p">.</span><span class="mi">033301</span> <span class="o">*</span> 
<span class="o">##</span> <span class="n">Population</span>  <span class="mi">1</span>  <span class="mi">24941</span> <span class="mi">24940</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">9</span><span class="p">.</span><span class="mi">7583</span> <span class="mi">0</span><span class="p">.</span><span class="mi">008068</span> <span class="o">**</span>
<span class="o">##</span> <span class="n">Residuals</span>  <span class="mi">13</span>  <span class="mi">33226</span>  <span class="mi">2555</span><span class="p">.</span><span class="mi">9</span>                    
<span class="o">##</span> <span class="c1">---</span>
<span class="o">##</span> <span class="n">Signif</span><span class="p">.</span> <span class="n">codes</span><span class="p">:</span>  <span class="mi">0</span> <span class="s1">&#39;***&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span> <span class="s1">&#39;**&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="s1">&#39;*&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span> <span class="s1">&#39;.&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="s1">&#39; &#39;</span> <span class="mi">1</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">vcov</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># covariance matrix for model parameters</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>             <span class="p">(</span><span class="n">Intercept</span><span class="p">)</span>          <span class="n">GNP</span>   <span class="n">Population</span>
<span class="o">##</span> <span class="p">(</span><span class="n">Intercept</span><span class="p">)</span> <span class="mi">1629652</span><span class="p">.</span><span class="mi">882</span> <span class="mi">1239</span><span class="p">.</span><span class="mi">7478355</span> <span class="o">-</span><span class="mi">17970</span><span class="p">.</span><span class="mi">27388</span>
<span class="o">##</span> <span class="n">GNP</span>            <span class="mi">1239</span><span class="p">.</span><span class="mi">748</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">9721911</span>    <span class="o">-</span><span class="mi">13</span><span class="p">.</span><span class="mi">76775</span>
<span class="o">##</span> <span class="n">Population</span>   <span class="o">-</span><span class="mi">17970</span><span class="p">.</span><span class="mi">274</span>  <span class="o">-</span><span class="mi">13</span><span class="p">.</span><span class="mi">7677545</span>    <span class="mi">198</span><span class="p">.</span><span class="mi">49444</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">influence</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># regression diagnostics </span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="err">$</span><span class="n">hat</span>
<span class="o">##</span>       <span class="mi">1947</span>       <span class="mi">1948</span>       <span class="mi">1949</span>       <span class="mi">1950</span>       <span class="mi">1951</span>       <span class="mi">1952</span> 
<span class="o">##</span> <span class="mi">0</span><span class="p">.</span><span class="mi">27412252</span> <span class="mi">0</span><span class="p">.</span><span class="mi">17438942</span> <span class="mi">0</span><span class="p">.</span><span class="mi">31563199</span> <span class="mi">0</span><span class="p">.</span><span class="mi">16765687</span> <span class="mi">0</span><span class="p">.</span><span class="mi">21219668</span> <span class="mi">0</span><span class="p">.</span><span class="mi">21127212</span> 
<span class="o">##</span>       <span class="mi">1953</span>       <span class="mi">1954</span>       <span class="mi">1955</span>       <span class="mi">1956</span>       <span class="mi">1957</span>       <span class="mi">1958</span> 
<span class="o">##</span> <span class="mi">0</span><span class="p">.</span><span class="mi">11339116</span> <span class="mi">0</span><span class="p">.</span><span class="mi">08602104</span> <span class="mi">0</span><span class="p">.</span><span class="mi">10270245</span> <span class="mi">0</span><span class="p">.</span><span class="mi">12845683</span> <span class="mi">0</span><span class="p">.</span><span class="mi">13251347</span> <span class="mi">0</span><span class="p">.</span><span class="mi">11070418</span> 
<span class="o">##</span>       <span class="mi">1959</span>       <span class="mi">1960</span>       <span class="mi">1961</span>       <span class="mi">1962</span> 
<span class="o">##</span> <span class="mi">0</span><span class="p">.</span><span class="mi">15598638</span> <span class="mi">0</span><span class="p">.</span><span class="mi">15164367</span> <span class="mi">0</span><span class="p">.</span><span class="mi">32488437</span> <span class="mi">0</span><span class="p">.</span><span class="mi">33842686</span> 
<span class="o">##</span> 
<span class="o">##</span> <span class="err">$</span><span class="n">coefficients</span>
<span class="o">##</span>      <span class="p">(</span><span class="n">Intercept</span><span class="p">)</span>          <span class="n">GNP</span>  <span class="n">Population</span>
<span class="o">##</span> <span class="mi">1947</span>  <span class="mi">128</span><span class="p">.</span><span class="mi">042531</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">131479474</span> <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">53731106</span>
<span class="o">##</span> <span class="mi">1948</span>   <span class="mi">29</span><span class="p">.</span><span class="mi">040635</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">121992502</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">69544934</span>
<span class="o">##</span> <span class="mi">1949</span>   <span class="o">-</span><span class="mi">6</span><span class="p">.</span><span class="mi">396740</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">005738655</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">07379997</span>
<span class="o">##</span> <span class="mi">1950</span>  <span class="mi">177</span><span class="p">.</span><span class="mi">778426</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">175668519</span> <span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="mi">11609661</span>
<span class="o">##</span> <span class="mi">1951</span>  <span class="mi">133</span><span class="p">.</span><span class="mi">333008</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">093997366</span> <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">43810938</span>
<span class="o">##</span> <span class="mi">1952</span>  <span class="mi">638</span><span class="p">.</span><span class="mi">680267</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">462229807</span> <span class="o">-</span><span class="mi">6</span><span class="p">.</span><span class="mi">92955762</span>
<span class="o">##</span> <span class="mi">1953</span>  <span class="mi">422</span><span class="p">.</span><span class="mi">107967</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">305133565</span> <span class="o">-</span><span class="mi">4</span><span class="p">.</span><span class="mi">56222462</span>
<span class="o">##</span> <span class="mi">1954</span> <span class="o">-</span><span class="mi">385</span><span class="p">.</span><span class="mi">998493</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">325674565</span>  <span class="mi">4</span><span class="p">.</span><span class="mi">42308458</span>
<span class="o">##</span> <span class="mi">1955</span>   <span class="mi">54</span><span class="p">.</span><span class="mi">458118</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">042127997</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">59713302</span>
<span class="o">##</span> <span class="mi">1956</span> <span class="o">-</span><span class="mi">163</span><span class="p">.</span><span class="mi">371695</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">131240587</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">81041089</span>
<span class="o">##</span> <span class="mi">1957</span> <span class="o">-</span><span class="mi">212</span><span class="p">.</span><span class="mi">039316</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">179084306</span>  <span class="mi">2</span><span class="p">.</span><span class="mi">37664757</span>
<span class="o">##</span> <span class="mi">1958</span>  <span class="o">-</span><span class="mi">51</span><span class="p">.</span><span class="mi">395691</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">033854337</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">55600613</span>
<span class="o">##</span> <span class="mi">1959</span> <span class="o">-</span><span class="mi">329</span><span class="p">.</span><span class="mi">488802</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">311550864</span>  <span class="mi">3</span><span class="p">.</span><span class="mi">79446941</span>
<span class="o">##</span> <span class="mi">1960</span>    <span class="mi">3</span><span class="p">.</span><span class="mi">116881</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">049904757</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">10916689</span>
<span class="o">##</span> <span class="mi">1961</span> <span class="o">-</span><span class="mi">242</span><span class="p">.</span><span class="mi">199361</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">158976865</span>  <span class="mi">2</span><span class="p">.</span><span class="mi">60043035</span>
<span class="o">##</span> <span class="mi">1962</span> <span class="o">-</span><span class="mi">194</span><span class="p">.</span><span class="mi">416431</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">113799395</span>  <span class="mi">2</span><span class="p">.</span><span class="mi">04462752</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="err">$</span><span class="n">sigma</span>
<span class="o">##</span>     <span class="mi">1947</span>     <span class="mi">1948</span>     <span class="mi">1949</span>     <span class="mi">1950</span>     <span class="mi">1951</span>     <span class="mi">1952</span>     <span class="mi">1953</span>     <span class="mi">1954</span> 
<span class="o">##</span> <span class="mi">52</span><span class="p">.</span><span class="mi">28757</span> <span class="mi">47</span><span class="p">.</span><span class="mi">63741</span> <span class="mi">52</span><span class="p">.</span><span class="mi">61955</span> <span class="mi">51</span><span class="p">.</span><span class="mi">47046</span> <span class="mi">52</span><span class="p">.</span><span class="mi">48826</span> <span class="mi">49</span><span class="p">.</span><span class="mi">73420</span> <span class="mi">48</span><span class="p">.</span><span class="mi">50003</span> <span class="mi">42</span><span class="p">.</span><span class="mi">21357</span> 
<span class="o">##</span>     <span class="mi">1955</span>     <span class="mi">1956</span>     <span class="mi">1957</span>     <span class="mi">1958</span>     <span class="mi">1959</span>     <span class="mi">1960</span>     <span class="mi">1961</span>     <span class="mi">1962</span> 
<span class="o">##</span> <span class="mi">52</span><span class="p">.</span><span class="mi">53729</span> <span class="mi">52</span><span class="p">.</span><span class="mi">12610</span> <span class="mi">51</span><span class="p">.</span><span class="mi">60167</span> <span class="mi">52</span><span class="p">.</span><span class="mi">51353</span> <span class="mi">48</span><span class="p">.</span><span class="mi">66817</span> <span class="mi">50</span><span class="p">.</span><span class="mi">57779</span> <span class="mi">52</span><span class="p">.</span><span class="mi">30331</span> <span class="mi">52</span><span class="p">.</span><span class="mi">29577</span> 
<span class="o">##</span> 
<span class="o">##</span> <span class="err">$</span><span class="n">wt</span><span class="p">.</span><span class="n">res</span>
<span class="o">##</span>        <span class="mi">1947</span>        <span class="mi">1948</span>        <span class="mi">1949</span>        <span class="mi">1950</span>        <span class="mi">1951</span>        <span class="mi">1952</span> 
<span class="o">##</span> <span class="o">-</span><span class="mi">17</span><span class="p">.</span><span class="mi">4245114</span> <span class="o">-</span><span class="mi">70</span><span class="p">.</span><span class="mi">3487085</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">4848669</span> <span class="o">-</span><span class="mi">34</span><span class="p">.</span><span class="mi">5681071</span>  <span class="mi">11</span><span class="p">.</span><span class="mi">4336564</span>  <span class="mi">52</span><span class="p">.</span><span class="mi">8721086</span> 
<span class="o">##</span>        <span class="mi">1953</span>        <span class="mi">1954</span>        <span class="mi">1955</span>        <span class="mi">1956</span>        <span class="mi">1957</span>        <span class="mi">1958</span> 
<span class="o">##</span>  <span class="mi">66</span><span class="p">.</span><span class="mi">5752438</span> <span class="mi">104</span><span class="p">.</span><span class="mi">0367029</span>   <span class="mi">9</span><span class="p">.</span><span class="mi">6668098</span> <span class="o">-</span><span class="mi">23</span><span class="p">.</span><span class="mi">2566323</span> <span class="o">-</span><span class="mi">33</span><span class="p">.</span><span class="mi">2359499</span>  <span class="mi">10</span><span class="p">.</span><span class="mi">9205505</span> 
<span class="o">##</span>        <span class="mi">1959</span>        <span class="mi">1960</span>        <span class="mi">1961</span>        <span class="mi">1962</span> 
<span class="o">##</span> <span class="o">-</span><span class="mi">63</span><span class="p">.</span><span class="mi">6698197</span> <span class="o">-</span><span class="mi">46</span><span class="p">.</span><span class="mi">3175746</span>  <span class="mi">16</span><span class="p">.</span><span class="mi">4025069</span>  <span class="mi">16</span><span class="p">.</span><span class="mi">4288577</span>
</pre></div>
</td></tr></table>

<h3 id="diagnostic-plots">Diagnostic plots<a class="headerlink" href="#diagnostic-plots" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># diagnostic plots</span>
<span class="nf">layout</span><span class="p">(</span><span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">),</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))</span> <span class="c1"># optional 4 graphs/page</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Notes/unnamed-chunk-44-1.png" /></center></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">layout</span><span class="p">(</span><span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
</pre></div>
</td></tr></table>

<h3 id="comparing-two-models-with-anova">Comparing two models with ANOVA<a class="headerlink" href="#comparing-two-models-with-anova" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># compare models</span>
<span class="n">fit1</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">x3</span> <span class="o">+</span> <span class="n">x4</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mydata</span><span class="p">)</span>
<span class="n">fit2</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span><span class="p">)</span>

<span class="nf">anova</span><span class="p">(</span><span class="n">fit1</span><span class="p">,</span> <span class="n">fit2</span><span class="p">)</span> 
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># compare models</span>
<span class="n">fit1</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">Armed.Forces</span> <span class="o">~</span> <span class="n">GNP</span> <span class="o">+</span> <span class="n">Population</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">longley</span><span class="p">)</span>
<span class="n">fit2</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">Armed.Forces</span> <span class="o">~</span> <span class="n">GNP</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">longley</span><span class="p">)</span>

<span class="nf">anova</span><span class="p">(</span><span class="n">fit1</span><span class="p">,</span> <span class="n">fit2</span><span class="p">)</span> 
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="n">Analysis</span> <span class="k">of</span> <span class="n">Variance</span> <span class="k">Table</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Model</span> <span class="mi">1</span><span class="p">:</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span> <span class="o">~</span> <span class="n">GNP</span> <span class="o">+</span> <span class="n">Population</span>
<span class="o">##</span> <span class="n">Model</span> <span class="mi">2</span><span class="p">:</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span> <span class="o">~</span> <span class="n">GNP</span>
<span class="o">##</span>   <span class="n">Res</span><span class="p">.</span><span class="n">Df</span>   <span class="n">RSS</span> <span class="n">Df</span> <span class="k">Sum</span> <span class="k">of</span> <span class="n">Sq</span>      <span class="n">F</span>   <span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span>   
<span class="o">##</span> <span class="mi">1</span>     <span class="mi">13</span> <span class="mi">33226</span>                                
<span class="o">##</span> <span class="mi">2</span>     <span class="mi">14</span> <span class="mi">58167</span> <span class="o">-</span><span class="mi">1</span>    <span class="o">-</span><span class="mi">24941</span> <span class="mi">9</span><span class="p">.</span><span class="mi">7583</span> <span class="mi">0</span><span class="p">.</span><span class="mi">008068</span> <span class="o">**</span>
<span class="o">##</span> <span class="c1">---</span>
<span class="o">##</span> <span class="n">Signif</span><span class="p">.</span> <span class="n">codes</span><span class="p">:</span>  <span class="mi">0</span> <span class="s1">&#39;***&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span> <span class="s1">&#39;**&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="s1">&#39;*&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span> <span class="s1">&#39;.&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="s1">&#39; &#39;</span> <span class="mi">1</span>
</pre></div>
</td></tr></table>

<h3 id="cross-validation">Cross validation<a class="headerlink" href="#cross-validation" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># dataset</span>
<span class="nf">library</span><span class="p">(</span><span class="n">DAAG</span><span class="p">)</span>

<span class="nf">data</span><span class="p">(</span><span class="n">houseprices</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">houseprices</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>    <span class="n">area</span> <span class="n">bedrooms</span> <span class="n">sale</span><span class="p">.</span><span class="n">price</span>
<span class="o">##</span> <span class="mi">9</span>   <span class="mi">694</span>        <span class="mi">4</span>        <span class="mi">192</span>
<span class="o">##</span> <span class="mi">10</span>  <span class="mi">905</span>        <span class="mi">4</span>        <span class="mi">215</span>
<span class="o">##</span> <span class="mi">11</span>  <span class="mi">802</span>        <span class="mi">4</span>        <span class="mi">215</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># k-fold cross-validation</span>
<span class="nf">library</span><span class="p">(</span><span class="n">DAAG</span><span class="p">)</span>

<span class="c1"># case 1, # 3 fold cross-validation</span>
<span class="nf">CVlm</span><span class="p">(</span><span class="n">houseprices</span><span class="p">,</span> <span class="n">form.lm</span> <span class="o">=</span> <span class="nf">formula</span><span class="p">(</span><span class="n">sale.price</span> <span class="o">~</span> <span class="n">area</span><span class="p">),</span> <span class="n">m</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">dots</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="m">29</span><span class="p">,</span> <span class="n">plotit</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;Observed&quot;</span><span class="p">,</span><span class="s">&quot;Residual&quot;</span><span class="p">),</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;Small symbols show cross-validation predicted values&quot;</span><span class="p">,</span> <span class="n">legend.pos</span> <span class="o">=</span> <span class="s">&quot;topleft&quot;</span><span class="p">,</span> <span class="n">printit</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="n">Analysis</span> <span class="k">of</span> <span class="n">Variance</span> <span class="k">Table</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Response</span><span class="p">:</span> <span class="n">sale</span><span class="p">.</span><span class="n">price</span>
<span class="o">##</span>           <span class="n">Df</span> <span class="k">Sum</span> <span class="n">Sq</span> <span class="n">Mean</span> <span class="n">Sq</span> <span class="n">F</span> <span class="n">value</span> <span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span>  
<span class="o">##</span> <span class="n">area</span>       <span class="mi">1</span>  <span class="mi">18566</span>   <span class="mi">18566</span>       <span class="mi">8</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">014</span> <span class="o">*</span>
<span class="o">##</span> <span class="n">Residuals</span> <span class="mi">13</span>  <span class="mi">30179</span>    <span class="mi">2321</span>                 
<span class="o">##</span> <span class="c1">---</span>
<span class="o">##</span> <span class="n">Signif</span><span class="p">.</span> <span class="n">codes</span><span class="p">:</span>  <span class="mi">0</span> <span class="s1">&#39;***&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span> <span class="s1">&#39;**&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="s1">&#39;*&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span> <span class="s1">&#39;.&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="s1">&#39; &#39;</span> <span class="mi">1</span>
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Notes/unnamed-chunk-48-1.png" /></center></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span> <span class="n">fold</span> <span class="mi">1</span> 
<span class="o">##</span> <span class="n">Observations</span> <span class="k">in</span> <span class="n">test</span> <span class="k">set</span><span class="p">:</span> <span class="mi">5</span> 
<span class="o">##</span>              <span class="mi">11</span>  <span class="mi">20</span>    <span class="mi">21</span>     <span class="mi">22</span>   <span class="mi">23</span>
<span class="o">##</span> <span class="n">area</span>        <span class="mi">802</span> <span class="mi">696</span> <span class="mi">771</span><span class="p">.</span><span class="mi">0</span> <span class="mi">1006</span><span class="p">.</span><span class="mi">0</span> <span class="mi">1191</span>
<span class="o">##</span> <span class="n">cvpred</span>      <span class="mi">204</span> <span class="mi">188</span> <span class="mi">199</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">234</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">262</span>
<span class="o">##</span> <span class="n">sale</span><span class="p">.</span><span class="n">price</span>  <span class="mi">215</span> <span class="mi">255</span> <span class="mi">260</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">293</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">375</span>
<span class="o">##</span> <span class="n">CV</span> <span class="n">residual</span>  <span class="mi">11</span>  <span class="mi">67</span>  <span class="mi">60</span><span class="p">.</span><span class="mi">7</span>   <span class="mi">58</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">113</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">Sum</span> <span class="k">of</span> <span class="n">squares</span> <span class="o">=</span> <span class="mi">24351</span>    <span class="n">Mean</span> <span class="n">square</span> <span class="o">=</span> <span class="mi">4870</span>    <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span> 
<span class="o">##</span> 
<span class="o">##</span> <span class="n">fold</span> <span class="mi">2</span> 
<span class="o">##</span> <span class="n">Observations</span> <span class="k">in</span> <span class="n">test</span> <span class="k">set</span><span class="p">:</span> <span class="mi">5</span> 
<span class="o">##</span>              <span class="mi">10</span>   <span class="mi">13</span>    <span class="mi">14</span>      <span class="mi">17</span>     <span class="mi">18</span>
<span class="o">##</span> <span class="n">area</span>        <span class="mi">905</span>  <span class="mi">716</span> <span class="mi">963</span><span class="p">.</span><span class="mi">0</span> <span class="mi">1018</span><span class="p">.</span><span class="mi">00</span> <span class="mi">887</span><span class="p">.</span><span class="mi">00</span>
<span class="o">##</span> <span class="n">cvpred</span>      <span class="mi">255</span>  <span class="mi">224</span> <span class="mi">264</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">273</span><span class="p">.</span><span class="mi">38</span> <span class="mi">252</span><span class="p">.</span><span class="mi">06</span>
<span class="o">##</span> <span class="n">sale</span><span class="p">.</span><span class="n">price</span>  <span class="mi">215</span>  <span class="mi">113</span> <span class="mi">185</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">276</span><span class="p">.</span><span class="mi">00</span> <span class="mi">260</span><span class="p">.</span><span class="mi">00</span>
<span class="o">##</span> <span class="n">CV</span> <span class="n">residual</span> <span class="o">-</span><span class="mi">40</span> <span class="o">-</span><span class="mi">112</span> <span class="o">-</span><span class="mi">79</span><span class="p">.</span><span class="mi">4</span>    <span class="mi">2</span><span class="p">.</span><span class="mi">62</span>   <span class="mi">7</span><span class="p">.</span><span class="mi">94</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">Sum</span> <span class="k">of</span> <span class="n">squares</span> <span class="o">=</span> <span class="mi">20416</span>    <span class="n">Mean</span> <span class="n">square</span> <span class="o">=</span> <span class="mi">4083</span>    <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span> 
<span class="o">##</span> 
<span class="o">##</span> <span class="n">fold</span> <span class="mi">3</span> 
<span class="o">##</span> <span class="n">Observations</span> <span class="k">in</span> <span class="n">test</span> <span class="k">set</span><span class="p">:</span> <span class="mi">5</span> 
<span class="o">##</span>                 <span class="mi">9</span>   <span class="mi">12</span>     <span class="mi">15</span>    <span class="mi">16</span>     <span class="mi">19</span>
<span class="o">##</span> <span class="n">area</span>        <span class="mi">694</span><span class="p">.</span><span class="mi">0</span> <span class="mi">1366</span> <span class="mi">821</span><span class="p">.</span><span class="mi">00</span> <span class="mi">714</span><span class="p">.</span><span class="mi">0</span> <span class="mi">790</span><span class="p">.</span><span class="mi">00</span>
<span class="o">##</span> <span class="n">cvpred</span>      <span class="mi">183</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">388</span> <span class="mi">221</span><span class="p">.</span><span class="mi">94</span> <span class="mi">189</span><span class="p">.</span><span class="mi">3</span> <span class="mi">212</span><span class="p">.</span><span class="mi">49</span>
<span class="o">##</span> <span class="n">sale</span><span class="p">.</span><span class="n">price</span>  <span class="mi">192</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">274</span> <span class="mi">212</span><span class="p">.</span><span class="mi">00</span> <span class="mi">220</span><span class="p">.</span><span class="mi">0</span> <span class="mi">221</span><span class="p">.</span><span class="mi">50</span>
<span class="o">##</span> <span class="n">CV</span> <span class="n">residual</span>   <span class="mi">8</span><span class="p">.</span><span class="mi">8</span> <span class="o">-</span><span class="mi">114</span>  <span class="o">-</span><span class="mi">9</span><span class="p">.</span><span class="mi">94</span>  <span class="mi">30</span><span class="p">.</span><span class="mi">7</span>   <span class="mi">9</span><span class="p">.</span><span class="mi">01</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">Sum</span> <span class="k">of</span> <span class="n">squares</span> <span class="o">=</span> <span class="mi">14241</span>    <span class="n">Mean</span> <span class="n">square</span> <span class="o">=</span> <span class="mi">2848</span>    <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span> 
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Overall</span> <span class="p">(</span><span class="k">Sum</span> <span class="n">over</span> <span class="k">all</span> <span class="mi">5</span> <span class="n">folds</span><span class="p">)</span> 
<span class="o">##</span>   <span class="n">ms</span> 
<span class="o">##</span> <span class="mi">3934</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">longley</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>      <span class="n">GNP</span><span class="p">.</span><span class="n">deflator</span> <span class="n">GNP</span> <span class="n">Unemployed</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span> <span class="n">Population</span> <span class="k">Year</span> <span class="n">Employed</span>
<span class="o">##</span> <span class="mi">1947</span>         <span class="mi">83</span><span class="p">.</span><span class="mi">0</span> <span class="mi">234</span>        <span class="mi">236</span>          <span class="mi">159</span>        <span class="mi">108</span> <span class="mi">1947</span>     <span class="mi">60</span><span class="p">.</span><span class="mi">3</span>
<span class="o">##</span> <span class="mi">1948</span>         <span class="mi">88</span><span class="p">.</span><span class="mi">5</span> <span class="mi">259</span>        <span class="mi">232</span>          <span class="mi">146</span>        <span class="mi">109</span> <span class="mi">1948</span>     <span class="mi">61</span><span class="p">.</span><span class="mi">1</span>
<span class="o">##</span> <span class="mi">1949</span>         <span class="mi">88</span><span class="p">.</span><span class="mi">2</span> <span class="mi">258</span>        <span class="mi">368</span>          <span class="mi">162</span>        <span class="mi">110</span> <span class="mi">1949</span>     <span class="mi">60</span><span class="p">.</span><span class="mi">2</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># case 2, # 3 fold cross-validation</span>
<span class="nf">CVlm</span><span class="p">(</span><span class="n">longley</span><span class="p">,</span> <span class="n">form.lm</span> <span class="o">=</span> <span class="nf">formula</span><span class="p">(</span><span class="n">Armed.Forces</span> <span class="o">~</span> <span class="n">GNP</span> <span class="o">+</span> <span class="n">Population</span><span class="p">),</span> <span class="n">m</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">dots</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="m">29</span><span class="p">,</span> <span class="n">plotit</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;Observed&quot;</span><span class="p">,</span><span class="s">&quot;Residual&quot;</span><span class="p">),</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;Small symbols show cross-validation predicted values&quot;</span><span class="p">,</span> <span class="n">legend.pos</span> <span class="o">=</span> <span class="s">&quot;topleft&quot;</span><span class="p">,</span> <span class="n">printit</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="n">Analysis</span> <span class="k">of</span> <span class="n">Variance</span> <span class="k">Table</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Response</span><span class="p">:</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span>
<span class="o">##</span>            <span class="n">Df</span> <span class="k">Sum</span> <span class="n">Sq</span> <span class="n">Mean</span> <span class="n">Sq</span> <span class="n">F</span> <span class="n">value</span> <span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span>   
<span class="o">##</span> <span class="n">GNP</span>         <span class="mi">1</span>  <span class="mi">14479</span>   <span class="mi">14479</span>    <span class="mi">5</span><span class="p">.</span><span class="mi">66</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0333</span> <span class="o">*</span> 
<span class="o">##</span> <span class="n">Population</span>  <span class="mi">1</span>  <span class="mi">24941</span>   <span class="mi">24941</span>    <span class="mi">9</span><span class="p">.</span><span class="mi">76</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0081</span> <span class="o">**</span>
<span class="o">##</span> <span class="n">Residuals</span>  <span class="mi">13</span>  <span class="mi">33226</span>    <span class="mi">2556</span>                  
<span class="o">##</span> <span class="c1">---</span>
<span class="o">##</span> <span class="n">Signif</span><span class="p">.</span> <span class="n">codes</span><span class="p">:</span>  <span class="mi">0</span> <span class="s1">&#39;***&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span> <span class="s1">&#39;**&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="s1">&#39;*&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span> <span class="s1">&#39;.&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="s1">&#39; &#39;</span> <span class="mi">1</span>
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Notes/unnamed-chunk-50-1.png" /></center></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span> <span class="n">fold</span> <span class="mi">1</span> 
<span class="o">##</span> <span class="n">Observations</span> <span class="k">in</span> <span class="n">test</span> <span class="k">set</span><span class="p">:</span> <span class="mi">5</span> 
<span class="o">##</span>               <span class="mi">1953</span> <span class="mi">1954</span>  <span class="mi">1957</span>  <span class="mi">1960</span>  <span class="mi">1962</span>
<span class="o">##</span> <span class="n">Predicted</span>    <span class="mi">288</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">231</span> <span class="mi">313</span><span class="p">.</span><span class="mi">0</span> <span class="mi">297</span><span class="p">.</span><span class="mi">7</span> <span class="mi">266</span><span class="p">.</span><span class="mi">3</span>
<span class="o">##</span> <span class="n">cvpred</span>       <span class="mi">281</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">219</span> <span class="mi">310</span><span class="p">.</span><span class="mi">6</span> <span class="mi">295</span><span class="p">.</span><span class="mi">7</span> <span class="mi">263</span><span class="p">.</span><span class="mi">1</span>
<span class="o">##</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span> <span class="mi">354</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">335</span> <span class="mi">279</span><span class="p">.</span><span class="mi">8</span> <span class="mi">251</span><span class="p">.</span><span class="mi">4</span> <span class="mi">282</span><span class="p">.</span><span class="mi">7</span>
<span class="o">##</span> <span class="n">CV</span> <span class="n">residual</span>   <span class="mi">73</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">116</span> <span class="o">-</span><span class="mi">30</span><span class="p">.</span><span class="mi">8</span> <span class="o">-</span><span class="mi">44</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">19</span><span class="p">.</span><span class="mi">6</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">Sum</span> <span class="k">of</span> <span class="n">squares</span> <span class="o">=</span> <span class="mi">22004</span>    <span class="n">Mean</span> <span class="n">square</span> <span class="o">=</span> <span class="mi">4401</span>    <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span> 
<span class="o">##</span> 
<span class="o">##</span> <span class="n">fold</span> <span class="mi">2</span> 
<span class="o">##</span> <span class="n">Observations</span> <span class="k">in</span> <span class="n">test</span> <span class="k">set</span><span class="p">:</span> <span class="mi">6</span> 
<span class="o">##</span>               <span class="mi">1948</span>   <span class="mi">1949</span>   <span class="mi">1955</span>   <span class="mi">1958</span>  <span class="mi">1959</span>  <span class="mi">1961</span>
<span class="o">##</span> <span class="n">Predicted</span>    <span class="mi">215</span><span class="p">.</span><span class="mi">9</span> <span class="mi">161</span><span class="p">.</span><span class="mi">12</span> <span class="mi">295</span><span class="p">.</span><span class="mi">13</span> <span class="mi">252</span><span class="p">.</span><span class="mi">78</span> <span class="mi">318</span><span class="p">.</span><span class="mi">9</span> <span class="mi">240</span><span class="p">.</span><span class="mi">8</span>
<span class="o">##</span> <span class="n">cvpred</span>       <span class="mi">231</span><span class="p">.</span><span class="mi">9</span> <span class="mi">171</span><span class="p">.</span><span class="mi">41</span> <span class="mi">306</span><span class="p">.</span><span class="mi">33</span> <span class="mi">255</span><span class="p">.</span><span class="mi">07</span> <span class="mi">324</span><span class="p">.</span><span class="mi">5</span> <span class="mi">234</span><span class="p">.</span><span class="mi">9</span>
<span class="o">##</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span> <span class="mi">145</span><span class="p">.</span><span class="mi">6</span> <span class="mi">161</span><span class="p">.</span><span class="mi">60</span> <span class="mi">304</span><span class="p">.</span><span class="mi">80</span> <span class="mi">263</span><span class="p">.</span><span class="mi">70</span> <span class="mi">255</span><span class="p">.</span><span class="mi">2</span> <span class="mi">257</span><span class="p">.</span><span class="mi">2</span>
<span class="o">##</span> <span class="n">CV</span> <span class="n">residual</span>  <span class="o">-</span><span class="mi">86</span><span class="p">.</span><span class="mi">3</span>  <span class="o">-</span><span class="mi">9</span><span class="p">.</span><span class="mi">81</span>  <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">53</span>   <span class="mi">8</span><span class="p">.</span><span class="mi">63</span> <span class="o">-</span><span class="mi">69</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">22</span><span class="p">.</span><span class="mi">3</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">Sum</span> <span class="k">of</span> <span class="n">squares</span> <span class="o">=</span> <span class="mi">12917</span>    <span class="n">Mean</span> <span class="n">square</span> <span class="o">=</span> <span class="mi">2153</span>    <span class="n">n</span> <span class="o">=</span> <span class="mi">6</span> 
<span class="o">##</span> 
<span class="o">##</span> <span class="n">fold</span> <span class="mi">3</span> 
<span class="o">##</span> <span class="n">Observations</span> <span class="k">in</span> <span class="n">test</span> <span class="k">set</span><span class="p">:</span> <span class="mi">5</span> 
<span class="o">##</span>               <span class="mi">1947</span>  <span class="mi">1950</span>  <span class="mi">1951</span>  <span class="mi">1952</span>   <span class="mi">1956</span>
<span class="o">##</span> <span class="n">Predicted</span>    <span class="mi">176</span><span class="p">.</span><span class="mi">4</span> <span class="mi">199</span><span class="p">.</span><span class="mi">6</span> <span class="mi">298</span><span class="p">.</span><span class="mi">5</span> <span class="mi">306</span><span class="p">.</span><span class="mi">5</span> <span class="mi">308</span><span class="p">.</span><span class="mi">96</span>
<span class="o">##</span> <span class="n">cvpred</span>       <span class="mi">192</span><span class="p">.</span><span class="mi">8</span> <span class="mi">211</span><span class="p">.</span><span class="mi">9</span> <span class="mi">282</span><span class="p">.</span><span class="mi">3</span> <span class="mi">288</span><span class="p">.</span><span class="mi">9</span> <span class="mi">295</span><span class="p">.</span><span class="mi">17</span>
<span class="o">##</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span> <span class="mi">159</span><span class="p">.</span><span class="mi">0</span> <span class="mi">165</span><span class="p">.</span><span class="mi">0</span> <span class="mi">309</span><span class="p">.</span><span class="mi">9</span> <span class="mi">359</span><span class="p">.</span><span class="mi">4</span> <span class="mi">285</span><span class="p">.</span><span class="mi">70</span>
<span class="o">##</span> <span class="n">CV</span> <span class="n">residual</span>  <span class="o">-</span><span class="mi">33</span><span class="p">.</span><span class="mi">8</span> <span class="o">-</span><span class="mi">46</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">27</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">70</span><span class="p">.</span><span class="mi">5</span>  <span class="o">-</span><span class="mi">9</span><span class="p">.</span><span class="mi">47</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">Sum</span> <span class="k">of</span> <span class="n">squares</span> <span class="o">=</span> <span class="mi">9161</span>    <span class="n">Mean</span> <span class="n">square</span> <span class="o">=</span> <span class="mi">1832</span>    <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span> 
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Overall</span> <span class="p">(</span><span class="k">Sum</span> <span class="n">over</span> <span class="k">all</span> <span class="mi">5</span> <span class="n">folds</span><span class="p">)</span> 
<span class="o">##</span>   <span class="n">ms</span> 
<span class="o">##</span> <span class="mi">2755</span>
</pre></div>
</td></tr></table>

<h3 id="variable-selection-heuristic-methods">Variable selection &ndash; Heuristic methods<a class="headerlink" href="#variable-selection-heuristic-methods" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">longley</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>      <span class="n">GNP</span><span class="p">.</span><span class="n">deflator</span> <span class="n">GNP</span> <span class="n">Unemployed</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span> <span class="n">Population</span> <span class="k">Year</span> <span class="n">Employed</span>
<span class="o">##</span> <span class="mi">1947</span>         <span class="mi">83</span><span class="p">.</span><span class="mi">0</span> <span class="mi">234</span>        <span class="mi">236</span>          <span class="mi">159</span>        <span class="mi">108</span> <span class="mi">1947</span>     <span class="mi">60</span><span class="p">.</span><span class="mi">3</span>
<span class="o">##</span> <span class="mi">1948</span>         <span class="mi">88</span><span class="p">.</span><span class="mi">5</span> <span class="mi">259</span>        <span class="mi">232</span>          <span class="mi">146</span>        <span class="mi">109</span> <span class="mi">1948</span>     <span class="mi">61</span><span class="p">.</span><span class="mi">1</span>
<span class="o">##</span> <span class="mi">1949</span>         <span class="mi">88</span><span class="p">.</span><span class="mi">2</span> <span class="mi">258</span>        <span class="mi">368</span>          <span class="mi">162</span>        <span class="mi">110</span> <span class="mi">1949</span>     <span class="mi">60</span><span class="p">.</span><span class="mi">2</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Stepwise Regression</span>
<span class="nf">library</span><span class="p">(</span><span class="n">MASS</span><span class="p">)</span>

<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">Armed.Forces</span> <span class="o">~</span> <span class="n">GNP</span> <span class="o">+</span> <span class="n">Population</span> <span class="o">+</span> <span class="n">Employed</span> <span class="o">+</span> <span class="n">Unemployed</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">longley</span><span class="p">)</span>
<span class="n">step</span> <span class="o">&lt;-</span> <span class="nf">stepAIC</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s">&quot;both&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="k">Start</span><span class="p">:</span>  <span class="n">AIC</span><span class="o">=</span><span class="mi">125</span>
<span class="o">##</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span> <span class="o">~</span> <span class="n">GNP</span> <span class="o">+</span> <span class="n">Population</span> <span class="o">+</span> <span class="n">Employed</span> <span class="o">+</span> <span class="n">Unemployed</span>
<span class="o">##</span> 
<span class="o">##</span>              <span class="n">Df</span> <span class="k">Sum</span> <span class="k">of</span> <span class="n">Sq</span>   <span class="n">RSS</span> <span class="n">AIC</span>
<span class="o">##</span> <span class="o">&lt;</span><span class="k">none</span><span class="o">&gt;</span>                    <span class="mi">21655</span> <span class="mi">125</span>
<span class="o">##</span> <span class="o">-</span> <span class="n">Unemployed</span>  <span class="mi">1</span>      <span class="mi">4508</span> <span class="mi">26163</span> <span class="mi">126</span>
<span class="o">##</span> <span class="o">-</span> <span class="n">Population</span>  <span class="mi">1</span>      <span class="mi">5522</span> <span class="mi">27177</span> <span class="mi">127</span>
<span class="o">##</span> <span class="o">-</span> <span class="n">Employed</span>    <span class="mi">1</span>     <span class="mi">10208</span> <span class="mi">31863</span> <span class="mi">130</span>
<span class="o">##</span> <span class="o">-</span> <span class="n">GNP</span>         <span class="mi">1</span>     <span class="mi">15323</span> <span class="mi">36978</span> <span class="mi">132</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">step</span><span class="o">$</span><span class="n">anova</span> <span class="c1"># display results</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="n">Stepwise</span> <span class="n">Model</span> <span class="n">Path</span> 
<span class="o">##</span> <span class="n">Analysis</span> <span class="k">of</span> <span class="n">Deviance</span> <span class="k">Table</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Initial</span> <span class="n">Model</span><span class="p">:</span>
<span class="o">##</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span> <span class="o">~</span> <span class="n">GNP</span> <span class="o">+</span> <span class="n">Population</span> <span class="o">+</span> <span class="n">Employed</span> <span class="o">+</span> <span class="n">Unemployed</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">Final</span> <span class="n">Model</span><span class="p">:</span>
<span class="o">##</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span> <span class="o">~</span> <span class="n">GNP</span> <span class="o">+</span> <span class="n">Population</span> <span class="o">+</span> <span class="n">Employed</span> <span class="o">+</span> <span class="n">Unemployed</span>
<span class="o">##</span> 
<span class="o">##</span> 
<span class="o">##</span>   <span class="n">Step</span> <span class="n">Df</span> <span class="n">Deviance</span> <span class="n">Resid</span><span class="p">.</span> <span class="n">Df</span> <span class="n">Resid</span><span class="p">.</span> <span class="n">Dev</span> <span class="n">AIC</span>
<span class="o">##</span> <span class="mi">1</span>                         <span class="mi">11</span>      <span class="mi">21655</span> <span class="mi">125</span>
</pre></div>
</td></tr></table>

<p>The goal is to reduce the AIC. Adding variable does not improve the model. Let&rsquo;s opt for the most valuable variable.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">Armed.Forces</span> <span class="o">~</span> <span class="n">Unemployed</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">longley</span><span class="p">)</span>
<span class="n">step</span> <span class="o">&lt;-</span> <span class="nf">stepAIC</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="s">&quot;both&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="k">Start</span><span class="p">:</span>  <span class="n">AIC</span><span class="o">=</span><span class="mi">138</span>
<span class="o">##</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span> <span class="o">~</span> <span class="n">Unemployed</span>
<span class="o">##</span> 
<span class="o">##</span>              <span class="n">Df</span> <span class="k">Sum</span> <span class="k">of</span> <span class="n">Sq</span>   <span class="n">RSS</span> <span class="n">AIC</span>
<span class="o">##</span> <span class="o">-</span> <span class="n">Unemployed</span>  <span class="mi">1</span>      <span class="mi">2287</span> <span class="mi">72646</span> <span class="mi">137</span>
<span class="o">##</span> <span class="o">&lt;</span><span class="k">none</span><span class="o">&gt;</span>                    <span class="mi">70359</span> <span class="mi">138</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Step</span><span class="p">:</span>  <span class="n">AIC</span><span class="o">=</span><span class="mi">137</span>
<span class="o">##</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span> <span class="o">~</span> <span class="mi">1</span>
<span class="o">##</span> 
<span class="o">##</span>              <span class="n">Df</span> <span class="k">Sum</span> <span class="k">of</span> <span class="n">Sq</span>   <span class="n">RSS</span> <span class="n">AIC</span>
<span class="o">##</span> <span class="o">&lt;</span><span class="k">none</span><span class="o">&gt;</span>                    <span class="mi">72646</span> <span class="mi">137</span>
<span class="o">##</span> <span class="o">+</span> <span class="n">Unemployed</span>  <span class="mi">1</span>      <span class="mi">2287</span> <span class="mi">70359</span> <span class="mi">138</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">step</span><span class="o">$</span><span class="n">anova</span> <span class="c1"># display results</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="n">Stepwise</span> <span class="n">Model</span> <span class="n">Path</span> 
<span class="o">##</span> <span class="n">Analysis</span> <span class="k">of</span> <span class="n">Deviance</span> <span class="k">Table</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Initial</span> <span class="n">Model</span><span class="p">:</span>
<span class="o">##</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span> <span class="o">~</span> <span class="n">Unemployed</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">Final</span> <span class="n">Model</span><span class="p">:</span>
<span class="o">##</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span> <span class="o">~</span> <span class="mi">1</span>
<span class="o">##</span> 
<span class="o">##</span> 
<span class="o">##</span>           <span class="n">Step</span> <span class="n">Df</span> <span class="n">Deviance</span> <span class="n">Resid</span><span class="p">.</span> <span class="n">Df</span> <span class="n">Resid</span><span class="p">.</span> <span class="n">Dev</span> <span class="n">AIC</span>
<span class="o">##</span> <span class="mi">1</span>                                 <span class="mi">14</span>      <span class="mi">70359</span> <span class="mi">138</span>
<span class="o">##</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">Unemployed</span>  <span class="mi">1</span>     <span class="mi">2287</span>        <span class="mi">15</span>      <span class="mi">72646</span> <span class="mi">137</span>
</pre></div>
</td></tr></table>

<h3 id="variable-selection-graphical-methods">Variable selection &ndash; Graphical methods<a class="headerlink" href="#variable-selection-graphical-methods" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># model</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">Armed.Forces</span> <span class="o">~</span> <span class="n">GNP</span> <span class="o">+</span> <span class="n">Population</span> <span class="o">+</span> <span class="n">Employed</span> <span class="o">+</span> <span class="n">Unemployed</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">longley</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># all Subsets Regression</span>
<span class="nf">library</span><span class="p">(</span><span class="n">leaps</span><span class="p">)</span>

<span class="n">leaps</span> <span class="o">&lt;-</span> <span class="nf">regsubsets</span><span class="p">(</span><span class="n">Armed.Forces</span> <span class="o">~</span> <span class="n">GNP</span> <span class="o">+</span> <span class="n">Population</span> <span class="o">+</span> <span class="n">Employed</span> <span class="o">+</span> <span class="n">Unemployed</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">longley</span><span class="p">,</span> <span class="n">nbest</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span>

<span class="c1"># view results</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">leaps</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="n">Subset</span> <span class="n">selection</span> <span class="k">object</span>
<span class="o">##</span> <span class="k">Call</span><span class="p">:</span> <span class="n">regsubsets</span><span class="p">.</span><span class="n">formula</span><span class="p">(</span><span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span> <span class="o">~</span> <span class="n">GNP</span> <span class="o">+</span> <span class="n">Population</span> <span class="o">+</span> <span class="n">Employed</span> <span class="o">+</span> 
<span class="o">##</span>     <span class="n">Unemployed</span><span class="p">,</span> <span class="k">data</span> <span class="o">=</span> <span class="n">longley</span><span class="p">,</span> <span class="n">nbest</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="o">##</span> <span class="mi">4</span> <span class="n">Variables</span>  <span class="p">(</span><span class="k">and</span> <span class="n">intercept</span><span class="p">)</span>
<span class="o">##</span>            <span class="n">Forced</span> <span class="k">in</span> <span class="n">Forced</span> <span class="k">out</span>
<span class="o">##</span> <span class="n">GNP</span>            <span class="k">FALSE</span>      <span class="k">FALSE</span>
<span class="o">##</span> <span class="n">Population</span>     <span class="k">FALSE</span>      <span class="k">FALSE</span>
<span class="o">##</span> <span class="n">Employed</span>       <span class="k">FALSE</span>      <span class="k">FALSE</span>
<span class="o">##</span> <span class="n">Unemployed</span>     <span class="k">FALSE</span>      <span class="k">FALSE</span>
<span class="o">##</span> <span class="mi">10</span> <span class="n">subsets</span> <span class="k">of</span> <span class="k">each</span> <span class="k">size</span> <span class="n">up</span> <span class="k">to</span> <span class="mi">4</span>
<span class="o">##</span> <span class="n">Selection</span> <span class="n">Algorithm</span><span class="p">:</span> <span class="n">exhaustive</span>
<span class="o">##</span>          <span class="n">GNP</span> <span class="n">Population</span> <span class="n">Employed</span> <span class="n">Unemployed</span>
<span class="o">##</span> <span class="mi">1</span>  <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span> <span class="ss">&quot; &quot;</span> <span class="ss">&quot; &quot;</span>        <span class="ss">&quot;*&quot;</span>      <span class="ss">&quot; &quot;</span>       
<span class="o">##</span> <span class="mi">1</span>  <span class="p">(</span> <span class="mi">2</span> <span class="p">)</span> <span class="ss">&quot;*&quot;</span> <span class="ss">&quot; &quot;</span>        <span class="ss">&quot; &quot;</span>      <span class="ss">&quot; &quot;</span>       
<span class="o">##</span> <span class="mi">1</span>  <span class="p">(</span> <span class="mi">3</span> <span class="p">)</span> <span class="ss">&quot; &quot;</span> <span class="ss">&quot;*&quot;</span>        <span class="ss">&quot; &quot;</span>      <span class="ss">&quot; &quot;</span>       
<span class="o">##</span> <span class="mi">1</span>  <span class="p">(</span> <span class="mi">4</span> <span class="p">)</span> <span class="ss">&quot; &quot;</span> <span class="ss">&quot; &quot;</span>        <span class="ss">&quot; &quot;</span>      <span class="ss">&quot;*&quot;</span>       
<span class="o">##</span> <span class="mi">2</span>  <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span> <span class="ss">&quot;*&quot;</span> <span class="ss">&quot;*&quot;</span>        <span class="ss">&quot; &quot;</span>      <span class="ss">&quot; &quot;</span>       
<span class="o">##</span> <span class="mi">2</span>  <span class="p">(</span> <span class="mi">2</span> <span class="p">)</span> <span class="ss">&quot;*&quot;</span> <span class="ss">&quot; &quot;</span>        <span class="ss">&quot; &quot;</span>      <span class="ss">&quot;*&quot;</span>       
<span class="o">##</span> <span class="mi">2</span>  <span class="p">(</span> <span class="mi">3</span> <span class="p">)</span> <span class="ss">&quot; &quot;</span> <span class="ss">&quot;*&quot;</span>        <span class="ss">&quot; &quot;</span>      <span class="ss">&quot;*&quot;</span>       
<span class="o">##</span> <span class="mi">2</span>  <span class="p">(</span> <span class="mi">4</span> <span class="p">)</span> <span class="ss">&quot; &quot;</span> <span class="ss">&quot; &quot;</span>        <span class="ss">&quot;*&quot;</span>      <span class="ss">&quot;*&quot;</span>       
<span class="o">##</span> <span class="mi">2</span>  <span class="p">(</span> <span class="mi">5</span> <span class="p">)</span> <span class="ss">&quot; &quot;</span> <span class="ss">&quot;*&quot;</span>        <span class="ss">&quot;*&quot;</span>      <span class="ss">&quot; &quot;</span>       
<span class="o">##</span> <span class="mi">2</span>  <span class="p">(</span> <span class="mi">6</span> <span class="p">)</span> <span class="ss">&quot;*&quot;</span> <span class="ss">&quot; &quot;</span>        <span class="ss">&quot;*&quot;</span>      <span class="ss">&quot; &quot;</span>       
<span class="o">##</span> <span class="mi">3</span>  <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span> <span class="ss">&quot;*&quot;</span> <span class="ss">&quot;*&quot;</span>        <span class="ss">&quot;*&quot;</span>      <span class="ss">&quot; &quot;</span>       
<span class="o">##</span> <span class="mi">3</span>  <span class="p">(</span> <span class="mi">2</span> <span class="p">)</span> <span class="ss">&quot;*&quot;</span> <span class="ss">&quot; &quot;</span>        <span class="ss">&quot;*&quot;</span>      <span class="ss">&quot;*&quot;</span>       
<span class="o">##</span> <span class="mi">3</span>  <span class="p">(</span> <span class="mi">3</span> <span class="p">)</span> <span class="ss">&quot;*&quot;</span> <span class="ss">&quot;*&quot;</span>        <span class="ss">&quot; &quot;</span>      <span class="ss">&quot;*&quot;</span>       
<span class="o">##</span> <span class="mi">3</span>  <span class="p">(</span> <span class="mi">4</span> <span class="p">)</span> <span class="ss">&quot; &quot;</span> <span class="ss">&quot;*&quot;</span>        <span class="ss">&quot;*&quot;</span>      <span class="ss">&quot;*&quot;</span>       
<span class="o">##</span> <span class="mi">4</span>  <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span> <span class="ss">&quot;*&quot;</span> <span class="ss">&quot;*&quot;</span>        <span class="ss">&quot;*&quot;</span>      <span class="ss">&quot;*&quot;</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># plot a table of models showing variables in each model</span>
<span class="c1"># models are ordered by the selection statistic</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">leaps</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="s">&quot;r2&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Notes/unnamed-chunk-55-1.png" /></center></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># plot statistic by subset size</span>
<span class="nf">library</span><span class="p">(</span><span class="n">car</span><span class="p">)</span>

<span class="nf">subsets</span><span class="p">(</span><span class="n">leaps</span><span class="p">,</span> <span class="n">statistic</span> <span class="o">=</span> <span class="s">&quot;rsq&quot;</span><span class="p">,</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span> <span class="c1"># available criteria are rsq, rss, adjr2, cp, bic</span>
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Notes/unnamed-chunk-55-2.png" /></center></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>            <span class="n">Abbreviation</span>
<span class="o">##</span> <span class="n">GNP</span>                   <span class="k">G</span>
<span class="o">##</span> <span class="n">Population</span>            <span class="n">P</span>
<span class="o">##</span> <span class="n">Employed</span>              <span class="n">E</span>
<span class="o">##</span> <span class="n">Unemployed</span>            <span class="n">U</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">subsets</span><span class="p">(</span><span class="n">leaps</span><span class="p">,</span> <span class="n">statistic</span> <span class="o">=</span> <span class="s">&quot;bic&quot;</span><span class="p">,</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span> <span class="c1"># available criteria are rsq, rss, adjr2, cp, bic</span>
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Notes/unnamed-chunk-55-3.png" /></center></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>            <span class="n">Abbreviation</span>
<span class="o">##</span> <span class="n">GNP</span>                   <span class="k">G</span>
<span class="o">##</span> <span class="n">Population</span>            <span class="n">P</span>
<span class="o">##</span> <span class="n">Employed</span>              <span class="n">E</span>
<span class="o">##</span> <span class="n">Unemployed</span>            <span class="n">U</span>
</pre></div>
</td></tr></table>

<h3 id="variable-selection-relative-importance">Variable selection &ndash; Relative importance<a class="headerlink" href="#variable-selection-relative-importance" title="Permanent link">&para;</a></h3>
<p>Model: <code class="codehilite"><span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">Armed.Forces</span> <span class="o">~</span> <span class="n">GNP</span> <span class="o">+</span> <span class="n">Population</span> <span class="o">+</span> <span class="n">Employed</span> <span class="o">+</span> <span class="n">Unemployed</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">longley</span><span class="p">)</span></code>.</p>
<p>Warning: <code class="codehilite"><span class="n">eval</span><span class="o">=</span><span class="k">FALSE</span></code>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># calculate the relative importance of each predictor</span>
<span class="nf">library</span><span class="p">(</span><span class="n">relaimpo</span><span class="p">)</span>

<span class="nf">calc.relimp</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;lmg&quot;</span><span class="p">,</span> <span class="s">&quot;last&quot;</span><span class="p">,</span> <span class="s">&quot;first&quot;</span><span class="p">,</span> <span class="s">&quot;pratt&quot;</span><span class="p">),</span> <span class="n">rela</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Results.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nv">Response</span> <span class="nv">variable</span>: <span class="nv">Armed</span>.<span class="nv">Forces</span> 
<span class="nv">Total</span> <span class="nv">response</span> <span class="nv">variance</span>: <span class="mi">4843</span> 
<span class="nv">Analysis</span> <span class="nv">based</span> <span class="nv">on</span> <span class="mi">16</span> <span class="nv">observations</span>

<span class="mi">4</span> <span class="nv">Regressors</span>: 
<span class="nv">GNP</span> <span class="nv">Population</span> <span class="nv">Employed</span> <span class="nv">Unemployed</span> 
<span class="nv">Proportion</span> <span class="nv">of</span> <span class="nv">variance</span> <span class="nv">explained</span> <span class="nv">by</span> <span class="nv">model</span>: <span class="mi">70</span>.<span class="mi">2</span><span class="o">%</span>
<span class="nv">Metrics</span> <span class="nv">are</span> <span class="nv">normalized</span> <span class="nv">to</span> <span class="nv">sum</span> <span class="nv">to</span> <span class="mi">100</span><span class="o">%</span> <span class="ss">(</span><span class="nv">rela</span><span class="o">=</span><span class="nv">TRUE</span><span class="ss">)</span>.

<span class="nv">Relative</span> <span class="nv">importance</span> <span class="nv">metrics</span>:

             <span class="nv">lmg</span>  <span class="nv">last</span> <span class="nv">first</span>  <span class="nv">pratt</span>
<span class="nv">GNP</span>        <span class="mi">0</span>.<span class="mi">328</span> <span class="mi">0</span>.<span class="mi">431</span> <span class="mi">0</span>.<span class="mi">348</span>  <span class="mi">4</span>.<span class="mi">566</span>
<span class="nv">Population</span> <span class="mi">0</span>.<span class="mi">241</span> <span class="mi">0</span>.<span class="mi">155</span> <span class="mi">0</span>.<span class="mi">232</span> <span class="o">-</span><span class="mi">1</span>.<span class="mi">934</span>
<span class="nv">Employed</span>   <span class="mi">0</span>.<span class="mi">217</span> <span class="mi">0</span>.<span class="mi">287</span> <span class="mi">0</span>.<span class="mi">365</span> <span class="o">-</span><span class="mi">1</span>.<span class="mi">780</span>
<span class="nv">Unemployed</span> <span class="mi">0</span>.<span class="mi">215</span> <span class="mi">0</span>.<span class="mi">127</span> <span class="mi">0</span>.<span class="mi">055</span>  <span class="mi">0</span>.<span class="mi">148</span>

<span class="nv">Average</span> <span class="nv">coefficients</span> <span class="k">for</span> <span class="nv">different</span> <span class="nv">model</span> <span class="nv">sizes</span>:

               <span class="mi">1</span><span class="nv">X</span>     <span class="mi">2</span><span class="nv">Xs</span>     <span class="mi">3</span><span class="nv">Xs</span>     <span class="mi">4</span><span class="nv">Xs</span>
<span class="nv">GNP</span>         <span class="mi">0</span>.<span class="mi">313</span>   <span class="mi">1</span>.<span class="mi">301</span>   <span class="mi">3</span>.<span class="mi">641</span>   <span class="mi">5</span>.<span class="mi">026</span>
<span class="nv">Population</span>  <span class="mi">3</span>.<span class="mi">646</span> <span class="o">-</span><span class="mi">14</span>.<span class="mi">815</span> <span class="o">-</span><span class="mi">24</span>.<span class="mi">637</span> <span class="o">-</span><span class="mi">37</span>.<span class="mi">260</span>
<span class="nv">Employed</span>    <span class="mi">9</span>.<span class="mi">062</span>  <span class="mi">17</span>.<span class="mi">646</span> <span class="o">-</span><span class="mi">34</span>.<span class="mi">249</span> <span class="o">-</span><span class="mi">54</span>.<span class="mi">144</span>
<span class="nv">Unemployed</span> <span class="o">-</span><span class="mi">0</span>.<span class="mi">132</span>  <span class="o">-</span><span class="mi">0</span>.<span class="mi">511</span>  <span class="o">-</span><span class="mi">0</span>.<span class="mi">584</span>  <span class="o">-</span><span class="mi">0</span>.<span class="mi">436</span>
</pre></div>
</td></tr></table>

<p><strong>Bootstrapping</strong></p>
<p>Model: <code class="codehilite"><span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">Armed.Forces</span> <span class="o">~</span> <span class="n">GNP</span> <span class="o">+</span> <span class="n">Population</span> <span class="o">+</span> <span class="n">Employed</span> <span class="o">+</span> <span class="n">Unemployed</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">longley</span><span class="p">)</span></code>.</p>
<p>Warning: <code class="codehilite"><span class="n">eval</span><span class="o">=</span><span class="k">FALSE</span></code>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># bootstrap measures of relative importance (1000 samples)</span>
<span class="n">boot</span> <span class="o">&lt;-</span> <span class="nf">boot.relimp</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="m">1000</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;lmg&quot;</span><span class="p">,</span> <span class="s">&quot;last&quot;</span><span class="p">,</span> <span class="s">&quot;first&quot;</span><span class="p">,</span> <span class="s">&quot;pratt&quot;</span><span class="p">),</span> <span class="n">rank</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="n">diff</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="n">rela</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">booteval.relimp</span><span class="p">(</span><span class="n">boot</span><span class="p">)</span> <span class="c1"># print result</span>
</pre></div>
</td></tr></table>

<p>Results.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nv">Response</span> <span class="nv">variable</span>: <span class="nv">Armed</span>.<span class="nv">Forces</span> 
<span class="nv">Total</span> <span class="nv">response</span> <span class="nv">variance</span>: <span class="mi">4843</span> 
<span class="nv">Analysis</span> <span class="nv">based</span> <span class="nv">on</span> <span class="mi">16</span> <span class="nv">observations</span>

<span class="mi">4</span> <span class="nv">Regressors</span>: 
<span class="nv">GNP</span> <span class="nv">Population</span> <span class="nv">Employed</span> <span class="nv">Unemployed</span> 
<span class="nv">Proportion</span> <span class="nv">of</span> <span class="nv">variance</span> <span class="nv">explained</span> <span class="nv">by</span> <span class="nv">model</span>: <span class="mi">70</span>.<span class="mi">2</span><span class="o">%</span>
<span class="nv">Metrics</span> <span class="nv">are</span> <span class="nv">normalized</span> <span class="nv">to</span> <span class="nv">sum</span> <span class="nv">to</span> <span class="mi">100</span><span class="o">%</span> <span class="ss">(</span><span class="nv">rela</span><span class="o">=</span><span class="nv">TRUE</span><span class="ss">)</span>.

<span class="nv">Relative</span> <span class="nv">importance</span> <span class="nv">metrics</span>:

             <span class="nv">lmg</span>  <span class="nv">last</span> <span class="nv">first</span>  <span class="nv">pratt</span>
<span class="nv">GNP</span>        <span class="mi">0</span>.<span class="mi">328</span> <span class="mi">0</span>.<span class="mi">431</span> <span class="mi">0</span>.<span class="mi">348</span>  <span class="mi">4</span>.<span class="mi">566</span>
<span class="nv">Population</span> <span class="mi">0</span>.<span class="mi">241</span> <span class="mi">0</span>.<span class="mi">155</span> <span class="mi">0</span>.<span class="mi">232</span> <span class="o">-</span><span class="mi">1</span>.<span class="mi">934</span>
<span class="nv">Employed</span>   <span class="mi">0</span>.<span class="mi">217</span> <span class="mi">0</span>.<span class="mi">287</span> <span class="mi">0</span>.<span class="mi">365</span> <span class="o">-</span><span class="mi">1</span>.<span class="mi">780</span>
<span class="nv">Unemployed</span> <span class="mi">0</span>.<span class="mi">215</span> <span class="mi">0</span>.<span class="mi">127</span> <span class="mi">0</span>.<span class="mi">055</span>  <span class="mi">0</span>.<span class="mi">148</span>

<span class="nv">Average</span> <span class="nv">coefficients</span> <span class="k">for</span> <span class="nv">different</span> <span class="nv">model</span> <span class="nv">sizes</span>:

               <span class="mi">1</span><span class="nv">X</span>     <span class="mi">2</span><span class="nv">Xs</span>     <span class="mi">3</span><span class="nv">Xs</span>     <span class="mi">4</span><span class="nv">Xs</span>
<span class="nv">GNP</span>         <span class="mi">0</span>.<span class="mi">313</span>   <span class="mi">1</span>.<span class="mi">301</span>   <span class="mi">3</span>.<span class="mi">641</span>   <span class="mi">5</span>.<span class="mi">026</span>
<span class="nv">Population</span>  <span class="mi">3</span>.<span class="mi">646</span> <span class="o">-</span><span class="mi">14</span>.<span class="mi">815</span> <span class="o">-</span><span class="mi">24</span>.<span class="mi">637</span> <span class="o">-</span><span class="mi">37</span>.<span class="mi">260</span>
<span class="nv">Employed</span>    <span class="mi">9</span>.<span class="mi">062</span>  <span class="mi">17</span>.<span class="mi">646</span> <span class="o">-</span><span class="mi">34</span>.<span class="mi">249</span> <span class="o">-</span><span class="mi">54</span>.<span class="mi">144</span>
<span class="nv">Unemployed</span> <span class="o">-</span><span class="mi">0</span>.<span class="mi">132</span>  <span class="o">-</span><span class="mi">0</span>.<span class="mi">511</span>  <span class="o">-</span><span class="mi">0</span>.<span class="mi">584</span>  <span class="o">-</span><span class="mi">0</span>.<span class="mi">436</span>


 <span class="nv">Confidence</span> <span class="nv">interval</span> <span class="nv">information</span> <span class="ss">(</span> <span class="mi">1000</span> <span class="nv">bootstrap</span> <span class="nv">replicates</span>, <span class="nv">bty</span><span class="o">=</span> <span class="nv">perc</span> <span class="ss">)</span>: 
<span class="nv">Relative</span> <span class="nv">Contributions</span> <span class="nv">with</span> <span class="nv">confidence</span> <span class="nv">intervals</span>:

                                 <span class="nv">Lower</span>  <span class="nv">Upper</span>
                 <span class="nv">percentage</span> <span class="mi">0</span>.<span class="mi">95</span> <span class="mi">0</span>.<span class="mi">95</span>    <span class="mi">0</span>.<span class="mi">95</span>   
<span class="nv">GNP</span>.<span class="nv">lmg</span>           <span class="mi">0</span>.<span class="mi">3280</span>    <span class="nv">ABC_</span>  <span class="mi">0</span>.<span class="mi">1488</span>  <span class="mi">0</span>.<span class="mi">4030</span>
<span class="nv">Population</span>.<span class="nv">lmg</span>    <span class="mi">0</span>.<span class="mi">2410</span>    <span class="nv">_BCD</span>  <span class="mi">0</span>.<span class="mi">1572</span>  <span class="mi">0</span>.<span class="mi">3060</span>
<span class="nv">Employed</span>.<span class="nv">lmg</span>      <span class="mi">0</span>.<span class="mi">2170</span>    <span class="nv">ABCD</span>  <span class="mi">0</span>.<span class="mi">1107</span>  <span class="mi">0</span>.<span class="mi">3240</span>
<span class="nv">Unemployed</span>.<span class="nv">lmg</span>    <span class="mi">0</span>.<span class="mi">2150</span>    <span class="nv">ABCD</span>  <span class="mi">0</span>.<span class="mi">0586</span>  <span class="mi">0</span>.<span class="mi">5550</span>

<span class="nv">GNP</span>.<span class="nv">last</span>          <span class="mi">0</span>.<span class="mi">4310</span>    <span class="nv">ABCD</span>  <span class="mi">0</span>.<span class="mi">0101</span>  <span class="mi">0</span>.<span class="mi">5660</span>
<span class="nv">Population</span>.<span class="nv">last</span>   <span class="mi">0</span>.<span class="mi">1550</span>    <span class="nv">_BCD</span>  <span class="mi">0</span>.<span class="mi">0003</span>  <span class="mi">0</span>.<span class="mi">3850</span>
<span class="nv">Employed</span>.<span class="nv">last</span>     <span class="mi">0</span>.<span class="mi">2870</span>    <span class="nv">ABCD</span>  <span class="mi">0</span>.<span class="mi">0476</span>  <span class="mi">0</span>.<span class="mi">6280</span>
<span class="nv">Unemployed</span>.<span class="nv">last</span>   <span class="mi">0</span>.<span class="mi">1270</span>    <span class="nv">ABCD</span>  <span class="mi">0</span>.<span class="mi">0009</span>  <span class="mi">0</span>.<span class="mi">7810</span>

<span class="nv">GNP</span>.<span class="nv">first</span>         <span class="mi">0</span>.<span class="mi">3480</span>    <span class="nv">ABCD</span>  <span class="mi">0</span>.<span class="mi">0151</span>  <span class="mi">0</span>.<span class="mi">3960</span>
<span class="nv">Population</span>.<span class="nv">first</span>  <span class="mi">0</span>.<span class="mi">2320</span>    <span class="nv">_BCD</span>  <span class="mi">0</span>.<span class="mi">0070</span>  <span class="mi">0</span>.<span class="mi">3060</span>
<span class="nv">Employed</span>.<span class="nv">first</span>    <span class="mi">0</span>.<span class="mi">3650</span>    <span class="nv">ABCD</span>  <span class="mi">0</span>.<span class="mi">0159</span>  <span class="mi">0</span>.<span class="mi">4020</span>
<span class="nv">Unemployed</span>.<span class="nv">first</span>  <span class="mi">0</span>.<span class="mi">0550</span>    <span class="nv">ABCD</span>  <span class="mi">0</span>.<span class="mi">0004</span>  <span class="mi">0</span>.<span class="mi">9280</span>

<span class="nv">GNP</span>.<span class="nv">pratt</span>         <span class="mi">4</span>.<span class="mi">5660</span>    <span class="nv">ABCD</span> <span class="o">-</span><span class="mi">1</span>.<span class="mi">0160</span> <span class="mi">10</span>.<span class="mi">5380</span>
<span class="nv">Population</span>.<span class="nv">pratt</span> <span class="o">-</span><span class="mi">1</span>.<span class="mi">9340</span>    <span class="nv">ABCD</span> <span class="o">-</span><span class="mi">6</span>.<span class="mi">0800</span>  <span class="mi">2</span>.<span class="mi">2050</span>
<span class="nv">Employed</span>.<span class="nv">pratt</span>   <span class="o">-</span><span class="mi">1</span>.<span class="mi">7800</span>    <span class="nv">_BCD</span> <span class="o">-</span><span class="mi">5</span>.<span class="mi">0290</span>  <span class="mi">0</span>.<span class="mi">8510</span>
<span class="nv">Unemployed</span>.<span class="nv">pratt</span>  <span class="mi">0</span>.<span class="mi">1480</span>    <span class="nv">ABC_</span> <span class="o">-</span><span class="mi">0</span>.<span class="mi">3250</span>  <span class="mi">1</span>.<span class="mi">0910</span>

<span class="nv">Letters</span> <span class="nv">indicate</span> <span class="nv">the</span> <span class="nv">ranks</span> <span class="nv">covered</span> <span class="nv">by</span> <span class="nv">bootstrap</span> <span class="nv">CIs</span>. 
<span class="ss">(</span><span class="nv">Rank</span> <span class="nv">bootstrap</span> <span class="nv">confidence</span> <span class="nv">intervals</span> <span class="nv">always</span> <span class="nv">obtained</span> <span class="nv">by</span> <span class="nv">percentile</span> <span class="nv">method</span><span class="ss">)</span> 
<span class="nv">CAUTION</span>: <span class="nv">Bootstrap</span> <span class="nv">confidence</span> <span class="nv">intervals</span> <span class="nv">can</span> <span class="nv">be</span> <span class="nv">somewhat</span> <span class="nv">liberal</span>.


 <span class="nv">Differences</span> <span class="nv">between</span> <span class="nv">Relative</span> <span class="nv">Contributions</span>:

                                            <span class="nv">Lower</span>   <span class="nv">Upper</span>
                            <span class="nv">difference</span> <span class="mi">0</span>.<span class="mi">95</span> <span class="mi">0</span>.<span class="mi">95</span>    <span class="mi">0</span>.<span class="mi">95</span>   
<span class="nv">GNP</span><span class="o">-</span><span class="nv">Population</span>.<span class="nv">lmg</span>           <span class="mi">0</span>.<span class="mi">0871</span>         <span class="o">-</span><span class="mi">0</span>.<span class="mi">0188</span>  <span class="mi">0</span>.<span class="mi">1521</span>
<span class="nv">GNP</span><span class="o">-</span><span class="nv">Employed</span>.<span class="nv">lmg</span>             <span class="mi">0</span>.<span class="mi">1106</span>         <span class="o">-</span><span class="mi">0</span>.<span class="mi">0479</span>  <span class="mi">0</span>.<span class="mi">1949</span>
<span class="nv">GNP</span><span class="o">-</span><span class="nv">Unemployed</span>.<span class="nv">lmg</span>           <span class="mi">0</span>.<span class="mi">1130</span>         <span class="o">-</span><span class="mi">0</span>.<span class="mi">4021</span>  <span class="mi">0</span>.<span class="mi">3281</span>
<span class="nv">Population</span><span class="o">-</span><span class="nv">Employed</span>.<span class="nv">lmg</span>      <span class="mi">0</span>.<span class="mi">0236</span>         <span class="o">-</span><span class="mi">0</span>.<span class="mi">1091</span>  <span class="mi">0</span>.<span class="mi">1124</span>
<span class="nv">Population</span><span class="o">-</span><span class="nv">Unemployed</span>.<span class="nv">lmg</span>    <span class="mi">0</span>.<span class="mi">0259</span>         <span class="o">-</span><span class="mi">0</span>.<span class="mi">3904</span>  <span class="mi">0</span>.<span class="mi">2417</span>
<span class="nv">Employed</span><span class="o">-</span><span class="nv">Unemployed</span>.<span class="nv">lmg</span>      <span class="mi">0</span>.<span class="mi">0023</span>         <span class="o">-</span><span class="mi">0</span>.<span class="mi">4315</span>  <span class="mi">0</span>.<span class="mi">2295</span>

<span class="nv">GNP</span><span class="o">-</span><span class="nv">Population</span>.<span class="nv">last</span>          <span class="mi">0</span>.<span class="mi">2756</span>         <span class="o">-</span><span class="mi">0</span>.<span class="mi">1062</span>  <span class="mi">0</span>.<span class="mi">4502</span>
<span class="nv">GNP</span><span class="o">-</span><span class="nv">Employed</span>.<span class="nv">last</span>            <span class="mi">0</span>.<span class="mi">1438</span>         <span class="o">-</span><span class="mi">0</span>.<span class="mi">5564</span>  <span class="mi">0</span>.<span class="mi">4011</span>
<span class="nv">GNP</span><span class="o">-</span><span class="nv">Unemployed</span>.<span class="nv">last</span>          <span class="mi">0</span>.<span class="mi">3041</span>         <span class="o">-</span><span class="mi">0</span>.<span class="mi">7408</span>  <span class="mi">0</span>.<span class="mi">5502</span>
<span class="nv">Population</span><span class="o">-</span><span class="nv">Employed</span>.<span class="nv">last</span>    <span class="o">-</span><span class="mi">0</span>.<span class="mi">1318</span>         <span class="o">-</span><span class="mi">0</span>.<span class="mi">6191</span>  <span class="mi">0</span>.<span class="mi">2653</span>
<span class="nv">Population</span><span class="o">-</span><span class="nv">Unemployed</span>.<span class="nv">last</span>   <span class="mi">0</span>.<span class="mi">0285</span>         <span class="o">-</span><span class="mi">0</span>.<span class="mi">7382</span>  <span class="mi">0</span>.<span class="mi">3622</span>
<span class="nv">Employed</span><span class="o">-</span><span class="nv">Unemployed</span>.<span class="nv">last</span>     <span class="mi">0</span>.<span class="mi">1603</span>         <span class="o">-</span><span class="mi">0</span>.<span class="mi">6784</span>  <span class="mi">0</span>.<span class="mi">4852</span>

<span class="nv">GNP</span><span class="o">-</span><span class="nv">Population</span>.<span class="nv">first</span>         <span class="mi">0</span>.<span class="mi">1161</span>         <span class="o">-</span><span class="mi">0</span>.<span class="mi">0590</span>  <span class="mi">0</span>.<span class="mi">1736</span>
<span class="nv">GNP</span><span class="o">-</span><span class="nv">Employed</span>.<span class="nv">first</span>          <span class="o">-</span><span class="mi">0</span>.<span class="mi">0172</span>         <span class="o">-</span><span class="mi">0</span>.<span class="mi">0893</span>  <span class="mi">0</span>.<span class="mi">0934</span>
<span class="nv">GNP</span><span class="o">-</span><span class="nv">Unemployed</span>.<span class="nv">first</span>         <span class="mi">0</span>.<span class="mi">2930</span>         <span class="o">-</span><span class="mi">0</span>.<span class="mi">9047</span>  <span class="mi">0</span>.<span class="mi">3766</span>
<span class="nv">Population</span><span class="o">-</span><span class="nv">Employed</span>.<span class="nv">first</span>   <span class="o">-</span><span class="mi">0</span>.<span class="mi">1333</span>         <span class="o">-</span><span class="mi">0</span>.<span class="mi">2134</span>  <span class="mi">0</span>.<span class="mi">0688</span>
<span class="nv">Population</span><span class="o">-</span><span class="nv">Unemployed</span>.<span class="nv">first</span>  <span class="mi">0</span>.<span class="mi">1769</span>         <span class="o">-</span><span class="mi">0</span>.<span class="mi">8967</span>  <span class="mi">0</span>.<span class="mi">2969</span>
<span class="nv">Employed</span><span class="o">-</span><span class="nv">Unemployed</span>.<span class="nv">first</span>    <span class="mi">0</span>.<span class="mi">3102</span>         <span class="o">-</span><span class="mi">0</span>.<span class="mi">8937</span>  <span class="mi">0</span>.<span class="mi">3823</span>

<span class="nv">GNP</span><span class="o">-</span><span class="nv">Population</span>.<span class="nv">pratt</span>         <span class="mi">6</span>.<span class="mi">4995</span>         <span class="o">-</span><span class="mi">2</span>.<span class="mi">2069</span> <span class="mi">15</span>.<span class="mi">7978</span>
<span class="nv">GNP</span><span class="o">-</span><span class="nv">Employed</span>.<span class="nv">pratt</span>           <span class="mi">6</span>.<span class="mi">3461</span>         <span class="o">-</span><span class="mi">1</span>.<span class="mi">3879</span> <span class="mi">15</span>.<span class="mi">0093</span>
<span class="nv">GNP</span><span class="o">-</span><span class="nv">Unemployed</span>.<span class="nv">pratt</span>         <span class="mi">4</span>.<span class="mi">4180</span>         <span class="o">-</span><span class="mi">1</span>.<span class="mi">9134</span> <span class="mi">10</span>.<span class="mi">6456</span>
<span class="nv">Population</span><span class="o">-</span><span class="nv">Employed</span>.<span class="nv">pratt</span>   <span class="o">-</span><span class="mi">0</span>.<span class="mi">1534</span>         <span class="o">-</span><span class="mi">4</span>.<span class="mi">1860</span>  <span class="mi">5</span>.<span class="mi">9691</span>
<span class="nv">Population</span><span class="o">-</span><span class="nv">Unemployed</span>.<span class="nv">pratt</span> <span class="o">-</span><span class="mi">2</span>.<span class="mi">0815</span>         <span class="o">-</span><span class="mi">6</span>.<span class="mi">1439</span>  <span class="mi">2</span>.<span class="mi">2348</span>
<span class="nv">Employed</span><span class="o">-</span><span class="nv">Unemployed</span>.<span class="nv">pratt</span>   <span class="o">-</span><span class="mi">1</span>.<span class="mi">9281</span>         <span class="o">-</span><span class="mi">5</span>.<span class="mi">2057</span>  <span class="mi">0</span>.<span class="mi">1725</span>

<span class="o">*</span> <span class="nv">indicates</span> <span class="nv">that</span> <span class="nv">CI</span> <span class="k">for</span> <span class="nv">difference</span> <span class="nv">does</span> <span class="nv">not</span> <span class="k">include</span> <span class="mi">0</span>. 
<span class="nv">CAUTION</span>: <span class="nv">Bootstrap</span> <span class="nv">confidence</span> <span class="nv">intervals</span> <span class="nv">can</span> <span class="nv">be</span> <span class="nv">somewhat</span> <span class="nv">liberal</span>.
</pre></div>
</td></tr></table>

<p>Warning: <code class="codehilite"><span class="n">eval</span><span class="o">=</span><span class="k">FALSE</span></code>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">plot</span><span class="p">(</span><span class="nf">booteval.relimp</span><span class="p">(</span><span class="n">boot</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">))</span> <span class="c1"># to plot the results</span>
</pre></div>
</td></tr></table>

<p>The .png file.</p>
<p><center><br />
<img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Notes/relimpResults.png" /><br />
</center></p>
<h3 id="going-further">Going further<a class="headerlink" href="#going-further" title="Permanent link">&para;</a></h3>
<ul>
<li>The <code class="codehilite"><span class="n">nls</span></code> package provides functions for nonlinear regression.</li>
<li>Perform robust regression with the <code class="codehilite"><span class="n">rlm</span></code> function in the <code class="codehilite"><span class="n">MASS</span></code> package.</li>
<li>The <code class="codehilite"><span class="n">robust</span></code> package provides a comprehensive library of robust methods, including regression.</li>
<li>The <code class="codehilite"><span class="n">robustbase</span></code> package also provides basic robust statistics including model selection methods.</li>
</ul>
<h2 id="regression-diagnostics">Regression diagnostics<a class="headerlink" href="#regression-diagnostics" title="Permanent link">&para;</a></h2>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># assume that we are fitting a multiple linear regression</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="n">disp</span> <span class="o">+</span> <span class="n">hp</span> <span class="o">+</span> <span class="n">wt</span> <span class="o">+</span> <span class="n">drat</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">)</span>
<span class="n">fit</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span> <span class="k">Call</span><span class="p">:</span>
<span class="o">##</span> <span class="n">lm</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="n">mpg</span> <span class="o">~</span> <span class="n">disp</span> <span class="o">+</span> <span class="n">hp</span> <span class="o">+</span> <span class="n">wt</span> <span class="o">+</span> <span class="n">drat</span><span class="p">,</span> <span class="k">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">)</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Coefficients</span><span class="p">:</span>
<span class="o">##</span> <span class="p">(</span><span class="n">Intercept</span><span class="p">)</span>         <span class="n">disp</span>           <span class="n">hp</span>           <span class="n">wt</span>         <span class="n">drat</span>  
<span class="o">##</span>    <span class="mi">29</span><span class="p">.</span><span class="mi">14874</span>      <span class="mi">0</span><span class="p">.</span><span class="mi">00382</span>     <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">03478</span>     <span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">47967</span>      <span class="mi">1</span><span class="p">.</span><span class="mi">76805</span>
</pre></div>
</td></tr></table>

<h3 id="outliers">Outliers<a class="headerlink" href="#outliers" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">car</span><span class="p">)</span>

<span class="c1"># assessing outliers</span>
<span class="nf">outlierTest</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># Bonferonni p-value for most extreme obs</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span> <span class="k">No</span> <span class="n">Studentized</span> <span class="n">residuals</span> <span class="k">with</span> <span class="n">Bonferonni</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span>
<span class="o">##</span> <span class="n">Largest</span> <span class="o">|</span><span class="n">rstudent</span><span class="o">|</span><span class="p">:</span>
<span class="o">##</span>                <span class="n">rstudent</span> <span class="n">unadjusted</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="n">Bonferonni</span> <span class="n">p</span>
<span class="o">##</span> <span class="n">Toyota</span> <span class="n">Corolla</span>     <span class="mi">2</span><span class="p">.</span><span class="mi">52</span>             <span class="mi">0</span><span class="p">.</span><span class="mi">0184</span>        <span class="mi">0</span><span class="p">.</span><span class="mi">588</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">qqPlot</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;QQ Plot&quot;</span><span class="p">)</span> <span class="c1">#qq plot for studentized resid</span>
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Notes/unnamed-chunk-60-1.png" /></center></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">leveragePlots</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span> <span class="c1"># leverage plots</span>
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Notes/unnamed-chunk-60-2.png" /></center></p>
<h3 id="influential-observations">Influential observations<a class="headerlink" href="#influential-observations" title="Permanent link">&para;</a></h3>
<p>Model: <code class="codehilite"><span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="n">disp</span> <span class="o">+</span> <span class="n">hp</span> <span class="o">+</span> <span class="n">wt</span> <span class="o">+</span> <span class="n">drat</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">)</span></code>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># influential observations</span>
<span class="c1"># added variable plots</span>
<span class="nf">library</span><span class="p">(</span><span class="n">car</span><span class="p">)</span>

<span class="nf">avPlots</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Notes/unnamed-chunk-61-1.png" /></center></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>

<span class="c1"># Cook&#39;s D plot</span>
<span class="c1"># identify D values &gt; 4/(n-k-1)</span>
<span class="n">cutoff</span> <span class="o">&lt;-</span> <span class="m">4</span><span class="o">/</span><span class="p">((</span><span class="nf">nrow</span><span class="p">(</span><span class="n">mtcars</span><span class="p">)</span> <span class="o">-</span> <span class="nf">length</span><span class="p">(</span><span class="n">fit</span><span class="o">$</span><span class="n">coefficients</span><span class="p">)</span> <span class="o">-</span> <span class="m">2</span><span class="p">))</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span> <span class="m">4</span><span class="p">,</span> <span class="n">cook.levels</span> <span class="o">=</span> <span class="n">cutoff</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Notes/unnamed-chunk-61-2.png" /></center></p>
<p>Warning: <code class="codehilite"><span class="n">eval</span><span class="o">=</span><span class="k">FALSE</span></code>; interactive function.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># influence plot</span>
<span class="nf">influencePlot</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">id.method</span> <span class="o">=</span> <span class="s">&quot;identify&quot;</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;Influence Plot&quot;</span><span class="p">,</span> <span class="n">sub</span> <span class="o">=</span> <span class="s">&quot;Circle size is proportial to Cook&#39;s Distance&quot;</span> <span class="p">)</span>
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Notes/unnamed-chunk-62-1.png" /></center></p>
<h3 id="nonnormality">Nonnormality<a class="headerlink" href="#nonnormality" title="Permanent link">&para;</a></h3>
<p>Model: <code class="codehilite"><span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="n">disp</span> <span class="o">+</span> <span class="n">hp</span> <span class="o">+</span> <span class="n">wt</span> <span class="o">+</span> <span class="n">drat</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">)</span></code>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># normality of residuals</span>
<span class="c1"># qq plot for studentized resid</span>
<span class="nf">library</span><span class="p">(</span><span class="n">car</span><span class="p">)</span>

<span class="nf">qqPlot</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;QQ Plot&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Notes/unnamed-chunk-63-1.png" /></center></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># distribution of studentized residuals</span>
<span class="nf">library</span><span class="p">(</span><span class="n">MASS</span><span class="p">)</span>

<span class="n">sresid</span> <span class="o">&lt;-</span> <span class="nf">studres</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
<span class="nf">hist</span><span class="p">(</span><span class="n">sresid</span><span class="p">,</span> <span class="n">freq</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;Distribution of Studentized Residuals&quot;</span><span class="p">)</span>
<span class="n">xfit</span> <span class="o">&lt;-</span> <span class="nf">seq</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">sresid</span><span class="p">),</span> <span class="nf">max</span><span class="p">(</span><span class="n">sresid</span><span class="p">),</span><span class="n">length</span> <span class="o">=</span> <span class="m">40</span><span class="p">)</span>
<span class="n">yfit</span> <span class="o">&lt;-</span> <span class="nf">dnorm</span><span class="p">(</span><span class="n">xfit</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">xfit</span><span class="p">,</span> <span class="n">yfit</span><span class="p">)</span> 
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Notes/unnamed-chunk-63-2.png" /></center></p>
<h3 id="heteroscedasticity">Heteroscedasticity<a class="headerlink" href="#heteroscedasticity" title="Permanent link">&para;</a></h3>
<p>Nonconstant error variance.</p>
<p>Model: <code class="codehilite"><span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="n">disp</span> <span class="o">+</span> <span class="n">hp</span> <span class="o">+</span> <span class="n">wt</span> <span class="o">+</span> <span class="n">drat</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">)</span></code>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># evaluate homoscedasticity</span>
<span class="c1"># non-constant error variance test</span>
<span class="nf">ncvTest</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="n">Non</span><span class="o">-</span><span class="n">constant</span> <span class="n">Variance</span> <span class="n">Score</span> <span class="n">Test</span> 
<span class="o">##</span> <span class="n">Variance</span> <span class="n">formula</span><span class="p">:</span> <span class="o">~</span> <span class="n">fitted</span><span class="p">.</span><span class="k">values</span> 
<span class="o">##</span> <span class="n">Chisquare</span> <span class="o">=</span> <span class="mi">1</span><span class="p">.</span><span class="mi">43</span>    <span class="n">Df</span> <span class="o">=</span> <span class="mi">1</span>     <span class="n">p</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">232</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># plot studentized residuals vs. fitted values</span>
<span class="nf">spreadLevelPlot</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Notes/unnamed-chunk-64-1.png" /></center></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span> <span class="n">Suggested</span> <span class="n">power</span> <span class="n">transformation</span><span class="p">:</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">662</span>
</pre></div>
</td></tr></table>

<h3 id="multicollinearity">Multicollinearity<a class="headerlink" href="#multicollinearity" title="Permanent link">&para;</a></h3>
<p>Model: <code class="codehilite"><span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="n">disp</span> <span class="o">+</span> <span class="n">hp</span> <span class="o">+</span> <span class="n">wt</span> <span class="o">+</span> <span class="n">drat</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">)</span></code>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># evaluatecCollinearity</span>
<span class="nf">vif</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="n">disp</span>   <span class="n">hp</span>   <span class="n">wt</span> <span class="n">drat</span> 
<span class="o">##</span> <span class="mi">8</span><span class="p">.</span><span class="mi">21</span> <span class="mi">2</span><span class="p">.</span><span class="mi">89</span> <span class="mi">5</span><span class="p">.</span><span class="mi">10</span> <span class="mi">2</span><span class="p">.</span><span class="mi">28</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">vif</span><span class="p">(</span><span class="n">fit</span><span class="p">))</span> <span class="o">&gt;</span> <span class="m">2</span> <span class="c1"># benchmark = 1.96, rounded to 2</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>  <span class="n">disp</span>    <span class="n">hp</span>    <span class="n">wt</span>  <span class="n">drat</span> 
<span class="o">##</span>  <span class="k">TRUE</span> <span class="k">FALSE</span>  <span class="k">TRUE</span> <span class="k">FALSE</span>
</pre></div>
</td></tr></table>

<h3 id="nonlinearity">Nonlinearity<a class="headerlink" href="#nonlinearity" title="Permanent link">&para;</a></h3>
<p>Model: <code class="codehilite"><span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="n">disp</span> <span class="o">+</span> <span class="n">hp</span> <span class="o">+</span> <span class="n">wt</span> <span class="o">+</span> <span class="n">drat</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">)</span></code>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># evaluate nonlinearity</span>
<span class="c1"># component + residual plot</span>
<span class="nf">crPlots</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Notes/unnamed-chunk-66-1.png" /></center></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Ceres plots</span>
<span class="nf">ceresPlots</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Notes/unnamed-chunk-66-2.png" /></center></p>
<h3 id="autocorrelation">Autocorrelation<a class="headerlink" href="#autocorrelation" title="Permanent link">&para;</a></h3>
<p>Serial correlation or non-independence of errors.</p>
<p>Model: <code class="codehilite"><span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="n">disp</span> <span class="o">+</span> <span class="n">hp</span> <span class="o">+</span> <span class="n">wt</span> <span class="o">+</span> <span class="n">drat</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">)</span></code>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># test for autocorrelated errors</span>
<span class="nf">durbinWatsonTest</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>  <span class="n">lag</span> <span class="n">Autocorrelation</span> <span class="n">D</span><span class="o">-</span><span class="n">W</span> <span class="n">Statistic</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span>
<span class="o">##</span>    <span class="mi">1</span>           <span class="mi">0</span><span class="p">.</span><span class="mi">101</span>          <span class="mi">1</span><span class="p">.</span><span class="mi">74</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">29</span>
<span class="o">##</span>  <span class="n">Alternative</span> <span class="n">hypothesis</span><span class="p">:</span> <span class="n">rho</span> <span class="o">!=</span> <span class="mi">0</span>
</pre></div>
</td></tr></table>

<h3 id="global-diagnostic">Global diagnostic<a class="headerlink" href="#global-diagnostic" title="Permanent link">&para;</a></h3>
<p>Model: <code class="codehilite"><span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="n">disp</span> <span class="o">+</span> <span class="n">hp</span> <span class="o">+</span> <span class="n">wt</span> <span class="o">+</span> <span class="n">drat</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">)</span></code>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># global test of model assumptions</span>
<span class="nf">library</span><span class="p">(</span><span class="n">gvlma</span><span class="p">)</span>

<span class="n">gvmodel</span> <span class="o">&lt;-</span> <span class="nf">gvlma</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">gvmodel</span><span class="p">)</span> 
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span> <span class="k">Call</span><span class="p">:</span>
<span class="o">##</span> <span class="n">lm</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="n">mpg</span> <span class="o">~</span> <span class="n">disp</span> <span class="o">+</span> <span class="n">hp</span> <span class="o">+</span> <span class="n">wt</span> <span class="o">+</span> <span class="n">drat</span><span class="p">,</span> <span class="k">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">)</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Residuals</span><span class="p">:</span>
<span class="o">##</span>    <span class="k">Min</span>     <span class="mi">1</span><span class="n">Q</span> <span class="n">Median</span>     <span class="mi">3</span><span class="n">Q</span>    <span class="k">Max</span> 
<span class="o">##</span> <span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">508</span> <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">905</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">506</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">982</span>  <span class="mi">5</span><span class="p">.</span><span class="mi">688</span> 
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Coefficients</span><span class="p">:</span>
<span class="o">##</span>             <span class="n">Estimate</span> <span class="n">Std</span><span class="p">.</span> <span class="n">Error</span> <span class="n">t</span> <span class="n">value</span> <span class="n">Pr</span><span class="p">(</span><span class="o">&gt;|</span><span class="n">t</span><span class="o">|</span><span class="p">)</span>    
<span class="o">##</span> <span class="p">(</span><span class="n">Intercept</span><span class="p">)</span> <span class="mi">29</span><span class="p">.</span><span class="mi">14874</span>    <span class="mi">6</span><span class="p">.</span><span class="mi">29359</span>    <span class="mi">4</span><span class="p">.</span><span class="mi">63</span>  <span class="mi">8</span><span class="p">.</span><span class="mi">2</span><span class="n">e</span><span class="o">-</span><span class="mi">05</span> <span class="o">***</span>
<span class="o">##</span> <span class="n">disp</span>         <span class="mi">0</span><span class="p">.</span><span class="mi">00382</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">01080</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">35</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">7268</span>    
<span class="o">##</span> <span class="n">hp</span>          <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">03478</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">01160</span>   <span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">0058</span> <span class="o">**</span> 
<span class="o">##</span> <span class="n">wt</span>          <span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">47967</span>    <span class="mi">1</span><span class="p">.</span><span class="mi">07837</span>   <span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">23</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">0033</span> <span class="o">**</span> 
<span class="o">##</span> <span class="n">drat</span>         <span class="mi">1</span><span class="p">.</span><span class="mi">76805</span>    <span class="mi">1</span><span class="p">.</span><span class="mi">31978</span>    <span class="mi">1</span><span class="p">.</span><span class="mi">34</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">1915</span>    
<span class="o">##</span> <span class="c1">---</span>
<span class="o">##</span> <span class="n">Signif</span><span class="p">.</span> <span class="n">codes</span><span class="p">:</span>  <span class="mi">0</span> <span class="s1">&#39;***&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span> <span class="s1">&#39;**&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="s1">&#39;*&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span> <span class="s1">&#39;.&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="s1">&#39; &#39;</span> <span class="mi">1</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Residual</span> <span class="n">standard</span> <span class="n">error</span><span class="p">:</span> <span class="mi">2</span><span class="p">.</span><span class="mi">6</span> <span class="k">on</span> <span class="mi">27</span> <span class="n">degrees</span> <span class="k">of</span> <span class="n">freedom</span>
<span class="o">##</span> <span class="n">Multiple</span> <span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="p">:</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">838</span><span class="p">,</span>  <span class="n">Adjusted</span> <span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="p">:</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">814</span> 
<span class="o">##</span> <span class="n">F</span><span class="o">-</span><span class="n">statistic</span><span class="p">:</span> <span class="mi">34</span><span class="p">.</span><span class="mi">8</span> <span class="k">on</span> <span class="mi">4</span> <span class="k">and</span> <span class="mi">27</span> <span class="n">DF</span><span class="p">,</span>  <span class="n">p</span><span class="o">-</span><span class="n">value</span><span class="p">:</span> <span class="mi">2</span><span class="p">.</span><span class="mi">7</span><span class="n">e</span><span class="o">-</span><span class="mi">10</span>
<span class="o">##</span> 
<span class="o">##</span> 
<span class="o">##</span> <span class="n">ASSESSMENT</span> <span class="k">OF</span> <span class="n">THE</span> <span class="n">LINEAR</span> <span class="n">MODEL</span> <span class="n">ASSUMPTIONS</span>
<span class="o">##</span> <span class="k">USING</span> <span class="n">THE</span> <span class="k">GLOBAL</span> <span class="n">TEST</span> <span class="k">ON</span> <span class="mi">4</span> <span class="n">DEGREES</span><span class="o">-</span><span class="k">OF</span><span class="o">-</span><span class="n">FREEDOM</span><span class="p">:</span>
<span class="o">##</span> <span class="k">Level</span> <span class="k">of</span> <span class="n">Significance</span> <span class="o">=</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">05</span> 
<span class="o">##</span> 
<span class="o">##</span> <span class="k">Call</span><span class="p">:</span>
<span class="o">##</span>  <span class="n">gvlma</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">fit</span><span class="p">)</span> 
<span class="o">##</span> 
<span class="o">##</span>                      <span class="n">Value</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span>                   <span class="n">Decision</span>
<span class="o">##</span> <span class="k">Global</span> <span class="n">Stat</span>        <span class="mi">13</span><span class="p">.</span><span class="mi">9382</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00750</span> <span class="n">Assumptions</span> <span class="k">NOT</span> <span class="n">satisfied</span><span class="o">!</span>
<span class="o">##</span> <span class="n">Skewness</span>            <span class="mi">4</span><span class="p">.</span><span class="mi">3131</span> <span class="mi">0</span><span class="p">.</span><span class="mi">03782</span> <span class="n">Assumptions</span> <span class="k">NOT</span> <span class="n">satisfied</span><span class="o">!</span>
<span class="o">##</span> <span class="n">Kurtosis</span>            <span class="mi">0</span><span class="p">.</span><span class="mi">0138</span> <span class="mi">0</span><span class="p">.</span><span class="mi">90654</span>    <span class="n">Assumptions</span> <span class="n">acceptable</span><span class="p">.</span>
<span class="o">##</span> <span class="n">Link</span> <span class="k">Function</span>       <span class="mi">8</span><span class="p">.</span><span class="mi">7166</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00315</span> <span class="n">Assumptions</span> <span class="k">NOT</span> <span class="n">satisfied</span><span class="o">!</span>
<span class="o">##</span> <span class="n">Heteroscedasticity</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">8947</span> <span class="mi">0</span><span class="p">.</span><span class="mi">34421</span>    <span class="n">Assumptions</span> <span class="n">acceptable</span><span class="p">.</span>
</pre></div>
</td></tr></table>

<h2 id="anova_1">ANOVA<a class="headerlink" href="#anova_1" title="Permanent link">&para;</a></h2>
<p>Analysis of variance (ANOVA) is an alternative to regressions among other applications.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># lower case letters are numeric variables</span>
<span class="c1"># upper case letters are factors</span>

<span class="c1"># one-way ANOVA (completely randomized design)</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">A</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mydataframe</span><span class="p">)</span>

<span class="c1"># randomized block design (B is the blocking factor)</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">A</span> <span class="o">+</span> <span class="n">B</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mydataframe</span><span class="p">)</span>

<span class="c1"># two-way factorial design</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">A</span> <span class="o">+</span> <span class="n">B</span> <span class="o">+</span> <span class="n">A</span><span class="o">:</span><span class="n">B</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mydataframe</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">A</span><span class="o">*</span><span class="n">B</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mydataframe</span><span class="p">)</span> <span class="c1"># same thing</span>

<span class="c1"># analysis of covariance</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">A</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mydataframe</span><span class="p">)</span> 
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">CO2</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="n">Grouped</span> <span class="k">Data</span><span class="p">:</span> <span class="n">uptake</span> <span class="o">~</span> <span class="n">conc</span> <span class="o">|</span> <span class="n">Plant</span>
<span class="o">##</span>   <span class="n">Plant</span>   <span class="k">Type</span>  <span class="n">Treatment</span> <span class="n">conc</span> <span class="n">uptake</span>
<span class="o">##</span> <span class="mi">1</span>   <span class="n">Qn1</span> <span class="n">Quebec</span> <span class="n">nonchilled</span>   <span class="mi">95</span>   <span class="mi">16</span><span class="p">.</span><span class="mi">0</span>
<span class="o">##</span> <span class="mi">2</span>   <span class="n">Qn1</span> <span class="n">Quebec</span> <span class="n">nonchilled</span>  <span class="mi">175</span>   <span class="mi">30</span><span class="p">.</span><span class="mi">4</span>
<span class="o">##</span> <span class="mi">3</span>   <span class="n">Qn1</span> <span class="n">Quebec</span> <span class="n">nonchilled</span>  <span class="mi">250</span>   <span class="mi">34</span><span class="p">.</span><span class="mi">8</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># one-way ANOVA (completely randomized design)</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>
<span class="n">fit</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="k">Call</span><span class="p">:</span>
<span class="o">##</span>    <span class="n">aov</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span><span class="p">,</span> <span class="k">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Terms</span><span class="p">:</span>
<span class="o">##</span>                 <span class="n">Plant</span> <span class="n">Residuals</span>
<span class="o">##</span> <span class="k">Sum</span> <span class="k">of</span> <span class="n">Squares</span>   <span class="mi">4862</span>      <span class="mi">4845</span>
<span class="o">##</span> <span class="n">Deg</span><span class="p">.</span> <span class="k">of</span> <span class="n">Freedom</span>    <span class="mi">11</span>        <span class="mi">72</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Residual</span> <span class="n">standard</span> <span class="n">error</span><span class="p">:</span> <span class="mi">8</span><span class="p">.</span><span class="mi">2</span>
<span class="o">##</span> <span class="n">Estimated</span> <span class="n">effects</span> <span class="k">are</span> <span class="n">balanced</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>             <span class="n">Df</span> <span class="k">Sum</span> <span class="n">Sq</span> <span class="n">Mean</span> <span class="n">Sq</span> <span class="n">F</span> <span class="n">value</span>  <span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span>    
<span class="o">##</span> <span class="n">Plant</span>       <span class="mi">11</span>   <span class="mi">4862</span>     <span class="mi">442</span>    <span class="mi">6</span><span class="p">.</span><span class="mi">57</span> <span class="mi">1</span><span class="p">.</span><span class="mi">8</span><span class="n">e</span><span class="o">-</span><span class="mi">07</span> <span class="o">***</span>
<span class="o">##</span> <span class="n">Residuals</span>   <span class="mi">72</span>   <span class="mi">4845</span>      <span class="mi">67</span>                    
<span class="o">##</span> <span class="c1">---</span>
<span class="o">##</span> <span class="n">Signif</span><span class="p">.</span> <span class="n">codes</span><span class="p">:</span>  <span class="mi">0</span> <span class="s1">&#39;***&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span> <span class="s1">&#39;**&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="s1">&#39;*&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span> <span class="s1">&#39;.&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="s1">&#39; &#39;</span> <span class="mi">1</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># randomized block design (B is the blocking factor)</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span> <span class="o">+</span> <span class="n">Type</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>
<span class="n">fit</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="k">Call</span><span class="p">:</span>
<span class="o">##</span>    <span class="n">aov</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span> <span class="o">+</span> <span class="k">Type</span><span class="p">,</span> <span class="k">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Terms</span><span class="p">:</span>
<span class="o">##</span>                 <span class="n">Plant</span> <span class="n">Residuals</span>
<span class="o">##</span> <span class="k">Sum</span> <span class="k">of</span> <span class="n">Squares</span>   <span class="mi">4862</span>      <span class="mi">4845</span>
<span class="o">##</span> <span class="n">Deg</span><span class="p">.</span> <span class="k">of</span> <span class="n">Freedom</span>    <span class="mi">11</span>        <span class="mi">72</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Residual</span> <span class="n">standard</span> <span class="n">error</span><span class="p">:</span> <span class="mi">8</span><span class="p">.</span><span class="mi">2</span>
<span class="o">##</span> <span class="mi">1</span> <span class="k">out</span> <span class="k">of</span> <span class="mi">13</span> <span class="n">effects</span> <span class="k">not</span> <span class="n">estimable</span>
<span class="o">##</span> <span class="n">Estimated</span> <span class="n">effects</span> <span class="k">are</span> <span class="n">balanced</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>             <span class="n">Df</span> <span class="k">Sum</span> <span class="n">Sq</span> <span class="n">Mean</span> <span class="n">Sq</span> <span class="n">F</span> <span class="n">value</span>  <span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span>    
<span class="o">##</span> <span class="n">Plant</span>       <span class="mi">11</span>   <span class="mi">4862</span>     <span class="mi">442</span>    <span class="mi">6</span><span class="p">.</span><span class="mi">57</span> <span class="mi">1</span><span class="p">.</span><span class="mi">8</span><span class="n">e</span><span class="o">-</span><span class="mi">07</span> <span class="o">***</span>
<span class="o">##</span> <span class="n">Residuals</span>   <span class="mi">72</span>   <span class="mi">4845</span>      <span class="mi">67</span>                    
<span class="o">##</span> <span class="c1">---</span>
<span class="o">##</span> <span class="n">Signif</span><span class="p">.</span> <span class="n">codes</span><span class="p">:</span>  <span class="mi">0</span> <span class="s1">&#39;***&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span> <span class="s1">&#39;**&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="s1">&#39;*&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span> <span class="s1">&#39;.&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="s1">&#39; &#39;</span> <span class="mi">1</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># two-way factorial design</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span> <span class="o">+</span> <span class="n">Type</span> <span class="o">+</span> <span class="n">Plant</span><span class="o">:</span><span class="n">Type</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>
<span class="n">fit</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="k">Call</span><span class="p">:</span>
<span class="o">##</span>    <span class="n">aov</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span> <span class="o">+</span> <span class="k">Type</span> <span class="o">+</span> <span class="n">Plant</span><span class="p">:</span><span class="k">Type</span><span class="p">,</span> <span class="k">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Terms</span><span class="p">:</span>
<span class="o">##</span>                 <span class="n">Plant</span> <span class="n">Residuals</span>
<span class="o">##</span> <span class="k">Sum</span> <span class="k">of</span> <span class="n">Squares</span>   <span class="mi">4862</span>      <span class="mi">4845</span>
<span class="o">##</span> <span class="n">Deg</span><span class="p">.</span> <span class="k">of</span> <span class="n">Freedom</span>    <span class="mi">11</span>        <span class="mi">72</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Residual</span> <span class="n">standard</span> <span class="n">error</span><span class="p">:</span> <span class="mi">8</span><span class="p">.</span><span class="mi">2</span>
<span class="o">##</span> <span class="mi">12</span> <span class="k">out</span> <span class="k">of</span> <span class="mi">24</span> <span class="n">effects</span> <span class="k">not</span> <span class="n">estimable</span>
<span class="o">##</span> <span class="n">Estimated</span> <span class="n">effects</span> <span class="k">are</span> <span class="n">balanced</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>             <span class="n">Df</span> <span class="k">Sum</span> <span class="n">Sq</span> <span class="n">Mean</span> <span class="n">Sq</span> <span class="n">F</span> <span class="n">value</span>  <span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span>    
<span class="o">##</span> <span class="n">Plant</span>       <span class="mi">11</span>   <span class="mi">4862</span>     <span class="mi">442</span>    <span class="mi">6</span><span class="p">.</span><span class="mi">57</span> <span class="mi">1</span><span class="p">.</span><span class="mi">8</span><span class="n">e</span><span class="o">-</span><span class="mi">07</span> <span class="o">***</span>
<span class="o">##</span> <span class="n">Residuals</span>   <span class="mi">72</span>   <span class="mi">4845</span>      <span class="mi">67</span>                    
<span class="o">##</span> <span class="c1">---</span>
<span class="o">##</span> <span class="n">Signif</span><span class="p">.</span> <span class="n">codes</span><span class="p">:</span>  <span class="mi">0</span> <span class="s1">&#39;***&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span> <span class="s1">&#39;**&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="s1">&#39;*&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span> <span class="s1">&#39;.&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="s1">&#39; &#39;</span> <span class="mi">1</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span><span class="o">*</span><span class="n">Type</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span> <span class="c1"># same thing</span>
<span class="n">fit</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="k">Call</span><span class="p">:</span>
<span class="o">##</span>    <span class="n">aov</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span> <span class="o">*</span> <span class="k">Type</span><span class="p">,</span> <span class="k">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Terms</span><span class="p">:</span>
<span class="o">##</span>                 <span class="n">Plant</span> <span class="n">Residuals</span>
<span class="o">##</span> <span class="k">Sum</span> <span class="k">of</span> <span class="n">Squares</span>   <span class="mi">4862</span>      <span class="mi">4845</span>
<span class="o">##</span> <span class="n">Deg</span><span class="p">.</span> <span class="k">of</span> <span class="n">Freedom</span>    <span class="mi">11</span>        <span class="mi">72</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Residual</span> <span class="n">standard</span> <span class="n">error</span><span class="p">:</span> <span class="mi">8</span><span class="p">.</span><span class="mi">2</span>
<span class="o">##</span> <span class="mi">12</span> <span class="k">out</span> <span class="k">of</span> <span class="mi">24</span> <span class="n">effects</span> <span class="k">not</span> <span class="n">estimable</span>
<span class="o">##</span> <span class="n">Estimated</span> <span class="n">effects</span> <span class="k">are</span> <span class="n">balanced</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>             <span class="n">Df</span> <span class="k">Sum</span> <span class="n">Sq</span> <span class="n">Mean</span> <span class="n">Sq</span> <span class="n">F</span> <span class="n">value</span>  <span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span>    
<span class="o">##</span> <span class="n">Plant</span>       <span class="mi">11</span>   <span class="mi">4862</span>     <span class="mi">442</span>    <span class="mi">6</span><span class="p">.</span><span class="mi">57</span> <span class="mi">1</span><span class="p">.</span><span class="mi">8</span><span class="n">e</span><span class="o">-</span><span class="mi">07</span> <span class="o">***</span>
<span class="o">##</span> <span class="n">Residuals</span>   <span class="mi">72</span>   <span class="mi">4845</span>      <span class="mi">67</span>                    
<span class="o">##</span> <span class="c1">---</span>
<span class="o">##</span> <span class="n">Signif</span><span class="p">.</span> <span class="n">codes</span><span class="p">:</span>  <span class="mi">0</span> <span class="s1">&#39;***&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span> <span class="s1">&#39;**&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="s1">&#39;*&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span> <span class="s1">&#39;.&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="s1">&#39; &#39;</span> <span class="mi">1</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Analysis of Covariance</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">uptake</span> <span class="o">+</span> <span class="n">conc</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>
<span class="n">fit</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="k">Call</span><span class="p">:</span>
<span class="o">##</span>    <span class="n">aov</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="n">uptake</span> <span class="o">~</span> <span class="n">uptake</span> <span class="o">+</span> <span class="n">conc</span><span class="p">,</span> <span class="k">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Terms</span><span class="p">:</span>
<span class="o">##</span>                 <span class="n">conc</span> <span class="n">Residuals</span>
<span class="o">##</span> <span class="k">Sum</span> <span class="k">of</span> <span class="n">Squares</span>  <span class="mi">2285</span>      <span class="mi">7422</span>
<span class="o">##</span> <span class="n">Deg</span><span class="p">.</span> <span class="k">of</span> <span class="n">Freedom</span>    <span class="mi">1</span>        <span class="mi">82</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Residual</span> <span class="n">standard</span> <span class="n">error</span><span class="p">:</span> <span class="mi">9</span><span class="p">.</span><span class="mi">51</span>
<span class="o">##</span> <span class="n">Estimated</span> <span class="n">effects</span> <span class="n">may</span> <span class="n">be</span> <span class="n">unbalanced</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>             <span class="n">Df</span> <span class="k">Sum</span> <span class="n">Sq</span> <span class="n">Mean</span> <span class="n">Sq</span> <span class="n">F</span> <span class="n">value</span>  <span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span>    
<span class="o">##</span> <span class="n">conc</span>         <span class="mi">1</span>   <span class="mi">2285</span>    <span class="mi">2285</span>    <span class="mi">25</span><span class="p">.</span><span class="mi">2</span> <span class="mi">2</span><span class="p">.</span><span class="mi">9</span><span class="n">e</span><span class="o">-</span><span class="mi">06</span> <span class="o">***</span>
<span class="o">##</span> <span class="n">Residuals</span>   <span class="mi">82</span>   <span class="mi">7422</span>      <span class="mi">91</span>                    
<span class="o">##</span> <span class="c1">---</span>
<span class="o">##</span> <span class="n">Signif</span><span class="p">.</span> <span class="n">codes</span><span class="p">:</span>  <span class="mi">0</span> <span class="s1">&#39;***&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span> <span class="s1">&#39;**&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="s1">&#39;*&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span> <span class="s1">&#39;.&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="s1">&#39; &#39;</span> <span class="mi">1</span>
</pre></div>
</td></tr></table>

<h3 id="evaluate-model-effects">Evaluate model effects<a class="headerlink" href="#evaluate-model-effects" title="Permanent link">&para;</a></h3>
<ul>
<li>Type I sequential SS: A+B and B+A will produce different results!</li>
<li>Use the <code class="codehilite"><span class="n">drop1</span></code> to produce the familiar Type III results; compare each term with the full model.</li>
</ul>
<!-- -->

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># display Type I ANOVA table</span>
<span class="n">fit1</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span> <span class="o">+</span> <span class="n">Type</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit1</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>             <span class="n">Df</span> <span class="k">Sum</span> <span class="n">Sq</span> <span class="n">Mean</span> <span class="n">Sq</span> <span class="n">F</span> <span class="n">value</span>  <span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span>    
<span class="o">##</span> <span class="n">Plant</span>       <span class="mi">11</span>   <span class="mi">4862</span>     <span class="mi">442</span>    <span class="mi">6</span><span class="p">.</span><span class="mi">57</span> <span class="mi">1</span><span class="p">.</span><span class="mi">8</span><span class="n">e</span><span class="o">-</span><span class="mi">07</span> <span class="o">***</span>
<span class="o">##</span> <span class="n">Residuals</span>   <span class="mi">72</span>   <span class="mi">4845</span>      <span class="mi">67</span>                    
<span class="o">##</span> <span class="c1">---</span>
<span class="o">##</span> <span class="n">Signif</span><span class="p">.</span> <span class="n">codes</span><span class="p">:</span>  <span class="mi">0</span> <span class="s1">&#39;***&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span> <span class="s1">&#39;**&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="s1">&#39;*&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span> <span class="s1">&#39;.&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="s1">&#39; &#39;</span> <span class="mi">1</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># display Type I ANOVA table</span>
<span class="n">fit2</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">Type</span> <span class="o">+</span> <span class="n">Plant</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit2</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>             <span class="n">Df</span> <span class="k">Sum</span> <span class="n">Sq</span> <span class="n">Mean</span> <span class="n">Sq</span> <span class="n">F</span> <span class="n">value</span>  <span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span>    
<span class="o">##</span> <span class="k">Type</span>         <span class="mi">1</span>   <span class="mi">3366</span>    <span class="mi">3366</span>   <span class="mi">50</span><span class="p">.</span><span class="mi">02</span> <span class="mi">8</span><span class="p">.</span><span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">10</span> <span class="o">***</span>
<span class="o">##</span> <span class="n">Plant</span>       <span class="mi">10</span>   <span class="mi">1497</span>     <span class="mi">150</span>    <span class="mi">2</span><span class="p">.</span><span class="mi">22</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">026</span> <span class="o">*</span>  
<span class="o">##</span> <span class="n">Residuals</span>   <span class="mi">72</span>   <span class="mi">4845</span>      <span class="mi">67</span>                    
<span class="o">##</span> <span class="c1">---</span>
<span class="o">##</span> <span class="n">Signif</span><span class="p">.</span> <span class="n">codes</span><span class="p">:</span>  <span class="mi">0</span> <span class="s1">&#39;***&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span> <span class="s1">&#39;**&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="s1">&#39;*&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span> <span class="s1">&#39;.&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="s1">&#39; &#39;</span> <span class="mi">1</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># display type III SS and F tests</span>
<span class="nf">drop1</span><span class="p">(</span><span class="n">fit1</span><span class="p">,</span> <span class="o">~</span> <span class="n">.,</span> <span class="n">test</span> <span class="o">=</span> <span class="s">&quot;F&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="n">Single</span> <span class="n">term</span> <span class="n">deletions</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Model</span><span class="p">:</span>
<span class="o">##</span> <span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span> <span class="o">+</span> <span class="k">Type</span>
<span class="o">##</span>        <span class="n">Df</span> <span class="k">Sum</span> <span class="k">of</span> <span class="n">Sq</span>  <span class="n">RSS</span> <span class="n">AIC</span> <span class="n">F</span> <span class="n">value</span> <span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span>  
<span class="o">##</span> <span class="o">&lt;</span><span class="k">none</span><span class="o">&gt;</span>              <span class="mi">4845</span> <span class="mi">365</span>                 
<span class="o">##</span> <span class="n">Plant</span>  <span class="mi">10</span>      <span class="mi">1497</span> <span class="mi">6341</span> <span class="mi">367</span>    <span class="mi">2</span><span class="p">.</span><span class="mi">22</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">026</span> <span class="o">*</span>
<span class="o">##</span> <span class="k">Type</span>    <span class="mi">0</span>         <span class="mi">0</span> <span class="mi">4845</span> <span class="mi">365</span>                 
<span class="o">##</span> <span class="c1">---</span>
<span class="o">##</span> <span class="n">Signif</span><span class="p">.</span> <span class="n">codes</span><span class="p">:</span>  <span class="mi">0</span> <span class="s1">&#39;***&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span> <span class="s1">&#39;**&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="s1">&#39;*&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span> <span class="s1">&#39;.&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="s1">&#39; &#39;</span> <span class="mi">1</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">drop1</span><span class="p">(</span><span class="n">fit2</span><span class="p">,</span> <span class="o">~</span> <span class="n">.,</span> <span class="n">test</span> <span class="o">=</span> <span class="s">&quot;F&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="n">Single</span> <span class="n">term</span> <span class="n">deletions</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Model</span><span class="p">:</span>
<span class="o">##</span> <span class="n">uptake</span> <span class="o">~</span> <span class="k">Type</span> <span class="o">+</span> <span class="n">Plant</span>
<span class="o">##</span>        <span class="n">Df</span> <span class="k">Sum</span> <span class="k">of</span> <span class="n">Sq</span>  <span class="n">RSS</span> <span class="n">AIC</span> <span class="n">F</span> <span class="n">value</span> <span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span>  
<span class="o">##</span> <span class="o">&lt;</span><span class="k">none</span><span class="o">&gt;</span>              <span class="mi">4845</span> <span class="mi">365</span>                 
<span class="o">##</span> <span class="k">Type</span>    <span class="mi">0</span>         <span class="mi">0</span> <span class="mi">4845</span> <span class="mi">365</span>                 
<span class="o">##</span> <span class="n">Plant</span>  <span class="mi">10</span>      <span class="mi">1497</span> <span class="mi">6341</span> <span class="mi">367</span>    <span class="mi">2</span><span class="p">.</span><span class="mi">22</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">026</span> <span class="o">*</span>
<span class="o">##</span> <span class="c1">---</span>
<span class="o">##</span> <span class="n">Signif</span><span class="p">.</span> <span class="n">codes</span><span class="p">:</span>  <span class="mi">0</span> <span class="s1">&#39;***&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span> <span class="s1">&#39;**&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="s1">&#39;*&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span> <span class="s1">&#39;.&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="s1">&#39; &#39;</span> <span class="mi">1</span>
</pre></div>
</td></tr></table>

<h3 id="compare-nested-models-directly">Compare nested models directly<a class="headerlink" href="#compare-nested-models-directly" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">fit1</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span> <span class="o">+</span> <span class="n">Type</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>
<span class="n">fit2</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>

<span class="nf">anova</span><span class="p">(</span><span class="n">fit1</span><span class="p">,</span> <span class="n">fit2</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="n">Analysis</span> <span class="k">of</span> <span class="n">Variance</span> <span class="k">Table</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Model</span> <span class="mi">1</span><span class="p">:</span> <span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span> <span class="o">+</span> <span class="k">Type</span>
<span class="o">##</span> <span class="n">Model</span> <span class="mi">2</span><span class="p">:</span> <span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span>
<span class="o">##</span>   <span class="n">Res</span><span class="p">.</span><span class="n">Df</span>  <span class="n">RSS</span> <span class="n">Df</span> <span class="k">Sum</span> <span class="k">of</span> <span class="n">Sq</span> <span class="n">F</span> <span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span>
<span class="o">##</span> <span class="mi">1</span>     <span class="mi">72</span> <span class="mi">4845</span>                      
<span class="o">##</span> <span class="mi">2</span>     <span class="mi">72</span> <span class="mi">4845</span>  <span class="mi">0</span>         <span class="mi">0</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">fit2</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span> <span class="o">+</span> <span class="n">Type</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>
<span class="n">fit1</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>

<span class="nf">anova</span><span class="p">(</span><span class="n">fit1</span><span class="p">,</span> <span class="n">fit2</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="n">Analysis</span> <span class="k">of</span> <span class="n">Variance</span> <span class="k">Table</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Model</span> <span class="mi">1</span><span class="p">:</span> <span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span>
<span class="o">##</span> <span class="n">Model</span> <span class="mi">2</span><span class="p">:</span> <span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span> <span class="o">+</span> <span class="k">Type</span>
<span class="o">##</span>   <span class="n">Res</span><span class="p">.</span><span class="n">Df</span>  <span class="n">RSS</span> <span class="n">Df</span> <span class="k">Sum</span> <span class="k">of</span> <span class="n">Sq</span> <span class="n">F</span> <span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span>
<span class="o">##</span> <span class="mi">1</span>     <span class="mi">72</span> <span class="mi">4845</span>                      
<span class="o">##</span> <span class="mi">2</span>     <span class="mi">72</span> <span class="mi">4845</span>  <span class="mi">0</span>         <span class="mi">0</span>
</pre></div>
</td></tr></table>

<h3 id="multiple-comparisons">Multiple comparisons<a class="headerlink" href="#multiple-comparisons" title="Permanent link">&para;</a></h3>
<ul>
<li>Tukey HSD tests for post hoc comparisons on each factor in the model.</li>
<li>Factors as an option.</li>
<li>Type I SS.</li>
</ul>
<!-- -->

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># model</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span> <span class="o">+</span> <span class="n">Type</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>

<span class="c1"># Tukey honestly significant differences</span>
<span class="nf">TukeyHSD</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>   <span class="n">Tukey</span> <span class="n">multiple</span> <span class="n">comparisons</span> <span class="k">of</span> <span class="n">means</span>
<span class="o">##</span>     <span class="mi">95</span><span class="o">%</span> <span class="n">family</span><span class="o">-</span><span class="n">wise</span> <span class="n">confidence</span> <span class="k">level</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="n">Fit</span><span class="p">:</span> <span class="n">aov</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="n">uptake</span> <span class="o">~</span> <span class="n">Plant</span> <span class="o">+</span> <span class="k">Type</span><span class="p">,</span> <span class="k">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">)</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="err">$</span><span class="n">Plant</span>
<span class="o">##</span>            <span class="n">diff</span>    <span class="n">lwr</span>     <span class="n">upr</span> <span class="n">p</span> <span class="n">adj</span>
<span class="o">##</span> <span class="n">Qn2</span><span class="o">-</span><span class="n">Qn1</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">929</span> <span class="o">-</span><span class="mi">12</span><span class="p">.</span><span class="mi">88</span>  <span class="mi">16</span><span class="p">.</span><span class="mi">739</span> <span class="mi">1</span><span class="p">.</span><span class="mi">000</span>
<span class="o">##</span> <span class="n">Qn3</span><span class="o">-</span><span class="n">Qn1</span>   <span class="mi">4</span><span class="p">.</span><span class="mi">386</span> <span class="o">-</span><span class="mi">10</span><span class="p">.</span><span class="mi">42</span>  <span class="mi">19</span><span class="p">.</span><span class="mi">196</span> <span class="mi">0</span><span class="p">.</span><span class="mi">997</span>
<span class="o">##</span> <span class="n">Qc1</span><span class="o">-</span><span class="n">Qn1</span>  <span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">257</span> <span class="o">-</span><span class="mi">18</span><span class="p">.</span><span class="mi">07</span>  <span class="mi">11</span><span class="p">.</span><span class="mi">553</span> <span class="mi">1</span><span class="p">.</span><span class="mi">000</span>
<span class="o">##</span> <span class="n">Qc3</span><span class="o">-</span><span class="n">Qn1</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">643</span> <span class="o">-</span><span class="mi">15</span><span class="p">.</span><span class="mi">45</span>  <span class="mi">14</span><span class="p">.</span><span class="mi">168</span> <span class="mi">1</span><span class="p">.</span><span class="mi">000</span>
<span class="o">##</span> <span class="n">Qc2</span><span class="o">-</span><span class="n">Qn1</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">529</span> <span class="o">-</span><span class="mi">15</span><span class="p">.</span><span class="mi">34</span>  <span class="mi">14</span><span class="p">.</span><span class="mi">282</span> <span class="mi">1</span><span class="p">.</span><span class="mi">000</span>
<span class="o">##</span> <span class="n">Mn3</span><span class="o">-</span><span class="n">Qn1</span>  <span class="o">-</span><span class="mi">9</span><span class="p">.</span><span class="mi">114</span> <span class="o">-</span><span class="mi">23</span><span class="p">.</span><span class="mi">92</span>   <span class="mi">5</span><span class="p">.</span><span class="mi">696</span> <span class="mi">0</span><span class="p">.</span><span class="mi">639</span>
<span class="o">##</span> <span class="n">Mn2</span><span class="o">-</span><span class="n">Qn1</span>  <span class="o">-</span><span class="mi">5</span><span class="p">.</span><span class="mi">886</span> <span class="o">-</span><span class="mi">20</span><span class="p">.</span><span class="mi">70</span>   <span class="mi">8</span><span class="p">.</span><span class="mi">925</span> <span class="mi">0</span><span class="p">.</span><span class="mi">970</span>
<span class="o">##</span> <span class="n">Mn1</span><span class="o">-</span><span class="n">Qn1</span>  <span class="o">-</span><span class="mi">6</span><span class="p">.</span><span class="mi">829</span> <span class="o">-</span><span class="mi">21</span><span class="p">.</span><span class="mi">64</span>   <span class="mi">7</span><span class="p">.</span><span class="mi">982</span> <span class="mi">0</span><span class="p">.</span><span class="mi">918</span>
<span class="o">##</span> <span class="n">Mc2</span><span class="o">-</span><span class="n">Qn1</span> <span class="o">-</span><span class="mi">21</span><span class="p">.</span><span class="mi">086</span> <span class="o">-</span><span class="mi">35</span><span class="p">.</span><span class="mi">90</span>  <span class="o">-</span><span class="mi">6</span><span class="p">.</span><span class="mi">275</span> <span class="mi">0</span><span class="p">.</span><span class="mi">000</span>
<span class="o">##</span> <span class="n">Mc3</span><span class="o">-</span><span class="n">Qn1</span> <span class="o">-</span><span class="mi">15</span><span class="p">.</span><span class="mi">929</span> <span class="o">-</span><span class="mi">30</span><span class="p">.</span><span class="mi">74</span>  <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">118</span> <span class="mi">0</span><span class="p">.</span><span class="mi">024</span>
<span class="o">##</span> <span class="n">Mc1</span><span class="o">-</span><span class="n">Qn1</span> <span class="o">-</span><span class="mi">15</span><span class="p">.</span><span class="mi">229</span> <span class="o">-</span><span class="mi">30</span><span class="p">.</span><span class="mi">04</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">418</span> <span class="mi">0</span><span class="p">.</span><span class="mi">038</span>
<span class="o">##</span> <span class="n">Qn3</span><span class="o">-</span><span class="n">Qn2</span>   <span class="mi">2</span><span class="p">.</span><span class="mi">457</span> <span class="o">-</span><span class="mi">12</span><span class="p">.</span><span class="mi">35</span>  <span class="mi">17</span><span class="p">.</span><span class="mi">268</span> <span class="mi">1</span><span class="p">.</span><span class="mi">000</span>
<span class="o">##</span> <span class="n">Qc1</span><span class="o">-</span><span class="n">Qn2</span>  <span class="o">-</span><span class="mi">5</span><span class="p">.</span><span class="mi">186</span> <span class="o">-</span><span class="mi">20</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">9</span><span class="p">.</span><span class="mi">625</span> <span class="mi">0</span><span class="p">.</span><span class="mi">989</span>
<span class="o">##</span> <span class="n">Qc3</span><span class="o">-</span><span class="n">Qn2</span>  <span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="mi">571</span> <span class="o">-</span><span class="mi">17</span><span class="p">.</span><span class="mi">38</span>  <span class="mi">12</span><span class="p">.</span><span class="mi">239</span> <span class="mi">1</span><span class="p">.</span><span class="mi">000</span>
<span class="o">##</span> <span class="n">Qc2</span><span class="o">-</span><span class="n">Qn2</span>  <span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="mi">457</span> <span class="o">-</span><span class="mi">17</span><span class="p">.</span><span class="mi">27</span>  <span class="mi">12</span><span class="p">.</span><span class="mi">353</span> <span class="mi">1</span><span class="p">.</span><span class="mi">000</span>
<span class="o">##</span> <span class="n">Mn3</span><span class="o">-</span><span class="n">Qn2</span> <span class="o">-</span><span class="mi">11</span><span class="p">.</span><span class="mi">043</span> <span class="o">-</span><span class="mi">25</span><span class="p">.</span><span class="mi">85</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">768</span> <span class="mi">0</span><span class="p">.</span><span class="mi">346</span>
<span class="o">##</span> <span class="n">Mn2</span><span class="o">-</span><span class="n">Qn2</span>  <span class="o">-</span><span class="mi">7</span><span class="p">.</span><span class="mi">814</span> <span class="o">-</span><span class="mi">22</span><span class="p">.</span><span class="mi">62</span>   <span class="mi">6</span><span class="p">.</span><span class="mi">996</span> <span class="mi">0</span><span class="p">.</span><span class="mi">822</span>
<span class="o">##</span> <span class="n">Mn1</span><span class="o">-</span><span class="n">Qn2</span>  <span class="o">-</span><span class="mi">8</span><span class="p">.</span><span class="mi">757</span> <span class="o">-</span><span class="mi">23</span><span class="p">.</span><span class="mi">57</span>   <span class="mi">6</span><span class="p">.</span><span class="mi">053</span> <span class="mi">0</span><span class="p">.</span><span class="mi">694</span>
<span class="o">##</span> <span class="n">Mc2</span><span class="o">-</span><span class="n">Qn2</span> <span class="o">-</span><span class="mi">23</span><span class="p">.</span><span class="mi">014</span> <span class="o">-</span><span class="mi">37</span><span class="p">.</span><span class="mi">82</span>  <span class="o">-</span><span class="mi">8</span><span class="p">.</span><span class="mi">204</span> <span class="mi">0</span><span class="p">.</span><span class="mi">000</span>
<span class="o">##</span> <span class="n">Mc3</span><span class="o">-</span><span class="n">Qn2</span> <span class="o">-</span><span class="mi">17</span><span class="p">.</span><span class="mi">857</span> <span class="o">-</span><span class="mi">32</span><span class="p">.</span><span class="mi">67</span>  <span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">047</span> <span class="mi">0</span><span class="p">.</span><span class="mi">006</span>
<span class="o">##</span> <span class="n">Mc1</span><span class="o">-</span><span class="n">Qn2</span> <span class="o">-</span><span class="mi">17</span><span class="p">.</span><span class="mi">157</span> <span class="o">-</span><span class="mi">31</span><span class="p">.</span><span class="mi">97</span>  <span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="mi">347</span> <span class="mi">0</span><span class="p">.</span><span class="mi">010</span>
<span class="o">##</span> <span class="n">Qc1</span><span class="o">-</span><span class="n">Qn3</span>  <span class="o">-</span><span class="mi">7</span><span class="p">.</span><span class="mi">643</span> <span class="o">-</span><span class="mi">22</span><span class="p">.</span><span class="mi">45</span>   <span class="mi">7</span><span class="p">.</span><span class="mi">168</span> <span class="mi">0</span><span class="p">.</span><span class="mi">842</span>
<span class="o">##</span> <span class="n">Qc3</span><span class="o">-</span><span class="n">Qn3</span>  <span class="o">-</span><span class="mi">5</span><span class="p">.</span><span class="mi">029</span> <span class="o">-</span><span class="mi">19</span><span class="p">.</span><span class="mi">84</span>   <span class="mi">9</span><span class="p">.</span><span class="mi">782</span> <span class="mi">0</span><span class="p">.</span><span class="mi">991</span>
<span class="o">##</span> <span class="n">Qc2</span><span class="o">-</span><span class="n">Qn3</span>  <span class="o">-</span><span class="mi">4</span><span class="p">.</span><span class="mi">914</span> <span class="o">-</span><span class="mi">19</span><span class="p">.</span><span class="mi">72</span>   <span class="mi">9</span><span class="p">.</span><span class="mi">896</span> <span class="mi">0</span><span class="p">.</span><span class="mi">993</span>
<span class="o">##</span> <span class="n">Mn3</span><span class="o">-</span><span class="n">Qn3</span> <span class="o">-</span><span class="mi">13</span><span class="p">.</span><span class="mi">500</span> <span class="o">-</span><span class="mi">28</span><span class="p">.</span><span class="mi">31</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">311</span> <span class="mi">0</span><span class="p">.</span><span class="mi">108</span>
<span class="o">##</span> <span class="n">Mn2</span><span class="o">-</span><span class="n">Qn3</span> <span class="o">-</span><span class="mi">10</span><span class="p">.</span><span class="mi">271</span> <span class="o">-</span><span class="mi">25</span><span class="p">.</span><span class="mi">08</span>   <span class="mi">4</span><span class="p">.</span><span class="mi">539</span> <span class="mi">0</span><span class="p">.</span><span class="mi">457</span>
<span class="o">##</span> <span class="n">Mn1</span><span class="o">-</span><span class="n">Qn3</span> <span class="o">-</span><span class="mi">11</span><span class="p">.</span><span class="mi">214</span> <span class="o">-</span><span class="mi">26</span><span class="p">.</span><span class="mi">02</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">596</span> <span class="mi">0</span><span class="p">.</span><span class="mi">323</span>
<span class="o">##</span> <span class="n">Mc2</span><span class="o">-</span><span class="n">Qn3</span> <span class="o">-</span><span class="mi">25</span><span class="p">.</span><span class="mi">471</span> <span class="o">-</span><span class="mi">40</span><span class="p">.</span><span class="mi">28</span> <span class="o">-</span><span class="mi">10</span><span class="p">.</span><span class="mi">661</span> <span class="mi">0</span><span class="p">.</span><span class="mi">000</span>
<span class="o">##</span> <span class="n">Mc3</span><span class="o">-</span><span class="n">Qn3</span> <span class="o">-</span><span class="mi">20</span><span class="p">.</span><span class="mi">314</span> <span class="o">-</span><span class="mi">35</span><span class="p">.</span><span class="mi">12</span>  <span class="o">-</span><span class="mi">5</span><span class="p">.</span><span class="mi">504</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span>
<span class="o">##</span> <span class="n">Mc1</span><span class="o">-</span><span class="n">Qn3</span> <span class="o">-</span><span class="mi">19</span><span class="p">.</span><span class="mi">614</span> <span class="o">-</span><span class="mi">34</span><span class="p">.</span><span class="mi">42</span>  <span class="o">-</span><span class="mi">4</span><span class="p">.</span><span class="mi">804</span> <span class="mi">0</span><span class="p">.</span><span class="mi">002</span>
<span class="o">##</span> <span class="n">Qc3</span><span class="o">-</span><span class="n">Qc1</span>   <span class="mi">2</span><span class="p">.</span><span class="mi">614</span> <span class="o">-</span><span class="mi">12</span><span class="p">.</span><span class="mi">20</span>  <span class="mi">17</span><span class="p">.</span><span class="mi">425</span> <span class="mi">1</span><span class="p">.</span><span class="mi">000</span>
<span class="o">##</span> <span class="n">Qc2</span><span class="o">-</span><span class="n">Qc1</span>   <span class="mi">2</span><span class="p">.</span><span class="mi">729</span> <span class="o">-</span><span class="mi">12</span><span class="p">.</span><span class="mi">08</span>  <span class="mi">17</span><span class="p">.</span><span class="mi">539</span> <span class="mi">1</span><span class="p">.</span><span class="mi">000</span>
<span class="o">##</span> <span class="n">Mn3</span><span class="o">-</span><span class="n">Qc1</span>  <span class="o">-</span><span class="mi">5</span><span class="p">.</span><span class="mi">857</span> <span class="o">-</span><span class="mi">20</span><span class="p">.</span><span class="mi">67</span>   <span class="mi">8</span><span class="p">.</span><span class="mi">953</span> <span class="mi">0</span><span class="p">.</span><span class="mi">971</span>
<span class="o">##</span> <span class="n">Mn2</span><span class="o">-</span><span class="n">Qc1</span>  <span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="mi">629</span> <span class="o">-</span><span class="mi">17</span><span class="p">.</span><span class="mi">44</span>  <span class="mi">12</span><span class="p">.</span><span class="mi">182</span> <span class="mi">1</span><span class="p">.</span><span class="mi">000</span>
<span class="o">##</span> <span class="n">Mn1</span><span class="o">-</span><span class="n">Qc1</span>  <span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">571</span> <span class="o">-</span><span class="mi">18</span><span class="p">.</span><span class="mi">38</span>  <span class="mi">11</span><span class="p">.</span><span class="mi">239</span> <span class="mi">1</span><span class="p">.</span><span class="mi">000</span>
<span class="o">##</span> <span class="n">Mc2</span><span class="o">-</span><span class="n">Qc1</span> <span class="o">-</span><span class="mi">17</span><span class="p">.</span><span class="mi">829</span> <span class="o">-</span><span class="mi">32</span><span class="p">.</span><span class="mi">64</span>  <span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">018</span> <span class="mi">0</span><span class="p">.</span><span class="mi">006</span>
<span class="o">##</span> <span class="n">Mc3</span><span class="o">-</span><span class="n">Qc1</span> <span class="o">-</span><span class="mi">12</span><span class="p">.</span><span class="mi">671</span> <span class="o">-</span><span class="mi">27</span><span class="p">.</span><span class="mi">48</span>   <span class="mi">2</span><span class="p">.</span><span class="mi">139</span> <span class="mi">0</span><span class="p">.</span><span class="mi">167</span>
<span class="o">##</span> <span class="n">Mc1</span><span class="o">-</span><span class="n">Qc1</span> <span class="o">-</span><span class="mi">11</span><span class="p">.</span><span class="mi">971</span> <span class="o">-</span><span class="mi">26</span><span class="p">.</span><span class="mi">78</span>   <span class="mi">2</span><span class="p">.</span><span class="mi">839</span> <span class="mi">0</span><span class="p">.</span><span class="mi">233</span>
<span class="o">##</span> <span class="n">Qc2</span><span class="o">-</span><span class="n">Qc3</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">114</span> <span class="o">-</span><span class="mi">14</span><span class="p">.</span><span class="mi">70</span>  <span class="mi">14</span><span class="p">.</span><span class="mi">925</span> <span class="mi">1</span><span class="p">.</span><span class="mi">000</span>
<span class="o">##</span> <span class="n">Mn3</span><span class="o">-</span><span class="n">Qc3</span>  <span class="o">-</span><span class="mi">8</span><span class="p">.</span><span class="mi">471</span> <span class="o">-</span><span class="mi">23</span><span class="p">.</span><span class="mi">28</span>   <span class="mi">6</span><span class="p">.</span><span class="mi">339</span> <span class="mi">0</span><span class="p">.</span><span class="mi">735</span>
<span class="o">##</span> <span class="n">Mn2</span><span class="o">-</span><span class="n">Qc3</span>  <span class="o">-</span><span class="mi">5</span><span class="p">.</span><span class="mi">243</span> <span class="o">-</span><span class="mi">20</span><span class="p">.</span><span class="mi">05</span>   <span class="mi">9</span><span class="p">.</span><span class="mi">568</span> <span class="mi">0</span><span class="p">.</span><span class="mi">988</span>
<span class="o">##</span> <span class="n">Mn1</span><span class="o">-</span><span class="n">Qc3</span>  <span class="o">-</span><span class="mi">6</span><span class="p">.</span><span class="mi">186</span> <span class="o">-</span><span class="mi">21</span><span class="p">.</span><span class="mi">00</span>   <span class="mi">8</span><span class="p">.</span><span class="mi">625</span> <span class="mi">0</span><span class="p">.</span><span class="mi">958</span>
<span class="o">##</span> <span class="n">Mc2</span><span class="o">-</span><span class="n">Qc3</span> <span class="o">-</span><span class="mi">20</span><span class="p">.</span><span class="mi">443</span> <span class="o">-</span><span class="mi">35</span><span class="p">.</span><span class="mi">25</span>  <span class="o">-</span><span class="mi">5</span><span class="p">.</span><span class="mi">632</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span>
<span class="o">##</span> <span class="n">Mc3</span><span class="o">-</span><span class="n">Qc3</span> <span class="o">-</span><span class="mi">15</span><span class="p">.</span><span class="mi">286</span> <span class="o">-</span><span class="mi">30</span><span class="p">.</span><span class="mi">10</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">475</span> <span class="mi">0</span><span class="p">.</span><span class="mi">037</span>
<span class="o">##</span> <span class="n">Mc1</span><span class="o">-</span><span class="n">Qc3</span> <span class="o">-</span><span class="mi">14</span><span class="p">.</span><span class="mi">586</span> <span class="o">-</span><span class="mi">29</span><span class="p">.</span><span class="mi">40</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">225</span> <span class="mi">0</span><span class="p">.</span><span class="mi">057</span>
<span class="o">##</span> <span class="n">Mn3</span><span class="o">-</span><span class="n">Qc2</span>  <span class="o">-</span><span class="mi">8</span><span class="p">.</span><span class="mi">586</span> <span class="o">-</span><span class="mi">23</span><span class="p">.</span><span class="mi">40</span>   <span class="mi">6</span><span class="p">.</span><span class="mi">225</span> <span class="mi">0</span><span class="p">.</span><span class="mi">719</span>
<span class="o">##</span> <span class="n">Mn2</span><span class="o">-</span><span class="n">Qc2</span>  <span class="o">-</span><span class="mi">5</span><span class="p">.</span><span class="mi">357</span> <span class="o">-</span><span class="mi">20</span><span class="p">.</span><span class="mi">17</span>   <span class="mi">9</span><span class="p">.</span><span class="mi">453</span> <span class="mi">0</span><span class="p">.</span><span class="mi">985</span>
<span class="o">##</span> <span class="n">Mn1</span><span class="o">-</span><span class="n">Qc2</span>  <span class="o">-</span><span class="mi">6</span><span class="p">.</span><span class="mi">300</span> <span class="o">-</span><span class="mi">21</span><span class="p">.</span><span class="mi">11</span>   <span class="mi">8</span><span class="p">.</span><span class="mi">511</span> <span class="mi">0</span><span class="p">.</span><span class="mi">952</span>
<span class="o">##</span> <span class="n">Mc2</span><span class="o">-</span><span class="n">Qc2</span> <span class="o">-</span><span class="mi">20</span><span class="p">.</span><span class="mi">557</span> <span class="o">-</span><span class="mi">35</span><span class="p">.</span><span class="mi">37</span>  <span class="o">-</span><span class="mi">5</span><span class="p">.</span><span class="mi">747</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span>
<span class="o">##</span> <span class="n">Mc3</span><span class="o">-</span><span class="n">Qc2</span> <span class="o">-</span><span class="mi">15</span><span class="p">.</span><span class="mi">400</span> <span class="o">-</span><span class="mi">30</span><span class="p">.</span><span class="mi">21</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">589</span> <span class="mi">0</span><span class="p">.</span><span class="mi">034</span>
<span class="o">##</span> <span class="n">Mc1</span><span class="o">-</span><span class="n">Qc2</span> <span class="o">-</span><span class="mi">14</span><span class="p">.</span><span class="mi">700</span> <span class="o">-</span><span class="mi">29</span><span class="p">.</span><span class="mi">51</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">111</span> <span class="mi">0</span><span class="p">.</span><span class="mi">054</span>
<span class="o">##</span> <span class="n">Mn2</span><span class="o">-</span><span class="n">Mn3</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">229</span> <span class="o">-</span><span class="mi">11</span><span class="p">.</span><span class="mi">58</span>  <span class="mi">18</span><span class="p">.</span><span class="mi">039</span> <span class="mi">1</span><span class="p">.</span><span class="mi">000</span>
<span class="o">##</span> <span class="n">Mn1</span><span class="o">-</span><span class="n">Mn3</span>   <span class="mi">2</span><span class="p">.</span><span class="mi">286</span> <span class="o">-</span><span class="mi">12</span><span class="p">.</span><span class="mi">52</span>  <span class="mi">17</span><span class="p">.</span><span class="mi">096</span> <span class="mi">1</span><span class="p">.</span><span class="mi">000</span>
<span class="o">##</span> <span class="n">Mc2</span><span class="o">-</span><span class="n">Mn3</span> <span class="o">-</span><span class="mi">11</span><span class="p">.</span><span class="mi">971</span> <span class="o">-</span><span class="mi">26</span><span class="p">.</span><span class="mi">78</span>   <span class="mi">2</span><span class="p">.</span><span class="mi">839</span> <span class="mi">0</span><span class="p">.</span><span class="mi">233</span>
<span class="o">##</span> <span class="n">Mc3</span><span class="o">-</span><span class="n">Mn3</span>  <span class="o">-</span><span class="mi">6</span><span class="p">.</span><span class="mi">814</span> <span class="o">-</span><span class="mi">21</span><span class="p">.</span><span class="mi">62</span>   <span class="mi">7</span><span class="p">.</span><span class="mi">996</span> <span class="mi">0</span><span class="p">.</span><span class="mi">919</span>
<span class="o">##</span> <span class="n">Mc1</span><span class="o">-</span><span class="n">Mn3</span>  <span class="o">-</span><span class="mi">6</span><span class="p">.</span><span class="mi">114</span> <span class="o">-</span><span class="mi">20</span><span class="p">.</span><span class="mi">92</span>   <span class="mi">8</span><span class="p">.</span><span class="mi">696</span> <span class="mi">0</span><span class="p">.</span><span class="mi">961</span>
<span class="o">##</span> <span class="n">Mn1</span><span class="o">-</span><span class="n">Mn2</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">943</span> <span class="o">-</span><span class="mi">15</span><span class="p">.</span><span class="mi">75</span>  <span class="mi">13</span><span class="p">.</span><span class="mi">868</span> <span class="mi">1</span><span class="p">.</span><span class="mi">000</span>
<span class="o">##</span> <span class="n">Mc2</span><span class="o">-</span><span class="n">Mn2</span> <span class="o">-</span><span class="mi">15</span><span class="p">.</span><span class="mi">200</span> <span class="o">-</span><span class="mi">30</span><span class="p">.</span><span class="mi">01</span>  <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">389</span> <span class="mi">0</span><span class="p">.</span><span class="mi">039</span>
<span class="o">##</span> <span class="n">Mc3</span><span class="o">-</span><span class="n">Mn2</span> <span class="o">-</span><span class="mi">10</span><span class="p">.</span><span class="mi">043</span> <span class="o">-</span><span class="mi">24</span><span class="p">.</span><span class="mi">85</span>   <span class="mi">4</span><span class="p">.</span><span class="mi">768</span> <span class="mi">0</span><span class="p">.</span><span class="mi">493</span>
<span class="o">##</span> <span class="n">Mc1</span><span class="o">-</span><span class="n">Mn2</span>  <span class="o">-</span><span class="mi">9</span><span class="p">.</span><span class="mi">343</span> <span class="o">-</span><span class="mi">24</span><span class="p">.</span><span class="mi">15</span>   <span class="mi">5</span><span class="p">.</span><span class="mi">468</span> <span class="mi">0</span><span class="p">.</span><span class="mi">603</span>
<span class="o">##</span> <span class="n">Mc2</span><span class="o">-</span><span class="n">Mn1</span> <span class="o">-</span><span class="mi">14</span><span class="p">.</span><span class="mi">257</span> <span class="o">-</span><span class="mi">29</span><span class="p">.</span><span class="mi">07</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">553</span> <span class="mi">0</span><span class="p">.</span><span class="mi">070</span>
<span class="o">##</span> <span class="n">Mc3</span><span class="o">-</span><span class="n">Mn1</span>  <span class="o">-</span><span class="mi">9</span><span class="p">.</span><span class="mi">100</span> <span class="o">-</span><span class="mi">23</span><span class="p">.</span><span class="mi">91</span>   <span class="mi">5</span><span class="p">.</span><span class="mi">711</span> <span class="mi">0</span><span class="p">.</span><span class="mi">641</span>
<span class="o">##</span> <span class="n">Mc1</span><span class="o">-</span><span class="n">Mn1</span>  <span class="o">-</span><span class="mi">8</span><span class="p">.</span><span class="mi">400</span> <span class="o">-</span><span class="mi">23</span><span class="p">.</span><span class="mi">21</span>   <span class="mi">6</span><span class="p">.</span><span class="mi">411</span> <span class="mi">0</span><span class="p">.</span><span class="mi">746</span>
<span class="o">##</span> <span class="n">Mc3</span><span class="o">-</span><span class="n">Mc2</span>   <span class="mi">5</span><span class="p">.</span><span class="mi">157</span>  <span class="o">-</span><span class="mi">9</span><span class="p">.</span><span class="mi">65</span>  <span class="mi">19</span><span class="p">.</span><span class="mi">968</span> <span class="mi">0</span><span class="p">.</span><span class="mi">989</span>
<span class="o">##</span> <span class="n">Mc1</span><span class="o">-</span><span class="n">Mc2</span>   <span class="mi">5</span><span class="p">.</span><span class="mi">857</span>  <span class="o">-</span><span class="mi">8</span><span class="p">.</span><span class="mi">95</span>  <span class="mi">20</span><span class="p">.</span><span class="mi">668</span> <span class="mi">0</span><span class="p">.</span><span class="mi">971</span>
<span class="o">##</span> <span class="n">Mc1</span><span class="o">-</span><span class="n">Mc3</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">700</span> <span class="o">-</span><span class="mi">14</span><span class="p">.</span><span class="mi">11</span>  <span class="mi">15</span><span class="p">.</span><span class="mi">511</span> <span class="mi">1</span><span class="p">.</span><span class="mi">000</span>
</pre></div>
</td></tr></table>

<h3 id="visualizing-results">Visualizing results<a class="headerlink" href="#visualizing-results" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># two-way interaction plot</span>
<span class="nf">attach</span><span class="p">(</span><span class="n">mtcars</span><span class="p">)</span>

<span class="n">gear</span> <span class="o">&lt;-</span> <span class="nf">factor</span><span class="p">(</span><span class="n">gear</span><span class="p">)</span>
<span class="n">cyl</span> <span class="o">&lt;-</span> <span class="nf">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">)</span>

<span class="c1"># two-way interactions</span>
<span class="nf">library</span><span class="p">(</span><span class="n">car</span><span class="p">)</span>

<span class="nf">interaction.plot</span><span class="p">(</span><span class="n">cyl</span><span class="p">,</span> <span class="n">gear</span><span class="p">,</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">),</span> <span class="n">leg.bty</span> <span class="o">=</span> <span class="s">&quot;o&quot;</span><span class="p">,</span> <span class="n">leg.bg</span> <span class="o">=</span> <span class="s">&quot;beige&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">pch</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">18</span><span class="p">,</span><span class="m">24</span><span class="p">,</span><span class="m">22</span><span class="p">),</span> <span class="n">xlab</span> <span class="o">=</span> <span class="s">&quot;Number of Cylinders&quot;</span><span class="p">,</span> <span class="n">ylab</span> <span class="o">=</span> <span class="s">&quot;Mean Miles Per Gallon&quot;</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;Interaction Plot&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Notes/unnamed-chunk-75-1.png" /></center></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># mean plots for single factors, and includes confidence intervals</span>
<span class="nf">library</span><span class="p">(</span><span class="n">gplots</span><span class="p">)</span>

<span class="nf">plotmeans</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="n">cyl</span><span class="p">,</span> <span class="n">xlab</span> <span class="o">=</span> <span class="s">&quot;Number of Cylinders&quot;</span><span class="p">,</span> <span class="n">ylab</span> <span class="o">=</span> <span class="s">&quot;Miles Per Gallon&quot;</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;Mean Plot\nwith 95% CI&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Notes/unnamed-chunk-75-2.png" /></center></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">detach</span><span class="p">(</span><span class="n">mtcars</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<h3 id="manova">MANOVA<a class="headerlink" href="#manova" title="Permanent link">&para;</a></h3>
<p>Multivariate analysis of variance (MANOVA) With more than one dependent variable Y. We can run several ANOVA over different Y, or one MANOVA with one Y built with several variables.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">head</span><span class="p">(</span><span class="n">longley</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>      <span class="n">GNP</span><span class="p">.</span><span class="n">deflator</span> <span class="n">GNP</span> <span class="n">Unemployed</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span> <span class="n">Population</span> <span class="k">Year</span> <span class="n">Employed</span>
<span class="o">##</span> <span class="mi">1947</span>         <span class="mi">83</span><span class="p">.</span><span class="mi">0</span> <span class="mi">234</span>        <span class="mi">236</span>          <span class="mi">159</span>        <span class="mi">108</span> <span class="mi">1947</span>     <span class="mi">60</span><span class="p">.</span><span class="mi">3</span>
<span class="o">##</span> <span class="mi">1948</span>         <span class="mi">88</span><span class="p">.</span><span class="mi">5</span> <span class="mi">259</span>        <span class="mi">232</span>          <span class="mi">146</span>        <span class="mi">109</span> <span class="mi">1948</span>     <span class="mi">61</span><span class="p">.</span><span class="mi">1</span>
<span class="o">##</span> <span class="mi">1949</span>         <span class="mi">88</span><span class="p">.</span><span class="mi">2</span> <span class="mi">258</span>        <span class="mi">368</span>          <span class="mi">162</span>        <span class="mi">110</span> <span class="mi">1949</span>     <span class="mi">60</span><span class="p">.</span><span class="mi">2</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">attach</span><span class="p">(</span><span class="n">longley</span><span class="p">)</span>

<span class="c1"># 2x2 factorial MANOVA with 3 dependent variables, Y</span>
<span class="n">Y</span> <span class="o">&lt;-</span> <span class="nf">cbind</span><span class="p">(</span><span class="n">Unemployed</span><span class="p">,</span> <span class="n">Armed.Forces</span><span class="p">,</span> <span class="n">Employed</span><span class="p">)</span> <span class="c1"># Y</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">manova</span><span class="p">(</span><span class="n">Y</span> <span class="o">~</span> <span class="n">Population</span><span class="o">*</span><span class="n">GNP</span><span class="p">)</span> <span class="c1"># Y ~ X</span>

<span class="c1"># display type I SS</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="s">&quot;Pillai&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>                <span class="n">Df</span> <span class="n">Pillai</span> <span class="n">approx</span> <span class="n">F</span> <span class="n">num</span> <span class="n">Df</span> <span class="n">den</span> <span class="n">Df</span>  <span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span>    
<span class="o">##</span> <span class="n">Population</span>      <span class="mi">1</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">997</span>     <span class="mi">1074</span>      <span class="mi">3</span>     <span class="mi">10</span> <span class="mi">7</span><span class="p">.</span><span class="mi">7</span><span class="n">e</span><span class="o">-</span><span class="mi">13</span> <span class="o">***</span>
<span class="o">##</span> <span class="n">GNP</span>             <span class="mi">1</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">888</span>       <span class="mi">26</span>      <span class="mi">3</span>     <span class="mi">10</span> <span class="mi">4</span><span class="p">.</span><span class="mi">6</span><span class="n">e</span><span class="o">-</span><span class="mi">05</span> <span class="o">***</span>
<span class="o">##</span> <span class="n">Population</span><span class="p">:</span><span class="n">GNP</span>  <span class="mi">1</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">870</span>       <span class="mi">22</span>      <span class="mi">3</span>     <span class="mi">10</span> <span class="mi">9</span><span class="p">.</span><span class="mi">4</span><span class="n">e</span><span class="o">-</span><span class="mi">05</span> <span class="o">***</span>
<span class="o">##</span> <span class="n">Residuals</span>      <span class="mi">12</span>                                          
<span class="o">##</span> <span class="c1">---</span>
<span class="o">##</span> <span class="n">Signif</span><span class="p">.</span> <span class="n">codes</span><span class="p">:</span>  <span class="mi">0</span> <span class="s1">&#39;***&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span> <span class="s1">&#39;**&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="s1">&#39;*&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span> <span class="s1">&#39;.&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="s1">&#39; &#39;</span> <span class="mi">1</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># test = &quot;Wilks&quot;, &quot;Hotelling-Lawley&quot;, and &quot;Roy&quot;</span>

<span class="c1"># display univariate statistics</span>
<span class="nf">summary.aov</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>  <span class="n">Response</span> <span class="n">Unemployed</span> <span class="p">:</span>
<span class="o">##</span>                <span class="n">Df</span> <span class="k">Sum</span> <span class="n">Sq</span> <span class="n">Mean</span> <span class="n">Sq</span> <span class="n">F</span> <span class="n">value</span>  <span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span>    
<span class="o">##</span> <span class="n">Population</span>      <span class="mi">1</span>  <span class="mi">61739</span>   <span class="mi">61739</span>   <span class="mi">45</span><span class="p">.</span><span class="mi">92</span>   <span class="mi">2</span><span class="n">e</span><span class="o">-</span><span class="mi">05</span> <span class="o">***</span>
<span class="o">##</span> <span class="n">GNP</span>             <span class="mi">1</span>  <span class="mi">42841</span>   <span class="mi">42841</span>   <span class="mi">31</span><span class="p">.</span><span class="mi">87</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00011</span> <span class="o">***</span>
<span class="o">##</span> <span class="n">Population</span><span class="p">:</span><span class="n">GNP</span>  <span class="mi">1</span>  <span class="mi">10270</span>   <span class="mi">10270</span>    <span class="mi">7</span><span class="p">.</span><span class="mi">64</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01715</span> <span class="o">*</span>  
<span class="o">##</span> <span class="n">Residuals</span>      <span class="mi">12</span>  <span class="mi">16133</span>    <span class="mi">1344</span>                    
<span class="o">##</span> <span class="c1">---</span>
<span class="o">##</span> <span class="n">Signif</span><span class="p">.</span> <span class="n">codes</span><span class="p">:</span>  <span class="mi">0</span> <span class="s1">&#39;***&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span> <span class="s1">&#39;**&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="s1">&#39;*&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span> <span class="s1">&#39;.&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="s1">&#39; &#39;</span> <span class="mi">1</span>
<span class="o">##</span> 
<span class="o">##</span>  <span class="n">Response</span> <span class="n">Armed</span><span class="p">.</span><span class="n">Forces</span> <span class="p">:</span>
<span class="o">##</span>                <span class="n">Df</span> <span class="k">Sum</span> <span class="n">Sq</span> <span class="n">Mean</span> <span class="n">Sq</span> <span class="n">F</span> <span class="n">value</span> <span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span>   
<span class="o">##</span> <span class="n">Population</span>      <span class="mi">1</span>   <span class="mi">9647</span>    <span class="mi">9647</span>    <span class="mi">4</span><span class="p">.</span><span class="mi">25</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0617</span> <span class="p">.</span> 
<span class="o">##</span> <span class="n">GNP</span>             <span class="mi">1</span>  <span class="mi">29772</span>   <span class="mi">29772</span>   <span class="mi">13</span><span class="p">.</span><span class="mi">10</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0035</span> <span class="o">**</span>
<span class="o">##</span> <span class="n">Population</span><span class="p">:</span><span class="n">GNP</span>  <span class="mi">1</span>   <span class="mi">5958</span>    <span class="mi">5958</span>    <span class="mi">2</span><span class="p">.</span><span class="mi">62</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1314</span>   
<span class="o">##</span> <span class="n">Residuals</span>      <span class="mi">12</span>  <span class="mi">27268</span>    <span class="mi">2272</span>                  
<span class="o">##</span> <span class="c1">---</span>
<span class="o">##</span> <span class="n">Signif</span><span class="p">.</span> <span class="n">codes</span><span class="p">:</span>  <span class="mi">0</span> <span class="s1">&#39;***&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span> <span class="s1">&#39;**&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="s1">&#39;*&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span> <span class="s1">&#39;.&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="s1">&#39; &#39;</span> <span class="mi">1</span>
<span class="o">##</span> 
<span class="o">##</span>  <span class="n">Response</span> <span class="n">Employed</span> <span class="p">:</span>
<span class="o">##</span>                <span class="n">Df</span> <span class="k">Sum</span> <span class="n">Sq</span> <span class="n">Mean</span> <span class="n">Sq</span> <span class="n">F</span> <span class="n">value</span>  <span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span>    
<span class="o">##</span> <span class="n">Population</span>      <span class="mi">1</span>  <span class="mi">170</span><span class="p">.</span><span class="mi">6</span>   <span class="mi">170</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">546</span><span class="p">.</span><span class="mi">45</span> <span class="mi">2</span><span class="p">.</span><span class="mi">2</span><span class="n">e</span><span class="o">-</span><span class="mi">11</span> <span class="o">***</span>
<span class="o">##</span> <span class="n">GNP</span>             <span class="mi">1</span>   <span class="mi">10</span><span class="p">.</span><span class="mi">5</span>    <span class="mi">10</span><span class="p">.</span><span class="mi">5</span>   <span class="mi">33</span><span class="p">.</span><span class="mi">60</span> <span class="mi">8</span><span class="p">.</span><span class="mi">5</span><span class="n">e</span><span class="o">-</span><span class="mi">05</span> <span class="o">***</span>
<span class="o">##</span> <span class="n">Population</span><span class="p">:</span><span class="n">GNP</span>  <span class="mi">1</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">1</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">1</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">41</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">54</span>    
<span class="o">##</span> <span class="n">Residuals</span>      <span class="mi">12</span>    <span class="mi">3</span><span class="p">.</span><span class="mi">7</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">3</span>                    
<span class="o">##</span> <span class="c1">---</span>
<span class="o">##</span> <span class="n">Signif</span><span class="p">.</span> <span class="n">codes</span><span class="p">:</span>  <span class="mi">0</span> <span class="s1">&#39;***&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span> <span class="s1">&#39;**&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="s1">&#39;*&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span> <span class="s1">&#39;.&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="s1">&#39; &#39;</span> <span class="mi">1</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># display type III SS</span>
<span class="n">fit1</span> <span class="o">&lt;-</span> <span class="nf">manova</span><span class="p">(</span><span class="n">Y</span> <span class="o">~</span> <span class="n">Population</span><span class="o">*</span><span class="n">GNP</span><span class="p">)</span>
<span class="n">fit2</span> <span class="o">&lt;-</span> <span class="nf">manova</span><span class="p">(</span><span class="n">Y</span> <span class="o">~</span> <span class="n">GNP</span><span class="o">*</span><span class="n">Population</span><span class="p">)</span>
<span class="c1"># type III GNP effect</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit1</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>                <span class="n">Df</span> <span class="n">Pillai</span> <span class="n">approx</span> <span class="n">F</span> <span class="n">num</span> <span class="n">Df</span> <span class="n">den</span> <span class="n">Df</span>  <span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span>    
<span class="o">##</span> <span class="n">Population</span>      <span class="mi">1</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">997</span>     <span class="mi">1074</span>      <span class="mi">3</span>     <span class="mi">10</span> <span class="mi">7</span><span class="p">.</span><span class="mi">7</span><span class="n">e</span><span class="o">-</span><span class="mi">13</span> <span class="o">***</span>
<span class="o">##</span> <span class="n">GNP</span>             <span class="mi">1</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">888</span>       <span class="mi">26</span>      <span class="mi">3</span>     <span class="mi">10</span> <span class="mi">4</span><span class="p">.</span><span class="mi">6</span><span class="n">e</span><span class="o">-</span><span class="mi">05</span> <span class="o">***</span>
<span class="o">##</span> <span class="n">Population</span><span class="p">:</span><span class="n">GNP</span>  <span class="mi">1</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">870</span>       <span class="mi">22</span>      <span class="mi">3</span>     <span class="mi">10</span> <span class="mi">9</span><span class="p">.</span><span class="mi">4</span><span class="n">e</span><span class="o">-</span><span class="mi">05</span> <span class="o">***</span>
<span class="o">##</span> <span class="n">Residuals</span>      <span class="mi">12</span>                                          
<span class="o">##</span> <span class="c1">---</span>
<span class="o">##</span> <span class="n">Signif</span><span class="p">.</span> <span class="n">codes</span><span class="p">:</span>  <span class="mi">0</span> <span class="s1">&#39;***&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span> <span class="s1">&#39;**&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="s1">&#39;*&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span> <span class="s1">&#39;.&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="s1">&#39; &#39;</span> <span class="mi">1</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># type III Population effect</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit2</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>                <span class="n">Df</span> <span class="n">Pillai</span> <span class="n">approx</span> <span class="n">F</span> <span class="n">num</span> <span class="n">Df</span> <span class="n">den</span> <span class="n">Df</span>  <span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span>    
<span class="o">##</span> <span class="n">GNP</span>             <span class="mi">1</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">997</span>     <span class="mi">1088</span>      <span class="mi">3</span>     <span class="mi">10</span> <span class="mi">7</span><span class="p">.</span><span class="mi">2</span><span class="n">e</span><span class="o">-</span><span class="mi">13</span> <span class="o">***</span>
<span class="o">##</span> <span class="n">Population</span>      <span class="mi">1</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">786</span>       <span class="mi">12</span>      <span class="mi">3</span>     <span class="mi">10</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0011</span> <span class="o">**</span> 
<span class="o">##</span> <span class="n">GNP</span><span class="p">:</span><span class="n">Population</span>  <span class="mi">1</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">870</span>       <span class="mi">22</span>      <span class="mi">3</span>     <span class="mi">10</span> <span class="mi">9</span><span class="p">.</span><span class="mi">4</span><span class="n">e</span><span class="o">-</span><span class="mi">05</span> <span class="o">***</span>
<span class="o">##</span> <span class="n">Residuals</span>      <span class="mi">12</span>                                          
<span class="o">##</span> <span class="c1">---</span>
<span class="o">##</span> <span class="n">Signif</span><span class="p">.</span> <span class="n">codes</span><span class="p">:</span>  <span class="mi">0</span> <span class="s1">&#39;***&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span> <span class="s1">&#39;**&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="s1">&#39;*&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span> <span class="s1">&#39;.&#39;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="s1">&#39; &#39;</span> <span class="mi">1</span>
</pre></div>
</td></tr></table>

<p><strong>Multiple comparisons</strong></p>
<p><code class="codehilite"><span class="n">TukeyHSD</span></code> and <code class="codehilite"><span class="n">plot</span></code> do work with a MANOVA fit. Run each dependent variable separately to obtain them&hellip; or proceed with ANOVA on each dependent variable.</p>
<h3 id="going-further_1">Going further<a class="headerlink" href="#going-further_1" title="Permanent link">&para;</a></h3>
<p>Package <code class="codehilite"><span class="n">lme4</span></code> has excellent facilities for fitting linear and generalized linear mixed-effects models.</p>
<h2 id="manova-assumptions">(M)ANOVA Assumptions<a class="headerlink" href="#manova-assumptions" title="Permanent link">&para;</a></h2>
<h3 id="outliers_1">Outliers<a class="headerlink" href="#outliers_1" title="Permanent link">&para;</a></h3>
<p>Outliers can severely affect normality and homogeneity of variance.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>                <span class="n">mpg</span> <span class="n">cyl</span> <span class="n">disp</span>  <span class="n">hp</span> <span class="n">drat</span>   <span class="n">wt</span> <span class="n">qsec</span> <span class="n">vs</span> <span class="n">am</span> <span class="n">gear</span> <span class="n">carb</span>
<span class="o">##</span> <span class="n">Mazda</span> <span class="n">RX4</span>     <span class="mi">21</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">6</span>  <span class="mi">160</span> <span class="mi">110</span> <span class="mi">3</span><span class="p">.</span><span class="mi">90</span> <span class="mi">2</span><span class="p">.</span><span class="mi">62</span> <span class="mi">16</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">0</span>  <span class="mi">1</span>    <span class="mi">4</span>    <span class="mi">4</span>
<span class="o">##</span> <span class="n">Mazda</span> <span class="n">RX4</span> <span class="n">Wag</span> <span class="mi">21</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">6</span>  <span class="mi">160</span> <span class="mi">110</span> <span class="mi">3</span><span class="p">.</span><span class="mi">90</span> <span class="mi">2</span><span class="p">.</span><span class="mi">88</span> <span class="mi">17</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>    <span class="mi">4</span>    <span class="mi">4</span>
<span class="o">##</span> <span class="n">Datsun</span> <span class="mi">710</span>    <span class="mi">22</span><span class="p">.</span><span class="mi">8</span>   <span class="mi">4</span>  <span class="mi">108</span>  <span class="mi">93</span> <span class="mi">3</span><span class="p">.</span><span class="mi">85</span> <span class="mi">2</span><span class="p">.</span><span class="mi">32</span> <span class="mi">18</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">1</span>  <span class="mi">1</span>    <span class="mi">4</span>    <span class="mi">1</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># detect outliers</span>
<span class="c1"># ordered squared robust Mahalanobis distances of the observations against the empirical distribution function of the MD2i</span>
<span class="nf">library</span><span class="p">(</span><span class="n">mvoutlier</span><span class="p">)</span>

<span class="n">outliers</span> <span class="o">&lt;-</span>
<span class="nf">aq.plot</span><span class="p">(</span><span class="n">mtcars</span><span class="nf">[c</span><span class="p">(</span><span class="s">&quot;mpg&quot;</span><span class="p">,</span> <span class="s">&quot;disp&quot;</span><span class="p">,</span> <span class="s">&quot;hp&quot;</span><span class="p">,</span> <span class="s">&quot;drat&quot;</span><span class="p">,</span> <span class="s">&quot;wt&quot;</span><span class="p">,</span> <span class="s">&quot;qsec&quot;</span><span class="p">)</span><span class="n">]</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="n">Projection</span> <span class="k">to</span> <span class="n">the</span> <span class="k">first</span> <span class="k">and</span> <span class="k">second</span> <span class="n">robust</span> <span class="n">principal</span> <span class="n">components</span><span class="p">.</span>
<span class="o">##</span> <span class="n">Proportion</span> <span class="k">of</span> <span class="n">total</span> <span class="n">variation</span> <span class="p">(</span><span class="n">explained</span> <span class="n">variance</span><span class="p">):</span> <span class="mi">0</span><span class="p">.</span><span class="mi">974</span>
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Notes/unnamed-chunk-79-1.png" /></center></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">outliers</span> <span class="c1"># show list of outliers</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="err">$</span><span class="n">outliers</span>
<span class="o">##</span>           <span class="n">Mazda</span> <span class="n">RX4</span>       <span class="n">Mazda</span> <span class="n">RX4</span> <span class="n">Wag</span>          <span class="n">Datsun</span> <span class="mi">710</span> 
<span class="o">##</span>               <span class="k">FALSE</span>               <span class="k">FALSE</span>               <span class="k">FALSE</span> 
<span class="o">##</span>      <span class="n">Hornet</span> <span class="mi">4</span> <span class="n">Drive</span>   <span class="n">Hornet</span> <span class="n">Sportabout</span>             <span class="n">Valiant</span> 
<span class="o">##</span>               <span class="k">FALSE</span>               <span class="k">FALSE</span>               <span class="k">FALSE</span> 
<span class="o">##</span>          <span class="n">Duster</span> <span class="mi">360</span>           <span class="n">Merc</span> <span class="mi">240</span><span class="n">D</span>            <span class="n">Merc</span> <span class="mi">230</span> 
<span class="o">##</span>                <span class="k">TRUE</span>                <span class="k">TRUE</span>                <span class="k">TRUE</span> 
<span class="o">##</span>            <span class="n">Merc</span> <span class="mi">280</span>           <span class="n">Merc</span> <span class="mi">280</span><span class="k">C</span>          <span class="n">Merc</span> <span class="mi">450</span><span class="n">SE</span> 
<span class="o">##</span>               <span class="k">FALSE</span>               <span class="k">FALSE</span>               <span class="k">FALSE</span> 
<span class="o">##</span>          <span class="n">Merc</span> <span class="mi">450</span><span class="n">SL</span>         <span class="n">Merc</span> <span class="mi">450</span><span class="n">SLC</span>  <span class="n">Cadillac</span> <span class="n">Fleetwood</span> 
<span class="o">##</span>               <span class="k">FALSE</span>               <span class="k">FALSE</span>               <span class="k">FALSE</span> 
<span class="o">##</span> <span class="n">Lincoln</span> <span class="n">Continental</span>   <span class="n">Chrysler</span> <span class="n">Imperial</span>            <span class="n">Fiat</span> <span class="mi">128</span> 
<span class="o">##</span>               <span class="k">FALSE</span>               <span class="k">FALSE</span>                <span class="k">TRUE</span> 
<span class="o">##</span>         <span class="n">Honda</span> <span class="n">Civic</span>      <span class="n">Toyota</span> <span class="n">Corolla</span>       <span class="n">Toyota</span> <span class="n">Corona</span> 
<span class="o">##</span>               <span class="k">FALSE</span>               <span class="k">FALSE</span>               <span class="k">FALSE</span> 
<span class="o">##</span>    <span class="n">Dodge</span> <span class="n">Challenger</span>         <span class="n">AMC</span> <span class="n">Javelin</span>          <span class="n">Camaro</span> <span class="n">Z28</span> 
<span class="o">##</span>               <span class="k">FALSE</span>               <span class="k">FALSE</span>                <span class="k">TRUE</span> 
<span class="o">##</span>    <span class="n">Pontiac</span> <span class="n">Firebird</span>           <span class="n">Fiat</span> <span class="n">X1</span><span class="o">-</span><span class="mi">9</span>       <span class="n">Porsche</span> <span class="mi">914</span><span class="o">-</span><span class="mi">2</span> 
<span class="o">##</span>               <span class="k">FALSE</span>               <span class="k">FALSE</span>               <span class="k">FALSE</span> 
<span class="o">##</span>        <span class="n">Lotus</span> <span class="n">Europa</span>      <span class="n">Ford</span> <span class="n">Pantera</span> <span class="n">L</span>        <span class="n">Ferrari</span> <span class="n">Dino</span> 
<span class="o">##</span>               <span class="k">FALSE</span>                <span class="k">TRUE</span>               <span class="k">FALSE</span> 
<span class="o">##</span>       <span class="n">Maserati</span> <span class="n">Bora</span>          <span class="n">Volvo</span> <span class="mi">142</span><span class="n">E</span> 
<span class="o">##</span>                <span class="k">TRUE</span>               <span class="k">FALSE</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
</pre></div>
</td></tr></table>

<h3 id="univariate-normality">Univariate normality<a class="headerlink" href="#univariate-normality" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Q-Q plot</span>
<span class="nf">qqnorm</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span>
<span class="nf">qqline</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Notes/unnamed-chunk-80-1.png" /></center></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Shapiro-Wilk test of normality</span>
<span class="nf">shapiro.test</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">Shapiro</span><span class="o">-</span><span class="n">Wilk</span> <span class="n">normality</span> <span class="n">test</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="n">mtcars$mpg</span>
<span class="o">##</span> <span class="n">W</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">9</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">nortest</span><span class="p">)</span>

<span class="c1"># Anderson-Darling test for normality</span>
<span class="nf">ad.test</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">Anderson</span><span class="o">-</span><span class="n">Darling</span> <span class="n">normality</span> <span class="n">test</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="n">mtcars$mpg</span>
<span class="o">##</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">6</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Cramer-von Mises test for normality</span>
<span class="nf">cvm.test</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">Cramer</span><span class="o">-</span><span class="n">von</span> <span class="n">Mises</span> <span class="n">normality</span> <span class="n">test</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="n">mtcars$mpg</span>
<span class="o">##</span> <span class="n">W</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">09</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Lilliefors (Kolmogorov-Smirnov) test for normality</span>
<span class="nf">lillie.test</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">Lilliefors</span> <span class="p">(</span><span class="n">Kolmogorov</span><span class="o">-</span><span class="n">Smirnov</span><span class="p">)</span> <span class="n">normality</span> <span class="n">test</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="n">mtcars$mpg</span>
<span class="o">##</span> <span class="n">D</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Pearson chi-square test for normality</span>
<span class="nf">pearson.test</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">Pearson</span> <span class="n">chi</span><span class="o">-</span><span class="n">square</span> <span class="n">normality</span> <span class="n">test</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="n">mtcars$mpg</span>
<span class="o">##</span> <span class="n">P</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Shapiro-Francia test for normality</span>
<span class="nf">sf.test</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">Shapiro</span><span class="o">-</span><span class="n">Francia</span> <span class="n">normality</span> <span class="n">test</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="n">mtcars$mpg</span>
<span class="o">##</span> <span class="n">W</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span>
</pre></div>
</td></tr></table>

<h3 id="multivariate-normality">Multivariate normality<a class="headerlink" href="#multivariate-normality" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">head</span><span class="p">(</span><span class="n">EuStockMarkets</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>       <span class="n">DAX</span>  <span class="n">SMI</span>  <span class="n">CAC</span> <span class="n">FTSE</span>
<span class="o">##</span> <span class="p">[</span><span class="mi">1</span><span class="p">,]</span> <span class="mi">1629</span> <span class="mi">1678</span> <span class="mi">1773</span> <span class="mi">2444</span>
<span class="o">##</span> <span class="p">[</span><span class="mi">2</span><span class="p">,]</span> <span class="mi">1614</span> <span class="mi">1688</span> <span class="mi">1750</span> <span class="mi">2460</span>
<span class="o">##</span> <span class="p">[</span><span class="mi">3</span><span class="p">,]</span> <span class="mi">1607</span> <span class="mi">1679</span> <span class="mi">1718</span> <span class="mi">2448</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">mvnormtest</span><span class="p">)</span>

<span class="c1"># Shapiro-Wilk test for multivariate normality of numeric matrix</span>
<span class="nf">mshapiro.test</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">EuStockMarkets</span><span class="p">))</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">Shapiro</span><span class="o">-</span><span class="n">Wilk</span> <span class="n">normality</span> <span class="n">test</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="n">Z</span>
<span class="o">##</span> <span class="n">W</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">9</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">&lt;</span><span class="mi">2</span><span class="n">e</span><span class="o">-</span><span class="mi">16</span>
</pre></div>
</td></tr></table>

<p>With a p x 1 multivariate normal random vector x vector, the squared Mahalanobis distance between x and ?? is going to be chi-square distributed with p degrees of freedom.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># graphical assessment of multivariate normality</span>
<span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">as.matrix</span><span class="p">(</span><span class="n">EuStockMarkets</span><span class="p">)</span> <span class="c1"># n x p numeric matrix</span>
<span class="n">center</span> <span class="o">&lt;-</span> <span class="nf">colMeans</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1"># centroid</span>
<span class="n">n</span> <span class="o">&lt;-</span> <span class="nf">nrow</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="n">p</span> <span class="o">&lt;-</span> <span class="nf">ncol</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">cov</span> <span class="o">&lt;-</span> <span class="nf">cov</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span> <span class="o">&lt;-</span> <span class="nf">mahalanobis</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">cov</span><span class="p">)</span> <span class="c1"># distances</span>

<span class="nf">qqplot</span><span class="p">(</span><span class="nf">qchisq</span><span class="p">(</span><span class="nf">ppoints</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">df</span> <span class="o">=</span> <span class="n">p</span><span class="p">),</span> <span class="n">d</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;QQ Plot Assessing Multivariate Normality&quot;</span><span class="p">,</span> <span class="n">ylab</span> <span class="o">=</span> <span class="s">&quot;Mahalanobis D2&quot;</span><span class="p">)</span>
<span class="nf">abline</span><span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span> 
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Notes/unnamed-chunk-84-1.png" /></center></p>
<h3 id="heteroscedasticity_1">Heteroscedasticity<a class="headerlink" href="#heteroscedasticity_1" title="Permanent link">&para;</a></h3>
<p>Nonconstant error variance or non-homogeneity of variances.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>                <span class="n">mpg</span> <span class="n">cyl</span> <span class="n">disp</span>  <span class="n">hp</span> <span class="n">drat</span>   <span class="n">wt</span> <span class="n">qsec</span> <span class="n">vs</span> <span class="n">am</span> <span class="n">gear</span> <span class="n">carb</span>
<span class="o">##</span> <span class="n">Mazda</span> <span class="n">RX4</span>     <span class="mi">21</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">6</span>  <span class="mi">160</span> <span class="mi">110</span> <span class="mi">3</span><span class="p">.</span><span class="mi">90</span> <span class="mi">2</span><span class="p">.</span><span class="mi">62</span> <span class="mi">16</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">0</span>  <span class="mi">1</span>    <span class="mi">4</span>    <span class="mi">4</span>
<span class="o">##</span> <span class="n">Mazda</span> <span class="n">RX4</span> <span class="n">Wag</span> <span class="mi">21</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">6</span>  <span class="mi">160</span> <span class="mi">110</span> <span class="mi">3</span><span class="p">.</span><span class="mi">90</span> <span class="mi">2</span><span class="p">.</span><span class="mi">88</span> <span class="mi">17</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>    <span class="mi">4</span>    <span class="mi">4</span>
<span class="o">##</span> <span class="n">Datsun</span> <span class="mi">710</span>    <span class="mi">22</span><span class="p">.</span><span class="mi">8</span>   <span class="mi">4</span>  <span class="mi">108</span>  <span class="mi">93</span> <span class="mi">3</span><span class="p">.</span><span class="mi">85</span> <span class="mi">2</span><span class="p">.</span><span class="mi">32</span> <span class="mi">18</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">1</span>  <span class="mi">1</span>    <span class="mi">4</span>    <span class="mi">1</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># y is a numeric variable and G is the grouping variable</span>
<span class="c1"># Bartlett parametric test of homogeneity of variances</span>
<span class="nf">bartlett.test</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="n">cyl</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">Bartlett</span> <span class="n">test</span> <span class="k">of</span> <span class="n">homogeneity</span> <span class="k">of</span> <span class="n">variances</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="n">mpg</span> <span class="k">by</span> <span class="n">cyl</span>
<span class="o">##</span> <span class="n">Bartlett</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">K</span><span class="o">-</span><span class="n">squared</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">02</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Figner-Killeen non-parametric test of homogeneity of variances</span>
<span class="nf">fligner.test</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="n">cyl</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">)</span> 
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">Fligner</span><span class="o">-</span><span class="n">Killeen</span> <span class="n">test</span> <span class="k">of</span> <span class="n">homogeneity</span> <span class="k">of</span> <span class="n">variances</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="n">mpg</span> <span class="k">by</span> <span class="n">cyl</span>
<span class="o">##</span> <span class="n">Fligner</span><span class="o">-</span><span class="n">Killeen</span><span class="p">:</span><span class="n">med</span> <span class="n">chi</span><span class="o">-</span><span class="n">squared</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">03</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">HH</span><span class="p">)</span>

<span class="c1"># y is numeric and G is a grouping factor</span>
<span class="c1"># G must be of type factor</span>
<span class="nf">hov</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="nf">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">hov</span><span class="p">:</span> <span class="n">Brown</span><span class="o">-</span><span class="n">Forsyth</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="n">mpg</span>
<span class="o">##</span> <span class="n">F</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span><span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span><span class="n">Residuals</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">009</span>
<span class="o">##</span> <span class="n">alternative</span> <span class="n">hypothesis</span><span class="p">:</span> <span class="n">variances</span> <span class="k">are</span> <span class="k">not</span> <span class="n">identical</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># homogeneity of variance plot</span>
<span class="c1"># graphic test of homogeneity of variances based on Brown-Forsyth</span>
<span class="nf">hovPlot</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="nf">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">)</span> 
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Notes/unnamed-chunk-87-1.png" /></center></p>
<p><strong>Non-homogeneity of covariance matrices</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>   <span class="n">Sepal</span><span class="p">.</span><span class="k">Length</span> <span class="n">Sepal</span><span class="p">.</span><span class="n">Width</span> <span class="n">Petal</span><span class="p">.</span><span class="k">Length</span> <span class="n">Petal</span><span class="p">.</span><span class="n">Width</span> <span class="n">Species</span>
<span class="o">##</span> <span class="mi">1</span>          <span class="mi">5</span><span class="p">.</span><span class="mi">1</span>         <span class="mi">3</span><span class="p">.</span><span class="mi">5</span>          <span class="mi">1</span><span class="p">.</span><span class="mi">4</span>         <span class="mi">0</span><span class="p">.</span><span class="mi">2</span>  <span class="n">setosa</span>
<span class="o">##</span> <span class="mi">2</span>          <span class="mi">4</span><span class="p">.</span><span class="mi">9</span>         <span class="mi">3</span><span class="p">.</span><span class="mi">0</span>          <span class="mi">1</span><span class="p">.</span><span class="mi">4</span>         <span class="mi">0</span><span class="p">.</span><span class="mi">2</span>  <span class="n">setosa</span>
<span class="o">##</span> <span class="mi">3</span>          <span class="mi">4</span><span class="p">.</span><span class="mi">7</span>         <span class="mi">3</span><span class="p">.</span><span class="mi">2</span>          <span class="mi">1</span><span class="p">.</span><span class="mi">3</span>         <span class="mi">0</span><span class="p">.</span><span class="mi">2</span>  <span class="n">setosa</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">biotools</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="c1">---</span>
<span class="o">##</span> <span class="n">biotools</span> <span class="k">version</span> <span class="mi">3</span><span class="p">.</span><span class="mi">0</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Box&#39;s M test</span>
<span class="c1"># very sensitive to violations of normality, leading to rejection in most typical cases</span>
<span class="nf">boxM</span><span class="p">(</span><span class="n">iris[</span><span class="p">,</span> <span class="m">-5</span><span class="n">]</span><span class="p">,</span> <span class="n">iris[</span><span class="p">,</span> <span class="m">5</span><span class="n">]</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>## 
##  <span class="nv">Box</span><span class="s1">&#39;</span><span class="s">s M-test for Homogeneity of Covariance Matrices</span>
## 
## <span class="nv">data</span>:  <span class="nv">iris</span>[, <span class="o">-</span><span class="mi">5</span>]
## <span class="nv">Chi</span><span class="o">-</span><span class="nv">Sq</span> <span class="ss">(</span><span class="nv">approx</span>.<span class="ss">)</span> <span class="o">=</span> <span class="mi">100</span>, <span class="nv">df</span> <span class="o">=</span> <span class="mi">20</span>, <span class="nv">p</span><span class="o">-</span><span class="nv">value</span> <span class="o">&lt;</span><span class="mi">2</span><span class="nv">e</span><span class="o">-</span><span class="mi">16</span>
</pre></div>
</td></tr></table>

<h2 id="resampling-statistics">Resampling Statistics<a class="headerlink" href="#resampling-statistics" title="Permanent link">&para;</a></h2>
<h3 id="independent-k-sample-location-tests">Independent k-sample location tests<a class="headerlink" href="#independent-k-sample-location-tests" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>                <span class="n">mpg</span> <span class="n">cyl</span> <span class="n">disp</span>  <span class="n">hp</span> <span class="n">drat</span>   <span class="n">wt</span> <span class="n">qsec</span> <span class="n">vs</span> <span class="n">am</span> <span class="n">gear</span> <span class="n">carb</span>
<span class="o">##</span> <span class="n">Mazda</span> <span class="n">RX4</span>     <span class="mi">21</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">6</span>  <span class="mi">160</span> <span class="mi">110</span> <span class="mi">3</span><span class="p">.</span><span class="mi">90</span> <span class="mi">2</span><span class="p">.</span><span class="mi">62</span> <span class="mi">16</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">0</span>  <span class="mi">1</span>    <span class="mi">4</span>    <span class="mi">4</span>
<span class="o">##</span> <span class="n">Mazda</span> <span class="n">RX4</span> <span class="n">Wag</span> <span class="mi">21</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">6</span>  <span class="mi">160</span> <span class="mi">110</span> <span class="mi">3</span><span class="p">.</span><span class="mi">90</span> <span class="mi">2</span><span class="p">.</span><span class="mi">88</span> <span class="mi">17</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>    <span class="mi">4</span>    <span class="mi">4</span>
<span class="o">##</span> <span class="n">Datsun</span> <span class="mi">710</span>    <span class="mi">22</span><span class="p">.</span><span class="mi">8</span>   <span class="mi">4</span>  <span class="mi">108</span>  <span class="mi">93</span> <span class="mi">3</span><span class="p">.</span><span class="mi">85</span> <span class="mi">2</span><span class="p">.</span><span class="mi">32</span> <span class="mi">18</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">1</span>  <span class="mi">1</span>    <span class="mi">4</span>    <span class="mi">1</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># exact Wilcoxon Mann Whitney rank sum test</span>
<span class="c1"># re-randomization or permutation based statistical tests</span>
<span class="c1"># where y is numeric and A is a binary factor</span>
<span class="nf">library</span><span class="p">(</span><span class="n">coin</span><span class="p">)</span>

<span class="nf">wilcox_test</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="nf">factor</span><span class="p">(</span><span class="n">am</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">,</span> <span class="n">distribution</span> <span class="o">=</span> <span class="s">&quot;exact&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">Exact</span> <span class="n">Wilcoxon</span><span class="o">-</span><span class="n">Mann</span><span class="o">-</span><span class="n">Whitney</span> <span class="n">Test</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="n">mpg</span> <span class="k">by</span> <span class="n">factor</span><span class="p">(</span><span class="n">am</span><span class="p">)</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="o">##</span> <span class="n">Z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span>
<span class="o">##</span> <span class="n">alternative</span> <span class="n">hypothesis</span><span class="p">:</span> <span class="k">true</span> <span class="n">mu</span> <span class="k">is</span> <span class="k">not</span> <span class="n">equal</span> <span class="k">to</span> <span class="mi">0</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># lower case letters represent numerical variables and upper case letters represent categorical factors</span>
</pre></div>
</td></tr></table>

<ul>
<li>Monte-Carlo simulations are available for all tests. Exact tests are available for 2 group procedures.</li>
<li>These tests do not assume random sampling from well-defined populations. They can be a reasonable alternative to     classical procedures when test assumptions can not be met.</li>
</ul>
<!-- -->

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># one-way permutation test based on 9999 Monte-Carlo</span>
<span class="c1"># resamplings</span>
<span class="c1"># y is numeric and A is a categorical factor</span>
<span class="nf">library</span><span class="p">(</span><span class="n">coin</span><span class="p">)</span>

<span class="nf">oneway_test</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="nf">factor</span><span class="p">(</span><span class="n">am</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">,</span> <span class="n">distribution</span> <span class="o">=</span> <span class="nf">approximate</span><span class="p">(</span><span class="n">B</span> <span class="o">=</span> <span class="m">9999</span><span class="p">))</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">Approximative</span> <span class="n">Two</span><span class="o">-</span><span class="n">Sample</span> <span class="n">Fisher</span><span class="o">-</span><span class="n">Pitman</span> <span class="n">Permutation</span> <span class="n">Test</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="n">mpg</span> <span class="k">by</span> <span class="n">factor</span><span class="p">(</span><span class="n">am</span><span class="p">)</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="o">##</span> <span class="n">Z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">=</span> <span class="mi">5</span><span class="n">e</span><span class="o">-</span><span class="mi">04</span>
<span class="o">##</span> <span class="n">alternative</span> <span class="n">hypothesis</span><span class="p">:</span> <span class="k">true</span> <span class="n">mu</span> <span class="k">is</span> <span class="k">not</span> <span class="n">equal</span> <span class="k">to</span> <span class="mi">0</span>
</pre></div>
</td></tr></table>

<h3 id="symmetry-of-a-response-for-repeated-measurements">Symmetry of a response for repeated measurements<a class="headerlink" href="#symmetry-of-a-response-for-repeated-measurements" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># exact Wilcoxon signed rank test</span>
<span class="c1"># where y1 and y2 are repeated measures</span>
<span class="nf">library</span><span class="p">(</span><span class="n">coin</span><span class="p">)</span>

<span class="nf">wilcoxsign_test</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="nf">factor</span><span class="p">(</span><span class="n">am</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">,</span> <span class="n">distribution</span> <span class="o">=</span> <span class="s">&quot;exact&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">Exact</span> <span class="n">Wilcoxon</span><span class="o">-</span><span class="n">Pratt</span> <span class="n">Signed</span><span class="o">-</span><span class="n">Rank</span> <span class="n">Test</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="n">y</span> <span class="k">by</span> <span class="n">x</span> <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">neg</span><span class="p">)</span> 
<span class="o">##</span>   <span class="n">stratified</span> <span class="k">by</span> <span class="n">block</span>
<span class="o">##</span> <span class="n">Z</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">=</span> <span class="mi">5</span><span class="n">e</span><span class="o">-</span><span class="mi">10</span>
<span class="o">##</span> <span class="n">alternative</span> <span class="n">hypothesis</span><span class="p">:</span> <span class="k">true</span> <span class="n">mu</span> <span class="k">is</span> <span class="k">not</span> <span class="n">equal</span> <span class="k">to</span> <span class="mi">0</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Freidman Test based on 9999 Monte-Carlo resamplings.</span>
<span class="c1"># y is numeric, A is a grouping factor, and B is a</span>
<span class="c1"># blocking factor</span>
<span class="nf">friedman_test</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">A</span> <span class="o">|</span> <span class="n">B</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mydata</span><span class="p">,</span>  <span class="n">distribution</span> <span class="o">=</span> <span class="nf">approximate</span><span class="p">(</span><span class="n">B</span> <span class="o">=</span> <span class="m">9999</span><span class="p">))</span>
</pre></div>
</td></tr></table>

<h3 id="independence-of-two-numeric-variables">Independence of two numeric variables<a class="headerlink" href="#independence-of-two-numeric-variables" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Spearman Test of independence based on 9999 Monte-Carlo</span>
<span class="c1"># resamplings. x and y are numeric variables</span>
<span class="nf">library</span><span class="p">(</span><span class="n">coin</span><span class="p">)</span>

<span class="nf">spearman_test</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="n">am</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">,</span> <span class="n">distribution</span> <span class="o">=</span> <span class="nf">approximate</span><span class="p">(</span><span class="n">B</span> <span class="o">=</span> <span class="m">9999</span><span class="p">))</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">Approximative</span> <span class="n">Spearman</span> <span class="n">Correlation</span> <span class="n">Test</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="n">mpg</span> <span class="k">by</span> <span class="n">am</span>
<span class="o">##</span> <span class="n">Z</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span>
<span class="o">##</span> <span class="n">alternative</span> <span class="n">hypothesis</span><span class="p">:</span> <span class="k">true</span> <span class="n">rho</span> <span class="k">is</span> <span class="k">not</span> <span class="n">equal</span> <span class="k">to</span> <span class="mi">0</span>
</pre></div>
</td></tr></table>

<h3 id="independence-in-contingency-tables">Independence in contingency tables<a class="headerlink" href="#independence-in-contingency-tables" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># dataset</span>
<span class="nf">head</span><span class="p">(</span><span class="n">CO2</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> <span class="n">Grouped</span> <span class="k">Data</span><span class="p">:</span> <span class="n">uptake</span> <span class="o">~</span> <span class="n">conc</span> <span class="o">|</span> <span class="n">Plant</span>
<span class="o">##</span>   <span class="n">Plant</span>   <span class="k">Type</span>  <span class="n">Treatment</span> <span class="n">conc</span> <span class="n">uptake</span>
<span class="o">##</span> <span class="mi">1</span>   <span class="n">Qn1</span> <span class="n">Quebec</span> <span class="n">nonchilled</span>   <span class="mi">95</span>   <span class="mi">16</span><span class="p">.</span><span class="mi">0</span>
<span class="o">##</span> <span class="mi">2</span>   <span class="n">Qn1</span> <span class="n">Quebec</span> <span class="n">nonchilled</span>  <span class="mi">175</span>   <span class="mi">30</span><span class="p">.</span><span class="mi">4</span>
<span class="o">##</span> <span class="mi">3</span>   <span class="n">Qn1</span> <span class="n">Quebec</span> <span class="n">nonchilled</span>  <span class="mi">250</span>   <span class="mi">34</span><span class="p">.</span><span class="mi">8</span>
<span class="o">##</span> <span class="mi">4</span>   <span class="n">Qn1</span> <span class="n">Quebec</span> <span class="n">nonchilled</span>  <span class="mi">350</span>   <span class="mi">37</span><span class="p">.</span><span class="mi">2</span>
<span class="o">##</span> <span class="mi">5</span>   <span class="n">Qn1</span> <span class="n">Quebec</span> <span class="n">nonchilled</span>  <span class="mi">500</span>   <span class="mi">35</span><span class="p">.</span><span class="mi">3</span>
<span class="o">##</span> <span class="mi">6</span>   <span class="n">Qn1</span> <span class="n">Quebec</span> <span class="n">nonchilled</span>  <span class="mi">675</span>   <span class="mi">39</span><span class="p">.</span><span class="mi">2</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">cases</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">59</span><span class="p">)</span>
<span class="n">n</span> <span class="o">&lt;-</span> <span class="nf">sum</span><span class="p">(</span><span class="n">cases</span><span class="p">)</span>
<span class="n">cochran</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span>
    <span class="n">diphtheria</span> <span class="o">=</span> <span class="nf">factor</span><span class="p">(</span>
        <span class="nf">unlist</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span>
                        <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span>
                        <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span>
                        <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span>
                        <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">)),</span>
                   <span class="n">cases</span><span class="p">))</span>
    <span class="p">),</span>
    <span class="n">media</span> <span class="o">=</span> <span class="nf">factor</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="kc">LETTERS</span><span class="n">[1</span><span class="o">:</span><span class="m">4</span><span class="n">]</span><span class="p">,</span> <span class="n">n</span><span class="p">)),</span>
    <span class="n">case</span> <span class="o">=</span>  <span class="nf">factor</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="nf">seq_len</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">each</span> <span class="o">=</span> <span class="m">4</span><span class="p">))</span>
<span class="p">)</span>

<span class="nf">head</span><span class="p">(</span><span class="n">cochran</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span>   <span class="n">diphtheria</span> <span class="n">media</span> <span class="k">case</span>
<span class="o">##</span> <span class="mi">1</span>          <span class="mi">1</span>     <span class="n">A</span>    <span class="mi">1</span>
<span class="o">##</span> <span class="mi">2</span>          <span class="mi">1</span>     <span class="n">B</span>    <span class="mi">1</span>
<span class="o">##</span> <span class="mi">3</span>          <span class="mi">1</span>     <span class="k">C</span>    <span class="mi">1</span>
<span class="o">##</span> <span class="mi">4</span>          <span class="mi">1</span>     <span class="n">D</span>    <span class="mi">1</span>
<span class="o">##</span> <span class="mi">5</span>          <span class="mi">1</span>     <span class="n">A</span>    <span class="mi">2</span>
<span class="o">##</span> <span class="mi">6</span>          <span class="mi">1</span>     <span class="n">B</span>    <span class="mi">2</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># independence in 2-way contingency table based on</span>
<span class="c1"># 9999 Monte-Carlo resamplings. A and B are factors</span>
<span class="nf">library</span><span class="p">(</span><span class="n">coin</span><span class="p">)</span>

<span class="nf">chisq_test</span><span class="p">(</span><span class="n">Plant</span> <span class="o">~</span> <span class="n">Type</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">,</span> <span class="n">distribution</span> <span class="o">=</span> <span class="nf">approximate</span><span class="p">(</span><span class="n">B</span> <span class="o">=</span> <span class="m">9999</span><span class="p">))</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">Approximative</span> <span class="n">Linear</span><span class="o">-</span><span class="k">by</span><span class="o">-</span><span class="n">Linear</span> <span class="n">Association</span> <span class="n">Test</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="n">Plant</span> <span class="p">(</span><span class="n">ordered</span><span class="p">)</span> <span class="k">by</span> <span class="k">Type</span> <span class="p">(</span><span class="n">Quebec</span><span class="p">,</span> <span class="n">Mississippi</span><span class="p">)</span>
<span class="o">##</span> <span class="n">Z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">&lt;</span><span class="mi">2</span><span class="n">e</span><span class="o">-</span><span class="mi">16</span>
<span class="o">##</span> <span class="n">alternative</span> <span class="n">hypothesis</span><span class="p">:</span> <span class="n">two</span><span class="p">.</span><span class="n">sided</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Cochran-Mantel-Haenzsel Test of 3-way Contingency Table</span>
<span class="c1"># based on 9999 Monte-Carlo resamplings. A, B, are factors</span>
<span class="c1"># and C is a stratefying factor</span>
<span class="nf">mh_test</span><span class="p">(</span><span class="n">diphtheria</span> <span class="o">~</span> <span class="n">media</span> <span class="o">|</span> <span class="n">case</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">cochran</span><span class="p">,</span> <span class="n">distribution</span> <span class="o">=</span> <span class="nf">approximate</span><span class="p">(</span><span class="n">B</span> <span class="o">=</span> <span class="m">9999</span><span class="p">))</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">Approximative</span> <span class="n">Marginal</span> <span class="n">Homogeneity</span> <span class="n">Test</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="n">diphtheria</span> <span class="k">by</span>
<span class="o">##</span>   <span class="n">media</span> <span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="k">C</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span> 
<span class="o">##</span>   <span class="n">stratified</span> <span class="k">by</span> <span class="k">case</span>
<span class="o">##</span> <span class="n">chi</span><span class="o">-</span><span class="n">squared</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># linear by linear association test based on 9999</span>
<span class="c1"># Monte-Carlo resamplings</span>
<span class="c1"># A and B are ordered factors</span>
<span class="nf">library</span><span class="p">(</span><span class="n">coin</span><span class="p">)</span>

<span class="nf">lbl_test</span><span class="p">(</span><span class="n">Plant</span> <span class="o">~</span> <span class="n">Type</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">,</span> <span class="n">distribution</span> <span class="o">=</span> <span class="nf">approximate</span><span class="p">(</span><span class="n">B</span> <span class="o">=</span> <span class="m">9999</span><span class="p">))</span> 
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">##</span> 
<span class="o">##</span>  <span class="n">Approximative</span> <span class="n">Linear</span><span class="o">-</span><span class="k">by</span><span class="o">-</span><span class="n">Linear</span> <span class="n">Association</span> <span class="n">Test</span>
<span class="o">##</span> 
<span class="o">##</span> <span class="k">data</span><span class="p">:</span>  <span class="n">Plant</span> <span class="p">(</span><span class="n">ordered</span><span class="p">)</span> <span class="k">by</span> <span class="k">Type</span> <span class="p">(</span><span class="n">Quebec</span><span class="p">,</span> <span class="n">Mississippi</span><span class="p">)</span>
<span class="o">##</span> <span class="n">Z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">&lt;</span><span class="mi">2</span><span class="n">e</span><span class="o">-</span><span class="mi">16</span>
<span class="o">##</span> <span class="n">alternative</span> <span class="n">hypothesis</span><span class="p">:</span> <span class="n">two</span><span class="p">.</span><span class="n">sided</span>
</pre></div>
</td></tr></table>

<p>Many other univariate and multivariate tests are possible using the functions in the <code class="codehilite"><span class="n">coin</span></code> package.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../a_hands-on_introduction_to_statistics_with_r_course_seven_moderation_and_mediation/" title="Statistics with R, Course Seven, Moderation and Mediation" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Statistics with R, Course Seven, Moderation and Mediation
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c648116f.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>