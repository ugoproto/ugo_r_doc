
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A R documentation website.">
      
      
      
      
      <link rel="icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.0">
    
    
      
        <title>Statistics with R, Course Four, Repeated Measures ANOVA - ugo_r_doc</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8b42a75e.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#2094f3">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700%7CUbuntu+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Ubuntu";--md-code-font-family:"Ubuntu Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../extra.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue" data-md-color-accent="red">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#an-introduction-to-repeated-measures" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ugo_r_doc" class="md-header__button md-logo" aria-label="ugo_r_doc" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 16 7.36-5.73L21 9l-9-7-9 7 1.63 1.27M12 18.54l-7.38-5.73L3 14.07l9 7 9-7-1.63-1.27L12 18.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ugo_r_doc
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Statistics with R, Course Four, Repeated Measures ANOVA
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/ugoproto/ugo_r_doc.git/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ugo_r_doc
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ugo_r_doc" class="md-nav__button md-logo" aria-label="ugo_r_doc" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 16 7.36-5.73L21 9l-9-7-9 7 1.63 1.27M12 18.54l-7.38-5.73L3 14.07l9 7 9-7-1.63-1.27L12 18.54z"/></svg>

    </a>
    ugo_r_doc
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/ugoproto/ugo_r_doc.git/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ugo_r_doc
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Cheat Sheets
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cheat Sheets" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Cheat Sheets
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../basics_cs/" class="md-nav__link">
        Basics Cheat Sheets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../specializations_cs/" class="md-nav__link">
        Specialization Cheat Sheets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../visualization_cs/" class="md-nav__link">
        Visualization Cheat Sheets
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Code and Vade Mecum
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Code and Vade Mecum" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Code and Vade Mecum
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../frequentist_bayesian/" class="md-nav__link">
        Frequentist vs. Bayesian
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../intermediate_r/" class="md-nav__link">
        Intermediate R
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../intermediate_r_the_apply_family/" class="md-nav__link">
        Intermediate R - The apply Family
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Data Wrangling Snippets
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data Wrangling Snippets" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Data Wrangling Snippets
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../io_snippets_cleaning/" class="md-nav__link">
        I/O Snippets & Cleaning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reading_data_into_r_with_readr/" class="md-nav__link">
        Reading Data into R with readr
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data_analysis_in_r_the_data_table_way/" class="md-nav__link">
        Data Analysis in R, the data.table Way
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data_manipulation_in_r_with_dplyr/" class="md-nav__link">
        Data Manipulation in R with dplyr
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data_wrangling/" class="md-nav__link">
        Data Wrangling
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Packages
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Packages" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Packages
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../googlevis/" class="md-nav__link">
        googleVis (embed HTML plots)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gganimate/" class="md-nav__link">
        gganimate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../fast_and_frugal_decision_trees_in_r_with_fftrees/" class="md-nav__link">
        Fast-and-Frugal Decision Trees
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../big_data_analysis_with_revolution_r_enterprise/" class="md-nav__link">
        Big Data Analysis with Revolution R Enterprise
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../time_series_in_r_the_power_of_xts_and_zoo/" class="md-nav__link">
        Time Series in R, The Power of xts and zoo
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Plot Snippets
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Plot Snippets" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Plot Snippets
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plot_snippets_basics/" class="md-nav__link">
        Plot Snippets for Exploratory (and some Explanatory) Analyses
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plot_snippets_ggplot2/" class="md-nav__link">
        Plot Snippets - ggplot2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plot_snippets_ggvis/" class="md-nav__link">
        Plot Snippets - ggvis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plot_snippets_colours/" class="md-nav__link">
        Plot Snippets - Colours
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          RStudio
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="RStudio" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          RStudio
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../working_with_rstudio_ide/" class="md-nav__link">
        Working with the RStudio IDE
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Tables and Figures
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tables and Figures" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Tables and Figures
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tables/" class="md-nav__link">
        Tables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../embedding/" class="md-nav__link">
        Embedding HTML into HTML
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../embedding_2/" class="md-nav__link">
        Embedding Rmd into Rmd
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          A Hands-on Introduction to Statistics with R
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="A Hands-on Introduction to Statistics with R" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          A Hands-on Introduction to Statistics with R
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../a_hands-on_introduction_to_statistics_with_r_course_one_introduction/" class="md-nav__link">
        Statistics with R, Course One, Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../a_hands-on_introduction_to_statistics_with_r_course_two_student_s_t-test/" class="md-nav__link">
        Statistics with R, Course Two, Student's t-test
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../a_hands-on_introduction_to_statistics_with_r_course_three_analysis_of_variance/" class="md-nav__link">
        Statistics with R, Course Three, Analysis of Variance
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Statistics with R, Course Four, Repeated Measures ANOVA
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Statistics with R, Course Four, Repeated Measures ANOVA
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#an-introduction-to-repeated-measures" class="md-nav__link">
    An introduction to repeated measures
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#repeated-measures-anova" class="md-nav__link">
    Repeated measures ANOVA
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../a_hands-on_introduction_to_statistics_with_r_course_five_correlation_and_regression/" class="md-nav__link">
        Statistics with R, Course Five, Correlation and Regression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../a_hands-on_introduction_to_statistics_with_r_course_six_multiple_regression/" class="md-nav__link">
        Statistics with R, Course Six, Multiple Regression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../a_hands-on_introduction_to_statistics_with_r_course_seven_moderation_and_mediation/" class="md-nav__link">
        Statistics with R, Course Seven, Moderation and Mediation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../a_hands-on_introduction_to_statistics_with_r_notes/" class="md-nav__link">
        Statistics with R, Notes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#an-introduction-to-repeated-measures" class="md-nav__link">
    An introduction to repeated measures
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#repeated-measures-anova" class="md-nav__link">
    Repeated measures ANOVA
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ugoproto/ugo_r_doc.git/edit/master/docs/a_hands-on_introduction_to_statistics_with_r_course_four_repeated_measures_anova.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>Statistics with R, Course Four, Repeated Measures ANOVA</h1>
                
                <!--
-   [1, An introduction to repeated measures](#an-introduction-to-repeated-measures)
-   [2, Repeated measures ANOVA](#repeated-measures-anova)
-->
<hr />
<p><strong>Foreword</strong></p>
<ul>
<li>Output options: the &lsquo;tango&rsquo; syntax and the &lsquo;readable&rsquo; theme.</li>
<li>Snippets and results.</li>
</ul>
<hr />
<h2 id="an-introduction-to-repeated-measures">An introduction to repeated measures<a class="headerlink" href="#an-introduction-to-repeated-measures" title="Permanent link">&para;</a></h2>
<p>The independent t-test is analogous to between-groups ANOVA and the paired-sample t-test is analogous to repeated measures ANOVA.</p>
<p>In a between-groups design, each subject is exposed to two or more treatments or conditions over time. In a within-subjects design, each subject is allocated to exactly one treatment or condition.</p>
<p>Between:</p>
<ul>
<li>Experiment 1: You want to test the effect of alcohol on test scores of students. There are three conditions: the student consumed no alcohol, two glasses of beer, or five glasses of beer. Alcohol tolerance and time spent studying should also be considered somehow.</li>
<li>Experiment 2: You want to investigate the effects of certain fertilizers on plant growth. Assume you have two different<br />
    fertilizers, A and B. Consider three conditions: you give the plant no fertilizer, fertilizer A, or fertilizer B. You measure the height of the plant after a specific period of time to see whether the fertilizers had an effect.</li>
</ul>
<p>Use a within-subjects design for for Experiment 1 and between-groups design for Experiment 2.</p>
<p>Is it always either manipulation between-groups or manipulation within-groups, or are there experiments where you could use either approach? In some cases, either approach is possible.</p>
<p><strong>Explore the working memory data</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Print the data set in the console</span>
<span class="nf">str</span><span class="p">(</span><span class="n">wm</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## &#39;data.frame&#39;:    80 obs. of  3 variables:</span>
<span class="c1">##  $ subject  : num  1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="c1">##  $ condition: Factor w/ 4 levels &quot;12 days&quot;,&quot;17 days&quot;,..: 4 4 4 4 4 4 4 4 4 4 ...</span>
<span class="c1">##  $ iq       : num  12.4 11.8 14.6 7.7 15.7 11.6 7 8.4 10.7 10.6 ...</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">psych</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="c1"># Define the variable subject as a categorical variable</span>
<span class="n">wm</span><span class="o">$</span><span class="n">subject</span> <span class="o">&lt;-</span> <span class="nf">factor</span><span class="p">(</span><span class="n">wm</span><span class="o">$</span><span class="n">subject</span><span class="p">)</span>

<span class="c1"># Summary statistics by all groups (8 sessions, 12 sessions, 17 sessions, 19 sessions)</span>
<span class="nf">describeBy</span><span class="p">(</span><span class="n">wm</span><span class="p">,</span> <span class="n">wm</span><span class="o">$</span><span class="n">condition</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">## </span>
<span class="c1">##  Descriptive statistics by group </span>
<span class="c1">## group: 12 days</span>
<span class="c1">##            vars  n mean   sd median trimmed  mad min  max range skew</span>
<span class="c1">## subject*      1 20 10.5 5.92  10.50   10.50 7.41 1.0 20.0  19.0 0.00</span>
<span class="c1">## condition*    2 20  1.0 0.00   1.00    1.00 0.00 1.0  1.0   0.0  NaN</span>
<span class="c1">## iq            3 20 11.7 2.58  11.65   11.69 2.89 6.9 16.1   9.2 0.05</span>
<span class="c1">##            kurtosis   se</span>
<span class="c1">## subject*      -1.38 1.32</span>
<span class="c1">## condition*      NaN 0.00</span>
<span class="c1">## iq            -1.06 0.58</span>
<span class="c1">## -------------------------------------------------------- </span>
<span class="c1">## group: 17 days</span>
<span class="c1">##            vars  n mean   sd median trimmed  mad min  max range skew</span>
<span class="c1">## subject*      1 20 10.5 5.92   10.5    10.5 7.41 1.0 20.0  19.0 0.00</span>
<span class="c1">## condition*    2 20  2.0 0.00    2.0     2.0 0.00 2.0  2.0   0.0  NaN</span>
<span class="c1">## iq            3 20 13.9 2.26   13.6    13.9 2.00 9.8 18.1   8.3 0.11</span>
<span class="c1">##            kurtosis   se</span>
<span class="c1">## subject*      -1.38 1.32</span>
<span class="c1">## condition*      NaN 0.00</span>
<span class="c1">## iq            -0.85 0.50</span>
<span class="c1">## -------------------------------------------------------- </span>
<span class="c1">## group: 19 days</span>
<span class="c1">##            vars  n  mean   sd median trimmed  mad  min  max range  skew</span>
<span class="c1">## subject*      1 20 10.50 5.92   10.5   10.50 7.41  1.0 20.0  19.0  0.00</span>
<span class="c1">## condition*    2 20  3.00 0.00    3.0    3.00 0.00  3.0  3.0   0.0   NaN</span>
<span class="c1">## iq            3 20 14.75 2.50   15.3   14.71 2.15 10.4 19.2   8.8 -0.09</span>
<span class="c1">##            kurtosis   se</span>
<span class="c1">## subject*      -1.38 1.32</span>
<span class="c1">## condition*      NaN 0.00</span>
<span class="c1">## iq            -0.99 0.56</span>
<span class="c1">## -------------------------------------------------------- </span>
<span class="c1">## group: 8 days</span>
<span class="c1">##            vars  n  mean   sd median trimmed  mad min  max range  skew</span>
<span class="c1">## subject*      1 20 10.50 5.92   10.5   10.50 7.41 1.0 20.0  19.0  0.00</span>
<span class="c1">## condition*    2 20  4.00 0.00    4.0    4.00 0.00 4.0  4.0   0.0   NaN</span>
<span class="c1">## iq            3 20 10.91 2.63   11.3   10.97 2.67 5.4 15.7  10.3 -0.21</span>
<span class="c1">##            kurtosis   se</span>
<span class="c1">## subject*      -1.38 1.32</span>
<span class="c1">## condition*      NaN 0.00</span>
<span class="c1">## iq            -0.70 0.59</span>
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># Boxplot IQ versus condition</span>
<span class="nf">boxplot</span><span class="p">(</span><span class="n">wm</span><span class="o">$</span><span class="n">iq</span> <span class="o">~</span> <span class="n">wm</span><span class="o">$</span><span class="n">condition</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&#39;Boxplot&#39;</span><span class="p">,</span> <span class="n">xlab</span> <span class="o">=</span> <span class="s">&#39;Training sessions&#39;</span><span class="p">,</span> <span class="n">ylab</span> <span class="o">=</span> <span class="s">&#39;IQ&#39;</span><span class="p">)</span>
</code></pre></div>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Course_Four%2C_Repeated_Measures_Anova/unnamed-chunk-3-1.png" /></center></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Illustration data, each line represents the development of each subject by number of trainings</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">wm</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">wm</span><span class="o">$</span><span class="n">condition</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">wm</span><span class="o">$</span><span class="n">iq</span><span class="p">,</span> <span class="n">group</span> <span class="o">=</span> <span class="n">wm</span><span class="o">$</span><span class="n">subject</span><span class="p">,</span> <span class="n">colour</span> <span class="o">=</span> <span class="n">wm</span><span class="o">$</span><span class="n">subject</span><span class="p">))</span> <span class="o">+</span> <span class="nf">geom_line</span><span class="p">()</span> <span class="o">+</span> <span class="nf">geom_point</span><span class="p">()</span>
</code></pre></div>
<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R%2C_Course_Four%2C_Repeated_Measures_Anova/unnamed-chunk-3-2.png" /></center></p>
<p><strong>Reduced cost</strong></p>
<p>The cost advantage of using manipulation within groups verses manipulation between groups for the working memory experiment is you need 60 subjects fewer.</p>
<p><strong>Statistically more powerful</strong></p>
<p>Repeated measures analysis accounts for individual differences across the experiment. This reduces the error term, which  increases statistical power.</p>
<p><strong>Counterbalancing</strong></p>
<p>Suppose you have three levels of an independent variable A (i.e. A1, A2, A3) and a blocked design. You want to use full counterbalancing to take into account order effects.</p>
<p>What are all the possible orders that you need to use? In other words, what are the order conditions?</p>
<p>(A1, A2, A3), (A1, A3, A2) , (A2, A1, A3), (A2, A3, A1) , (A3, A2, A1),<br />
(A3, A1, A2)</p>
<p><strong>Number of order conditions?</strong></p>
<p>Assume the number of levels of the independent variable goes up and you want to completely counterbalance. What will happen to the number of order conditions you&rsquo;ll need?</p>
<p>The number becomes really large. An independent variable with n levels will have <code>n!=n*(n???1)*(n???2)*...</code> order conditions.</p>
<p><strong>Latin Squares design</strong></p>
<p>As you hopefully realized in the previous exercise, completely counterbalancing is not always a practical solution for taking into account order effects. This is because the number of different orders required gets really large as the number of possible conditions increases.</p>
<p>The most common workaround to this problem is the Latin Squares design, in which you do not completely counterbalance, but instead put each condition at every position (at least) once.</p>
<p>Which of the following examples has been constructed according to the Latin Squares design?</p>
<p>(A1, A2, A3), (A2, A3, A1), (A3, A1, A2)</p>
<p><strong>More on Latin Squares</strong></p>
<p>The number of order conditions is always equal to the number of levels of your independent variable.</p>
<p><strong>Why is missing data a problem?</strong></p>
<p>In a between-groups design, it is okay to have a slightly different number of subjects in each group, so if one subject drops out in one of the conditions then that group has just one less subject. Now you want to look at how subjects change over time and the different scores between two or more conditions for each subject.</p>
<p><strong>Understanding sphericity</strong></p>
<p>The variances of the differences between all possible pairs of groups (i.e. levels of the independent variable) are equal.</p>
<p><strong>Mauchly&rsquo;s test</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Define iq as a data frame where each column represents a condition</span>
<span class="n">iq</span> <span class="o">&lt;-</span> <span class="nf">cbind</span><span class="p">(</span><span class="n">wm</span><span class="o">$</span><span class="n">iq</span><span class="p">[</span><span class="n">wm</span><span class="o">$</span><span class="n">condition</span> <span class="o">==</span> <span class="s">&#39;8 days&#39;</span><span class="p">],</span> <span class="n">wm</span><span class="o">$</span><span class="n">iq</span><span class="p">[</span><span class="n">wm</span><span class="o">$</span><span class="n">condition</span> <span class="o">==</span> <span class="s">&#39;12 days&#39;</span><span class="p">],</span> <span class="n">wm</span><span class="o">$</span><span class="n">iq</span><span class="p">[</span><span class="n">wm</span><span class="o">$</span><span class="n">condition</span> <span class="o">==</span> <span class="s">&#39;17 days&#39;</span><span class="p">],</span> <span class="n">wm</span><span class="o">$</span><span class="n">iq</span><span class="p">[</span><span class="n">wm</span><span class="o">$</span><span class="n">condition</span> <span class="o">==</span> <span class="s">&#39;19 days&#39;</span><span class="p">])</span>

<span class="c1"># Make an mlm object</span>
<span class="n">mlm</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">iq</span> <span class="o">~</span> <span class="m">1</span><span class="p">)</span>

<span class="c1"># Mauchly&#39;s test</span>
<span class="nf">mauchly.test</span><span class="p">(</span><span class="n">mlm</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="o">~</span> <span class="m">1</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  Mauchly&#39;s test of sphericity
## 
## data:  SSD matrix from lm(formula = iq ~ 1)
## W = 0.81725, p-value = 0.9407
</code></pre></div>
</td></tr></table>
<p>Based on the results, the sphericity assumption holds.</p>
<p><strong>Pros of repeated measures</strong></p>
<p>Less cost and statistically more powerful</p>
<p><strong>Cons of repeated measures</strong></p>
<p>Order effects, counterbalancing, missing data, and an extra assumption</p>
<h2 id="repeated-measures-anova">Repeated measures ANOVA<a class="headerlink" href="#repeated-measures-anova" title="Permanent link">&para;</a></h2>
<p><strong>The systematic between groups variance</strong></p>
<p>To understand everything a bit better, we will calculate the F-ratio for a repeated measures design by ourself in the next exercises.</p>
<p>First, we will need the systematic between-groups variance. This is the same as in the between-groups design&ndash;the variance due to grouping by condition.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Define number of subjects for each condition</span>
<span class="n">n</span> <span class="o">&lt;-</span> <span class="m">20</span>

<span class="c1"># Calculate group means</span>
<span class="n">y_j</span> <span class="o">&lt;-</span> <span class="nf">tapply</span><span class="p">(</span><span class="n">wm</span><span class="o">$</span><span class="n">iq</span><span class="p">,</span> <span class="n">wm</span><span class="o">$</span><span class="n">condition</span><span class="p">,</span> <span class="n">mean</span><span class="p">)</span>

<span class="c1"># Calculate the grand mean</span>
<span class="n">y_t</span> <span class="o">&lt;-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">y_j</span><span class="p">)</span>

<span class="c1"># Calculate the sum of squares</span>
<span class="n">ss_cond</span> <span class="o">&lt;-</span> <span class="nf">sum</span><span class="p">((</span><span class="n">y_j</span> <span class="o">-</span> <span class="n">y_t</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="o">*</span><span class="n">n</span>

<span class="c1"># Define the degrees of freedom for conditions</span>
<span class="n">df</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="m">4</span> <span class="o">-</span> <span class="m">1</span><span class="p">)</span>

<span class="c1"># Calculate the mean squares (variance)</span>
<span class="n">ms_cond</span> <span class="o">&lt;-</span> <span class="n">ss_cond</span><span class="o">/</span><span class="n">df</span>
</code></pre></div>
<p><strong>The subject variance</strong></p>
<p>We will also need the error term of the repeated measures design. This can be calculated in a few steps.</p>
<ul>
<li>First calculate the systematic variance due to subjects.</li>
<li>Below, we will calculate the unsystematic variance, like we did with the between-groups design.</li>
<li>If we subtract these two results, we will get the error term of the repeated measures design.</li>
</ul>
<p>The systematic (stable) subject variance will be taken out of the error term, so the error term is reduced in comparison with the between-groups design.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Define number of conditions for each subject</span>
<span class="n">n</span> <span class="o">&lt;-</span> <span class="m">4</span>

<span class="c1"># Calculate subject means</span>
<span class="n">y_j</span> <span class="o">&lt;-</span> <span class="nf">tapply</span><span class="p">(</span><span class="n">wm</span><span class="o">$</span><span class="n">iq</span><span class="p">,</span> <span class="n">wm</span><span class="o">$</span><span class="n">subject</span><span class="p">,</span> <span class="n">mean</span><span class="p">)</span>

<span class="c1"># Calculate the grand mean</span>
<span class="n">y_t</span> <span class="o">&lt;-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">y_j</span><span class="p">)</span>

<span class="c1"># Calculate the sum of squares</span>
<span class="n">ss_subjects</span> <span class="o">&lt;-</span> <span class="nf">sum</span><span class="p">((</span><span class="n">y_j</span> <span class="o">-</span> <span class="n">y_t</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="o">*</span><span class="n">n</span>

<span class="c1"># Define the degrees of freedom for subjects</span>
<span class="n">df</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="m">20</span> <span class="o">-</span> <span class="m">1</span><span class="p">)</span>

<span class="c1"># Calculate the mean squares (variance)</span>
<span class="n">ms_subjects</span> <span class="o">&lt;-</span> <span class="n">ss_subjects</span><span class="o">/</span><span class="n">df</span>
</code></pre></div>
<p><strong>The unsystematic within groups variance</strong></p>
<p>To calculate the error term of the repeated measures design, we need the unsystematic within-groups variance: the unsystematic variance or the error term of the between-groups design.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Create four subsets of the four groups, containing the IQ results</span>
    <span class="c1"># Make the subset for the group condition = &quot;8 days&quot;</span>
<span class="n">y_i1</span> <span class="o">&lt;-</span> <span class="nf">subset</span><span class="p">(</span><span class="n">wm</span><span class="o">$</span><span class="n">iq</span><span class="p">,</span> <span class="n">wm</span><span class="o">$</span><span class="n">condition</span> <span class="o">==</span> <span class="s">&quot;8 days&quot;</span><span class="p">)</span>
    <span class="c1"># Make the subset for the group condition = &quot;12 days&quot;</span>
<span class="n">y_i2</span> <span class="o">&lt;-</span> <span class="nf">subset</span><span class="p">(</span><span class="n">wm</span><span class="o">$</span><span class="n">iq</span><span class="p">,</span> <span class="n">wm</span><span class="o">$</span><span class="n">condition</span> <span class="o">==</span> <span class="s">&quot;12 days&quot;</span><span class="p">)</span>
    <span class="c1"># Make the subset for the group condition = &quot;17 days&quot;</span>
<span class="n">y_i3</span> <span class="o">&lt;-</span> <span class="nf">subset</span><span class="p">(</span><span class="n">wm</span><span class="o">$</span><span class="n">iq</span><span class="p">,</span> <span class="n">wm</span><span class="o">$</span><span class="n">condition</span> <span class="o">==</span> <span class="s">&quot;17 days&quot;</span><span class="p">)</span>
    <span class="c1"># Make the subset for the group condition = &quot;19 days&quot;</span>
<span class="n">y_i4</span> <span class="o">&lt;-</span> <span class="nf">subset</span><span class="p">(</span><span class="n">wm</span><span class="o">$</span><span class="n">iq</span><span class="p">,</span> <span class="n">wm</span><span class="o">$</span><span class="n">condition</span> <span class="o">==</span> <span class="s">&quot;19 days&quot;</span><span class="p">)</span>

<span class="c1"># Subtract the individual values by their group means</span>
<span class="n">s_1</span> <span class="o">&lt;-</span> <span class="n">y_i1</span> <span class="o">-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">y_i1</span><span class="p">)</span>
<span class="n">s_2</span> <span class="o">&lt;-</span> <span class="n">y_i2</span> <span class="o">-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">y_i2</span><span class="p">)</span>
<span class="n">s_3</span> <span class="o">&lt;-</span> <span class="n">y_i3</span> <span class="o">-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">y_i3</span><span class="p">)</span>
<span class="n">s_4</span> <span class="o">&lt;-</span> <span class="n">y_i4</span> <span class="o">-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">y_i4</span><span class="p">)</span>

<span class="c1"># Put everything back into one vector</span>
<span class="n">s_t</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">s_1</span><span class="p">,</span> <span class="n">s_2</span><span class="p">,</span> <span class="n">s_3</span><span class="p">,</span> <span class="n">s_4</span><span class="p">)</span>

<span class="c1"># Calculate the within sum of squares by using the vector s_t</span>
<span class="n">ss_sa</span> <span class="o">&lt;-</span> <span class="nf">sum</span><span class="p">(</span><span class="n">s_t</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>

<span class="c1"># Define the degrees of freedom</span>
<span class="n">df</span> <span class="o">&lt;-</span> <span class="m">4</span><span class="o">*</span><span class="p">(</span><span class="m">20-1</span><span class="p">)</span>

<span class="c1"># Calculate the mean squares (variances)</span>
<span class="n">ms_sa</span> <span class="o">&lt;-</span> <span class="n">ss_sa</span><span class="o">/</span><span class="n">df</span>
</code></pre></div>
<p><strong>The unsystematic variance for the repeated measures design</strong></p>
<p>Now we can easily calculate the unsystematic variance for the repeated measures design, also called the error term.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ss_sa = ss_subjects + ss_rm</span>
<span class="n">ss_rm</span> <span class="o">&lt;-</span> <span class="n">ss_sa</span> <span class="o">-</span> <span class="n">ss_subjects</span>

<span class="c1"># Define the degrees of freedom</span>
<span class="n">df</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="m">20</span> <span class="o">-</span> <span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="m">4</span> <span class="o">-</span> <span class="m">1</span><span class="p">)</span>

<span class="c1"># Calculate the mean squares (variances)</span>
<span class="n">ms_rm</span> <span class="o">&lt;-</span> <span class="n">ss_rm</span><span class="o">/</span><span class="n">df</span>
</code></pre></div>
<p>Now we&rsquo;ve calculated the error term of the repeated measures design, which is clearly smaller than the error term of the between-groups design because you reduced this one. To complete you can now calculate the F-ratio and the corresponding p-value.</p>
<p><strong>F-ratio and p-value</strong></p>
<p>To do the ANOVA analysis we actually need the F-ratio and the corresponding p-value.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Calculate the F-ratio</span>
<span class="n">f_rat</span> <span class="o">&lt;-</span> <span class="n">ms_cond</span><span class="o">/</span><span class="n">ms_rm</span>

<span class="c1"># Define the degrees of freedom of the F-distribution</span>
<span class="c1"># df1 for freedom of conditions (ss_cond)</span>
<span class="c1"># df2 for (freedom of) conditions and subjects (sa_sa)</span>
<span class="n">df1</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="m">4</span> <span class="o">-</span> <span class="m">1</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="m">4</span> <span class="o">-</span> <span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="m">20</span> <span class="o">-</span> <span class="m">1</span><span class="p">)</span>

<span class="c1"># Calculate the p-value</span>
<span class="n">p</span> <span class="o">&lt;-</span> <span class="m">1</span> <span class="o">-</span> <span class="nf">pf</span><span class="p">(</span><span class="n">f_rat</span><span class="p">,</span> <span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">)</span>
</code></pre></div>
<p><strong>Error term in a repeated measures design?</strong></p>
<p>The inconsistent individual differences across conditions, the effect of subjects that differ across conditions. So it is an interaction between subjects and condition.</p>
<p><strong>Anova in R</strong></p>
<p>ANOVA in R is usually done with the <code>aov</code> function.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># anova model</span>
<span class="n">model</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">wm</span><span class="o">$</span><span class="n">iq</span> <span class="o">~</span> <span class="n">wm</span><span class="o">$</span><span class="n">condition</span> <span class="o">+</span> <span class="nf">Error</span><span class="p">(</span><span class="n">wm</span><span class="o">$</span><span class="n">subject</span> <span class="o">/</span> <span class="n">wm</span><span class="o">$</span><span class="n">condition</span><span class="p">))</span>

<span class="c1"># summary model</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
## Error: wm$subject
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## Residuals 19  175.6   9.242               
## 
## Error: wm$subject:wm$condition
##              Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## wm$condition  3  196.1   65.36   12.51 2.16e-06 ***
## Residuals    57  297.8    5.22                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre></div>
</td></tr></table>
<p>The F-ratio is significant. Therefore, the number of training days does affect the IQ scores.</p>
<p><strong>Effect size</strong></p>
<p>Calculate eta-squared, which helps you estimate effect size.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Define the total sum of squares</span>

<span class="c1"># ss_cond (syst. between groups or of the effect), </span>
<span class="c1"># ss_sa (unsyst. within groups) =</span>
<span class="c1"># ss_rm (unsyst. for repeated measures design) + # ss_subjects (ok)</span>
<span class="n">ss_total</span> <span class="o">&lt;-</span> <span class="n">ss_cond</span> <span class="o">+</span> <span class="n">ss_rm</span>

<span class="c1"># Calculate the effect size</span>
<span class="n">eta_sq</span> <span class="o">&lt;-</span> <span class="n">ss_cond</span> <span class="o">/</span> <span class="n">ss_total</span>
</code></pre></div>
<p><strong>Post-hoc test one</strong></p>
<p>We will now look at a few different procedures for the post-hoc test. Let&rsquo;s start with the Holm procedure.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Post-hoc test: default procedure</span>
<span class="nf">with</span><span class="p">(</span><span class="n">wm</span><span class="p">,</span> <span class="nf">pairwise.t.test</span><span class="p">(</span><span class="n">iq</span><span class="p">,</span> <span class="n">condition</span><span class="p">,</span> <span class="n">paired</span> <span class="o">=</span> <span class="bp">T</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  Pairwise comparisons using paired t tests 
## 
## data:  iq and condition 
## 
##         12 days 17 days 19 days
## 17 days 0.01955 -       -      
## 19 days 0.00270 0.40038 -      
## 8 days  0.40038 0.00244 0.00054
## 
## P value adjustment method: holm
</code></pre></div>
</td></tr></table>
<p>We get a table with some values as the output for the post-hoc test and a line saying that we have used the Holm procedure. What are the values in the table of the output? p-values.</p>
<p>Recall that the hypotheses are tested at a 5% significance level.</p>
<p>We can conclude that all pairwise comparisons are significant, except for the comparison between 19 and 17 and the comparison between 12 and 8.</p>
<p><strong>Post-hoc test: Bonferroni</strong></p>
<p>Now we&rsquo;ll take a look at the most conservative procedure, Bonferroni. This procedure will apply the most extreme adjustments to the p-values.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Post-hoc test: Bonferroni procedure</span>
<span class="nf">with</span><span class="p">(</span><span class="n">wm</span><span class="p">,</span> <span class="nf">pairwise.t.test</span><span class="p">(</span><span class="n">iq</span><span class="p">,</span> <span class="n">condition</span><span class="p">,</span> <span class="n">paired</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="n">p.adjust.method</span> <span class="o">=</span> <span class="s">&#39;bonferroni&#39;</span><span class="p">))</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  Pairwise comparisons using paired t tests 
## 
## data:  iq and condition 
## 
##         12 days 17 days 19 days
## 17 days 0.03910 -       -      
## 19 days 0.00405 1.00000 -      
## 8 days  1.00000 0.00293 0.00054
## 
## P value adjustment method: bonferroni
</code></pre></div>
</td></tr></table>
<p>Notice the change in p-values in comparison with the previous procedure.</p>
<p><strong>Paired t-test</strong></p>
<p>Assume that you do not know how to perform an analysis of variance (ANOVA), we may do a number of paired t-tests instead.</p>
<p>Have a look at just one paired t-test and take, for example, the comparison between 12 days and 17 days.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Define two subsets containing the IQ scores for the condition group &#39;12 days&#39; and &#39;17 days&#39;</span>
<span class="n">cond_12days</span> <span class="o">&lt;-</span> <span class="nf">subset</span><span class="p">(</span><span class="n">wm</span><span class="p">,</span> <span class="n">condition</span> <span class="o">==</span> <span class="s">&#39;12 days&#39;</span><span class="p">)</span><span class="o">$</span><span class="n">iq</span>
<span class="n">cond_17days</span> <span class="o">&lt;-</span> <span class="nf">subset</span><span class="p">(</span><span class="n">wm</span><span class="p">,</span> <span class="n">condition</span> <span class="o">==</span> <span class="s">&#39;17 days&#39;</span><span class="p">)</span><span class="o">$</span><span class="n">iq</span>
<span class="n">cond_12days</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>##  [1] 12.5 11.6  8.9  8.3 10.9 13.4 12.3  8.7  9.7  9.7  6.9 10.5 11.6 13.8
## [15] 15.6 11.7 16.1 11.7 15.0 15.1
</code></pre></div>
</td></tr></table>
<div class="highlight"><pre><span></span><code><span class="c1"># t-test</span>
<span class="nf">t.test</span><span class="p">(</span><span class="n">cond_12days</span><span class="p">,</span> <span class="n">cond_17days</span><span class="p">,</span> <span class="n">paired</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</code></pre></div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>## 
##  Paired t-test
## 
## data:  cond_12days and cond_17days
## t = -3.0549, df = 19, p-value = 0.006517
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -3.7157116 -0.6942884
## sample estimates:
## mean of the differences 
##                  -2.205
</code></pre></div>
</td></tr></table>
<p>It is clear that we can apply different procedures for post-hoc tests. These procedures differ with respect to how they handle inflation of the possibility of a type I error and will therefore give us different p-values. However, these p-values will always be in a certain range.</p>
<p>What is the (smallest) range of p-values for the comparison between 12 days and 17 days? Look at the results from applying the Bonferroni procedure as well as the paired t-test.</p>
<p>p-values:</p>
<ul>
<li>Bonferroni 12 days-17 days: 0.03910</li>
<li>Paired t-test (cond_12days, cond_17days): 0.006517</li>
</ul>
<p>Therefore: [0.0065, 0.0391].</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../a_hands-on_introduction_to_statistics_with_r_course_three_analysis_of_variance/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Statistics with R, Course Three, Analysis of Variance" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Statistics with R, Course Three, Analysis of Variance
            </div>
          </div>
        </a>
      
      
        
        <a href="../a_hands-on_introduction_to_statistics_with_r_course_five_correlation_and_regression/" class="md-footer__link md-footer__link--next" aria-label="Next: Statistics with R, Course Five, Correlation and Regression" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Statistics with R, Course Five, Correlation and Regression
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.f8263e09.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.4fc53ad4.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>