



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="A R documentation website.">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.2.0">
    
    
      
        <title>Statistics with R, Course Four, Repeated Measures ANOVA - ugo_r_doc</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.572ca0f0.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
      <script src="../assets/javascripts/modernizr.8c900955.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../extra.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#an-introduction-to-repeated-measures" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="ugo_r_doc" class="md-header-nav__button md-logo">
          
            <i class="md-icon">layers</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                ugo_r_doc
              </span>
              <span class="md-header-nav__topic">
                Statistics with R, Course Four, Repeated Measures ANOVA
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/ugoproto/ugo_r_doc.git/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      ugo_r_doc
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="ugo_r_doc" class="md-nav__button md-logo">
      
        <i class="md-icon">layers</i>
      
    </a>
    ugo_r_doc
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/ugoproto/ugo_r_doc.git/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      ugo_r_doc
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Cheat Sheets
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Cheat Sheets
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basics_cs/" title="Basics Cheat Sheets" class="md-nav__link">
      Basics Cheat Sheets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../specializations_cs/" title="Specializations Cheat Sheets" class="md-nav__link">
      Specializations Cheat Sheets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../visualization_cs/" title="Visualization Cheat Sheets" class="md-nav__link">
      Visualization Cheat Sheets
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Code and Vade Mecum
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Code and Vade Mecum
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../frequentist_bayesian/" title="Frequentist vs. Bayesian" class="md-nav__link">
      Frequentist vs. Bayesian
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../intermediate_r/" title="Intermediate R" class="md-nav__link">
      Intermediate R
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../intermediate_r_the_apply_family/" title="Intermediate R - The apply Family" class="md-nav__link">
      Intermediate R - The apply Family
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Data Wrangling Snippets
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Data Wrangling Snippets
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../io_snippets_cleaning/" title="I/O Snippets & Cleaning" class="md-nav__link">
      I/O Snippets & Cleaning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../reading_data_into_r_with_readr/" title="Reading Data into R with readr" class="md-nav__link">
      Reading Data into R with readr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data_analysis_in_r_the_data_table_way/" title="Data Analysis in R, the data.table Way" class="md-nav__link">
      Data Analysis in R, the data.table Way
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data_manipulation_in_r_with_dplyr/" title="Data Manipulation in R with dplyr" class="md-nav__link">
      Data Manipulation in R with dplyr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data_wrangling/" title="Data Wrangling" class="md-nav__link">
      Data Wrangling
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Packages
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Packages
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../googlevis/" title="googleVis (embed HTML plots)" class="md-nav__link">
      googleVis (embed HTML plots)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gganimate/" title="gganimate" class="md-nav__link">
      gganimate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fast_and_frugal_decision_trees_in_r_with_fftrees/" title="Fast-and-Frugal Decision Trees" class="md-nav__link">
      Fast-and-Frugal Decision Trees
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../big_data_analysis_with_revolution_r_enterprise/" title="Big Data Analysis with Revolution R Enterprise" class="md-nav__link">
      Big Data Analysis with Revolution R Enterprise
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../time_series_in_r_the_power_of_xts_and_zoo/" title="Time Series in R, The Power of xts and zoo" class="md-nav__link">
      Time Series in R, The Power of xts and zoo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Plot Snippets
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Plot Snippets
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../plot_snippets_basics/" title="Plot Snippets for Exploratory (and some Explanatory) Analyses" class="md-nav__link">
      Plot Snippets for Exploratory (and some Explanatory) Analyses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../plot_snippets_ggplot2/" title="Plot Snippets - ggplot2" class="md-nav__link">
      Plot Snippets - ggplot2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../plot_snippets_ggvis/" title="Plot Snippets - ggvis" class="md-nav__link">
      Plot Snippets - ggvis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../plot_snippets_colours/" title="Plot Snippets - Colours" class="md-nav__link">
      Plot Snippets - Colours
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      RStudio
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        RStudio
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../working_with_rstudio_ide/" title="Working with the RStudio IDE" class="md-nav__link">
      Working with the RStudio IDE
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Tables and Figures
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Tables and Figures
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../tables/" title="Tables" class="md-nav__link">
      Tables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../embedding/" title="Embedding HTML into HTML" class="md-nav__link">
      Embedding HTML into HTML
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../embedding_2/" title="Embedding Rmd into Rmd" class="md-nav__link">
      Embedding Rmd into Rmd
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9" checked>
    
    <label class="md-nav__link" for="nav-9">
      A Hands-on Introduction to Statistics with R
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        A Hands-on Introduction to Statistics with R
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../a_hands-on_introduction_to_statistics_with_r_course_one_introduction/" title="Statistics with R, Course One, Introduction" class="md-nav__link">
      Statistics with R, Course One, Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../a_hands-on_introduction_to_statistics_with_r_course_two_student_s_t-test/" title="Statistics with R, Course Two, Student's t-test" class="md-nav__link">
      Statistics with R, Course Two, Student's t-test
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../a_hands-on_introduction_to_statistics_with_r_course_three_analysis_of_variance/" title="Statistics with R, Course Three, Analysis of Variance" class="md-nav__link">
      Statistics with R, Course Three, Analysis of Variance
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Statistics with R, Course Four, Repeated Measures ANOVA
      </label>
    
    <a href="./" title="Statistics with R, Course Four, Repeated Measures ANOVA" class="md-nav__link md-nav__link--active">
      Statistics with R, Course Four, Repeated Measures ANOVA
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#an-introduction-to-repeated-measures" title="An introduction to repeated measures" class="md-nav__link">
    An introduction to repeated measures
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#repeated-measures-anova" title="Repeated measures ANOVA" class="md-nav__link">
    Repeated measures ANOVA
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../a_hands-on_introduction_to_statistics_with_r_course_five_correlation_and_regression/" title="Statistics with R, Course Five, Correlation and Regression" class="md-nav__link">
      Statistics with R, Course Five, Correlation and Regression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../a_hands-on_introduction_to_statistics_with_r_course_six_multiple_regression/" title="Statistics with R, Course Six, Multiple Regression" class="md-nav__link">
      Statistics with R, Course Six, Multiple Regression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../a_hands-on_introduction_to_statistics_with_r_course_seven_moderation_and_mediation/" title="Statistics with R, Course Seven, Moderation and Mediation" class="md-nav__link">
      Statistics with R, Course Seven, Moderation and Mediation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../a_hands-on_introduction_to_statistics_with_r_notes/" title="Statistics with R, Notes" class="md-nav__link">
      Statistics with R, Notes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#an-introduction-to-repeated-measures" title="An introduction to repeated measures" class="md-nav__link">
    An introduction to repeated measures
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#repeated-measures-anova" title="Repeated measures ANOVA" class="md-nav__link">
    Repeated measures ANOVA
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ugoproto/ugo_r_doc.git/edit/master/docs/a_hands-on_introduction_to_statistics_with_r_course_four_repeated_measures_anova.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Statistics with R, Course Four, Repeated Measures ANOVA</h1>
                
                <!--
-   [1, An introduction to repeated measures](#an-introduction-to-repeated-measures)
-   [2, Repeated measures ANOVA](#repeated-measures-anova)
-->

<hr />
<p><strong>Foreword</strong></p>
<ul>
<li>Output options: the &lsquo;tango&rsquo; syntax and the &lsquo;readable&rsquo; theme.</li>
<li>Snippets and results.</li>
</ul>
<hr />
<h2 id="an-introduction-to-repeated-measures">An introduction to repeated measures<a class="headerlink" href="#an-introduction-to-repeated-measures" title="Permanent link">&para;</a></h2>
<p>The independent t-test is analogous to between-groups ANOVA and the paired-sample t-test is analogous to repeated measures ANOVA.</p>
<p>In a between-groups design, each subject is exposed to two or more treatments or conditions over time. In a within-subjects design, each subject is allocated to exactly one treatment or condition.</p>
<p>Between:</p>
<ul>
<li>Experiment 1: You want to test the effect of alcohol on test scores of students. There are three conditions: the student consumed no alcohol, two glasses of beer, or five glasses of beer. Alcohol tolerance and time spent studying should also be considered somehow.</li>
<li>Experiment 2: You want to investigate the effects of certain fertilizers on plant growth. Assume you have two different<br />
    fertilizers, A and B. Consider three conditions: you give the plant no fertilizer, fertilizer A, or fertilizer B. You measure the height of the plant after a specific period of time to see whether the fertilizers had an effect.</li>
</ul>
<p>Use a within-subjects design for for Experiment 1 and between-groups design for Experiment 2.</p>
<p>Is it always either manipulation between-groups or manipulation within-groups, or are there experiments where you could use either approach? In some cases, either approach is possible.</p>
<p><strong>Explore the working memory data</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Print the data set in the console</span>
<span class="nf">str</span><span class="p">(</span><span class="n">wm</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>## &#39;data.frame&#39;:    80 obs. of  3 variables:
##  $ subject  : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ condition: Factor w/ 4 levels &quot;12 days&quot;,&quot;17 days&quot;,..: 4 4 4 4 4 4 4 4 4 4 ...
##  $ iq       : num  12.4 11.8 14.6 7.7 15.7 11.6 7 8.4 10.7 10.6 ...
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">psych</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="c1"># Define the variable subject as a categorical variable</span>
<span class="n">wm</span><span class="o">$</span><span class="n">subject</span> <span class="o">&lt;-</span> <span class="nf">factor</span><span class="p">(</span><span class="n">wm</span><span class="o">$</span><span class="n">subject</span><span class="p">)</span>

<span class="c1"># Summary statistics by all groups (8 sessions, 12 sessions, 17 sessions, 19 sessions)</span>
<span class="nf">describeBy</span><span class="p">(</span><span class="n">wm</span><span class="p">,</span> <span class="n">wm</span><span class="o">$</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>## 
##  Descriptive statistics by group 
## group: 12 days
##            vars  n mean   sd median trimmed  mad min  max range skew
## subject*      1 20 10.5 5.92  10.50   10.50 7.41 1.0 20.0  19.0 0.00
## condition*    2 20  1.0 0.00   1.00    1.00 0.00 1.0  1.0   0.0  NaN
## iq            3 20 11.7 2.58  11.65   11.69 2.89 6.9 16.1   9.2 0.05
##            kurtosis   se
## subject*      -1.38 1.32
## condition*      NaN 0.00
## iq            -1.06 0.58
## -------------------------------------------------------- 
## group: 17 days
##            vars  n mean   sd median trimmed  mad min  max range skew
## subject*      1 20 10.5 5.92   10.5    10.5 7.41 1.0 20.0  19.0 0.00
## condition*    2 20  2.0 0.00    2.0     2.0 0.00 2.0  2.0   0.0  NaN
## iq            3 20 13.9 2.26   13.6    13.9 2.00 9.8 18.1   8.3 0.11
##            kurtosis   se
## subject*      -1.38 1.32
## condition*      NaN 0.00
## iq            -0.85 0.50
## -------------------------------------------------------- 
## group: 19 days
##            vars  n  mean   sd median trimmed  mad  min  max range  skew
## subject*      1 20 10.50 5.92   10.5   10.50 7.41  1.0 20.0  19.0  0.00
## condition*    2 20  3.00 0.00    3.0    3.00 0.00  3.0  3.0   0.0   NaN
## iq            3 20 14.75 2.50   15.3   14.71 2.15 10.4 19.2   8.8 -0.09
##            kurtosis   se
## subject*      -1.38 1.32
## condition*      NaN 0.00
## iq            -0.99 0.56
## -------------------------------------------------------- 
## group: 8 days
##            vars  n  mean   sd median trimmed  mad min  max range  skew
## subject*      1 20 10.50 5.92   10.5   10.50 7.41 1.0 20.0  19.0  0.00
## condition*    2 20  4.00 0.00    4.0    4.00 0.00 4.0  4.0   0.0   NaN
## iq            3 20 10.91 2.63   11.3   10.97 2.67 5.4 15.7  10.3 -0.21
##            kurtosis   se
## subject*      -1.38 1.32
## condition*      NaN 0.00
## iq            -0.70 0.59
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Boxplot IQ versus condition</span>
<span class="nf">boxplot</span><span class="p">(</span><span class="n">wm</span><span class="o">$</span><span class="n">iq</span> <span class="o">~</span> <span class="n">wm</span><span class="o">$</span><span class="n">condition</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&#39;Boxplot&#39;</span><span class="p">,</span> <span class="n">xlab</span> <span class="o">=</span> <span class="s">&#39;Training sessions&#39;</span><span class="p">,</span> <span class="n">ylab</span> <span class="o">=</span> <span class="s">&#39;IQ&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Course_Four,_Repeated_Measures_Anova/unnamed-chunk-3-1.png" /></center></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Illustration data, each line represents the development of each subject by number of trainings</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">wm</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">wm</span><span class="o">$</span><span class="n">condition</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">wm</span><span class="o">$</span><span class="n">iq</span><span class="p">,</span> <span class="n">group</span> <span class="o">=</span> <span class="n">wm</span><span class="o">$</span><span class="n">subject</span><span class="p">,</span> <span class="n">colour</span> <span class="o">=</span> <span class="n">wm</span><span class="o">$</span><span class="n">subject</span><span class="p">))</span> <span class="o">+</span> <span class="nf">geom_line</span><span class="p">()</span> <span class="o">+</span> <span class="nf">geom_point</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p><center><img alt="" src="../img/A_Hands-on_Introduction_to_Statistics_with_R,_Course_Four,_Repeated_Measures_Anova/unnamed-chunk-3-2.png" /></center></p>
<p><strong>Reduced cost</strong></p>
<p>The cost advantage of using manipulation within groups verses manipulation between groups for the working memory experiment is you need 60 subjects fewer.</p>
<p><strong>Statistically more powerful</strong></p>
<p>Repeated measures analysis accounts for individual differences across the experiment. This reduces the error term, which  increases statistical power.</p>
<p><strong>Counterbalancing</strong></p>
<p>Suppose you have three levels of an independent variable A (i.e. A1, A2, A3) and a blocked design. You want to use full counterbalancing to take into account order effects.</p>
<p>What are all the possible orders that you need to use? In other words, what are the order conditions?</p>
<p>(A1, A2, A3), (A1, A3, A2) , (A2, A1, A3), (A2, A3, A1) , (A3, A2, A1),<br />
(A3, A1, A2)</p>
<p><strong>Number of order conditions?</strong></p>
<p>Assume the number of levels of the independent variable goes up and you want to completely counterbalance. What will happen to the number of order conditions you&rsquo;ll need?</p>
<p>The number becomes really large. An independent variable with n levels will have <code class="codehilite">n!=n*(n???1)*(n???2)*...</code> order conditions.</p>
<p><strong>Latin Squares design</strong></p>
<p>As you hopefully realized in the previous exercise, completely counterbalancing is not always a practical solution for taking into account order effects. This is because the number of different orders required gets really large as the number of possible conditions increases.</p>
<p>The most common workaround to this problem is the Latin Squares design, in which you do not completely counterbalance, but instead put each condition at every position (at least) once.</p>
<p>Which of the following examples has been constructed according to the Latin Squares design?</p>
<p>(A1, A2, A3), (A2, A3, A1), (A3, A1, A2)</p>
<p><strong>More on Latin Squares</strong></p>
<p>The number of order conditions is always equal to the number of levels of your independent variable.</p>
<p><strong>Why is missing data a problem?</strong></p>
<p>In a between-groups design, it is okay to have a slightly different number of subjects in each group, so if one subject drops out in one of the conditions then that group has just one less subject. Now you want to look at how subjects change over time and the different scores between two or more conditions for each subject.</p>
<p><strong>Understanding sphericity</strong></p>
<p>The variances of the differences between all possible pairs of groups (i.e. levels of the independent variable) are equal.</p>
<p><strong>Mauchly&rsquo;s test</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Define iq as a data frame where each column represents a condition</span>
<span class="n">iq</span> <span class="o">&lt;-</span> <span class="nf">cbind</span><span class="p">(</span><span class="n">wm</span><span class="o">$</span><span class="n">iq[wm</span><span class="o">$</span><span class="n">condition</span> <span class="o">==</span> <span class="s">&#39;8 days&#39;</span><span class="n">]</span><span class="p">,</span> <span class="n">wm</span><span class="o">$</span><span class="n">iq[wm</span><span class="o">$</span><span class="n">condition</span> <span class="o">==</span> <span class="s">&#39;12 days&#39;</span><span class="n">]</span><span class="p">,</span> <span class="n">wm</span><span class="o">$</span><span class="n">iq[wm</span><span class="o">$</span><span class="n">condition</span> <span class="o">==</span> <span class="s">&#39;17 days&#39;</span><span class="n">]</span><span class="p">,</span> <span class="n">wm</span><span class="o">$</span><span class="n">iq[wm</span><span class="o">$</span><span class="n">condition</span> <span class="o">==</span> <span class="s">&#39;19 days&#39;</span><span class="n">]</span><span class="p">)</span>

<span class="c1"># Make an mlm object</span>
<span class="n">mlm</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">iq</span> <span class="o">~</span> <span class="m">1</span><span class="p">)</span>

<span class="c1"># Mauchly&#39;s test</span>
<span class="nf">mauchly.test</span><span class="p">(</span><span class="n">mlm</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="o">~</span> <span class="m">1</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>## 
##  Mauchly&#39;s test of sphericity
## 
## data:  SSD matrix from lm(formula = iq ~ 1)
## W = 0.81725, p-value = 0.9407
</pre></div>
</td></tr></table>

<p>Based on the results, the sphericity assumption holds.</p>
<p><strong>Pros of repeated measures</strong></p>
<p>Less cost and statistically more powerful</p>
<p><strong>Cons of repeated measures</strong></p>
<p>Order effects, counterbalancing, missing data, and an extra assumption</p>
<h2 id="repeated-measures-anova">Repeated measures ANOVA<a class="headerlink" href="#repeated-measures-anova" title="Permanent link">&para;</a></h2>
<p><strong>The systematic between groups variance</strong></p>
<p>To understand everything a bit better, we will calculate the F-ratio for a repeated measures design by ourself in the next exercises.</p>
<p>First, we will need the systematic between-groups variance. This is the same as in the between-groups design&ndash;the variance due to grouping by condition.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Define number of subjects for each condition</span>
<span class="n">n</span> <span class="o">&lt;-</span> <span class="m">20</span>

<span class="c1"># Calculate group means</span>
<span class="n">y_j</span> <span class="o">&lt;-</span> <span class="nf">tapply</span><span class="p">(</span><span class="n">wm</span><span class="o">$</span><span class="n">iq</span><span class="p">,</span> <span class="n">wm</span><span class="o">$</span><span class="n">condition</span><span class="p">,</span> <span class="n">mean</span><span class="p">)</span>

<span class="c1"># Calculate the grand mean</span>
<span class="n">y_t</span> <span class="o">&lt;-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">y_j</span><span class="p">)</span>

<span class="c1"># Calculate the sum of squares</span>
<span class="n">ss_cond</span> <span class="o">&lt;-</span> <span class="nf">sum</span><span class="p">((</span><span class="n">y_j</span> <span class="o">-</span> <span class="n">y_t</span><span class="p">)</span><span class="n">^2</span><span class="p">)</span><span class="o">*</span><span class="n">n</span>

<span class="c1"># Define the degrees of freedom for conditions</span>
<span class="n">df</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="m">4</span> <span class="o">-</span> <span class="m">1</span><span class="p">)</span>

<span class="c1"># Calculate the mean squares (variance)</span>
<span class="n">ms_cond</span> <span class="o">&lt;-</span> <span class="n">ss_cond</span><span class="o">/</span><span class="n">df</span>
</pre></div>
</td></tr></table>

<p><strong>The subject variance</strong></p>
<p>We will also need the error term of the repeated measures design. This can be calculated in a few steps.</p>
<ul>
<li>First calculate the systematic variance due to subjects.</li>
<li>Below, we will calculate the unsystematic variance, like we did with the between-groups design.</li>
<li>If we subtract these two results, we will get the error term of the repeated measures design.</li>
</ul>
<p>The systematic (stable) subject variance will be taken out of the error term, so the error term is reduced in comparison with the between-groups design.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Define number of conditions for each subject</span>
<span class="n">n</span> <span class="o">&lt;-</span> <span class="m">4</span>

<span class="c1"># Calculate subject means</span>
<span class="n">y_j</span> <span class="o">&lt;-</span> <span class="nf">tapply</span><span class="p">(</span><span class="n">wm</span><span class="o">$</span><span class="n">iq</span><span class="p">,</span> <span class="n">wm</span><span class="o">$</span><span class="n">subject</span><span class="p">,</span> <span class="n">mean</span><span class="p">)</span>

<span class="c1"># Calculate the grand mean</span>
<span class="n">y_t</span> <span class="o">&lt;-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">y_j</span><span class="p">)</span>

<span class="c1"># Calculate the sum of squares</span>
<span class="n">ss_subjects</span> <span class="o">&lt;-</span> <span class="nf">sum</span><span class="p">((</span><span class="n">y_j</span> <span class="o">-</span> <span class="n">y_t</span><span class="p">)</span><span class="n">^2</span><span class="p">)</span><span class="o">*</span><span class="n">n</span>

<span class="c1"># Define the degrees of freedom for subjects</span>
<span class="n">df</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="m">20</span> <span class="o">-</span> <span class="m">1</span><span class="p">)</span>

<span class="c1"># Calculate the mean squares (variance)</span>
<span class="n">ms_subjects</span> <span class="o">&lt;-</span> <span class="n">ss_subjects</span><span class="o">/</span><span class="n">df</span>
</pre></div>
</td></tr></table>

<p><strong>The unsystematic within groups variance</strong></p>
<p>To calculate the error term of the repeated measures design, we need the unsystematic within-groups variance: the unsystematic variance or the error term of the between-groups design.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Create four subsets of the four groups, containing the IQ results</span>
    <span class="c1"># Make the subset for the group condition = &quot;8 days&quot;</span>
<span class="n">y_i1</span> <span class="o">&lt;-</span> <span class="nf">subset</span><span class="p">(</span><span class="n">wm</span><span class="o">$</span><span class="n">iq</span><span class="p">,</span> <span class="n">wm</span><span class="o">$</span><span class="n">condition</span> <span class="o">==</span> <span class="s">&quot;8 days&quot;</span><span class="p">)</span>
    <span class="c1"># Make the subset for the group condition = &quot;12 days&quot;</span>
<span class="n">y_i2</span> <span class="o">&lt;-</span> <span class="nf">subset</span><span class="p">(</span><span class="n">wm</span><span class="o">$</span><span class="n">iq</span><span class="p">,</span> <span class="n">wm</span><span class="o">$</span><span class="n">condition</span> <span class="o">==</span> <span class="s">&quot;12 days&quot;</span><span class="p">)</span>
    <span class="c1"># Make the subset for the group condition = &quot;17 days&quot;</span>
<span class="n">y_i3</span> <span class="o">&lt;-</span> <span class="nf">subset</span><span class="p">(</span><span class="n">wm</span><span class="o">$</span><span class="n">iq</span><span class="p">,</span> <span class="n">wm</span><span class="o">$</span><span class="n">condition</span> <span class="o">==</span> <span class="s">&quot;17 days&quot;</span><span class="p">)</span>
    <span class="c1"># Make the subset for the group condition = &quot;19 days&quot;</span>
<span class="n">y_i4</span> <span class="o">&lt;-</span> <span class="nf">subset</span><span class="p">(</span><span class="n">wm</span><span class="o">$</span><span class="n">iq</span><span class="p">,</span> <span class="n">wm</span><span class="o">$</span><span class="n">condition</span> <span class="o">==</span> <span class="s">&quot;19 days&quot;</span><span class="p">)</span>

<span class="c1"># Subtract the individual values by their group means</span>
<span class="n">s_1</span> <span class="o">&lt;-</span> <span class="n">y_i1</span> <span class="o">-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">y_i1</span><span class="p">)</span>
<span class="n">s_2</span> <span class="o">&lt;-</span> <span class="n">y_i2</span> <span class="o">-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">y_i2</span><span class="p">)</span>
<span class="n">s_3</span> <span class="o">&lt;-</span> <span class="n">y_i3</span> <span class="o">-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">y_i3</span><span class="p">)</span>
<span class="n">s_4</span> <span class="o">&lt;-</span> <span class="n">y_i4</span> <span class="o">-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">y_i4</span><span class="p">)</span>

<span class="c1"># Put everything back into one vector</span>
<span class="n">s_t</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">s_1</span><span class="p">,</span> <span class="n">s_2</span><span class="p">,</span> <span class="n">s_3</span><span class="p">,</span> <span class="n">s_4</span><span class="p">)</span>

<span class="c1"># Calculate the within sum of squares by using the vector s_t</span>
<span class="n">ss_sa</span> <span class="o">&lt;-</span> <span class="nf">sum</span><span class="p">(</span><span class="n">s_t^2</span><span class="p">)</span>

<span class="c1"># Define the degrees of freedom</span>
<span class="n">df</span> <span class="o">&lt;-</span> <span class="m">4</span><span class="o">*</span><span class="p">(</span><span class="m">20-1</span><span class="p">)</span>

<span class="c1"># Calculate the mean squares (variances)</span>
<span class="n">ms_sa</span> <span class="o">&lt;-</span> <span class="n">ss_sa</span><span class="o">/</span><span class="n">df</span>
</pre></div>
</td></tr></table>

<p><strong>The unsystematic variance for the repeated measures design</strong></p>
<p>Now we can easily calculate the unsystematic variance for the repeated measures design, also called the error term.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># ss_sa = ss_subjects + ss_rm</span>
<span class="n">ss_rm</span> <span class="o">&lt;-</span> <span class="n">ss_sa</span> <span class="o">-</span> <span class="n">ss_subjects</span>

<span class="c1"># Define the degrees of freedom</span>
<span class="n">df</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="m">20</span> <span class="o">-</span> <span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="m">4</span> <span class="o">-</span> <span class="m">1</span><span class="p">)</span>

<span class="c1"># Calculate the mean squares (variances)</span>
<span class="n">ms_rm</span> <span class="o">&lt;-</span> <span class="n">ss_rm</span><span class="o">/</span><span class="n">df</span>
</pre></div>
</td></tr></table>

<p>Now we&rsquo;ve calculated the error term of the repeated measures design, which is clearly smaller than the error term of the between-groups design because you reduced this one. To complete you can now calculate the F-ratio and the corresponding p-value.</p>
<p><strong>F-ratio and p-value</strong></p>
<p>To do the ANOVA analysis we actually need the F-ratio and the corresponding p-value.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Calculate the F-ratio</span>
<span class="n">f_rat</span> <span class="o">&lt;-</span> <span class="n">ms_cond</span><span class="o">/</span><span class="n">ms_rm</span>

<span class="c1"># Define the degrees of freedom of the F-distribution</span>
<span class="c1"># df1 for freedom of conditions (ss_cond)</span>
<span class="c1"># df2 for (freedom of) conditions and subjects (sa_sa)</span>
<span class="n">df1</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="m">4</span> <span class="o">-</span> <span class="m">1</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="m">4</span> <span class="o">-</span> <span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="m">20</span> <span class="o">-</span> <span class="m">1</span><span class="p">)</span>

<span class="c1"># Calculate the p-value</span>
<span class="n">p</span> <span class="o">&lt;-</span> <span class="m">1</span> <span class="o">-</span> <span class="nf">pf</span><span class="p">(</span><span class="n">f_rat</span><span class="p">,</span> <span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Error term in a repeated measures design?</strong></p>
<p>The inconsistent individual differences across conditions, the effect of subjects that differ across conditions. So it is an interaction between subjects and condition.</p>
<p><strong>Anova in R</strong></p>
<p>ANOVA in R is usually done with the <code class="codehilite">aov</code> function.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># anova model</span>
<span class="n">model</span> <span class="o">&lt;-</span> <span class="nf">aov</span><span class="p">(</span><span class="n">wm</span><span class="o">$</span><span class="n">iq</span> <span class="o">~</span> <span class="n">wm</span><span class="o">$</span><span class="n">condition</span> <span class="o">+</span> <span class="nf">Error</span><span class="p">(</span><span class="n">wm</span><span class="o">$</span><span class="n">subject</span> <span class="o">/</span> <span class="n">wm</span><span class="o">$</span><span class="n">condition</span><span class="p">))</span>

<span class="c1"># summary model</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>## 
## Error: wm$subject
##           Df Sum Sq Mean Sq F value Pr(&amp;gt;F)
## Residuals 19  175.6   9.242               
## 
## Error: wm$subject:wm$condition
##              Df Sum Sq Mean Sq F value   Pr(&amp;gt;F)    
## wm$condition  3  196.1   65.36   12.51 2.16e-06 ***
## Residuals    57  297.8    5.22                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</pre></div>
</td></tr></table>

<p>The F-ratio is significant. Therefore, the number of training days does affect the IQ scores.</p>
<p><strong>Effect size</strong></p>
<p>Calculate eta-squared, which helps you estimate effect size.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Define the total sum of squares</span>

<span class="c1"># ss_cond (syst. between groups or of the effect), </span>
<span class="c1"># ss_sa (unsyst. within groups) =</span>
<span class="c1"># ss_rm (unsyst. for repeated measures design) + # ss_subjects (ok)</span>
<span class="n">ss_total</span> <span class="o">&lt;-</span> <span class="n">ss_cond</span> <span class="o">+</span> <span class="n">ss_rm</span>

<span class="c1"># Calculate the effect size</span>
<span class="n">eta_sq</span> <span class="o">&lt;-</span> <span class="n">ss_cond</span> <span class="o">/</span> <span class="n">ss_total</span>
</pre></div>
</td></tr></table>

<p><strong>Post-hoc test one</strong></p>
<p>We will now look at a few different procedures for the post-hoc test. Let&rsquo;s start with the Holm procedure.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Post-hoc test: default procedure</span>
<span class="nf">with</span><span class="p">(</span><span class="n">wm</span><span class="p">,</span> <span class="nf">pairwise.t.test</span><span class="p">(</span><span class="n">iq</span><span class="p">,</span> <span class="n">condition</span><span class="p">,</span> <span class="n">paired</span> <span class="o">=</span> <span class="bp">T</span><span class="p">))</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>## 
##  Pairwise comparisons using paired t tests 
## 
## data:  iq and condition 
## 
##         12 days 17 days 19 days
## 17 days 0.01955 -       -      
## 19 days 0.00270 0.40038 -      
## 8 days  0.40038 0.00244 0.00054
## 
## P value adjustment method: holm
</pre></div>
</td></tr></table>

<p>We get a table with some values as the output for the post-hoc test and a line saying that we have used the Holm procedure. What are the values in the table of the output? p-values.</p>
<p>Recall that the hypotheses are tested at a 5% significance level.</p>
<p>We can conclude that all pairwise comparisons are significant, except for the comparison between 19 and 17 and the comparison between 12 and 8.</p>
<p><strong>Post-hoc test: Bonferroni</strong></p>
<p>Now we&rsquo;ll take a look at the most conservative procedure, Bonferroni. This procedure will apply the most extreme adjustments to the p-values.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Post-hoc test: Bonferroni procedure</span>
<span class="nf">with</span><span class="p">(</span><span class="n">wm</span><span class="p">,</span> <span class="nf">pairwise.t.test</span><span class="p">(</span><span class="n">iq</span><span class="p">,</span> <span class="n">condition</span><span class="p">,</span> <span class="n">paired</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="n">p.adjust.method</span> <span class="o">=</span> <span class="s">&#39;bonferroni&#39;</span><span class="p">))</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>## 
##  Pairwise comparisons using paired t tests 
## 
## data:  iq and condition 
## 
##         12 days 17 days 19 days
## 17 days 0.03910 -       -      
## 19 days 0.00405 1.00000 -      
## 8 days  1.00000 0.00293 0.00054
## 
## P value adjustment method: bonferroni
</pre></div>
</td></tr></table>

<p>Notice the change in p-values in comparison with the previous procedure.</p>
<p><strong>Paired t-test</strong></p>
<p>Assume that you do not know how to perform an analysis of variance (ANOVA), we may do a number of paired t-tests instead.</p>
<p>Have a look at just one paired t-test and take, for example, the comparison between 12 days and 17 days.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Define two subsets containing the IQ scores for the condition group &#39;12 days&#39; and &#39;17 days&#39;</span>
<span class="n">cond_12days</span> <span class="o">&lt;-</span> <span class="nf">subset</span><span class="p">(</span><span class="n">wm</span><span class="p">,</span> <span class="n">condition</span> <span class="o">==</span> <span class="s">&#39;12 days&#39;</span><span class="p">)</span><span class="o">$</span><span class="n">iq</span>
<span class="n">cond_17days</span> <span class="o">&lt;-</span> <span class="nf">subset</span><span class="p">(</span><span class="n">wm</span><span class="p">,</span> <span class="n">condition</span> <span class="o">==</span> <span class="s">&#39;17 days&#39;</span><span class="p">)</span><span class="o">$</span><span class="n">iq</span>
<span class="n">cond_12days</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>##  [1] 12.5 11.6  8.9  8.3 10.9 13.4 12.3  8.7  9.7  9.7  6.9 10.5 11.6 13.8
## [15] 15.6 11.7 16.1 11.7 15.0 15.1
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># t-test</span>
<span class="nf">t.test</span><span class="p">(</span><span class="n">cond_12days</span><span class="p">,</span> <span class="n">cond_17days</span><span class="p">,</span> <span class="n">paired</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>## 
##  Paired t-test
## 
## data:  cond_12days and cond_17days
## t = -3.0549, df = 19, p-value = 0.006517
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -3.7157116 -0.6942884
## sample estimates:
## mean of the differences 
##                  -2.205
</pre></div>
</td></tr></table>

<p>It is clear that we can apply different procedures for post-hoc tests. These procedures differ with respect to how they handle inflation of the possibility of a type I error and will therefore give us different p-values. However, these p-values will always be in a certain range.</p>
<p>What is the (smallest) range of p-values for the comparison between 12 days and 17 days? Look at the results from applying the Bonferroni procedure as well as the paired t-test.</p>
<p>p-values:</p>
<ul>
<li>Bonferroni 12 days-17 days: 0.03910</li>
<li>Paired t-test (cond_12days, cond_17days): 0.006517</li>
</ul>
<p>Therefore: [0.0065, 0.0391].</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../a_hands-on_introduction_to_statistics_with_r_course_three_analysis_of_variance/" title="Statistics with R, Course Three, Analysis of Variance" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Statistics with R, Course Three, Analysis of Variance
              </span>
            </div>
          </a>
        
        
          <a href="../a_hands-on_introduction_to_statistics_with_r_course_five_correlation_and_regression/" title="Statistics with R, Course Five, Correlation and Regression" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Statistics with R, Course Five, Correlation and Regression
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.b41f3d20.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
    
      
        <script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-93008985-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(a){a.host!=document.location.host&&a.addEventListener("click",function(){var e=a.getAttribute("data-md-action")||"follow";ga("send","event","outbound",e,a.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
  </body>
</html>