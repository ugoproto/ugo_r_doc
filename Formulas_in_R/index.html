<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Ugo Sparks">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Formulas in R - ugo_r_doc</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Formulas in R";
    var mkdocs_page_input_path = "Formulas_in_R.md";
    var mkdocs_page_url = "/Formulas_in_R/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-93008985-1', 'mkdocs.org');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> ugo_r_doc</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../An Introduction to R/">An Introduction to R</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Le logiciel R, maitriser le langage, effectuer des analyses (bio)statistiques/">Le logiciel R, maitriser le langage, effectuer des analyses (bio)statistiques</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../R_CS/">R Cheat Sheets</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Intermediate R</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../Intermediate_R/">Intermediate R</a>
                </li>
                <li class="">
                    
    <a class="" href="../Intermediate_R_-_The_apply_Family/">Intermediate R - The apply Family</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">RStudio</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../Code___Plot_Chunk_Options/">Code & Plot Chunk Options</a>
                </li>
                <li class="">
                    
    <a class="" href="../Working_with_RStudio_IDE/">Working with the RStudio IDE</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Data Wrangling Snippets</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../IO_snippets___Cleaning/">I/O snippets & Cleaning</a>
                </li>
                <li class="">
                    
    <a class="" href="../Reading_Data_into_R_with_readr/">Reading Data into R with readr</a>
                </li>
                <li class="">
                    
    <a class="" href="../Data_Analysis_in_R,_the_data.table_Way/">Data Analysis in R, the data.table Way</a>
                </li>
                <li class="">
                    
    <a class="" href="../Data_Manipulation_in_R_with_dplyr/">Data Manipulation in R with dplyr</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Plot Snippets</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../Plot_snippets_-_Basics/">Plot Snippets for Exploratory (and some Explanatory) Analyses</a>
                </li>
                <li class="">
                    
    <a class="" href="../Plot_snippets_-_ggplot2/">Plot Snippets - ggplot2</a>
                </li>
                <li class="">
                    
    <a class="" href="../Plot_snippets_-_ggvis/">Plot Snippets - ggvis</a>
                </li>
                <li class="">
                    
    <a class="" href="../Plot_snippets_-_Colours/">Plot Snippets - Colours</a>
                </li>
                <li class="">
                    
    <a class="" href="../Improved_codes/">Improved codes</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Formulas in R</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#formula-structures">Formula structures</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#formulation">Formulation</a></li>
        
            <li><a class="toctree-l4" href="#concatenation">Concatenation</a></li>
        
            <li><a class="toctree-l4" href="#operators">Operators</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#examine-formulas">Examine formulas</a></li>
    

    <li class="toctree-l3"><a href="#modify-formulas">Modify formulas</a></li>
    

    <li class="toctree-l3"><a href="#use-formulas">Use formulas</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#linear-models">Linear models</a></li>
        
            <li><a class="toctree-l4" href="#get-back-a-dataframe-of-the-fitted-object">Get back a data.frame of the fitted object</a></li>
        
            <li><a class="toctree-l4" href="#mixed-effect-models">Mixed-effect models</a></li>
        
            <li><a class="toctree-l4" href="#non-linear-models">Non-linear models</a></li>
        
            <li><a class="toctree-l4" href="#generalized-linear-models-glm">Generalized Linear Models (GLM)</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#use-formulas-in-graphical-functions">Use formulas in graphical functions</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#basic">Basic</a></li>
        
            <li><a class="toctree-l4" href="#the-lattice-package">The lattice package</a></li>
        
            <li><a class="toctree-l4" href="#the-ggplot2-package">The ggplot2 package</a></li>
        
            <li><a class="toctree-l4" href="#the-ggformula-package">The ggformula package</a></li>
        
            <li><a class="toctree-l4" href="#the-dplyr-package">The dplyr package</a></li>
        
            <li><a class="toctree-l4" href="#other-packages">Other packages</a></li>
        
        </ul>
    

    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Packages</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../googleVis/">googleVis (embed HTML plots)</a>
                </li>
                <li class="">
                    
    <a class="" href="../gganimate/">gganimate</a>
                </li>
                <li class="">
                    
    <a class="" href="../Fast-and-Frugal_Decision_Trees_in_R_with_FFTrees/">Fast-and-Frugal Decision Trees</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Other Snippets</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../Tables/">Tables</a>
                </li>
                <li class="">
                    
    <a class="" href="../embedding/">Embedding HTML into HTML</a>
                </li>
                <li class="">
                    
    <a class="" href="../embedding2/">Embedding Rmd into Rmd</a>
                </li>
                <li class="">
                    
    <a class="" href="../Frequentist_Bayesian/">Frequentist vs. Bayesian</a>
                </li>
                <li class="">
                    
    <a class="" href="../Parallel computing in R/">Parallel computing in R</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">A Hands-on Introduction to Statistics with R</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../A_Hands-on_Introduction_to_Statistics_with_R,_Course_One,_Introduction/">Statistics with R, Course One, Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../A_Hands-on_Introduction_to_Statistics_with_R,_Course_Two,_Student_s_T-test/">Statistics with R, Course Two, Student's t-test</a>
                </li>
                <li class="">
                    
    <a class="" href="../A_Hands-on_Introduction_to_Statistics_with_R,_Course_Three,_Analysis_of_Variance/">Statistics with R, Course Three, Analysis of Variance</a>
                </li>
                <li class="">
                    
    <a class="" href="../A_Hands-on_Introduction_to_Statistics_with_R,_Course_Four,_Repeated_Measures_Anova/">Statistics with R, Course Four, Repeated Measures ANOVA</a>
                </li>
                <li class="">
                    
    <a class="" href="../A_Hands-on_Introduction_to_Statistics_with_R,_Course_Five,_Correlation_and_Regression/">Statistics with R, Course Five, Correlation and Regression</a>
                </li>
                <li class="">
                    
    <a class="" href="../A_Hands-on_Introduction_to_Statistics_with_R,_Course_Six,_Multiple_Regression/">Statistics with R, Course Six, Multiple Regression</a>
                </li>
                <li class="">
                    
    <a class="" href="../A_Hands-on_Introduction_to_Statistics_with_R,_Course_Seven,_Moderation_and_Mediation/">Statistics with R, Course Seven, Moderation and Mediation</a>
                </li>
                <li class="">
                    
    <a class="" href="../A_Hands-on_Introduction_to_Statistics_with_R,_Notes/">Statistics with R, Notes</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Big_Data_Analysis_with_Revolution_R_Enterprise/">Big Data Analysis with Revolution R Enterprise</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Time+Series+in+R+The+Power+of+xts+and+zoo/">Time Series in R, The Power of xts and zoo</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">ugo_r_doc</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Plot Snippets &raquo;</li>
        
      
    
    <li>Formulas in R</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <div class="toc"><span class="toctitle">CONTENT</span><ul>
<li><a href="#overall-data-structures">Overall data structures</a></li>
<li><a href="#formula-structures">Formula structures</a><ul>
<li><a href="#formulation">Formulation</a></li>
<li><a href="#concatenation">Concatenation</a></li>
<li><a href="#operators">Operators</a></li>
</ul>
</li>
<li><a href="#examine-formulas">Examine formulas</a></li>
<li><a href="#modify-formulas">Modify formulas</a></li>
<li><a href="#use-formulas">Use formulas</a><ul>
<li><a href="#linear-models">Linear models</a></li>
<li><a href="#get-back-a-dataframe-of-the-fitted-object">Get back a data.frame of the fitted object</a></li>
<li><a href="#mixed-effect-models">Mixed-effect models</a></li>
<li><a href="#non-linear-models">Non-linear models</a></li>
<li><a href="#generalized-linear-models-glm">Generalized Linear Models (GLM)</a></li>
</ul>
</li>
<li><a href="#use-formulas-in-graphical-functions">Use formulas in graphical functions</a><ul>
<li><a href="#basic">Basic</a></li>
<li><a href="#the-lattice-package">The lattice package</a></li>
<li><a href="#the-ggplot2-package">The ggplot2 package</a></li>
<li><a href="#the-ggformula-package">The ggformula package</a></li>
<li><a href="#the-dplyr-package">The dplyr package</a></li>
<li><a href="#other-packages">Other packages</a></li>
</ul>
</li>
</ul>
</div>
<hr />
<p><strong>Foreword</strong></p>
<p>Code snippets and excerpts from the tutorial. From DataCamp.</p>
<hr />
<h3 id="overall-data-structures">Overall data structures<a class="headerlink" href="#overall-data-structures" title="Permanent link">&para;</a></h3>
<pre><code># Create variables
a &lt;- c(1,2,3,4,5,6,7,8,9)
b &lt;- list(x = LifeCycleSavings[,1], y = LifeCycleSavings[,2])

# Retrieve the types of `a` and `b`
# atomic data types
typeof(a)

## [1] "double"

typeof(b)

## [1] "list"

# Retrieve the classes of `a` and `b`
# for attributes, methods attached
class(a)

## [1] "numeric"

class(b)

## [1] "list"
</code></pre>
<p>Note that if an object does not have a class attribute, it has an<br />
implicit <code>class</code>, &ldquo;matrix&rdquo;, &ldquo;array&rdquo; or the result of the <code>mode()</code><br />
function.</p>
<p>Dates and formulas are a special class.</p>
<pre><code># Retrieve the object type
typeof(quote(x * 10))

## [1] "language"

# Retrieve the class
class(quote(x * 10))

## [1] "call"

# A formula
c &lt;- y ~ x # Sepal.Width ~ Petal.Width
d &lt;- y ~ x + b # Sepal.Width ~ Petal.Width + Species

# Double check the class of `c`
class(c)

## [1] "formula"

# Return the type of `d`
typeof(c)

## [1] "language"

# Retrieve the attributes of `d`
attributes(c)

## $class
## [1] "formula"
## 
## $.Environment
## &lt;environment: R_GlobalEnv&gt;
</code></pre>
<h3 id="formula-structures">Formula structures<a class="headerlink" href="#formula-structures" title="Permanent link">&para;</a></h3>
<ul>
<li>Independent variables appear as &ldquo;predictor (variable)&rdquo;, &ldquo;controlled<br />
    variable&rdquo;, &ldquo;feature&rdquo;, etc.</li>
<li>Dependent variables are &ldquo;response variable&rdquo;, &ldquo;outcome variable&rdquo;<br />
    or &ldquo;label&rdquo;.</li>
</ul>
<!-- -->

<pre><code>e &lt;- ~ x + y + z
f &lt;- y ~ x + b

# Return the length of `g`
length(e)

## [1] 2

length(f)

## [1] 3

# Retrieve the elements at index 1 and 2
e[[1]]

## `~`

e[[2]]

## x + y + z

f[[1]]

## `~`

f[[2]]

## y

f[[3]]

## x + b
</code></pre>
<h4 id="formulation">Formulation<a class="headerlink" href="#formulation" title="Permanent link">&para;</a></h4>
<ul>
<li><code>y ~ x + a + b</code> where &ldquo;y is a function of x, a, and b&rdquo;.</li>
<li><code>Sepal.Width ~ Petal.Width | Species</code> where &ldquo;the sepal width is a<br />
    function of petal width, conditioned on species&rdquo;.</li>
</ul>
<!-- -->

<pre><code>"y ~ x1 + x2"
h &lt;- as.formula("y ~ x1 + x2")
h &lt;- formula("y ~ x1 + x2")
</code></pre>
<h4 id="concatenation">Concatenation<a class="headerlink" href="#concatenation" title="Permanent link">&para;</a></h4>
<pre><code># Create variables
i &lt;- y ~ x
j &lt;- y ~ x + x1
k &lt;- y ~ x + x1 + x2

# Concatentate
formulae &lt;- list(as.formula(i), as.formula(j), as.formula(k))
formulae

## [[1]]
## y ~ x
## 
## [[2]]
## y ~ x + x1
## 
## [[3]]
## y ~ x + x1 + x2

# Double check the class of the list elements
class(formulae[[1]])

## [1] "formula"

# Join all with `c()`
l &lt;- c(i, j, k)

# Apply `as.formula` to all elements of `f`
lapply(l, as.formula)

## [[1]]
## y ~ x
## 
## [[2]]
## y ~ x + x1
## 
## [[3]]
## y ~ x + x1 + x2
</code></pre>
<h4 id="operators">Operators<a class="headerlink" href="#operators" title="Permanent link">&para;</a></h4>
<ul>
<li><code>-</code> for removing terms,</li>
<li><code>:</code> for interaction for the variable&rsquo; interaction, not the variable<br />
    itself (regression),</li>
<li><code>*</code> for crossing: include two variables and their interaction<br />
    (regression),</li>
<li><code>%in%</code> for nesting,</li>
<li><code>^</code> for limit crossing to the specified degree,</li>
<li><code>-1</code> for removing the intercept.</li>
</ul>
<!-- -->

<pre><code># Use multiple independent variables
y ~ x1 + x2

## y ~ x1 + x2

# Ignore objects in an analysis
y ~ x1 - x2

## y ~ x1 - x2

# Interactions
y ~ x1 * x2

## y ~ x1 * x2

# or
y ~ x1 + x2 + x1:x2

## y ~ x1 + x2 + x1:x2

# No intercept
y ~ x1 * x2 -1

## y ~ x1 * x2 - 1

y ~ 0 + x1 * x2

## y ~ 0 + x1 * x2

# Nesting
y ~ a + a:b

## y ~ a + a:b

# or
y ~ a + b %in% a

## y ~ a + b %in% a

# Quadratic regression
y ~ x + I(x^2)

## y ~ x + I(x^2)

# Polynomial regression
y ~ x + I(x^2) + I(x^3)

## y ~ x + I(x^2) + I(x^3)

# Factorial ANOVA
y ~ (a*b*c)^2

## y ~ (a * b * c)^2

# All independent variables
y ~ .

## y ~ .
</code></pre>
<h3 id="examine-formulas">Examine formulas<a class="headerlink" href="#examine-formulas" title="Permanent link">&para;</a></h3>
<pre><code>m &lt;- formula("y ~ x1 + x2")

attributes(m)

## $class
## [1] "formula"
## 
## $.Environment
## &lt;environment: R_GlobalEnv&gt;

typeof(m)

## [1] "language"

class(m)

## [1] "formula"

terms(m)

## y ~ x1 + x2
## attr(,"variables")
## list(y, x1, x2)
## attr(,"factors")
##    x1 x2
## y   0  0
## x1  1  0
## x2  0  1
## attr(,"term.labels")
## [1] "x1" "x2"
## attr(,"order")
## [1] 1 1
## attr(,"intercept")
## [1] 1
## attr(,"response")
## [1] 1
## attr(,".Environment")
## &lt;environment: R_GlobalEnv&gt;

print(all.vars(m))

## [1] "y"  "x1" "x2"

library(plyr)
is.formula(m)

## [1] TRUE
</code></pre>
<h3 id="modify-formulas">Modify formulas<a class="headerlink" href="#modify-formulas" title="Permanent link">&para;</a></h3>
<pre><code>update(y ~ x1 + x2, ~ . + x3)

## y ~ x1 + x2 + x3
</code></pre>
<h3 id="use-formulas">Use formulas<a class="headerlink" href="#use-formulas" title="Permanent link">&para;</a></h3>
<h4 id="linear-models">Linear models<a class="headerlink" href="#linear-models" title="Permanent link">&para;</a></h4>
<pre><code>lm.m &lt;- lm(Sepal.Width ~ Petal.Width + log(Petal.Length) + Species, 
        data = iris, 
        subset = Sepal.Length &gt; 4.6)

print(lm.m)

## 
## Call:
## lm(formula = Sepal.Width ~ Petal.Width + log(Petal.Length) + 
##     Species, data = iris, subset = Sepal.Length &gt; 4.6)
## 
## Coefficients:
##       (Intercept)        Petal.Width  log(Petal.Length)  
##            3.1531             0.6620             0.4612  
## Speciesversicolor   Speciesvirginica  
##           -1.9265            -2.3088
</code></pre>
<h4 id="get-back-a-dataframe-of-the-fitted-object">Get back a data.frame of the fitted object<a class="headerlink" href="#get-back-a-dataframe-of-the-fitted-object" title="Permanent link">&para;</a></h4>
<pre><code>stats::model.frame(formula = Sepal.Width ~ Petal.Width + log(Petal.Length) + Species, 
                   data = iris, 
                   subset = Sepal.Length &gt; 6.9, 
                   drop.unused.levels = TRUE)

##     Sepal.Width Petal.Width log(Petal.Length)    Species
## 51          3.2         1.4          1.547563 versicolor
## 103         3.0         2.1          1.774952  virginica
## 106         3.0         2.1          1.887070  virginica
## 108         2.9         1.8          1.840550  virginica
## 110         3.6         2.5          1.808289  virginica
## 118         3.8         2.2          1.902108  virginica
## 119         2.6         2.3          1.931521  virginica
## 123         2.8         2.0          1.902108  virginica
## 126         3.2         1.8          1.791759  virginica
## 130         3.0         1.6          1.757858  virginica
## 131         2.8         1.9          1.808289  virginica
## 132         3.8         2.0          1.856298  virginica
## 136         3.0         2.3          1.808289  virginica
</code></pre>
<h4 id="mixed-effect-models">Mixed-effect models<a class="headerlink" href="#mixed-effect-models" title="Permanent link">&para;</a></h4>
<p>The <code>nlme</code> and the <code>lme4</code> package are dedicated to fitting linear and<br />
generalized linear mixed-effects models.</p>
<pre><code># Load packages
library(MASS)
library(nlme)

# Get some data 
data(oats)

# Adjust the data names and columns
names(oats) = c('block', 'variety', 'nitrogen', 'yield')
oats$mainplot = oats$variety
oats$subplot = oats$nitrogen

# Fit a non-linear mixed-effects model 
nlme.m = lme(yield ~ variety*nitrogen,
             random = ~ 1|block/mainplot,
             data = oats)

# Retrieve a summary
summary(nlme.m)

## Linear mixed-effects model fit by REML
##  Data: oats 
##        AIC      BIC    logLik
##   559.0285 590.4437 -264.5143
## 
## Random effects:
##  Formula: ~1 | block
##         (Intercept)
## StdDev:    14.64496
## 
##  Formula: ~1 | mainplot %in% block
##         (Intercept) Residual
## StdDev:    10.29864 13.30727
## 
## Fixed effects: yield ~ variety * nitrogen 
##                                     Value Std.Error DF   t-value p-value
## (Intercept)                      80.00000  9.106959 45  8.784491  0.0000
## varietyMarvellous                 6.66667  9.715030 10  0.686222  0.5082
## varietyVictory                   -8.50000  9.715030 10 -0.874933  0.4021
## nitrogen0.2cwt                   18.50000  7.682956 45  2.407927  0.0202
## nitrogen0.4cwt                   34.66667  7.682956 45  4.512152  0.0000
## nitrogen0.6cwt                   44.83333  7.682956 45  5.835427  0.0000
## varietyMarvellous:nitrogen0.2cwt  3.33333 10.865341 45  0.306786  0.7604
## varietyVictory:nitrogen0.2cwt    -0.33333 10.865341 45 -0.030679  0.9757
## varietyMarvellous:nitrogen0.4cwt -4.16667 10.865341 45 -0.383482  0.7032
## varietyVictory:nitrogen0.4cwt     4.66667 10.865341 45  0.429500  0.6696
## varietyMarvellous:nitrogen0.6cwt -4.66667 10.865341 45 -0.429500  0.6696
## varietyVictory:nitrogen0.6cwt     2.16667 10.865341 45  0.199411  0.8428
##  Correlation: 
##                                  (Intr) vrtyMr vrtyVc ntr0.2 ntr0.4 ntr0.6
## varietyMarvellous                -0.533                                   
## varietyVictory                   -0.533  0.500                            
## nitrogen0.2cwt                   -0.422  0.395  0.395                     
## nitrogen0.4cwt                   -0.422  0.395  0.395  0.500              
## nitrogen0.6cwt                   -0.422  0.395  0.395  0.500  0.500       
## varietyMarvellous:nitrogen0.2cwt  0.298 -0.559 -0.280 -0.707 -0.354 -0.354
## varietyVictory:nitrogen0.2cwt     0.298 -0.280 -0.559 -0.707 -0.354 -0.354
## varietyMarvellous:nitrogen0.4cwt  0.298 -0.559 -0.280 -0.354 -0.707 -0.354
## varietyVictory:nitrogen0.4cwt     0.298 -0.280 -0.559 -0.354 -0.707 -0.354
## varietyMarvellous:nitrogen0.6cwt  0.298 -0.559 -0.280 -0.354 -0.354 -0.707
## varietyVictory:nitrogen0.6cwt     0.298 -0.280 -0.559 -0.354 -0.354 -0.707
##                                  vM:0.2 vV:0.2 vM:0.4 vV:0.4 vM:0.6
## varietyMarvellous                                                  
## varietyVictory                                                     
## nitrogen0.2cwt                                                     
## nitrogen0.4cwt                                                     
## nitrogen0.6cwt                                                     
## varietyMarvellous:nitrogen0.2cwt                                   
## varietyVictory:nitrogen0.2cwt     0.500                            
## varietyMarvellous:nitrogen0.4cwt  0.500  0.250                     
## varietyVictory:nitrogen0.4cwt     0.250  0.500  0.500              
## varietyMarvellous:nitrogen0.6cwt  0.500  0.250  0.500  0.250       
## varietyVictory:nitrogen0.6cwt     0.250  0.500  0.250  0.500  0.500
## 
## Standardized Within-Group Residuals:
##         Min          Q1         Med          Q3         Max 
## -1.81300913 -0.56144819  0.01758018  0.63864472  1.57034195 
## 
## Number of Observations: 72
## Number of Groups: 
##               block mainplot %in% block 
##                   6                  18
</code></pre>
<h4 id="non-linear-models">Non-linear models<a class="headerlink" href="#non-linear-models" title="Permanent link">&para;</a></h4>
<pre><code># Set seed
set.seed(20160227)

# Data
x &lt;- seq(0,50,1)
y &lt;- ((runif(1,10,20)*x)/(runif(1,0,10)+x))+rnorm(51,0,1)

# Non-linear model
nls.m &lt;- nls(y ~ a*x/(b+x), 
             start=c(a=4, b=1))
</code></pre>
<h4 id="generalized-linear-models-glm">Generalized Linear Models (GLM)<a class="headerlink" href="#generalized-linear-models-glm" title="Permanent link">&para;</a></h4>
<pre><code># Load package
library(MPDiR)

# Get the data
data(Chromatic)

# Model
glm.m &lt;- glm(Thresh ~ Axis:(I(Age^-1) + Age),
             family = Gamma(link = "identity"), 
             data = Chromatic)

# Get back a summary
summary(glm.m)

## 
## Call:
## glm(formula = Thresh ~ Axis:(I(Age^-1) + Age), family = Gamma(link = "identity"), 
##     data = Chromatic)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.2160  -0.3728  -0.0805   0.2311   1.2932  
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          3.282e-04  9.965e-05   3.294  0.00106 ** 
## AxisDeutan:I(Age^-1) 7.803e-03  3.686e-04  21.172  &lt; 2e-16 ***
## AxisProtan:I(Age^-1) 8.271e-03  3.863e-04  21.410  &lt; 2e-16 ***
## AxisTritan:I(Age^-1) 1.166e-02  5.284e-04  22.065  &lt; 2e-16 ***
## AxisDeutan:Age       1.521e-05  3.418e-06   4.450 1.06e-05 ***
## AxisProtan:Age       1.540e-05  3.434e-06   4.484 9.10e-06 ***
## AxisTritan:Age       4.812e-05  5.838e-06   8.241 1.48e-15 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for Gamma family taken to be 0.2054848)
## 
##     Null deviance: 543.35  on 510  degrees of freedom
## Residual deviance: 100.40  on 504  degrees of freedom
## AIC: -4777.6
## 
## Number of Fisher Scoring iterations: 6
</code></pre>
<h3 id="use-formulas-in-graphical-functions">Use formulas in graphical functions<a class="headerlink" href="#use-formulas-in-graphical-functions" title="Permanent link">&para;</a></h3>
<h4 id="basic">Basic<a class="headerlink" href="#basic" title="Permanent link">&para;</a></h4>
<pre><code># Get data
data(airquality)

# Plot
plot(Ozone ~ Wind, data = airquality, pch = as.character(Month))
</code></pre>
<p><img alt="" src="../img/Formulas_in_R_files/unnamed-chunk-16-1.png" /></p>
<h4 id="the-lattice-package">The <code>lattice</code> package<a class="headerlink" href="#the-lattice-package" title="Permanent link">&para;</a></h4>
<pre><code># Load package
library(lattice)

# Plot histogram
histogram(~ Ozone | factor(Month), 
          data = airquality, 
          layout = c(2, 3),
          xlab = "Ozone (ppb)")
</code></pre>
<p><img alt="" src="../img/Formulas_in_R_files/unnamed-chunk-17-1.png" /></p>
<h4 id="the-ggplot2-package">The <code>ggplot2</code> package<a class="headerlink" href="#the-ggplot2-package" title="Permanent link">&para;</a></h4>
<pre><code># Load package
library(ggplot2)

# Plot
ggplot(mpg, aes(displ, hwy)) +
  geom_point() +
  geom_smooth(method = "lm", 
              formula = y ~ splines::bs(x, 3), 
              se = FALSE)
</code></pre>
<p><img alt="" src="../img/Formulas_in_R_files/unnamed-chunk-18-1.png" /></p>
<pre><code>ggplot(mpg, aes(displ, hwy)) +
  geom_point() +
  geom_smooth(span = 0.8) +
  facet_wrap(~drv)
</code></pre>
<p><img alt="" src="../img/Formulas_in_R_files/unnamed-chunk-18-2.png" /></p>
<h4 id="the-ggformula-package">The <code>ggformula</code> package<a class="headerlink" href="#the-ggformula-package" title="Permanent link">&para;</a></h4>
<p><code>ggplot2</code>, but provides an interface that is based on formulas like the<br />
<code>lattice</code> package. Check out the vignette.</p>
<pre><code># Load package
library(ggformula)

# Plot
gf_point(mpg ~ hp, data = mtcars)
</code></pre>
<p><img alt="" src="../img/Formulas_in_R_files/unnamed-chunk-19-1.png" /></p>
<h4 id="the-dplyr-package">The <code>dplyr</code> package<a class="headerlink" href="#the-dplyr-package" title="Permanent link">&para;</a></h4>
<p>Standard and non-standard evaluation.</p>
<pre><code># Load `dplyr`
library(dplyr)

# NSE evaluation
select(iris, Sepal.Length, Petal.Length)

##     Sepal.Length Petal.Length
## 1            5.1          1.4
## 2            4.9          1.4
## 3            4.7          1.3
## 4            4.6          1.5
## 5            5.0          1.4
## 6            5.4          1.7
## 7            4.6          1.4
## 8            5.0          1.5
## 9            4.4          1.4
## 10           4.9          1.5
## 11           5.4          1.5
## 12           4.8          1.6
## 13           4.8          1.4
## 14           4.3          1.1
## 15           5.8          1.2
## 16           5.7          1.5
## 17           5.4          1.3
## 18           5.1          1.4
## 19           5.7          1.7
## 20           5.1          1.5
## 21           5.4          1.7
## 22           5.1          1.5
## 23           4.6          1.0
## 24           5.1          1.7
## 25           4.8          1.9
## 26           5.0          1.6
## 27           5.0          1.6
## 28           5.2          1.5
## 29           5.2          1.4
## 30           4.7          1.6
## 31           4.8          1.6
## 32           5.4          1.5
## 33           5.2          1.5
## 34           5.5          1.4
## 35           4.9          1.5
## 36           5.0          1.2
## 37           5.5          1.3
## 38           4.9          1.4
## 39           4.4          1.3
## 40           5.1          1.5
## 41           5.0          1.3
## 42           4.5          1.3
## 43           4.4          1.3
## 44           5.0          1.6
## 45           5.1          1.9
## 46           4.8          1.4
## 47           5.1          1.6
## 48           4.6          1.4
## 49           5.3          1.5
## 50           5.0          1.4
## 51           7.0          4.7
## 52           6.4          4.5
## 53           6.9          4.9
## 54           5.5          4.0
## 55           6.5          4.6
## 56           5.7          4.5
## 57           6.3          4.7
## 58           4.9          3.3
## 59           6.6          4.6
## 60           5.2          3.9
## 61           5.0          3.5
## 62           5.9          4.2
## 63           6.0          4.0
## 64           6.1          4.7
## 65           5.6          3.6
## 66           6.7          4.4
## 67           5.6          4.5
## 68           5.8          4.1
## 69           6.2          4.5
## 70           5.6          3.9
## 71           5.9          4.8
## 72           6.1          4.0
## 73           6.3          4.9
## 74           6.1          4.7
## 75           6.4          4.3
## 76           6.6          4.4
## 77           6.8          4.8
## 78           6.7          5.0
## 79           6.0          4.5
## 80           5.7          3.5
## 81           5.5          3.8
## 82           5.5          3.7
## 83           5.8          3.9
## 84           6.0          5.1
## 85           5.4          4.5
## 86           6.0          4.5
## 87           6.7          4.7
## 88           6.3          4.4
## 89           5.6          4.1
## 90           5.5          4.0
## 91           5.5          4.4
## 92           6.1          4.6
## 93           5.8          4.0
## 94           5.0          3.3
## 95           5.6          4.2
## 96           5.7          4.2
## 97           5.7          4.2
## 98           6.2          4.3
## 99           5.1          3.0
## 100          5.7          4.1
## 101          6.3          6.0
## 102          5.8          5.1
## 103          7.1          5.9
## 104          6.3          5.6
## 105          6.5          5.8
## 106          7.6          6.6
## 107          4.9          4.5
## 108          7.3          6.3
## 109          6.7          5.8
## 110          7.2          6.1
## 111          6.5          5.1
## 112          6.4          5.3
## 113          6.8          5.5
## 114          5.7          5.0
## 115          5.8          5.1
## 116          6.4          5.3
## 117          6.5          5.5
## 118          7.7          6.7
## 119          7.7          6.9
## 120          6.0          5.0
## 121          6.9          5.7
## 122          5.6          4.9
## 123          7.7          6.7
## 124          6.3          4.9
## 125          6.7          5.7
## 126          7.2          6.0
## 127          6.2          4.8
## 128          6.1          4.9
## 129          6.4          5.6
## 130          7.2          5.8
## 131          7.4          6.1
## 132          7.9          6.4
## 133          6.4          5.6
## 134          6.3          5.1
## 135          6.1          5.6
## 136          7.7          6.1
## 137          6.3          5.6
## 138          6.4          5.5
## 139          6.0          4.8
## 140          6.9          5.4
## 141          6.7          5.6
## 142          6.9          5.1
## 143          5.8          5.1
## 144          6.8          5.9
## 145          6.7          5.7
## 146          6.7          5.2
## 147          6.3          5.0
## 148          6.5          5.2
## 149          6.2          5.4
## 150          5.9          5.1

# standard evaluation 
select_(iris, ~Sepal.Length)

##     Sepal.Length
## 1            5.1
## 2            4.9
## 3            4.7
## 4            4.6
## 5            5.0
## 6            5.4
## 7            4.6
## 8            5.0
## 9            4.4
## 10           4.9
## 11           5.4
## 12           4.8
## 13           4.8
## 14           4.3
## 15           5.8
## 16           5.7
## 17           5.4
## 18           5.1
## 19           5.7
## 20           5.1
## 21           5.4
## 22           5.1
## 23           4.6
## 24           5.1
## 25           4.8
## 26           5.0
## 27           5.0
## 28           5.2
## 29           5.2
## 30           4.7
## 31           4.8
## 32           5.4
## 33           5.2
## 34           5.5
## 35           4.9
## 36           5.0
## 37           5.5
## 38           4.9
## 39           4.4
## 40           5.1
## 41           5.0
## 42           4.5
## 43           4.4
## 44           5.0
## 45           5.1
## 46           4.8
## 47           5.1
## 48           4.6
## 49           5.3
## 50           5.0
## 51           7.0
## 52           6.4
## 53           6.9
## 54           5.5
## 55           6.5
## 56           5.7
## 57           6.3
## 58           4.9
## 59           6.6
## 60           5.2
## 61           5.0
## 62           5.9
## 63           6.0
## 64           6.1
## 65           5.6
## 66           6.7
## 67           5.6
## 68           5.8
## 69           6.2
## 70           5.6
## 71           5.9
## 72           6.1
## 73           6.3
## 74           6.1
## 75           6.4
## 76           6.6
## 77           6.8
## 78           6.7
## 79           6.0
## 80           5.7
## 81           5.5
## 82           5.5
## 83           5.8
## 84           6.0
## 85           5.4
## 86           6.0
## 87           6.7
## 88           6.3
## 89           5.6
## 90           5.5
## 91           5.5
## 92           6.1
## 93           5.8
## 94           5.0
## 95           5.6
## 96           5.7
## 97           5.7
## 98           6.2
## 99           5.1
## 100          5.7
## 101          6.3
## 102          5.8
## 103          7.1
## 104          6.3
## 105          6.5
## 106          7.6
## 107          4.9
## 108          7.3
## 109          6.7
## 110          7.2
## 111          6.5
## 112          6.4
## 113          6.8
## 114          5.7
## 115          5.8
## 116          6.4
## 117          6.5
## 118          7.7
## 119          7.7
## 120          6.0
## 121          6.9
## 122          5.6
## 123          7.7
## 124          6.3
## 125          6.7
## 126          7.2
## 127          6.2
## 128          6.1
## 129          6.4
## 130          7.2
## 131          7.4
## 132          7.9
## 133          6.4
## 134          6.3
## 135          6.1
## 136          7.7
## 137          6.3
## 138          6.4
## 139          6.0
## 140          6.9
## 141          6.7
## 142          6.9
## 143          5.8
## 144          6.8
## 145          6.7
## 146          6.7
## 147          6.3
## 148          6.5
## 149          6.2
## 150          5.9

select_(iris, ~Sepal.Length, ~Petal.Length) #works

##     Sepal.Length Petal.Length
## 1            5.1          1.4
## 2            4.9          1.4
## 3            4.7          1.3
## 4            4.6          1.5
## 5            5.0          1.4
## 6            5.4          1.7
## 7            4.6          1.4
## 8            5.0          1.5
## 9            4.4          1.4
## 10           4.9          1.5
## 11           5.4          1.5
## 12           4.8          1.6
## 13           4.8          1.4
## 14           4.3          1.1
## 15           5.8          1.2
## 16           5.7          1.5
## 17           5.4          1.3
## 18           5.1          1.4
## 19           5.7          1.7
## 20           5.1          1.5
## 21           5.4          1.7
## 22           5.1          1.5
## 23           4.6          1.0
## 24           5.1          1.7
## 25           4.8          1.9
## 26           5.0          1.6
## 27           5.0          1.6
## 28           5.2          1.5
## 29           5.2          1.4
## 30           4.7          1.6
## 31           4.8          1.6
## 32           5.4          1.5
## 33           5.2          1.5
## 34           5.5          1.4
## 35           4.9          1.5
## 36           5.0          1.2
## 37           5.5          1.3
## 38           4.9          1.4
## 39           4.4          1.3
## 40           5.1          1.5
## 41           5.0          1.3
## 42           4.5          1.3
## 43           4.4          1.3
## 44           5.0          1.6
## 45           5.1          1.9
## 46           4.8          1.4
## 47           5.1          1.6
## 48           4.6          1.4
## 49           5.3          1.5
## 50           5.0          1.4
## 51           7.0          4.7
## 52           6.4          4.5
## 53           6.9          4.9
## 54           5.5          4.0
## 55           6.5          4.6
## 56           5.7          4.5
## 57           6.3          4.7
## 58           4.9          3.3
## 59           6.6          4.6
## 60           5.2          3.9
## 61           5.0          3.5
## 62           5.9          4.2
## 63           6.0          4.0
## 64           6.1          4.7
## 65           5.6          3.6
## 66           6.7          4.4
## 67           5.6          4.5
## 68           5.8          4.1
## 69           6.2          4.5
## 70           5.6          3.9
## 71           5.9          4.8
## 72           6.1          4.0
## 73           6.3          4.9
## 74           6.1          4.7
## 75           6.4          4.3
## 76           6.6          4.4
## 77           6.8          4.8
## 78           6.7          5.0
## 79           6.0          4.5
## 80           5.7          3.5
## 81           5.5          3.8
## 82           5.5          3.7
## 83           5.8          3.9
## 84           6.0          5.1
## 85           5.4          4.5
## 86           6.0          4.5
## 87           6.7          4.7
## 88           6.3          4.4
## 89           5.6          4.1
## 90           5.5          4.0
## 91           5.5          4.4
## 92           6.1          4.6
## 93           5.8          4.0
## 94           5.0          3.3
## 95           5.6          4.2
## 96           5.7          4.2
## 97           5.7          4.2
## 98           6.2          4.3
## 99           5.1          3.0
## 100          5.7          4.1
## 101          6.3          6.0
## 102          5.8          5.1
## 103          7.1          5.9
## 104          6.3          5.6
## 105          6.5          5.8
## 106          7.6          6.6
## 107          4.9          4.5
## 108          7.3          6.3
## 109          6.7          5.8
## 110          7.2          6.1
## 111          6.5          5.1
## 112          6.4          5.3
## 113          6.8          5.5
## 114          5.7          5.0
## 115          5.8          5.1
## 116          6.4          5.3
## 117          6.5          5.5
## 118          7.7          6.7
## 119          7.7          6.9
## 120          6.0          5.0
## 121          6.9          5.7
## 122          5.6          4.9
## 123          7.7          6.7
## 124          6.3          4.9
## 125          6.7          5.7
## 126          7.2          6.0
## 127          6.2          4.8
## 128          6.1          4.9
## 129          6.4          5.6
## 130          7.2          5.8
## 131          7.4          6.1
## 132          7.9          6.4
## 133          6.4          5.6
## 134          6.3          5.1
## 135          6.1          5.6
## 136          7.7          6.1
## 137          6.3          5.6
## 138          6.4          5.5
## 139          6.0          4.8
## 140          6.9          5.4
## 141          6.7          5.6
## 142          6.9          5.1
## 143          5.8          5.1
## 144          6.8          5.9
## 145          6.7          5.7
## 146          6.7          5.2
## 147          6.3          5.0
## 148          6.5          5.2
## 149          6.2          5.4
## 150          5.9          5.1

select_(iris, quote(Sepal.Length), quote(Petal.Length)) # yes!

##     Sepal.Length Petal.Length
## 1            5.1          1.4
## 2            4.9          1.4
## 3            4.7          1.3
## 4            4.6          1.5
## 5            5.0          1.4
## 6            5.4          1.7
## 7            4.6          1.4
## 8            5.0          1.5
## 9            4.4          1.4
## 10           4.9          1.5
## 11           5.4          1.5
## 12           4.8          1.6
## 13           4.8          1.4
## 14           4.3          1.1
## 15           5.8          1.2
## 16           5.7          1.5
## 17           5.4          1.3
## 18           5.1          1.4
## 19           5.7          1.7
## 20           5.1          1.5
## 21           5.4          1.7
## 22           5.1          1.5
## 23           4.6          1.0
## 24           5.1          1.7
## 25           4.8          1.9
## 26           5.0          1.6
## 27           5.0          1.6
## 28           5.2          1.5
## 29           5.2          1.4
## 30           4.7          1.6
## 31           4.8          1.6
## 32           5.4          1.5
## 33           5.2          1.5
## 34           5.5          1.4
## 35           4.9          1.5
## 36           5.0          1.2
## 37           5.5          1.3
## 38           4.9          1.4
## 39           4.4          1.3
## 40           5.1          1.5
## 41           5.0          1.3
## 42           4.5          1.3
## 43           4.4          1.3
## 44           5.0          1.6
## 45           5.1          1.9
## 46           4.8          1.4
## 47           5.1          1.6
## 48           4.6          1.4
## 49           5.3          1.5
## 50           5.0          1.4
## 51           7.0          4.7
## 52           6.4          4.5
## 53           6.9          4.9
## 54           5.5          4.0
## 55           6.5          4.6
## 56           5.7          4.5
## 57           6.3          4.7
## 58           4.9          3.3
## 59           6.6          4.6
## 60           5.2          3.9
## 61           5.0          3.5
## 62           5.9          4.2
## 63           6.0          4.0
## 64           6.1          4.7
## 65           5.6          3.6
## 66           6.7          4.4
## 67           5.6          4.5
## 68           5.8          4.1
## 69           6.2          4.5
## 70           5.6          3.9
## 71           5.9          4.8
## 72           6.1          4.0
## 73           6.3          4.9
## 74           6.1          4.7
## 75           6.4          4.3
## 76           6.6          4.4
## 77           6.8          4.8
## 78           6.7          5.0
## 79           6.0          4.5
## 80           5.7          3.5
## 81           5.5          3.8
## 82           5.5          3.7
## 83           5.8          3.9
## 84           6.0          5.1
## 85           5.4          4.5
## 86           6.0          4.5
## 87           6.7          4.7
## 88           6.3          4.4
## 89           5.6          4.1
## 90           5.5          4.0
## 91           5.5          4.4
## 92           6.1          4.6
## 93           5.8          4.0
## 94           5.0          3.3
## 95           5.6          4.2
## 96           5.7          4.2
## 97           5.7          4.2
## 98           6.2          4.3
## 99           5.1          3.0
## 100          5.7          4.1
## 101          6.3          6.0
## 102          5.8          5.1
## 103          7.1          5.9
## 104          6.3          5.6
## 105          6.5          5.8
## 106          7.6          6.6
## 107          4.9          4.5
## 108          7.3          6.3
## 109          6.7          5.8
## 110          7.2          6.1
## 111          6.5          5.1
## 112          6.4          5.3
## 113          6.8          5.5
## 114          5.7          5.0
## 115          5.8          5.1
## 116          6.4          5.3
## 117          6.5          5.5
## 118          7.7          6.7
## 119          7.7          6.9
## 120          6.0          5.0
## 121          6.9          5.7
## 122          5.6          4.9
## 123          7.7          6.7
## 124          6.3          4.9
## 125          6.7          5.7
## 126          7.2          6.0
## 127          6.2          4.8
## 128          6.1          4.9
## 129          6.4          5.6
## 130          7.2          5.8
## 131          7.4          6.1
## 132          7.9          6.4
## 133          6.4          5.6
## 134          6.3          5.1
## 135          6.1          5.6
## 136          7.7          6.1
## 137          6.3          5.6
## 138          6.4          5.5
## 139          6.0          4.8
## 140          6.9          5.4
## 141          6.7          5.6
## 142          6.9          5.1
## 143          5.8          5.1
## 144          6.8          5.9
## 145          6.7          5.7
## 146          6.7          5.2
## 147          6.3          5.0
## 148          6.5          5.2
## 149          6.2          5.4
## 150          5.9          5.1

select_(iris, "Sepal.Length", "Petal.Length", "Species")

##     Sepal.Length Petal.Length    Species
## 1            5.1          1.4     setosa
## 2            4.9          1.4     setosa
## 3            4.7          1.3     setosa
## 4            4.6          1.5     setosa
## 5            5.0          1.4     setosa
## 6            5.4          1.7     setosa
## 7            4.6          1.4     setosa
## 8            5.0          1.5     setosa
## 9            4.4          1.4     setosa
## 10           4.9          1.5     setosa
## 11           5.4          1.5     setosa
## 12           4.8          1.6     setosa
## 13           4.8          1.4     setosa
## 14           4.3          1.1     setosa
## 15           5.8          1.2     setosa
## 16           5.7          1.5     setosa
## 17           5.4          1.3     setosa
## 18           5.1          1.4     setosa
## 19           5.7          1.7     setosa
## 20           5.1          1.5     setosa
## 21           5.4          1.7     setosa
## 22           5.1          1.5     setosa
## 23           4.6          1.0     setosa
## 24           5.1          1.7     setosa
## 25           4.8          1.9     setosa
## 26           5.0          1.6     setosa
## 27           5.0          1.6     setosa
## 28           5.2          1.5     setosa
## 29           5.2          1.4     setosa
## 30           4.7          1.6     setosa
## 31           4.8          1.6     setosa
## 32           5.4          1.5     setosa
## 33           5.2          1.5     setosa
## 34           5.5          1.4     setosa
## 35           4.9          1.5     setosa
## 36           5.0          1.2     setosa
## 37           5.5          1.3     setosa
## 38           4.9          1.4     setosa
## 39           4.4          1.3     setosa
## 40           5.1          1.5     setosa
## 41           5.0          1.3     setosa
## 42           4.5          1.3     setosa
## 43           4.4          1.3     setosa
## 44           5.0          1.6     setosa
## 45           5.1          1.9     setosa
## 46           4.8          1.4     setosa
## 47           5.1          1.6     setosa
## 48           4.6          1.4     setosa
## 49           5.3          1.5     setosa
## 50           5.0          1.4     setosa
## 51           7.0          4.7 versicolor
## 52           6.4          4.5 versicolor
## 53           6.9          4.9 versicolor
## 54           5.5          4.0 versicolor
## 55           6.5          4.6 versicolor
## 56           5.7          4.5 versicolor
## 57           6.3          4.7 versicolor
## 58           4.9          3.3 versicolor
## 59           6.6          4.6 versicolor
## 60           5.2          3.9 versicolor
## 61           5.0          3.5 versicolor
## 62           5.9          4.2 versicolor
## 63           6.0          4.0 versicolor
## 64           6.1          4.7 versicolor
## 65           5.6          3.6 versicolor
## 66           6.7          4.4 versicolor
## 67           5.6          4.5 versicolor
## 68           5.8          4.1 versicolor
## 69           6.2          4.5 versicolor
## 70           5.6          3.9 versicolor
## 71           5.9          4.8 versicolor
## 72           6.1          4.0 versicolor
## 73           6.3          4.9 versicolor
## 74           6.1          4.7 versicolor
## 75           6.4          4.3 versicolor
## 76           6.6          4.4 versicolor
## 77           6.8          4.8 versicolor
## 78           6.7          5.0 versicolor
## 79           6.0          4.5 versicolor
## 80           5.7          3.5 versicolor
## 81           5.5          3.8 versicolor
## 82           5.5          3.7 versicolor
## 83           5.8          3.9 versicolor
## 84           6.0          5.1 versicolor
## 85           5.4          4.5 versicolor
## 86           6.0          4.5 versicolor
## 87           6.7          4.7 versicolor
## 88           6.3          4.4 versicolor
## 89           5.6          4.1 versicolor
## 90           5.5          4.0 versicolor
## 91           5.5          4.4 versicolor
## 92           6.1          4.6 versicolor
## 93           5.8          4.0 versicolor
## 94           5.0          3.3 versicolor
## 95           5.6          4.2 versicolor
## 96           5.7          4.2 versicolor
## 97           5.7          4.2 versicolor
## 98           6.2          4.3 versicolor
## 99           5.1          3.0 versicolor
## 100          5.7          4.1 versicolor
## 101          6.3          6.0  virginica
## 102          5.8          5.1  virginica
## 103          7.1          5.9  virginica
## 104          6.3          5.6  virginica
## 105          6.5          5.8  virginica
## 106          7.6          6.6  virginica
## 107          4.9          4.5  virginica
## 108          7.3          6.3  virginica
## 109          6.7          5.8  virginica
## 110          7.2          6.1  virginica
## 111          6.5          5.1  virginica
## 112          6.4          5.3  virginica
## 113          6.8          5.5  virginica
## 114          5.7          5.0  virginica
## 115          5.8          5.1  virginica
## 116          6.4          5.3  virginica
## 117          6.5          5.5  virginica
## 118          7.7          6.7  virginica
## 119          7.7          6.9  virginica
## 120          6.0          5.0  virginica
## 121          6.9          5.7  virginica
## 122          5.6          4.9  virginica
## 123          7.7          6.7  virginica
## 124          6.3          4.9  virginica
## 125          6.7          5.7  virginica
## 126          7.2          6.0  virginica
## 127          6.2          4.8  virginica
## 128          6.1          4.9  virginica
## 129          6.4          5.6  virginica
## 130          7.2          5.8  virginica
## 131          7.4          6.1  virginica
## 132          7.9          6.4  virginica
## 133          6.4          5.6  virginica
## 134          6.3          5.1  virginica
## 135          6.1          5.6  virginica
## 136          7.7          6.1  virginica
## 137          6.3          5.6  virginica
## 138          6.4          5.5  virginica
## 139          6.0          4.8  virginica
## 140          6.9          5.4  virginica
## 141          6.7          5.6  virginica
## 142          6.9          5.1  virginica
## 143          5.8          5.1  virginica
## 144          6.8          5.9  virginica
## 145          6.7          5.7  virginica
## 146          6.7          5.2  virginica
## 147          6.3          5.0  virginica
## 148          6.5          5.2  virginica
## 149          6.2          5.4  virginica
## 150          5.9          5.1  virginica
</code></pre>
<h4 id="other-packages">Other packages<a class="headerlink" href="#other-packages" title="Permanent link">&para;</a></h4>
<ul>
<li><code>Formula</code>,</li>
<li><code>formula.tools</code>.</li>
</ul>
<p>From R for Data Science by Garrett Grolemund and Hadley Wickham (2017).</p>
<hr />
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../googleVis/" class="btn btn-neutral float-right" title="googleVis (embed HTML plots)">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../Improved_codes/" class="btn btn-neutral" title="Improved codes"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p> Ugo Sparks</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../Improved_codes/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../googleVis/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../js/theme.js"></script>
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
      <script src="../mathjaxhelper.js"></script>

</body>
</html>
